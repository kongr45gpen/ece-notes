% !TeX program = xelatex
\documentclass[11pt,a4paper,notitlepage,fleqn,draft]{article}

\input{preamble.tex}

\title{ΨΕΣ
	\\
	{ 
		\normalsize Ψηφιακή Επεξεργασία Σήματος
		\\
		\normalsize Σημειώσεις από τις παραδόσεις\footnote{Όπως διδάσκονται στο τμήμα \textit{Ηλεκτρολόγων Μηχανικών και Μηχανικών Υπολογιστών} στο \textit{Αριστοτέλειο Πανεπιστήμιο Θεσσαλονίκης}.}
	}}
\date{Φθινόπωρο 2018
	\\
	{ 
		\small Τελευταία ενημέρωση: \today
	}
}
\author{
	Για τον κώδικα σε \LaTeX, ενημερώσεις και προτάσεις:
	\\
	\url{https://github.com/kongr45gpen/ece-notes}}

\setallmainfonts(Digits,Latin,Greek){Asana Math}
\setmainfont{Noto Serif}
\setsansfont{Ubuntu}
\usepackage{polyglossia}
\newfontfamily\greekfont[Script=Greek,Scale=1.00]{Liberation Serif}

\hypersetup{pdftitle = {Ψηφιακή Επεξεργασία Σήματος}}

\let\mytodo\todo
\renewcommand{\todo}[1]{\par\mytodo[inline,noline]{#1}}


\begin{document}
\maketitle

\hrule
\vspace{50pt}

\begin{infobox}{Λάθη \& Διορθώσεις}
	Οι τελευταίες εκδόσεις των σημειώσεων βρίσκονται στο Github
	(\url{https://github.com/kongr45gpen/ece-notes/raw/master/dsp.pdf}) ή
	στη διεύθυνση \url{http://helit.org/ece-notes/dsp.pdf}.
	
	Περιέχουν διορθώσεις σε λάθη και τυχόν βελτιώσεις.
	
	\tcblower
	
	Μπορείτε να ενημερώνετε για οποιοδήποτε λάθος και πρόταση
	μέσω PM στο forum, issue στο Github, ή οποιουδήποτε άλλου τρόπου.
\end{infobox}

{
	\hypersetup{linkcolor=black}
	\listoflecture
	\tableofcontents
}

\newpage

\section{Εισαγωγή}

\lecture{1}{1/10/2018}
	
Στο μάθημα της \textbf{Ψηφιακής Επεξεργασίας Σήματος} ασχολούμαστε
με προβλήματα όπως το εξής:

Παλιότερα, αν μας ζητούνταν να κατασκευάσουμε ένα φίλτρο (π.χ.
ζωνοπερατό από 20 Hz - 500 kHz), μπορούσαμε πολύ εύκολα να αγοράσουμε μια σακούλα με
όλα τα εξαρτήματα (πυκνωτές, αντιστάσεις, \textellipsis) από ένα
κατάστημα και να φτιάξουμε το κύκλωμα.

Αν αργότερα μας ζητούσαν να φτιάξουμε ένα φίλτρο 20 Hz - 300 kHz, θα
έπρεπε να ξαναπάμε στο κατάστημα και να αγοράσουμε ξανά νέα σακούλα και νέα εξαρτήματα
και να ξανακατασκευάσουμε το κύκλωμα.

Από τη στιγμή όμως που εφευρέθηκαν οι υπολογιστές, φανταστήκαμε να τους
χρησιμοποιήσουμε και για να πραγματοποιήσουμε την παραπάνω διαδικασία και
να αλλάζουμε προδιαγραφές όσο συχνά θέλουμε χωρίς να τρέχουμε στο κατάστημα.

Αυτή η διαδικασία απαιτεί τα εξής:
\begin{itemize}
	\item Πρέπει να μετατρέψουμε το \textit{πραγματικό} \textit{αναλογικό}
	σήμα σε μια μορφή που αναγνωρίζει αυτός ο υπολογιστής. Δηλαδή να μετατραπεί
	από αναλογικό σε ψηφιακό. Αυτό γίνεται με δύο βήματα:
	\begin{enumerate}
		\item \textbf{Δειγματοληψία}. Πρώτα πρέπει με έναν συγκεκριμένο τρόπο
		να λάβουμε \textit{δείγματα} σε \textit{διακριτές} στιγμές του αρχικού
		αναλογικού σήματος. Αφού ο υπολογιστής δεν μπορεί να αποθηκεύσει
		άπειρες τιμές, αναγκαστικά θα λάβουμε ένα πεπερασμένο εύρος τους.
		
		\begin{center}
		\begin{tikzpicture}
		\def\points{(0,0) (0.2,0.2) (0.4,0.5) (0.6,0.7)
			(0.8,0.9) (1,0.7) (1.2,0.6) (1.4,1) (1.6,0.8) (1.8,0.8) (2,1.1) (2.2,1.4)
			(2.4, 1.2) (2.6,1.1) (2.8,1) (3,0.95)
		}
		\def\pointsc{(0,0),(0.2,0.2),(0.4,0.5),(0.6,0.7),(0.8,0.9),(1,0.7),(1.2,0.6),(1.4,1),(1.6,0.8),(1.8,0.8),(2,1.1),(2.2,1.4),(2.4, 1.2),(2.6,1.1),(2.8,1),(3,0.95)
		}
		\def\pointsr{(0,0),(0.2,0.21),(0.4,0.42),(0.6,0.63),(0.8,0.84),(1,0.63),(1.2,0.63),(1.4,1.05),(1.6,0.84),(1.8,0.84),(2,1.05),(2.2,1.47),(2.4, 1.26),(2.6,1.05),(2.8,1.05),(3,0.84)
		}
		
		\draw[->] (0,0) -- (3,0) node[below] {$t$};
		\draw[->] (0,0) -- (0,2) node[left] (xt) {$x(t)$} node[right,align=left,scale=.7] {αναλογικό\\σήμα};
		\draw (xt.south) node[below,scale=.7,yshift=2mm] {$\in\mathbb R$};
		
		\draw[\timecolour,thick]
		plot [smooth] coordinates \points;
		
		\foreach \p in \pointsc
		\filldraw[red,top color=white,bottom color=blue,opacity=.4] \p circle(0.05);
		
		\draw[<->,thick,opacity=.9]
		(3.75,1) -- ++(1,0);
		
		\begin{scope}[xshift=5.5cm]
		\draw[->] (0,0) -- (3,0) node[below] {$n\in\mathbb N$};
		\draw[->] (0,0) -- (0,2) node[left] (xn) {$x(n)$} node[right,align=left,scale=.7] {διακριτό\\σήμα};
		
		\draw (xn.south) node[below,scale=.7,yshift=2mm] {$\in\mathbb R$};
		
		\foreach \p in \pointsc
		\filldraw[draw=black,top color=white,bottom color=blue,opacity=.4] \p circle(0.05);
		\end{scope}
		
		\end{tikzpicture}
		\end{center}
		
		Αυτό το σήμα ονομάζεται \textbf{διακριτό} (\textbf{discrete}).
		\item \textbf{Κβάντωση}. Στον αναλογικό κόσμο, οι πεπερασμένες τιμές έχουν
		άπειρη ακρίβεια. Όμως στον υπολογιστή δεν μπορούμε να αποθηκεύσουμε άπειρα
		δεκαδικά ψηφία, αλλά πρέπει να τα αποθηκεύσουμε σε πεπερασμένες στάθμες
		που μας επιτρέπεται να χρησιμοποιηθούν.
		
		\begin{tikzpicture}
		\def\points{(0,0) (0.2,0.2) (0.4,0.5) (0.6,0.7)
			(0.8,0.9) (1,0.7) (1.2,0.6) (1.4,1) (1.6,0.8) (1.8,0.8) (2,1.1) (2.2,1.4)
			(2.4, 1.2) (2.6,1.1) (2.8,1) (3,0.95)
		}
		\def\pointsc{(0,0),(0.2,0.2),(0.4,0.5),(0.6,0.7),(0.8,0.9),(1,0.7),(1.2,0.6),(1.4,1),(1.6,0.8),(1.8,0.8),(2,1.1),(2.2,1.4),(2.4, 1.2),(2.6,1.1),(2.8,1),(3,0.95)
		}
		\def\pointsr{(0,0),(0.2,0.21),(0.4,0.42),(0.6,0.63),(0.8,0.84),(1,0.63),(1.2,0.63),(1.4,1.05),(1.6,0.84),(1.8,0.84),(2,1.05),(2.2,1.47),(2.4, 1.26),(2.6,1.05),(2.8,1.05),(3,0.84)
		}
		
		\draw[->] (0,0) -- (3,0) node[below] {$t$};
		\draw[->] (0,0) -- (0,2) node[left] (xt) {$x(t)$} node[right,align=left,scale=.7] {αναλογικό\\σήμα};
		\draw (xt.south) node[below,scale=.7,yshift=2mm] {$\in\mathbb R$};
		
		\draw[blue!50!cyan!80!brown,thick]
		plot [smooth] coordinates \points;
		
		\foreach \p in \pointsc
		\filldraw[red,top color=white,bottom color=blue,opacity=.4] \p circle(0.05);
		
		\draw[<->,thick,opacity=.9]
		(3.75,1) -- ++(1,0);
		
		\begin{scope}[xshift=5.5cm]
		\draw[->] (0,0) -- (3,0) node[below] {$n\in\mathbb N$};
		\draw[->] (0,0) -- (0,2) node[left] (xn) {$x(n)$} node[right,align=left,scale=.7] {διακριτό\\σήμα};
		
		\draw (xn.south) node[below,scale=.7,yshift=2mm] {$\in\mathbb R$};
		
		\foreach \y in {0,0.21,...,1.6}
		\draw[blue,opacity=.5,densely dashed] (0,\y) -- ++(3,0);
		
		\foreach \p in \pointsc
		\filldraw[draw=black,top color=white,bottom color=blue,opacity=.4] \p circle(0.05);
		\end{scope}
		
		\draw[->,thick,opacity=.9]
		(9.5,1) -- ++(1,0);
		
		\begin{scope}[xshift=11.25cm]
		\draw[->] (0,0) -- (3,0) node[below] {$n\in\mathbb N$};
		\draw[->] (0,0) -- (0,2) node[left] (xn) {$x(n)$} node[right,align=left,scale=.7] {ψηφιακό\\σήμα};
		
		\draw (xn.south) node[below,scale=.9,yshift=1mm] {$\in\mathbb Z$};
		
		\foreach \y in {0,0.21,...,1.6}
		\draw[blue,opacity=.5,densely dashed] (0,\y) -- ++(3,0);
		
		\foreach \p in \pointsr
		\filldraw[draw=black,top color=white!50!red,bottom color=blue,opacity=.4] \p circle(0.05);
		\end{scope}
		
		\end{tikzpicture}
		
		Αυτό το σήμα ονομάζεται \textbf{ψηφιακό} (\textbf{digital}).
	\end{enumerate}

	Σε αυτό το μάθημα, παρά τον τίτλο του, θα ασχοληθούμε με \textbf{διακριτά σήματα}, και
	όχι ψηφιακά.
	
	Για να επεξεργαστούμε τα σήματα, υποθέτουμε ότι θα υπάρχει μια συσκευή που
	μετατρέπει το \textit{Αναλογικό σήμα} σε \textit{Διακριτό σήμα} με τέτοιον τρόπο
	ώστε να μπορούμε να γυρίσουμε πίσω και να μπορούμε να το επεξεργαστούμε με έναν
	ασφαλή τρόπο που θα επιστρέψει σίγουρα σωστό αποτέλεσμα. Αυτό το εξασφαλίζει το
	\textbf{θεώρημα δειγματοληψίας} (Nyquist-Shannon), σύμφωνα με το οποίο για να
	αναπαραστήσουμε ένα ζωνοπερατό σήμα, αρκεί να το δειγματοληπτήσουμε με συχνότητα διπλάσια
	της μέγιστης συχνότητας του σήματος.
	
	Στην πραγματικότητα βέβαια, το θεώρημα δειγματοληψίας απαιτεί να δειγματοληπτούμε για άπειρο
	χρόνο, κάτι μη πραγματικά εφικτό. Μάλιστα, τα πραγματικά σήματα είναι \textit{χρονοπερατά}, άρα
	\textit{μη ζωνοπερατά}, επομένως εν γένει δεν εφαρμόζεται το θεώρημα δειγματοληψίας. Όμως η παραπάνω
	διαδικασία μπορούμε να πούμε ότι δίνει προσεγγιστικά ορθό αποτέλεσμα.
	
	Ακόμα, υπάρχουν σήματα που είναι από τη φύση τους ψηφιακά, όπως τιμές χρηματιστηρίου, ακολουθίες,
	δεδομένα, followers στο instagram, \textellipsis
	
	\item Παραμένει η ίδια η \textbf{επεξεργασία} του σήματος. Αυτή γίνεται με κώδικα ενός αλγορίθμου
	που εκτελεί πράξεις, δεδομένου ότι έχει επεξεργαστεί το σήμα σωστά.
\end{itemize}

Σχηματικά:

\begin{tikzpicture}

\pgfdeclarelayer{foreground}
\pgfsetlayers{main,foreground}

\draw[fill=yellow,draw opacity=.7,fill opacity=.15] (2.2,1.6) rectangle (5.2,-0.7) node[below,opacity=.7,circle,draw,inner sep=1pt,outer sep=2pt] {$A$};
\draw[fill=yellow,draw opacity=.7,fill opacity=.15] (-0.4,-2.3) rectangle (8.39,-3.7) node[below,opacity=.7,circle,draw,inner sep=1pt,outer sep=2pt] {$B$};

\draw (-2,0.5) node[scale=.9,align=center] {αναλογικός\\κόσμος};

\draw (0,0) --(1,0);
\draw (0,0) --(0,1);
\draw[\timecolour] plot[variable=\x,domain=0:1,samples=10,smooth]
(\x,{\x*((1+rand*0.3))});

\ctikzset{bipoles/length=.6cm}

\begin{pgfonlayer}{foreground}
\begin{scope}[xshift=3cm,yshift=1cm,local bounding box=scope1]
\draw (-0.1,0) node {};
\draw (0,0) to[L] ++(0.5,0);
\draw (0,-0.3) to[C] ++(0.5,0);
\draw (0,-0.7) to[R] ++(0.5,0);
\draw (0,-1.1) to[D] ++(0.5,0);

\draw (1.2,0) node {$H(\omega)$};
\draw (1.2,-0.4) node {$H(s)$};
\draw (1.2,-0.8) node {$h(t)$};
\draw (1.2,-1.2) node {???};
\end{scope}
\end{pgfonlayer}
\draw[fill=white] (scope1.north west) rectangle (scope1.south east);

\draw[<-] (scope1.west) -- ++(-1,0) node[left] {$x(t)$};
\draw[->] (scope1.east) -- ++(1,0) node[right] {$y(t)$};

\begin{scope}[xshift=6.5cm]
\draw (0,0) --(1.1,0);
\draw (0,0) --(0,1);
\draw[\timecolour] plot[variable=\x,domain=0:1,samples=10,smooth]
(\x,{(1-\x)*((0.9+rand*0.3))});
\end{scope}

\begin{scope}[yshift=-3cm]
\draw (-2,0) node[scale=.9,align=center] {ψηφιακός\\κόσμος};

\draw (1,0) node[rectangle,draw] (b1) {A$\to$D converter};
\draw (4,0) node[rectangle,scale=.8,draw,align=center] (b2)
{Algorithm\\Code\\ALU+Memory};
\draw (7,0) node[rectangle,draw] (b3) {D$\to$A converter};

\draw[<-] (b1.west) -- ++(-0.2,0) node[left,scale=.8] {$x(t)$};
\draw[->] (b1) -- (b2);
\draw[->] (b2) -- (b3);
\draw[->] (b3.east) -- ++(0.15,0) node[right,scale=.8] {$y(t)$};
\end{scope}
\end{tikzpicture}

Θέλουμε η διαδικασία \( A \) που είναι ένα \textbf{πραγματικό, φυσικό} φίλτρο ή κύκλωμα, να βγάζει
περίπου ίδιο αποτέλεσμα με μια διαδικασία \( B \) που υλοποιούμε ψηφιακά, δηλαδή:
\[
A \simeq B
\]
ή, ισοδύναμα για τα σήματα \( x(t) \) και \( y(t) \):
\begin{align*}
	A\left[x(t)\right] &\simeq B\left[x(t)\right] \\
	y_{\mathrm{analog}}(t) &\simeq y_{\mathrm{digital}}(t)
\end{align*}

\paragraph{}
Στο μάθημα θα ασχοληθούμε μόνο με \textbf{διακριτά}, όχι αυστηρά ψηφιακά σήματα. Παρακάτω στις σημειώσεις οι δύο όροι
συχνά θα χρησιμοποιούνται εναλλάξ, αλλά θα αναφέρονται πάντα στο απλώς \emph{διακριτό} σήμα.

\subsection{Ιδιότητες}
Όταν μιλάμε για διακριτό σήμα, μιλάμε ουσιαστικά για μία ακολουθία, όπως τη γνωρίζουμε από τα μαθηματικά.

\paragraph{Πράξεις}
Οι πράξεις σημάτων ορίζονται όπως και στις ακολουθίες. Ασχολούμαστε με τιμές ίδιων \textbf{δεικτών} (indices) \( n \):
\begin{enumerate}
	\item \textbf{Πρόσθεση}: \( x(n) + y(n) = z(n) \)
	\item \textbf{Πολλαπλασιασμός ακολουθιών}: \( x(n) \cdot y(n) = z(n) \)
	\item \textbf{Πολλαπλασιασμός αριθμού-ακολουθίας}: \( a\in\mathbb R,\ z(n) = a\cdot x(n) \)
\end{enumerate}

\paragraph{Άθροισμα γεωμετρικής προόδου}
Η γεωμετρική πρόοδος έχει σημαντική θέση στην ψηφιακή επεξεργασία σήματος (αφού στο αναλογικό σήμα
είχαμε το σημαντικό \( e^{j\omega t} \), εδώ είναι σημαντικό το \( e^{j\omega n} \) που εκφράζει συνεχή πολλαπλασιασμό με το \( e^{j\omega } \)):
\[
\sum_{n=0}^{\infty} a^n
= \begin{cases}
\displaystyle \frac{1}{1-a} &,\quad |a|<1\\
\text{αποκλίνει}&,\quad |a|>1
\end{cases}
\]
(για \( a=1 \) αποκλίνει, και για \( a=-1 \) ταλαντεύεται. Επίσης, η παραπάνω σχέση ισχύει και για
\( a\in\mathbb C \)).

\textbf{Προσοχή} ότι η παραπάνω σχέση ισχύει μόνο όταν το \( n \) ξεκινάει από το 0. Για παράδειγμα,
\( \sum_{n=1}^\infty {\left(\frac{1}{2}\right)^n} = \frac{1}{1-\frac{1}{2}}-1 = 1 \).

Για \textbf{πεπερασμένο αριθμό όρων}:
\[
\sum_{n=0}^{N} a^n
= \frac{1-a^{N+1}}{1-a}
\]

\subsubsection{Χρήσιμοι τύποι ακολουθιών}
\paragraph{Περιοδική ακολουθία}
\label{sec:periodic}
Η περιοδική ακολουθία περιέχει όρους που επαναλαμβάνονται, όπως και μία περιοδική συνάρτηση.
Μαθηματικά:
\[
\exists N \in \mathbb Z: \ \forall n \in \mathbb Z: \ x(n) = x(n+N)
\]
δηλαδή η περιοδική μας ακολουθία έχει μια \textbf{περίοδο \( \mathbb N \)} που είναι ακέραιος αριθμός.

\textbf{Προσοχή!} Δεδομένου ότι η \( \cos(\omega t) \) είναι \textit{περιοδική}, θα μπορούσε κάποιος
να φαντασεί ότι και η \( \cos(\omega n) \) είναι \textit{περιοδικό διακριτό σήμα}. Αν το δούμε μαθηματικά:
Έστω \( \exists N \in \mathbb Z:\ \cos(\omega n)=\cos\left( \omega (n+N) \right)
\implies \omega n = \omega n + \omega N + kπ \implies N = \frac{π}{\omega } \notin \mathbb Z \).

\begin{tikzpicture}[scale=.8]
\def\freq{0.5}

\draw (0,0) node[left,align=right,scale=.8] {περιοδικό\\ψηφιακό\\σήμα};

\draw (0,0) -- (10,0);
\draw (0,-1.5) -- (0,1.5);

\begin{scope}[green!50!black,opacity=.6]
\draw (0.5,1) -- (0.5,-1.5);
\draw (1,0) -- (1,-1.5);
\draw[<->] ([xshift=-1mm]1,-1.3) -- ([xshift=1mm]0.5,-1.3) node[below,yshift=-3mm,scale=.6,midway] {$f_s=2\;\mathrm{Hz}$};
\end{scope}

\draw[thick,timecolour]
plot[domain=0:9,samples=\lowsamples,smooth] (\x,{sin(\freq*2*pi*\x r)});

\foreach \x in {0.5,1,...,9} {
	\def\sample{sin(\freq*2*pi*\x r)}
	\draw[dashed,orange] (\x,0) -- (\x,{\sample});
	\filldraw[fill opacity=.8,fill=orange!50!white] (\x,{\sample}) circle (2.5pt);
}

\begin{scope}[yshift=-4cm]
\draw (0,0) node[left,align=right,scale=.8] {\emph{μη} περιοδικό\\ψηφιακό\\σήμα};

\draw (0,0) -- (10,0);
\draw (0,-1.5) -- (0,1.5);

\begin{scope}[green!50!black,opacity=.6]
\draw (0.55,{sin(\freq*2*pi*0.55 r)}) -- (0.55,-1.5);
\draw (1.1,{sin(\freq*2*pi*1.1 r)}) -- (1.1,-1.5);
\draw[<->] ([xshift=-1mm]1.1,-1.3) -- ([xshift=1mm]0.55,-1.3) node[below,yshift=-3mm,scale=.6,midway] {$f_s=1.28\sqrt{2}\;\mathrm{Hz}$};
\end{scope}

\draw[thick,timecolour]
plot[domain=0:9,samples=\lowsamples,smooth] (\x,{sin(\freq*2*pi*\x r)});

\foreach \x in {0.55,1.1,...,9} {
	\def\sample{sin(\freq*2*pi*\x r)}
	\draw[dashed,red] (\x,0) -- (\x,{\sample});
	\filldraw[fill opacity=.8,fill=red!50!white] (\x,{\sample}) circle (2.5pt);
}
\end{scope}
\end{tikzpicture}

Πρακτικά, δειγματοληπτούμε σε διαφορετικά σημεία, άσχετα ίσως από την περίοδο του σήματος. Γενικότερα,
όταν δειγματοληπτούμε περιοδικά αναλογικά σήματα, δεν θα παίρνουμε πάντα περιοδικά διακριτά πίσω.

Μάλιστα, κάτι άλλο περίεργο όταν δειγματοληπτούμε είναι πως για διαφορετικά αναλογικά σήματα, μπορεί
να πάρουμε το ίδιο ψηφιακό!

\begin{tikzpicture}
\draw (0,1.5) -- (0,-1.5);
\draw[->] (0,0) -- (5,0) node[below] {$t$};

\draw[\timecolour!40!black,very thick]
plot[samples=\lowsamples,smooth,domain=0:4,variable=\x]
(\x,{1.1*sin((\x*1.25*pi) r)});
\draw[\timecolour,very thick]
(0,0) -- (1/4*1.6,1) -- (3/4*1.6,-1) -- (5/4*1.6,1) -- (7/4*1.6,-1)
-- (9/4*1.6,1);
\end{tikzpicture}

Στο παραπάνω σχήμα, δειγματοληπτώντας στις κορυφές και στα μηδενικά, θα πάρουμε το ίδιο πράγμα από
τα δύο σήματα.

\paragraph{Άρτιες \& Περιττές ακολουθίες}
\begin{align*}
	\text{άρτια (even)} &\quad \forall n \in \mathbb Z: \ x_e(n) = x_e(-n) \\
	\text{περιττή (odd)} &\quad \forall n \in \mathbb Z: \ -x_o(n) = x_o(-n)
\end{align*}

Μπορούμε να μετατρέψουμε οποιαδήποτε ακολουθία σε ένα άρτιο και ένα περιττό μέρος:
\begin{align*}
	x_e(n) &= \frac{x(n) + x(-n)}{2}\\
	x_o(n) &= \frac{x(n) - x(-n)}{2}
\end{align*}

\subsubsection{Χαρακτηριστικά Μεγέθη}
\begin{minipage}{.6\textwidth}
\begin{enumerate}
	\item \textbf{Μέση τιμή}:
	\( \displaystyle
	\overline{x(n)} = \frac{\displaystyle \sum_{n=0}^{N} x(n)}{N+1}
	 \)
	\item \textbf{Ενεργός τιμή}:
	\( 
	\displaystyle
	\overline{\overline{x(n)}} = \left[
	\frac{\displaystyle \sum_{n=0}^{N} x^2(n)}{N+1}
	\right]^{\sfrac{1}{2} }
	 \)
	\item \textbf{Στιγμιαία ισχύς}:
	\( 
	\displaystyle
	p(n) = x^2(n)
	 \)
	\item \textbf{Μέση Ισχύς}:
	\( 
	\displaystyle
	p = \overline{p(n)} = \frac{\displaystyle \sum_{n=0}^{N} x^2(n)}{N+1}
	 \)
	\item \textbf{Ενέργεια}:
	\( 
	\displaystyle
	W = \sum_{n=0}^{N} x^2(n) = (N+1)p
	 \)
\end{enumerate}
\end{minipage}
\begin{minipage}{.4\textwidth}
	\begin{center}
		Σημείωση: Για μιγαδικές ακολουθίες θεωρούμε το \textbf{μέτρο} των τιμών της ακολουθίας για τον υπολογισμό ισχύος \& ενέργειας.
	\end{center}
\end{minipage}

\pagebreak[3]

\subsubsection{Χρήσιμες ακολουθίες}
\begin{enumpar}
	\item \textbf{Εκθετική ακολουθία}:

	\begin{minipage}{.5\textwidth}
		\begin{knowledgebox}{Εκθετική ακολουθία}
		\[ \displaystyle
		x(n) = Ae^{sn} = Aa^{(\sigma + j \omega )n}
		\]
		\end{knowledgebox}

		για την οποία λαμβάνουμε τις εξής περιπτώσεις για τις σταθερές:
		\begin{itemize}
			\item \( a=e \) και \( s = \sigma < 0 \):
			\[
			x(n) = Ae^{-|σ|n}
			\]
			(γεωμετρική πρόοδος με λόγο \( e^{-|σ|} \))
			\item \( a=e \) και \( s = \pm j\omega  \):
			\[
			x(n) = A\left[
			cos(\omega n) \pm j \sin(\omega n)
			\right]
			\]
			
			Είναι περιοδική \textit{μόνο} εάν \( \frac{\pi}{\omega } \in \mathbb Q \)
		\end{itemize}
	\end{minipage}
	\begin{minipage}{.5\textwidth}
		\begin{tikzpicture}
		\tikzstyle{sample}=[bottom color=orange,top color=\timecolour,fill opacity=.7,rounded corners=2.5pt,thick]
		
		\draw[->] (-3,0) -- (3.5,0);
		\draw[->] (0,0) -- (0,2)  node[right] {$x(n)$};
		
		\def\sf{0.7}
		\def\sx{0.11}
		\def\sy{0.09}
		
		\foreach \x in {-4,-3,...,4} {
			\draw (\x*\sf-0.1,0.1) -- (\x*\sf+0.1,-0.1);
			\draw (\x*\sf,-0.1) node[below,scale=.9] {$\x$};
		}
		
		\foreach \x in {-4,-3,...,4} {
			\filldraw[sample] (\x*\sf + \sx,{exp(\x/3)/2 + \sy}) rectangle ++(-\sx*2,-\sy*2);
		}
		\end{tikzpicture}
	\end{minipage}
    \item \textbf{Δέλτα του Kronecker}:

    \begin{minipage}{.5\textwidth}
    	\begin{knowledgebox}{Δέλτα του Kronecker}
    		\[ \displaystyle
    		\delta(n) = \begin{cases}
    		1 &\quad n=0\\
    		0 &\quad n\neq 0
    		\end{cases}
    		\]
    	\end{knowledgebox}
    \end{minipage}
	\begin{minipage}{.5\textwidth}
		\begin{tikzpicture}
		\tikzstyle{sample}=[bottom color=orange,top color=\timecolour,fill opacity=.7,rounded corners=2.5pt,thick]
		
		\draw[->] (-3,0) -- (3.5,0);
		\draw[->] (0,0) -- (0,2)  node[right] {$\delta(n)$};
		
		\def\sf{0.7}
		\def\sx{0.11}
		\def\sy{0.09}
		
		\foreach \x in {-4,-3,...,4} {
			\draw (\x*\sf-0.1,0.1) -- (\x*\sf+0.1,-0.1);
			\draw (\x*\sf,-0.1) node[below,scale=.9] {$\x$};
		}
		
		\foreach \x in {1,2,...,4} {
			\filldraw[sample] (\x*\sf + \sx,0 + \sy) rectangle ++(-\sx*2,-\sy*2);
			\filldraw[sample] (-\x*\sf + \sx,0 + \sy) rectangle ++(-\sx*2,-\sy*2);
		}
		\filldraw[sample] ( + \sx,1 + \sy) rectangle ++(-\sx*2,-\sy*2);
		\draw (0+0.15,1) node[right] {$1$};
		
		\end{tikzpicture}
	\end{minipage}
    \item \textbf{Βηματική ακολουθία step}:
    
    \begin{minipage}{.5\textwidth}
    \begin{knowledgebox}{Βηματική ακολουθία}
    	\[
    	u(n) = \begin{cases}
    	1 &\quad n \geq 0\\
    	0 &\quad n < 0
    	\end{cases}
    	\]
    \end{knowledgebox}
    
	\end{minipage}
	\begin{minipage}{.5\textwidth}
		\begin{tikzpicture}
		\tikzstyle{sample}=[bottom color=orange,top color=\timecolour,fill opacity=.7,rounded corners=2.5pt,thick]
		
		\draw[->] (-3,0) -- (3.5,0);
		\draw[->] (0,0) -- (0,2)  node[right] {$\mathrm u(n)$};
		
		\def\sf{0.7}
		\def\sx{0.11}
		\def\sy{0.09}
		
		\foreach \x in {-4,-3,...,4} {
			\draw (\x*\sf-0.1,0.1) -- (\x*\sf+0.1,-0.1);
			\draw (\x*\sf,-0.1) node[below,scale=.9] {$\x$};
		}
		
		\foreach \x in {1,2,...,4} {
			\filldraw[sample] (\x*\sf + \sx,1 + \sy) rectangle ++(-\sx*2,-\sy*2);
			\filldraw[sample] (-\x*\sf + \sx,0 + \sy) rectangle ++(-\sx*2,-\sy*2);
		}
		\filldraw[sample] ( + \sx,1 + \sy) rectangle ++(-\sx*2,-\sy*2);
		\draw (0-\sx,1) node[left] {$1$};
		
		\end{tikzpicture}
	\end{minipage}
    
    Μάλιστα, ισχύει ότι:
    \[
    u(n) = \sum_{m=-\infty}^{n} δ(m)
    \]
    κάτι που μας θυμίζει αντίστοιχα από το αναλογικό σήμα ότι \( u(t) = \int_{-\infty}^{t} δ(τ)\dif τ \)
\end{enumpar}

\subsubsection{Συνέλιξη}
Μπορούμε να μετατρέψουμε τη \textbf{συνέλιξη} του αναλογικού σήματος στο ψηφιακό.

Στο αναλογικό, θυμόμαστε ότι, σύμφωνα με τον ορισμό της συνέλιξης:
\[
x(t) = x(t) * δ(t) = \int_{-\infty}^{\infty} x(τ)δ(t-τ) \dif τ
\]
και στο ψηφιακό, μπορούμε να έχουμε κάτι αντίστοιχο: 
\begin{equation}
\label{eq:deltaconv}
x(n) = \sum_{m=-\infty}^{\infty} x(m) δ(n-m)
\end{equation}

\begin{defn}{Συνέλιξη}{}
	Η \textbf{συνέλιξη} δύο διακριτών σημάτων ορίζεται ως εξής:
	\[
	z(n) = x(n) * y(n) = \sum_{k=-\infty}^\infty x(k)y(n-k)
	\]
\end{defn}

\paragraph{Απόδειξη σχέσης \eqref{eq:deltaconv}}
Έχουμε:
\begin{align*}
	\sum_{m=-\infty}^{\infty} x(m)\delta(n-m) &=
	\sum_{m=-\infty}^{n-1} x(m) \cdot 0 + x(n) \cdot \delta(n-n) + \sum_{m=n+1}^{-\infty} x(m) \cdot 0 = x(m)
\end{align*}

\subsection{Συστήματα}
Στον αναλογικό κόσμο, ένα σύστημα ήταν ένα κουτί που έπαιρνε σήματα εισόδου, τα επεξεργαζόταν, και έβγαζε σήματα εξόδου. Μαθηματικά, είναι μια απεικόνιση συναρτήσεων \( x(t) \) εισόδου σε συναρτήσεις εξόδους.

Επομένως, μπορούμε να ορίσουμε το \textbf{ψηφιακό σύστημα} ως ένα σύστημα που απεικονίζει ακολουθίες
σε ακολουθίες.

 \begin{tikzpicture}[scale=.8]
\draw (0,0) node[rectangle,inner sep=18pt,draw] (s) {Σύστημα};
\draw[->] (s.east) -- ++(1,0) node[right] {$y(n)$};
\draw[<-] (s.west) -- ++(-1,0) node[left] {$x(n)$};

\draw[->,gray!50!brown!50!black] (s) ++(0.2,-2) node[below] {Νόμος $T$} to[bend left] (s);
\end{tikzpicture}

Αντίστοιχα, ένα \textbf{υβριδικό σύστημα} απεικονίζει συναρτήσεις σε ακολουθίες. Δηλαδή έχει είσοδο αναλογικό σήμα, και έξοδο ψηφιακό.

\paragraph{Γραμμικό Σύστημα}
Μπορούμε σε αυτό το σημείο να δώσουμε τον ορισμό του \textbf{γραμμικού συστήματος} που συναντάμε συνέχεια,
για ένα ψηφιακό σύστημα \( T \). Έστω οι έξοδοι \( y_1(n) = T\left[x_1(n)\right] \),
\( y_2(n) = T\left[x_2(n)\right] \). Το σύστημα είναι γραμμικό ανν:
\begin{gather*}
\forall x_1,x_2\quad,\quad \forall a_1,a_2\in\mathbb C:\\
a_1T\left[x_1(n)\right]+a_2T\left[x_2(n)\right] = T\left[a_1x_1(n)+a_2x_2(n)\right]
\end{gather*}

Παραδείγματα:
\begin{itemize}
	\item Το \( y(n) = ax(n) + b \) \textit{δεν} είναι γραμμικό, λόγω του \( b \).
	\item Το \( y(n) = nx(n) \) \textit{είναι} γραμμικό.
\end{itemize}

\paragraph{Αμετάβλητο Κατά τη Μετατόπιση Σύστημα (ΑΚΜ)}
\begin{align*}
	y(n) &= T\left[x(n)\right] \\
	y(n-n_0) &= T\left[x(n-n_0)\right]
\end{align*}
δηλαδή, αν το ενοχλήσουμε τη στιγμή 2 ή τη στιγμή 50, θα δώσει την ίδια έξοδο, ξεκινώντας αντίστοιχα
από τη στιγμή 2 ή τη στιγμή 50.

Παραδείγματα:
\begin{itemize}
	\item Το \( y(n) = ax(n) + b \) \textit{είναι} αμετάβλητο κατά τη μετατόπιση.
	\item Το \( y(n) = nx(n) \) \textit{δεν} είναι αμετάβλητο κατά τη μετατόπιση, λόγω του όρου \( n \).
\end{itemize}

Το σύστημα που προκύπτει από μία διαφορική εξίσωση είναι αμετάβλητο κατά τη μετατόπιση όταν οι συντελεστές των παραγώγων του δεν εξαρτώνται από το χρόνο.

\paragraph{Λίγη προσοχή}
Χρειάζεται κάποια προσοχή στο χειρισμό ΑΚΜ και γραμμικών συστημάτων.

Έστω τα συστήματα που εκφράζουν το νόμο του \emph{Ohm} (\( V=IR \)) σε μια \emph{αντίσταση}:
\begin{align*}
	y_1(t) &= R(t) \cdot x(t)\\
	y_2(t) &= R(x) \cdot x(t)
\end{align*}

Στο πρώτο σύστημα η αντίσταση εξαρτάται από το χρόνο (π.χ. διάβρωση), και στο δεύτερο εξαρτάται από την είσοδο (π.χ. αύξηση θερμοκρασίας \( \implies \) αλλαγή αντίστασης για μεγαλύτερα ρεύματα).

Το πρώτο σύστημα είναι γραμμικό αλλά \emph{όχι} ΑΚΜ, αφού η \( R(t) \) εξαρτάται από το χρόνο.
Το δεύτερο σύστημα είναι ΑΚΜ αλλά \emph{όχι} γραμμικό, αφού η \( R(x) \) εξαρτάται από την είσοδο.

Είναι \textbf{λάθος} να πούμε πως έστω \( R(t)=x(t) \implies y_1(t)=x^2(t)\ \text{(μη γραμμικό)} \), καθώς
η \( R(t) \) είναι μια παράμετρος του συστήματος που δεν μπορεί να είναι ίση με τις διαφορετικές πιθανές
εισόδους του. Παρομοίως, είναι \emph{λάθος} να θεωρήσουμε ότι \( R(x) = R(x(t)) = R(t) \implies y_2(t) = R(t)x(t) \ \text{(μη ΑΚΜ)} \) (δηλαδή ότι αφού η \( R \) εξαρτάται από το \( x \) και το \( x \) εξαρτάται από το χρόνο, άρα η \( R \) εξαρτάται μόνο από το χρόνο).

\lecture{2}{5/10/2018}

\paragraph{}
Πιο αυστηρά, ένα σύστημα \( y(n) = T\left[x(n)\right] \) είναι μία \textbf{απεικόνιση}
από το σύνολο όλων των ακολουθιών \( x(n) \in \mathbb R \) (ή \( \mathbb C \))
στο σύνολο όλων των ακολουθιών \( y(n) \in \mathbb R  \) (ή \( \mathbb{C} \))

\begin{center}
	\begin{tikzpicture}
	\draw[scale=1.4,xscale=1.4]
	(0,0) to[bend left] ++(0.4+0.2*rand,0.4+0.2*rand) to[bend left] ++(0.3+0.2*rand,0.3+0.2*rand) to[bend left] ++(0.4+0.2*rand,-0.3+0.2*rand) to[bend left]  ++(-0.3+0.2*rand,-0.2+0.2*rand) to[bend left] node[midway] (a) {} ++(0.3+0.2*rand,-0.4+0.2*rand) to[bend left] (-0.4+0.1*rand,-0.8+0.1*rand) to[bend left] (0,0);
	\draw (0.8,0) node {$x(n)$};
	
	\draw (0,-1.7) node {Ακολουθίες $\in \mathbb R,\mathbb C$};
	
	\draw[xshift=3.5cm,scale=1.4]
	(0,0) to[bend left] node[midway] (b) {}  ++(0.4+0.2*rand,0.4+0.2*rand) to[bend left]  ++(0.3+0.2*rand,0.3+0.2*rand) to[bend left] ++(0.4+0.2*rand,-0.3+0.2*rand) to[bend left]  ++(-0.3+0.2*rand,-0.2+0.2*rand) to[bend left] ++(0.3+0.2*rand,-0.4+0.2*rand) to[bend left] (-0.4+0.1*rand,-0.8+0.1*rand) to[bend left] (0,0);
	\draw (4.2,0) node {$y(n)$};
	
	\draw[->] (a.center) to[bend left] node[midway, above] {$T\left[x(n)\right]$} (b.center);
	
	\draw (3.8,-1.7) node {Ακολουθίες $\in \mathbb R,\mathbb C$};
	\end{tikzpicture}
\end{center}

\subsubsection{Συνέλιξη}
Θυμόμαστε ότι ένα \emph{ψηφιακό} σήμα είναι ίσο με την \emph{ψηφιακή} συνέλιξή του
με την \( δ(n) \) \eqref{eq:deltaconv}:
\begin{align*}
	x(n) &= \sum_{k=-\infty}^{\infty} x(k)δ(n-k)
	\intertext{Άρα, εφαρμόζοντας το σύστημα στη παραπάνω σχέση:}
	y(n) &= T\left[x(n)\right] = T\left[
	x(k)δ(n-k)
	\right]
	\intertext{Και, αν το $T$ είναι \textbf{γραμμικό}:}
	y(n) &= \sum_{k=-\infty}^{\infty} T\left[x(k)δ(n-k)\right]
	\\ &= \sum_{k=-\infty}^{\infty} x(k) \cdot T\left[δ(n-k)\right]
\end{align*}
Δηλαδή η \textbf{έξοδος} του συστήματος σε κάποια είσοδο \( x(n) \) προκύπτει από τη συνέλιξη
της εισόδου με την \textbf{κρουστική απόκριση} του συστήματος (απόκριση στη \( δ(n) \)), την οποία ορίζουμε:
\begin{knowledgebox}{Κρουστική απόκριση}
	Έστω ότι δίνουμε σε ένα σύστημα είσοδο το δέλτα του Kronecker \( δ(n) \).
	
	Τότε η έξοδός του \( T\left[δ(n)\right] \) είναι η κρουστική απόκριση, την οποία ονομάζουμε
	\( h(n) \):
	\begin{align*}
		h(n) &= T\left[\delta(n)\right]
		\intertext{Μάλιστα, αν θεωρήσουμε ότι το σύστημα είναι ΑΚΜ, ισχύει ακόμα:}
		h(n-k) &= T\left[δ(n-k)\right]
	\end{align*}
\end{knowledgebox}
άρα το παραπάνω σύστημα γράφεται:
\[
y(n)= \sum_{k=-\infty}^{\infty} x(k) \cdot h(n-k)
\]

\begin{theorem}[title=Συμπέρασμα]{}{}
	Αν ένα σύστημα \( T:x(n) \to y(n) \) είναι γραμμικό, τότε ορίζω την έννοια της
	\textbf{κρουστικής απόκρισης} του \( t \) ως \( h(n) = T\left[δ(n)\right] \).
	Αν επιπροσθέτως το \( T \) είναι ΑΚΜ, τότε για οποιαδήποτε είσοδο \( x(n) \) μπορώ να γράψω ότι
	η έξοδος θα δίνεται ως:
	\[
	y(n) = \sum_{k=-\infty}^{\infty} x(k)h(n-k) = x(n) * h(n)
	\quad \text{(συνέλιξη των διακριτών ακολουθιών)}
	\]
\end{theorem}

\paragraph{Ιδιότητες}
Οι ιδιότητες της διακριτής συνέλιξης είναι ίδιες με αυτές του πολλαπλασιασμού:
\begin{enumgreekpar}
	\item \textbf{Αντιμεταθετική}: \( x(n) * y(n) = y(n) * x(n) \)
	\item \textbf{Προσεταιριστική}: \( x_1 * (x_2*x_3) = (x_1*x_2)*x_3 \)
	\item \textbf{Επιμεριστική} με πρόσθεση: \( x_1 * (x_2+x_3) = x_1*x_2 + x_1*x_3 \)
	\item \textbf{Ουδέτερο στοιχείο} η \( δ(n) \):\[
	x(n) * δ(n) = x(n)
	\]
\end{enumgreekpar}

\paragraph{Χρήσιμες πληροφορίες}
\begin{itemize}
	\item Μπορούμε να πούμε ότι ένα ψηφιακό σήμα έχει \textbf{διάρκεια}.
	
	\begin{minipage}{0.5\textwidth}
			Αν \emph{ξεκινάει} (πρώτο μη-0 στοιχείο) στο \( n=D_1 \) και \emph{τελειώνει} (τελευταίο μη-0 στοιχείο) στο \( n=U_1 \), τότε λέμε ότι έχει διάρκεια:
		\[
		T = U_1-D_1 + 1
		\]
		(προσοχή στον όρο \( +1 \)!)
	\end{minipage}
\begin{minipage}{0.5\textwidth}
	\begin{center}
	\begin{tikzpicture}
	\tikzstyle{sample}=[bottom color=orange,top color=\timecolour,fill opacity=.7,rounded corners=2.5pt,thick]
	
	\draw[->] (-3,0) -- (3.5,0);
	\draw[->] (0,0) -- (0,2);
	
	\def\sf{0.7}
	\def\sx{0.11}
	\def\sy{0.09}
	
	\foreach \x in {-4,-3,...,1} {
		\filldraw[sample] (\x*\sf + \sx,0 + \sy) rectangle ++(-\sx*2,-\sy*2);
	}
	
	\draw (2*\sf,0) node[below] {$D_1$};
	\draw (4*\sf,0) node[below] {$U_1$};
	
	\draw (3*\sf,0.9) node[scale=1.5] {\textellipsis};
	
	\filldraw[sample] ( 2*\sf+\sx,1 + \sy) rectangle ++(-\sx*2,-\sy*2);
	\filldraw[sample] ( 4*\sf+\sx,0.8 + \sy) rectangle ++(-\sx*2,-\sy*2);
	\end{tikzpicture}
	\end{center}
\end{minipage}
	
	\item Έστω δύο σήματα:
	\begin{align*}
		x_1(n) \text{ έχει διάρκεια } & T_1\\
		x_2(n) \text{ έχει διάρκεια } & T_2
	\end{align*}
	τότε η συνέλιξή τους έχει διάρκεια:
	\[
	T_3 = T_1+T_2-1
	\]
	
	\begin{questionbox}{Άσκηση για το σπίτι}
 		Φανταστείτε ότι σας δίνονται αρχές \( D_1 \) και τέλη \( U_1 \). Για παράδειγμα, μια ακολουθία
		ξεκινά από το 1813 και τελειώνει στο 1980. Γνωρίζουμε ότι αν συνελίξουμε τέτοιες ακολουθίες
		μεταξύ τους, θα πάρουμε σήματα διάρκειας \( T_3 = T_1+T_2-1 \).
		
		Ζητείται να βρεθεί μια σχέση που, δεδομένων των \( U_1,U_2,D_1,D_2 \), να βρίσκει \textbf{από ποιό σημείο \( D_3 \)} ξεκινάει το αποτέλεσμα της συνέλιξης, και σε ποιό σημείο \( U_3 \) τελειώνει.
		
		\tcblower
		Η απάντηση θα είναι \( D_3 = D_1+D_2 \) και \( U_3 = U_1+U_2 \)
	\end{questionbox}

	\item Για τη συνέλιξη με τη βηματική ακολουθία \( \mathrm u(n) \) ισχύει:
	\begin{align*}
		x(n) * u(n) &= \sum_{k=-\infty}^{\infty} x(k) \mathrm u(n-k)
		\intertext{Η \( u(n-k) \) είναι 1 όταν \( n-k \geq 0 \implies k \leq n \):}
		&= \sum_{k=-\infty}^{n} x(k) \mathrm{u}(n-k) = \sum_{k=-\infty}^{n} x(k)
	\end{align*}
	δηλαδή η συνέλιξη με τη βηματική ακολουθία είναι ουσιαστικά το "ολοκλήρωμα" της ακολουθίας.
\end{itemize}

\paragraph{Παραδείγματα}
\hspace{0pt}

\begin{exercise}
	Να συνελιχθούν οι συναρτήσεις:
	\begin{align*}
		x_1(n) &= δ(n) + 2δ(n-1) + 3δ(n-2) + 4δ(n-3)\\
		x_2(n) &= δ(n+1) -2δ(n) + δ(n-1)
	\end{align*}
	\tcblower
	Περιμένουμε η συνέλιξη, με βάση αυτά που είδαμε παραπάνω, να έχει διάρκεια:
	\[
	4+3-1=6
	\]
	
	Πραγματοποιούμε τους υπολογισμούς:
	\begin{align*}
		x_1 * x_2 &=
		x_1(n) * \left[ δ(n+1)-2δ(n)+δ(n+1) \right]
		\\ &= x_1(n) * δ(n+1) - x_1(n)*\left( 2 δ(n) \right) + x_1(n)*δ(n-1)
		\\ &= x_1(n+1) - 2x_1(n) + x_1(n-1)
		\\ &= δ(n+1) + 2δ(n) + 3δ(n-1) + 4δ(n-2) - 2δ(n) - 4δ(n-1)
		\\ &\hphantom{=} - 6δ(n-2) - 8δ(n-3) + δ(n-1) +2δ(n-2) + 3δ(n-3)+4δ(n-4)
		\\ &= δ(n+1) -5δ(n-3) + 4δ(n-4)
	\end{align*}
	κάτι που όντως έχει διάρκεια 6.
\end{exercise}

\begin{exercise}
Έστω ότι έχουμε συναρτήσεις που ξεκινούν και τελειώνουν σε διάφορα σημεία:

\begin{minipage}{.5\textwidth}
	\[
	y(n) = \begin{cases}
	β^{n-n_0} &\quad n \geq n_0\\
	0 &\quad n < n_0
	\end{cases}
	\]
\end{minipage}
\begin{minipage}{.5\textwidth}
	\[
	x(n) = \begin{cases}
	a^{n} &\quad 0 \leq n \leq N\\
	0&\text{αλλού}
	\end{cases}
	\]
\end{minipage}
\paragraph{}

Να βρεθεί η συνέλιξή τους.

\tcblower

Μπορούμε να γράψουμε τις παραπάνω συναρτήσεις απλούστερα, εκμεταλλευόμενοι τη \textbf{βηματική step function}:
\begin{align*}
	y(n) &= β^{n-n_0} \cdot \mathrm u (n-n_0)\\
	x(n) &= a^n \cdot \left[
	\mathrm u(n) - \mathrm u(n-N-1)
	\right]
\end{align*}
(με \textit{προσοχή} στον όρο \( -1 \) μέσα στη \( \mathrm{u} \))

Άρα η συνέλιξη βρίσκεται:
\begin{align*}
	z(n) &= x(n) * y(n) \\
	&= \sum_{k=-\infty}^{\infty} β^{n-n_0} \mathrm u (n-n_0)a^n \left[
	\mathrm u(n) - \mathrm u(n-N-1)
	\right]
	\\ &= \sum_{k=-\infty}^{\infty} \left[
	β^{k-n_0}u(k-n_0)\cdot a^{n-k} \left[ u(n-k)-u(n-k-N-1) \right]
	\right]
	\\ &= \sum_{k=-\infty}^{\infty} β^{k-n_0}
	a^{n-k} u(k-n_0)u(n-k)
	- \sum_{k=-\infty}^{\infty} β^{k-n_0}u(k-n_0)a^{n-k} u (n-k-N-1)
	\\ &= β^{-n_0}a^n \sum_{k=n_0}^{n} β^k a^{-k} u (n-n_0)
	- β^{-n_0}a^n \sum_{k=n_0}^{n-N-1}β^ka^{-k}u(n-N-1-n_0)
	\intertext{Προσπαθώντας να φτάσουμε έναν όρο γεωμετρικής προόδου, θα κάνουμε το άθροισμα να ξεκινάει από το 0:}
	\\ &=
	a^n β^{-n_0}\left[
	\left(\frac{β}{a}\right)^{n_0}\sum_{k=0}^{n-n_0}\left(\frac{β}{a}\right)^k
	u(n-n_0) - \left(\frac{β}{a}\right)^{n_0}
	\sum_{k=0}^{n-n_0-N-1}\left(\frac{β}{a}\right)^k u(n-N-1-n_0)
	\right]
	\intertext{και ήρθε η ώρα να εκμεταλλευτούμε τους τύπους αθροίσματος γεωμετρικής προόδου:}
	\\ &= a^{n-n_0}\left[
	\frac{\left(\frac{β}{a}\right)^{n-n_0+1}-1}{\frac{β}{a}-1}u(n-n_0)
	- \frac{\left(\frac{β}{a}\right)^{n-N-n_0}-1}{\frac{β}{a}-1}u(n-N-1-n_0)
	\right]
\end{align*}

\end{exercise}

\begin{exercise}
	Έστω η ακολουθία:
	\[
	x(n) = a^n\ \forall n
	\]
	και οι \( y(n), \ z(n) \) αυθαίρετες.
	
	Να δειχθεί ότι:
	\[
	\left[
	x(n)y(n)
	\right]*\left[
	x(n)z(n)
	\right] = x(n)\left[
	y(n)*z(n)
	\right]
	\]
	
	\tcblower
	
	Το αριστερό μέλος της ζητούμενης σχέσης είναι:
	\begin{align*}
		\left[
		x(n)y(n)
		\right]*\left[
		x(n)z(n)
		\right] &=
		\sum_{k=-\infty}^{\infty}
		x(k)y(k)x(n-k)z(n-k)
		\\ &= \sum_{k=-\infty}^{\infty} a^k y(k)a^{n-k} z(n-k)
		\\ &= a^n \sum_{k=-\infty}^{\infty} y(k) z(n-k)
		\\ &= x(n) \cdot \left[y(n) * z(n)\right]
	\end{align*}
\end{exercise}

\begin{exercise}
	Να υπολογιστεί η ενέργεια και η ισχύς του σήματος:
	\[
	x_1(n) = \left( \frac{1}{2} \right)^n u(n)
	\]
	\tcblower
	Η ενέργεια δίνεται από τον τύπο:
	\begin{align*}
		E_{x_1} &=
		\sum_{n=-\infty}^{\infty}x_1^2(n) = \sum_{n=-\infty}^{\infty}\left(\frac{1}{2}\right)^{2n}
		u(n) = \sum_{n=0}^{\infty}\left( \frac{1}{4} \right)^n
		\\ &= \frac{1}{1-\frac{1}{4}} = \frac{4}{3}
	\end{align*}
	
	Έχουμε αποδείξει ότι το σήμα είναι σήμα ενέργειας, άρα σίγουρα δεν είναι σήμα ισχύος, δηλαδή η ισχύς του είναι:
	\[
	P=0
	\]
	
	Εναλλακτικά, η ισχύς είναι η ενέργεια διά τη διάρκεια του σήματος, δηλαδή:
	\[
	P = \frac{\sfrac{4}{3} }{\infty} = 0
	\]
\end{exercise}

\begin{exercise}
	Να υπολογιστεί η ενέργεια \& η ισχύς του σήματος:
	\[
	x_2(n) = e^{j\left( n\frac{π}{2} + \frac{π}{8} \right)}
	\]
	\tcblower
	Έχουμε:
	\[
	E_{x_2} = \sum_{n=-\infty}^{\infty} \left|x_2(n)\right|^2 = \sum_{n=-\infty}^{\infty} |1|^2 = \infty
	\]
	
	Η ισχύς του σήματος είναι:
	\[
	P_a = \lim_{N\to \infty}\frac{1}{2N+1}
	\sum_{n=-N}^{N} \cancelto{1}{\left|x_2(n)\right|^2}
	= \lim_{N\to \infty}\frac{2N+1}{2N+1} = 1
	\]
	όπου \( N\to \infty \) o αριθμός στοιχείων αριστερά και δεξιά από το 0 (επομένως η ακολουθία έχει συνολικά \( 2N+1\to \infty \) μη μηδενικά στοιχεία).
\end{exercise}

\begin{exercise}
	Δίνονται τα σήματα:
	\begin{align*}
	x(n) &= 2^n u(-n-1)\\
	y(n) &= 4^n u(-n-1)
	\end{align*}
	
	Να βρείτε τη συνέλιξή τους:
	\[
	x(n) * y(n) = z(n)
	\]
	
	\tcblower
	Έχουμε:
	\begin{align*}
		z(n) &= \sum_{k=-\infty}^{\infty} x(k)y(n-k)
		\\ &= \sum_{k=-\infty}^{\infty}
		2^k u(-k-1) 4^{n-k} u \left(-(n-k)-1\right)
		\\ &= 4^n\sum_{k=-\infty}^{\infty}\left(\frac{2}{4}\right)^k u(-k-1)u(-n-1+k)
		\\ &= 4^n\sum_{k=n+1}^{-1} \left(\frac{1}{2}\right)^k u(-1-n-1)
		\\ &= 4^n\left(\frac{1}{2}\right)^{n+1}\ \cdot \ \sum_{k=0}^{-n-2}\left(\frac{1}{2}\right)^k
		u(-1-n-1)
		\\ &= 4^n \left(\frac{1}{2}\right)^{n+1}
		\frac{\left(\frac{1}{2}\right)^{-n-1}-1}{\frac{1}{2}-1}u(-n-2)
		\\ &= \left(2^n-2^{2n+1}\right)u(-n-2)
	\end{align*}
\end{exercise}

\begin{questionbox}{Άσκηση για το σπίτι}
	Να γίνει η συνέλιξη των δύο ακολουθιών:
	\begin{align*}
		x(n) &= u(-n-1)\\
		y(n) &= \left(\frac{1}{2}\right)^n u(n)
	\end{align*}
\end{questionbox}

\lecture{3}{8/10/2018}

\subsubsection{Ευστάθεια}
Την ευστάθεια μπορούμε να την ορίσουμε με διαφορετικούς ασύμβατους τρόπους.

Εμείς θα χρησιμοποιούμε την \textbf{ευστάθεια κατά ΦΕΦΕ (Φραγμένη Είσοδος \textendash~Φραγμένη Έξοδος)} (BIBO \textemdash~ Bounded Input \textendash~Bounded Output).

\begin{defn}{Φραγμένη ακολουθία}{}
	Μια \textbf{φραγμένη} ακολουθία \( x(n) \) είναι αυτή που δεν πιάνει τιμές μέχρι το άπειρο:
	\[
	\left|x(n)\right| < M < \infty \quad \forall n \in \mathbb Z
	\]
\end{defn}

\begin{defn}{Ευστάθεια συστήματος κατά ΦΕΦΕ}{}
	Αν \( \forall x(n) \) φραγμένη είσοδο, η έξοδος \( y(n) \) ενός συστήματος 
	είναι \textbf{φραγμένη}, τότε το σύστημα είναι \textbf{ευσταθές κατά ΦΕΦΕ (BIBO)}.
\end{defn}

\begin{theorem}{Πόρισμα}{}
	Αν γνωρίζουμε ότι ένα σύστημα είναι \emph{γραμμικό} και \emph{ΑΚΜ} (άρα \( \exists\ h(n) \), δηλαδή υπάρχει η κρουστική του απόκριση), τότε το σύστημα είναι \textbf{ευσταθές} ανν:
	\[
	\sum_{n=-\infty}^{\infty} \left|h(n)\right| < \infty
	\]
\end{theorem}
\subparagraph{Απόδειξη}
Για τις δύο κατευθύνσεις:
\begin{itemize}
	\item Εξετάζω ότι \( \sum_{n=-\infty}^{\infty} \left|h(n)\right| < \infty \implies \text{ευστάθεια κατά BIBO} \):
	
	Αφού το άθροισμα της κρουστικής απόκρισης είναι φραγμένο, θα ισχύει \( \displaystyle
	\sum_{n=-\infty}^{\infty} \left|h(n) \right| < L \) για κάποιο (μεγάλο) \( L \).
	
	Έστω \( x(n) \) φραγμένη είσοδος \( \iff \left|x(n)\right| < M \ \forall n \), η έξοδος θα είναι:
	\begin{align*}
		y(n) &= \sum_{k=-\infty}^{\infty} h(k)x(n-k)
		\\ \implies \left|y(n)\right| &= \left|\sum_{k=-\infty}^{\infty} h(k)x(n-k) \right|
		\leq \sum_{k=-\infty}^{\infty} \left|h(k)\right|\left|x(n-k)\right|
		\\ \implies \left|y(n)\right| &< M \sum_{k=-\infty}^{\infty} \left|h(n)\right|
		= N
	\end{align*}
	
	Άρα \( \left|y(n)\right| < N \), άρα η έξοδος είναι φραγμένη.
	
	\item Εξετάζω ότι \( \text{BIBO} \implies \sum_{n=-\infty}^{\infty} \left|h(n)\right| < \infty \).
	
	Εναλλακτικά θα εξετάσω το \textit{αντιθετοαντίστροφο}, δηλαδή ότι
	\( \displaystyle \sum_{n=-\infty}^{\infty} \left|h(n)\right| = \infty \implies
	\text{όχι BIBO} \)
	
	Ορίζω μία νέα ακολουθία \( x(n) \) ως εξής:
	\[
	x(n) = 
	\begin{cases}
	\frac{h^*(-n)}{\left| h(-n) \right|} 
 &\quad \text{αν } h(-n) \neq 0\\
	 0 &\quad \text{αλλού}
	 \end{cases}
	\]
	
	Η \( x(n) \) έχει μοναδιαίο ή μηδενικό μέτρο παντού. Επομένως είναι \emph{φραγμένη}. Θα την πετάξουμε ως είσοδο στο σύστημα για να αποδείξουμε ότι αυτό
	δίνει \textbf{μη φραγμένη έξοδο, για φραγμένη είσοδο}, άρα είναι αυτό ασταθές κατά BIBO:
	
	\begin{align*}
		y(n) &= \sum_{k=-\infty}^{\infty} h(k)x(n-k) =  \sum_{k=-\infty}^{\infty} \frac{h(k)h^*(k-n)}{\left|h(k-n)\right|}\\
		\intertext{Θέτουμε συγκεκριμένα $y=0$:}
		y(0) & =  \sum_{k=-\infty}^{\infty} \frac{h(k)h^*(k)}{\left|h(k)\right|}
		= \sum_{k=-\infty}^{\infty} \left|h(k)\right|
		= \infty.
	\end{align*}
\end{itemize}

\subsubsection{Αιτιατότητα}
\begin{defn}{Αιτιατό σύστημα}{}
	Ένα σύστημα είναι \textbf{αιτιατό} αν η έξοδος εξαρτάται μόνο από \textbf{παρελθούσες τιμές} της εισόδου ή/και την τρέχουσα (παρούσα).
	
	Μαθηματικά:
	\[
	y(n) = f\left( x(k),x(λ),x(ξ), \dots, x(p) \right)
	\]
	όπου \( κ,λ,ξ,\dots,p \leq n \)
\end{defn}

\begin{theorem}{}{}
	Ένα γρ. ΑΚΜ σύστημα θα είναι \textbf{αιτιατό} αν:
	\[
	h(n) = 0 \ \forall n<0
	\]
	δηλαδή αν η κρουστική απόκριση είναι \textbf{αιτιατή ακολουθία}.
\end{theorem}
\subparagraph{Απόδειξη}
Η έξοδος του συστήματος θα είναι:
\begin{align*}
	y(n) &= \sum_{k=-\infty}^{\infty} h(k)x(n-k)
\end{align*}
Εμείς θέλουμε ο δείκτης του \( x \) να μην είναι ποτέ \emph{μεγαλύτερος} από το \( n \),
διότι σε αυτήν την περίπτωση η έξοδος θα εξαρτιόταν από το \emph{μέλλον} του \( x(n) \). Δηλαδή
το \( y(n) \) θα εξαρτάται από τα \( x(n+1), x(n+2), \dots \). Άρα θέλουμε \( k > 0 \).

Αυτό εξασφαλίζεται όταν \( h(k) = 0\ \forall k < 0 \). Τότε η έξοδος θα είναι:
\begin{align*}
	y(n) &= \sum_{k=0}^{\infty} h(k)x(n-k)
\end{align*}

Το παραπάνω βέβαια, δεδομένου του ορισμού της συνέλιξης, γράφεται και ως εξής:
\begin{align*}
	y(n) &= h(n) * x(n) = x(n) * h(n)
	\\ &= \sum_{k=-\infty}^{\infty}x(k)h(n-k)
	\\ &= \sum_{k=-\infty}^{n} x(k)h(n-k)
\end{align*}

\subsubsection{Μερικοί χρήσιμοι ορισμοί για ακολουθίες}
\label{sec:seqtypes}
\begin{enumgreekpar}
	\item \textbf{Αιτιατή ακολουθία:} \( x(n) = 0 \quad \forall\ n<0 \)
	\item \textbf{Ακολουθία δεξιάς πλευράς:} \( \exists \ M \in \mathbb Z:\ x(n) = 0 \quad \forall \ n<M \)
	\item \textbf{Ακολουθία αντιαιτιατή:} \( x(n) = 0\quad \forall\ n \geq 0 \)
	\item \textbf{Ακολουθία αριστερής πλευράς:} \( \exists\ M \in \mathbb Z : \ x(n) = 0 \quad \forall \ n>M \)
	\item \textbf{Ακολουθία πεπερασμένης διάρκειας:} \( \exists \ M,N\ M<N:\ \forall n < M \text{ ή } n>N:\ x(n) = 0 \)
\end{enumgreekpar}

Κάθε αιτιατή ακολουθία είναι δεξιάς πλευράς.

\section{Συνεχής μετασχηματισμός Fourier διακριτού σήματος (Discrete-Time Fourier Transform)}

\subsection{Απόκριση γραμμικού ΑΚΜ συστήματος σε εκθετική είσοδο}
Μελετάμε την απόκριση συστήματος σε είσοδο:
\[
x(n) = a^n
\]
όπου \( a\in\mathbb{C} \).

Τότε η έξοδος είναι:
\begin{align*}
	y(n) = h(n) * x(n)  &= \sum_{k=-\infty}^{\infty} h(k) x(n-k)
	\\ &= \sum_{k=-\infty}^{\infty} h(k) a^{n-k}
	\\ &= a^n \sum_{k=-\infty}^{\infty} h(k)a^{-k}
	\\ &= x(n) \cdot \sum_{k=-\infty}^{\infty} \underbrace{h(k)a^{-k}}_{\mathclap{
			\raisebox{-1.5ex}{\footnotesize\text{αριθμός που δεν εξαρτάται από το $n$}}
		}}
	\\ &= x(n) \cdot H
\end{align*}

Το τελικό αποτέλεσμα δηλαδή θα είναι η είσοδος \textbf{πολλαπλασιασμένη με έναν αριθμό} που
εξαρτάται από την κρουστική απόκριση του συστήματος και τη βάση \( a \) της εισόδου.
\begin{itemize}
	\item
Έστω ότι:
\[
\infoboxed{a = e^{j\omega }} \quad \implies x(n) = e^{j\omega n}
\]
για \( \omega \in \mathbb R \) μία συνεχή μεταβλητή.

Άρα η έξοδος θα είναι:
\[
y(n) = x(n) \cdot \boxed{\sum_{k=-\infty}^{\infty} h(k) e^{-j\omega k}}
\]
το πλαίσιο είναι ουσιαστικά μία συνάρτηση που εξαρτάται από το \( e^{j\omega}  \), ή
πρακτικά μόνο από το \( \omega  \). Ονομάζουμε αυτήν τη συνάρτηση \( H(\omega ) \):
\[
H(\omega ) = \sum_{k=-\infty}^{\infty} h(k)e^{-j\omega k}
\]
αυτή ουσιαστικά είναι η \textbf{απόκριση συχνότητας του συστήματος}.

Υπενθυμίζουμε ότι το \( \omega  \) είναι \textbf{συνεχής μεταβλητή}. Μπορούμε να ορίσουμε
έναν συνεχή μετασχηματισμό Fourier ως εξής:
\[
x(n) \rightarrow X(\omega ) = \sum_{n=-\infty}^{\infty} x(n) e^{-j\omega n}
\]
\item
Έστω ότι:
\[
\infoboxed{a = z}
\]
δηλαδή το \( a \) ανήκει οπουδήποτε στο μιγαδικό επίπεδο
Τότε:
\[
y(n) = x(n) \cdot \boxed{\sum_{k=-\infty}^{\infty} h(k) z^{-k}}
\]
\end{itemize}

\begin{defn}{Απόκριση συχνότητας}{}
	Ως \textbf{απόκριση συχνότητας} του συστήματος ορίζουμε τη συνάρτηση:
	\begin{align*}
		H\left(e^{j\omega }\right) &= \sum_{k=-\infty}^{\infty}h(k)e^{-j\omega k}
		\\ &= H_R\left(e^{j\omega }\right) + j H_I\left(e^{j\omega }\right)
		\\ &=
		\underbrace{\left|H\left(e^{j\omega }\right)\right|}_{\mathclap{\text{απόκριση πλάτους}}}
		\exp\underbrace{\left[j \mathop{arg} \left(H\left(e^{j\omega t}\right)\right)\right]}_{\mathclap{\text{απόκριση φάσης}}}
	\end{align*}
\end{defn}

\subsubsection{Απόκριση συστήματος σε ημιτονοειδείς συναρτήσεις}
Έστω η είσοδος:
\[
x(n) = A\cos\left( \omega_0 n + \phi \right)
\]

Υπενθυμίζουμε ότι η είσοδος εν γένει \textbf{δεν είναι περιοδική} (\autoref{sec:periodic}).

Αντικαθιστούμε το συνημίτονο:
\[
x(n) = A\frac{e^{j\phi}e^{j\omega_0 n} + e^{-j\phi}e^{-j\omega_0n}}{2}
\]
οπότε κατά τα παραπάνω, η έξοδος θα είναι:
\begin{align*}
	y(n) &= \frac{A}{2}e^{j\phi}e^{j\omega_0 n} H\left(e^{j\omega_0}\right)
	+ \frac{A}{2}e^{-j\phi}e^{-j\omega_0 n} H\left(e^{-j\omega_0}\right)
\end{align*}

Εφ' όσον θεωρηθεί ότι \( h(n) \in \mathbb R \), τότε θα ισχύει \( H\left( e^{j\omega_0} \right) = H^*\left(e^{-j\omega_0}\right) \). Άρα τελικά:
\begin{align*}
	y(n) &= \frac{A}{2} e^{j\phi} e^{j\omega_0 n} \left| H\left(e^{j\omega_0}\right) \right|
	\exp \left[j \mathop{arg}\left( H\left(e^{j\omega_0}\right) \right)\right]
	+ \frac{A}{2} e^{j\phi} e^{-j \omega_0 n}
	\left| H\left(e^{j\omega_0}\right) \right| \exp \left[-j\mathop{arg} \left(
	H\left(e^{j\omega_0}\right)
	\right)\right]
	\\ &= A\left| H\left( e^{j\omega_0} \right) \right|
	\cos\left( \omega_0 n + \phi + \mathop{arg}\left(H\left(e^{j\omega_0}\right)\right) \right)
\end{align*}

\begin{exercise}
	Να βρεθεί η απόκριση συχνότητας του συστήματος με μοναδιαία απόκριση \( h(n) = a^n \mathrm{u}(n) \) για \( |a| < 1 \).
	
	\tcblower
	Εύκολα φαίνεται ότι το σύστημα είναι αιτιατό και ευσταθές.
	
	Για την απόκρισή του, από τον ορισμό της έχουμε:
	\begin{align*}
		H\left(e^{j\omega }\right)
		&= \sum_{n=-\infty}^{\infty} h(n) e^{-j\omega n}
		\\ &= \sum_{n=0}^{\infty} a^n e^{-j\omega n}
		\\ &= \sum_{n=0}^{\infty}\left( ae^{-j\omega } \right)^n
		\intertext{Σε αυτό το σημείο εκμεταλλευόμαστε το άθροισμα άπειρων όρων γεωμετρικής προόδου:}
		&= \frac{1}{1-ae^{-j\omega }} \quad \text{(επειδή $\left|ae^{-j\omega }\right|=|a|<1$)}
		\intertext{Άρα η απόκριση πλάτους \& συχνότητας θα είναι:}
		\left| H\left(e^{j\omega }\right) \right|
		&= \frac{1}{\left(1+a^2-2a\cos \omega \right)^{\sfrac{1}{2} }}
		\\
		\mathop{arg}\left(H\left(e^{j\omega }\right)\right)
		&= -\arctan \left( \frac{a\sin\omega}{1-a\cos\omega} \right)
	\end{align*}
\end{exercise}

\begin{exercise}
	Δίνεται γρ. ΑΚΜ σύστημα με:\[
	h(n) = \frac{1}{2}δ(n) + δ(n-1) + \frac{1}{2}δ(n-2)
	\]
	
	Να χαρακτηριστεί και να βρεθεί η απόκριση συχνότητάς του.
	\tcblower
	Το σύστημα είναι αιτιατό \& ευσταθές.
	
	Σύμφωνα με τον ορισμό, έχουμε:
	\begin{align*}
		H\left(e^{j\omega }\right) &= \sum_{n=-\infty}^{\infty}
		h(n) e^{-j\omega n}
		\\ &= \sum_{n=-\infty}^{\infty}
		\left[
		\frac{1}{2}δ(n) + δ(n-1) + \frac{1}{2}δ(n-2)
		\right]e^{-j\omega n}
		\\ &= \frac{1}{2}e^{-j\omega 0}
		+ e^{-j\omega 1}
		+ \frac{1}{2}e^{-j\omega 2}
		\\ &= e^{-j\omega } \left[ \frac{1}{2}e^{j\omega } + 1 + \frac{1}{2}e^{-j\omega }  \right]
		\\ &= e^{-j\omega } (1 + \cos \omega)
		\intertext{Άρα σε πλάτος και φάση:}
		\left|
		H\left(e^{j\omega }\right)
		\right| &= \left|1+\cos \omega \right| = 1 + \cos \omega 
		\\
		\mathop{arg}\left[H\left(e^{j\omega }\right)\right]
		&= \mathop{arg} \left[
		e^{-j\omega }(1+\cos \omega)
		\right]
		= \mathop{arg}\left[e^{-j\omega}\right] +\underbrace{ \mathop{arg}\left[1+\cos\omega\right]}_{\mathclap{\text{επειδή $1+\cos\omega \geq 0$}}}
		= -\omega + 0 = -\omega
	\end{align*}
	
	\begin{tikzpicture}[scale=1]
	\begin{axis}[
	scale=.7,
	title={$\left|H\left(e^{j\omega}\right)\right|$},
	xmin=0, xmax=2*pi,
	xticklabels={$0$,$\frac{\pi}{2}$,$\pi$,$\frac{3\pi}{2}$,$2\pi$},
	xtick={0,1.57079632679490,3.14159265358979,4.71238898038469,6.28318530717959},
	% ytick={0,20,40,60,80,100,120},
	ymajorgrids=true,
	grid style=dashed,
	]
	\addplot[
	style={very thick,smooth},
	samples=\lowsamples,
	color=orange!50!red,
	variable=\x,
	domain=0:2*pi
	] (\x,{1+cos(\x r)});
	\end{axis}
	
	\begin{axis}[
	scale=.7,
	title={$\arg\left[H\left(e^{j\omega}\right)\right]$},
	xmin=0, xmax=2*pi,
	xshift=7cm,
	xticklabels={$0$,$\frac{\pi}{2}$,$\pi$,$\frac{3\pi}{2}$,$2\pi$},
	xtick={0,1.57079632679490,3.14159265358979,4.71238898038469,6.28318530717959},
	yticklabels={$0\degree$,$-90\degree$,$-180\degree$,$-270\degree$,$-360\degree$},
	ytick={0,-1.57079632679490,-3.14159265358979,-4.71238898038469,-6.28318530717959},
	yticklabel pos=right,
	ymajorgrids=true,
	grid style=dashed,
	]
	\addplot[
	style={very thick},
	samples=\vlowsamples,
	color=orange!50!red!70!green,
	variable=\x,
	domain=0:2*pi
	] (\x,{-\x});
	\end{axis}
	\end{tikzpicture}
\end{exercise}

\lecture{4}{12/10/2018}
\subsection{Μετασχηματισμός Fourier}
Παραπάνω ορίσαμε το συνεχή μετασχηματισμό Fourier στο διακριτό σήμα ως εξής:
\[
H(e^{j\omega }) = \sum_{n=-\infty}^{\infty} h(n)e^{-j\omega n}
\]
και, αν το σύστημα είναι ευσταθές κατά BIBO, έχουμε:
\begin{align*}
	h(n) \text{ ευσταθές}
	&\iff \sum_{n=-\infty}^{\infty} \left|h(n)\right| < \infty
	\\ &\iff \sum_{n=-\infty}^{\infty} \left|h(n)\right|\left|e^{-j\omega n}\right| < \infty
	\\ &\iff \sum_{n=-\infty}^{\infty} \left|h(n)e^{-j\omega n}\right| < \infty
	\implies \sum_{n=-\infty}^{\infty}h(n)e^{-j\omega n} < \infty
	\implies \exists \text{ } H\left(e^{j\omega }\right)
\end{align*}

Πρακτικά, διαπιστώνουμε ότι \textit{αν το σύστημα είναι ευσταθές}, τότε \textit{το σύστημα έχει απόκριση
συχνότητας}, δηλαδή ορίζεται ο μετασχηματισμός Fourier του.

Ένα ερώτημα που προκύπτει είναι αν ισχύει το αντίστροφο, δηλαδή αν η ύπαρξη του \( H\left(e^{j\omega }\right) \implies \) ότι το σύστημα είναι \emph{ευσταθές}. Για να το διαπιστώσουμε αυτό, θεωρούμε
ένα αντιπαράδειγμα (\emph{χαμηλοπερατού φίλτρου}):

\begin{minipage}{.5\textwidth}
	\[
	H\left(e^{j\omega }\right)
	\begin{cases}
		1 &\quad |\omega | < \omega_c\\
		0 &\quad \text{αλλού}
	\end{cases}
	\]
\end{minipage}
\begin{minipage}{.5\textwidth}
	\begin{center}
	\begin{tikzpicture}[scale=.7]
	\begin{axis}[
	scale=.4,
	title={$H\left(e^{j\omega}\right)$},
	xmin=-2, xmax=2, ymax=1.4,
	ytick={0,1},xtick={-1,0,1},
	%xticklabels={$0$,$\frac{\pi}{2}$,$\pi$,$\frac{3\pi}{2}$,$2\pi$},
	%xtick={0,1.57079632679490,3.14159265358979,4.71238898038469,6.28318530717959},
	axis lines=center,
	ymajorgrids=true,
	grid style=dashed,
	]
	\addplot[
	style={very thick,const plot},
	samples=\lowsamples,
	color=orange!50!red,
	variable=\x,
	] coordinates {(-2,0) (-1,1) (1,0)};
	\end{axis}
	\end{tikzpicture}
	\end{center}
\end{minipage}

Το παραπάνω σύστημα \textbf{δεν είναι ευσταθές}! Πράγματι, η αντίστοιχη κρουστική απόκρισή του είναι
\( h(n) = \frac{\sin\omega_c n}{\pi n} \). Το σύστημα δεν είναι αιτιατό (αφού \( h(n)\neq 0 \impliedby n <0 \)), και το άθροισμα \( \displaystyle S = \sum_{n=-\infty}^{\infty} \left| \frac{\sin\omega_c n}{\pi n} \right| \) τείνει στο \( \infty \).

Επομένως, η ύπαρξη του μετασχηματισμού Fourier \emph{δεν} συνεπάγεται την ευστάθεια του συστήματος.

\subsubsection{Ιδιότητες της απόκρισης συχνότητας}
Ο \emph{συνεχής} μετασχηματισμός Fourier στο διακριτό σήμα:
\begin{enumerate}
	\item Είναι συνάρτηση \textbf{συνεχούς} μεταβλητής \( \omega \in (-\infty,\infty) \)
	\item Η \( H\left( e^{j\omega } \right) \) είναι \textbf{περιοδική} με περίοδο \( 2π \).
\end{enumerate}

Επιπλέον, αν για το αρχικό σήμα στο χρόνο ισχύει \( h(n)\in\mathbb R \):

\begin{minipage}{.5\linewidth}
\begin{enumerate}
	\item[3.] Η \( \left|H\left(e^{j\omega }\right)\right| \) είναι \textbf{άρτια} συνάρτηση του \( \omega  \) και συμμετρική ως προς τον άξονα \( \omega = π \).

	\item[4.] Το \( \arg H\left(e^{j\omega }\right) \) είναι \textbf{περιττή} συνάρτηση του \( \omega  \)
	και αντισυμμετρική ως προς τον άξονα \( \omega = \pi \).

\end{enumerate}
\end{minipage}
\begin{minipage}{.49\linewidth}
	\begin{center}
	\begin{tikzpicture}[scale=.5]
	\tikzstyle{sample}=[bottom color=orange,top color=\timecolour,fill opacity=.7,rounded corners=2.5pt,thick]
	
	\draw[->] (-3,0) -- (3,0);
	\draw[->] (0,0) -- (0,2);
	
	\draw[ultra thick,red!50!orange!90!brown,xshift=-1.5cm] plot [smooth,tension=1.5] coordinates {(-0.7,0) (0,1.2) (0.7,0)};
	\draw[ultra thick,red!50!orange!90!brown,xshift=1.5cm] plot [smooth,tension=1.5] coordinates {(-0.7,0) (0,1.2) (0.7,0)};
	
	\draw[thick,magenta!50!blue] (1.5,1.5) -- ++(0,-2);
	\draw (1.5,0) node[below right,scale=.8] {$\pi$};
	\draw (0,-1.5);
	\end{tikzpicture}
	~
	\begin{tikzpicture}[scale=.5]
	\tikzstyle{sample}=[bottom color=orange,top color=\timecolour,fill opacity=.7,rounded corners=2.5pt,thick]
	
	\draw[->] (-3,0) -- (3,0);
	\draw[->] (0,0) -- (0,2);
	
	\draw[ultra thick,red!50!orange!50!green,xshift=-1.5cm] (-1,0) -- (0,-1.2) (0,1.2) -- (1,0);
	\draw[thick,dashed,red!50!orange!50!green,xshift=-1.5cm] (0,-1.2) -- (0,1.2);
	\draw[ultra thick,red!50!orange!50!green,xshift=1.5cm] (-1,0) -- (0,-1.2) (0,1.2) -- (1,0);
	
	\draw[thick,magenta!50!blue,dashed] (1.5,1.5) -- ++(0,-3);
	\draw (1.5,0) node[below right,scale=.8] {$\pi$};
	\end{tikzpicture}
	\end{center}
\end{minipage}

\begin{questionbox}{Άσκηση για το σπίτι}
	Να αποδειχθούν οι ιδιότητες \textbf{3}, \textbf{4}. Γιατί η ιδιότητα \textbf{2} δεν ισχύει στον Μ/Σ Fourier συνεχών σημάτων;
\end{questionbox}

\begin{exercise}
	Να βρεθεί ο συνεχής Μ/Σ Fourier της:
	\[
	h(n) = \begin{cases}
	1 & \quad 0 \leq n < N\\
	0 & \quad \text{αλλού}
	\end{cases}
	\]
	\tcblower
	Η δοθείσα συνάρτηση γράφεται απλούστερα ως:
	\[
	h(n) = u(n) - u(n-N)
	\]
	
	Επομένως μπορούμε να υπολογίσουμε αναλυτικά το μετασχηματισμό της:
	\begin{align*}
		H\left(e^{j\omega }\right)
		&= \sum_{n=-\infty}^{\infty} h(n) e^{-j\omega n}
		\\ &= \sum_{n=0}^{N-1} 1 e^{-j\omega n}
		\\ &= \frac{1-e^{-j\omega N}}{1-e^{-j\omega }}
		\\ &= \frac
		{
			e^{-j\omega \sfrac{N}{2} } 
			\left(
				e^{j\omega \sfrac{N}{2} }-e^{-j\omega \sfrac{N}{2} }
			\right)
		}
		{ 
			e^{-j\sfrac{\omega }{2} }  
			\left( e^{j\sfrac{\omega }{2}  }
			-e^{-j\sfrac{\omega }{2} 	}\right)
		}
	\\ &= e^{-\frac{j\omega }{2} (N-1)}	\frac{\sin\left(\frac{\omega N}{2}\right)}{\sin\left(\frac{\omega}{2}\right)}
	\end{align*}
	Άρα:
	\begin{align*}
		\left|H\left(e^{j\omega }\right)\right|
		 &= \left|
		\frac{\sin\left(\frac{\omega N}{2}\right)}{\sin\left(\frac{\omega}{2}\right)}
		\right|
		\\
		\arg\left(H\left(e\right)\right) &= -\frac{\omega}{2}(N-1) + \mathop{atan2}\left(0, \frac{\sin\left(\frac{\omega N}{2}\right)}{\sin\left(\frac{\omega}{2}\right)}\right)
	\end{align*}
\end{exercise}

\begin{enumerate}
	\item[5.]
	Μπορούμε να χωρίσουμε κάθε απόκριση συχνότητας σε ένα περιττό και ένα άρτιο κομμάτι:
	\[
	h(n) = h_o(n) + h_e(n)
	\]
	όπου \( h_o(n) = j\Im \left\lbrace H\left(e^{j\omega }\right)\right\rbrace \)
	και \( h_e = \Re\left\lbrace H\left(e^{j\omega }\right) \right\rbrace \)
\end{enumerate}

\paragraph{Μετασχηματισμός σήματος}
Ακριβώς όπως ορίσαμε το μετασχηματισμό της κρουστικής απόκρισης, μπορούμε να μετασχηματίσουμε
και την είσοδο \( x(n) \):
\[
X\left(e^{j\omega }\right) = \sum_{-\infty}^{\infty} x(n)e^{-j\omega n}
\]

Τότε, μπορούμε δοθέντος του συνεχούς Μ/Σ Fourier ενός σήματος, να γυρίσουμε πίσω στο ίδιο το σήμα:
\[
x(n) = \frac{1}{2π} \int_{-π}^{π} X\left(e^{j\omega }\right)e^{j\omega n}\dif \omega 
\]

Εδώ δίνουμε προσοχή στο ότι \textbf{ολοκληρώνουμε} και δεν αθροίζουμε, αφού στο μετασχηματισμό αυτόν
η συχνότητα είναι \emph{συνεχής μεταβλητή}.

\subparagraph{Απόδειξη}
Έχουμε:
\begin{align*}
	X\left(e^{j\omega }\right) &= \sum_{k=-\infty}^{\infty} x(k)e^{-j\omega k}
	\implies  \\ X\left(e^{j\omega }\right)e^{j\omega n} &= \sum_{k=-\infty}^{\infty} x(k)e^{j\omega (n-k)}
	\\ \implies \int_{-π}^{π}X\left(e^{j\omega }\right) e^{j\omega n}\dif\omega
	&= \sum_{k=-\infty}^{\infty} x(k) \int_{-π}^{π} e^{j\omega (n-k)}\dif\omega
	= \sum_{k=-\infty}^{\infty} x(k) 2πδ(n-k) = 2\pi x(n).
\end{align*}

\paragraph{Θεώρημα Parseval}\hspace{0pt}

\begin{theorem}{Parseval's Theorem}{}
	Το θεώρημα του Parseval συνδέει την \textbf{ενέργεια} του σήματος με το Μ/Σ Fourier του:
	\[
	E = \sum_{n=-\infty}^{\infty} \left|x(n)\right|^2
	= \frac{1}{2\pi} \int_{-π}^{π}X\left(e^{j\omega }\right)X^*\left(e^{j\omega }\right)\dif \omega 
	\]
\end{theorem}
\begin{questionbox}{Άσκηση για το σπίτι}
	Να αποδειχθεί το θεώρημα του Parseval.
\end{questionbox}


\paragraph{Πολλαπλασιασμός \& Συνέλιξη}
\hspace{0pt}

\begin{theorem}{}{}
	Η \textbf{συνέλιξη} στο χρόνο είναι \textbf{πολλαπλασιασμός} στη συχνότητα του DTFT:
	\[
	x(k) * h(k) \leftrightarrow X\left(e^{j\omega }\right) H\left(e^{j\omega }\right)
	\]
\end{theorem}

\subparagraph{Απόδειξη}
Έχουμε:
\begin{align*}
	y(n) &= \sum_{k=-\infty}^{\infty}
	h(n-k)x(k)
	\implies \\
	\sum_{n=-\infty}^{\infty}y(n)e^{-j\omega n} &= \sum_{n=-\infty}^{\infty}
	e^{-j\omega n}\sum_{k=-\infty}^{\infty} h(n-k)x(k)
	\implies \\
	Y\left(e^{j\omega }\right) &= \sum_{k=-\infty}^{\infty} x(k) \sum_{n=-\infty}^{\infty}e^{-j\omega n}h(n-k)
    \\ &=
    \sum_{k=-\infty}^{\infty}x(k)e^{-j\omega k}\sum_{n=-\infty}^{\infty}e^{-j\omega (n-k)}h(n-k)
    \\ &= X\left(e^{j\omega }\right) H\left(e^{j\omega }\right)
\end{align*}

\section{Μετασχηματισμός Z}
Ο \textbf{μετασχηματισμός Z} είναι μια επέκταση του μετασχηματισμού Fourier στον διακριτό κόσμο, που
θα μπορούσε να μοιάσει με το μετασχηματισμό Laplace στο συνεχές σήμα.

Θυμόμαστε ότι η έξοδος ενός συστήματος είναι:
\[
y(n) = h(n) * x(n)
\]
και για μία είσοδο εκθετικής μορφής:
\[
x(n) =a^n
\]
η έξοδος θα είναι:
\[
y(n) = a^n \underbrace{\sum_{k=-\infty}^{\infty} h(k)a^{-k}}_{H(a)}
\]
ή, θεωρώντας ότι το \( a \) είναι κάποιο μιγαδικό \( z \):
\[
y(n) = z^n \sum_{k=-\infty}^{\infty} h(k)z^{-k}
\]

Τώρα μπορούμε να ορίσουμε το μετασχηματισμό \( Z \) ως εξής:
\begin{defn}[label=defn:ztrans]{Μετασχηματισμός Z}{}
	Ο μετασχηματισμός Z μιας συνάρτησης \( x(n) \) ορίζεται ως εξής:
	\[
	X(z) = \sum_{n=-\infty}^{\infty} x(n) z^{-n}
	\]
\end{defn}

\subsection{Περιοχή σύγκλισης}

Για να έχει νόημα ο \autoref{defn:ztrans}, πρέπει να συγκλίνει το εξής άθροισμα:
\[
\sum_{n=-\infty}^{\infty} \left| x(n)z^{-n} \right| < \infty
\]
ή, ισοδύναμα:
\[
\sum_{n=-\infty}^{\infty} \left\lvert x(n) \right\rvert \left\lvert z\right\rvert^{-n} < \infty
\]

Αυτό που καθορίζει το αν θα συγκλίνουμε είναι το μέτρο \( |z| \). Οι περιοχές ίσου μέτρου ορίζουν
κύκλους ή donuts στο μιγαδικό επίπεδο του \( z \):

\begin{tikzpicture}
\draw[->] (0,-2) -- (0,2);
\draw[->] (-2,0) -- (2,0) ;
\filldraw[fill=green!50] (0,0) circle (1cm);
\end{tikzpicture}
\hfill
\begin{tikzpicture}
\fill[inner color=green!50!black, outer color=green!5,fill=white]
(0,0) circle (2);
\draw[->] (0,-2) -- (0,2);
\draw[->] (-2,0) -- (2,0) ;
\filldraw[fill=white] (0,0) circle (1cm);
\end{tikzpicture}
\hfill
\begin{tikzpicture}
\fill[green!50,even odd rule] (0,0) circle (0.8) -- (0,0) circle (1.5);

\draw[->] (0,-2) -- (0,2);
\draw[->] (-2,0) -- (2,0) ;

\draw (0,0) circle (0.8) -- (0,0) circle (1.5);
\end{tikzpicture}

Από τη μιγαδική ανάλυση αποδεικνύεται πως η περιοχή σύγκλισης \textbf{δεν} μπορεί να έχει κάποια άλλη περίεργη
μορφή:

\begin{tikzpicture}[scale=.7]
\fill[white,inner color=red!50!black,outer color=white,even odd rule] (0,0) circle (1.8) -- (0,0) circle (3);
\draw[black] (0,0) circle(1.8);

\filldraw[fill=red!50] (0,0) circle (0.9);

\draw[->] (0,-3) -- (0,3);
\draw[->] (-3,0) -- (3,0) ;
\end{tikzpicture}
\hfill
\begin{tikzpicture}[scale=.7]

\fill[white,inner color=red!50!black,outer color=white,even odd rule] (0,0) circle (2) -- (0,0) circle (3);
\draw[black] (0,0) circle(2);

\fill[red!50,even odd rule] (0,0) circle (0.6) -- (0,0) circle (1.3);

\draw[->] (0,-3) -- (0,3);
\draw[->] (-3,0) -- (3,0) ;

\draw (0,0) circle (0.6) -- (0,0) circle (1.3);
\end{tikzpicture}
\hfill
\begin{tikzpicture}[scale=.7]
\fill[red!50,even odd rule] (0,0) circle (0.8) -- (0,0) circle (1.5);
\draw (0,0) circle (0.8) -- (0,0) circle (1.5);

\fill[red!50,even odd rule] (0,0) circle (2.2) -- (0,0) circle (2.8);
\draw (0,0) circle (2.2) -- (0,0) circle (2.8);

\draw[->] (0,-3) -- (0,3);
\draw[->] (-3,0) -- (3,0) ;
\end{tikzpicture}

Επομένως, για το \( |z| \) θα ισχύει \( D < |z| < U \) για κάποια \( D, U \). Αυτά ορίζουν το \textbf{ROC} (Region Of Convergence) του μετασχηματισμού Z, χωρίς το οποίο ο μετασχηματισμός δεν έχει νόημα.

\subparagraph{}
\phantomsection
\label{sec:znroc}
Στις περιοχές σύγκλισης θα εξετάζουμε και αν ανήκει το \( |z|=\infty \). Τονίζουμε ότι ο όρος \( z^{n} \) \textbf{ορίζεται} για:
\begin{itemize}
	\item \( |z| < \infty \), όταν \( n>0 \).
	\item \( z \in \mathbb C \), όταν \( n = 0 \).
	\item \( |z| > 0\), όταν \( n<0 \).
\end{itemize}

\begin{exercise}
	\phantomsection
	\label{sec:findz1}

	Να βρεθεί ο Z μετασχηματισμός του \( x(n) = a^n\mathrm u(n) \).\tcblower
	\begin{align*}
		X(z) &= \sum_{n=-\infty}^{\infty} x(n) z^{-n}
		= \sum_{n=0}^{\infty} a^n z^{-n} = \sum_{n=0}^{\infty} \left(\frac{a}{z}\right)^n
		\\ &= \frac{1}{1-\frac{a}{z}} = \frac{z}{z-a} \qquad \text{ αν $\left|\frac{a}{z}\right|=1$}
	\end{align*}
	
	Άρα γράφουμε συμβολικά:
	\[
	x(n) = a^n\mathrm{u}(n) \xrightarrow{ZT} X(z) = \frac{z}{z-a}\qquad \text{ROC}: |z|>|a|
	\]
\end{exercise}

\begin{exercise}
	Να βρεθεί ο μετασχηματισμός Z του \( x(n)= -a^n \mathrm{u}(-n-1) \).
	\tcblower
	Έχουμε:
	\begin{align*}
		X(z) &= \sum_{n=-\infty}^{\infty} x(n) z^{-n}
		= \sum_{n=-\infty}^{-1} -a^n z^{-n}
		= \sum_{n=-\infty}^{-1} -\left(\frac{a}{z}\right)^n
		\intertext{Προσπαθώ να ξεκινήσω την άθροιση από το 0 για να εφαρμόσω τύπο γεωμετρικής προόδου:}
		 &=
		\sum_{n=1}^{\infty} -\left(\frac{a}{z}\right)^{-n}
		= -\sum_{n=1}^{\infty}\left(\frac{z}{a}\right)^n
		= 1-\sum_{n=0}^{\infty}\left(\frac{z}{a}\right)^n
		\\ &= 1 - \frac{1}{1-\frac{z}{a}} & \left|\frac{z}{a}\right|<1
		\\ &= \frac{1-\frac{z}{a}-1}{1-\frac{z}{a}} = \frac{-\frac{z}{a}}{1-\frac{z}{a}}
		= \frac{-z}{a-z} = \frac{z}{z-a}
	\end{align*}
	
	Εδώ παρατηρούμε κάτι ενδιαφέρον: Ο τύπος του μετασχηματισμού Z είναι \textbf{ακριβώς ίδιος} με
	αυτόν της προηγούμεης άσκησης, παρ' όλο που προέρχονται από διαφορετικές συναρτήσεις. Η διαφορά
	εδώ βρίσκεται στην \textbf{περιοχή σύγκλισης} (ROC), που είναι διαφορετική στις δύο ασκήσεις.
	Εδώ φαίνεται και η σημασία του δεδομένου της περιοχής σύγκλισης.
\end{exercise}

\begin{exercise}
	Να βρεθεί ο μετασχηματισμός Z της συνάρτησης:\[
	x(n) = a^n \mathrm{u}(n) - b^n \mathrm{u}(-n-1)
	\]
	\tcblower
	Έχουμε:
	\begin{align*}
		X(z) &= \sum_{n=-\infty}^{\infty} x(n)z^{-n}
		\\ &= \sum_{n=-\infty}^{\infty} \left[
		a^n \mathrm{u}(n) - b^n \mathrm{u}(-n-1)
		\right]z^{-n}
		\\ &= \sum_{n=0}^{\infty} a^n z^{-n}
		- \sum_{n=-\infty}^{-1}b^n z^{-n}
		\\ &= \frac{z}{z-a} + \frac{z}{z-b} \qquad \text{για $|z|>|a|$ και $|z|<|b|$}
	\end{align*}
	
	Η \( X(z) \) υπάρχει αν υπάρχει η περιοχή σύγκλισης (ROC): \( |a|<|z|<|b| \). Για να συμβαίνει
	αυτό, πρέπει να ισχύει η συνθήκη \( |a|<|b| \). Διαφορετικά, δεν υπάρχει ο μετασχηματισμός.
\end{exercise}

\todo{Slightly underline links}
\begin{itemize}
	\item Για \textbf{ακολουθίες δεξιάς πλευράς} 
	(\( x(n) = 0 \impliedby n<n_0 \), \autoref{sec:seqtypes}), αν \( n_0 \geq 0 \), η περιοχή σύγκλισης είναι:
	\[
	|z| > |z_1|
	\]
	\subparagraph{Απόδειξη}
	Ο μετασχηματισμός \( Z \) της ακολουθίας θα είναι:
	\[
	\sum_{n=n_0\; \geq 0}^{\infty} x(n)z^{-n}
	\]
	
	Υποθέτουμε ότι συγκλίνει για κάποιο \( |z| = |z_1| \)
	Θέλουμε η σειρά \(\displaystyle \sum_{n=n_0\geq 0}^{\infty} \left| x(n)z_1^{-n} \right| < \infty \) να συγκλίνει.
	
	Τότε, για ένα τυχαίο \( |z| > |z_1| \), θα ισχύει
	\[
	|z| > |z_1| \implies |z|^{-n} < |z_1|^{-n} \implies \left\lvert x(n) \middle\rvert \middle\lvert z^{-n} \right\rvert < \left\lvert x(n) \middle\rvert \middle\lvert z_1^{-n} \right\rvert < \infty
	\]
	αν \( n \geq 0 \). Δηλαδή, η ακολουθία θα συγκλίνει για οποιοδήποτε \( |z| \) μεγαλύτερο κάποιου \( |z_1| \).
	
	\begin{itemize}
	\item Αν αντίθετα, \( n_0 < 0 \):
	\[
	\sum_{n=n_0}^{\infty} x(n)z^{-n} = \underbrace{\sum_{n=n_0}^{-1} x(n)z^{-n}}_{\mathclap{\text{συγκλίνει ως πεπερασμένο}}} + \overbrace{  \sum_{n=0}^{\infty} x(n)z^{-n}}^{\mathclap{\text{συγκλίνει}}}
	\]
	που οδηγεί σε ένα αντίστοιχο αποτέλεσμα, πλην του κύκλου στο άπειρο:
	\[
	|z_1| < |z| < \infty
	\]
	\end{itemize}
	\item Για \textbf{ακολουθίες αριστερής πλευράς} (\( x(n) = 0 \impliedby n > n_0 \)), τότε (αντίστοιχα με παραπάνω):
	
	\[
	X(z) = \sum_{n=-\infty}^{n_0} x(n)z^{-n}
	\]
	
	Τότε θα ισχύει:
	\[
	\begin{cases}
	n_0 \leq 0 &\implies \text{ROC } =\ |z| < |z_1|\\
	n_0 > 0 &\implies \text{ROC } =\ 0 < |z| < |z_1|
	\end{cases}
	\]
	\item Για \textbf{ακολουθίες πεπερασμένου μήκους} (\( x(n) = 0\ \forall\ n<N,\ n>M,\ M>N \)), ο μετασχηματισμός Z θα είναι:
	\[
	X(z) = \sum_{n=N}^{M} x(n) z^{-n}
	\]
	
	Εδώ δεν έχουμε άπειρο άθροισμα. Κινδυνεύουμε με απειρισμούς μόνον όταν \( z = 0 \) ή \( z = \infty \).
	Πιο συγκεκριμένα:
	\[
	\begin{cases}
	\text{Αν $N < 0$ \& $M > 0$} &\implies \text{ROC: } 0<|z|<\infty\\
	\text{Αν $N > 0$ \& $M > 0$} &\implies \text{ROC: } 0<|z|\\
	\text{Αν $N < 0$ \& $M < 0$} &\implies \text{ROC: } |z|<\infty
	\end{cases}
	\]
\end{itemize}

\lecture{5}{15/10/2018}

\subsection{Αντίστροφος μετασχηματισμός Z}
\label{sec:invz}
Ο ευθύς μετασχηματισμός Z είναι:
\[
X(z) \overset{\triangle}{=} \sum_{n=-\infty}^{\infty} x(n)z^{-n}
\quad \mathcal{R}_{X(z)}
\]

Αποδεικνύεται ότι ο \textbf{αντίστροφος μετασχηματισμός Z} είναι:
\[
x(n) = \frac{1}{2 π j} \ointctrclockwise\limits_{c \in \mathcal{R}_{X(z)z^{n-1}}} X(z)z^{n-1} \dif z
\]

Η παραπάνω σχέση βασίζεται στο ολοκλήρωμα του Cauchy, \( \frac{1}{2πj} \ointctrclockwise z^{-k-1}\dif z = \begin{cases}
1 &\quad k=0 \\ 0&\quad k\neq 0
\end{cases} \)

\subsection{Μέθοδοι υπολογισμού αντίστροφου μετασχηματισμού Z}
\subsubsection{Ολοκληρωτικά υπόλοιπα}
\label{sec:res}
\begin{minipage}{.5\textwidth}
	Με βάση τη μιγαδική ανάλυση, γνωρίζουμε ότι:
	\[
	x(n) = \sum \left\lbrace 
	\mathop{Res} \left[ X(z)z^{n-1} \right]
	\right\rbrace
	\]
	για τους πόλους \textbf{εντός} του \( C \in \mathcal{R}_{X(z)z^{n-1}} \).
\end{minipage}
\begin{minipage}{.5\textwidth}
	\centering
	\begin{tikzpicture}
	\fill[green!50,even odd rule] (0,0) circle (0.8) -- (0,0) circle (1.5);
	\draw[dashed] (0,0) circle (0.8) -- (0,0) circle (1.5);
	\draw[green!50!white!50!black,->] (45:1.2) to[bend left] ++(1,1) node[right,scale=1.2] {\textbf{ROC}};
	
	\draw (60:0.5) node[locuspole,red,ultra thick] {}
	(30:0.2) node[locuspole,red,ultra thick] {}
	(10:0.8) node[locuspole,red,ultra thick] {};
	
	\draw (170:1.8) node[locuspole,densely dotted,thin,opacity=1] {};
	\draw (230:2) node[locuspole,densely dotted,thin,opacity=1] {};
	\draw (190:2.2) node[locuspole,densely dotted,thin,opacity=1] {};
	\draw (40:2.2) node[locuspole,densely dotted,thin,opacity=1] {};
	
	
	\draw[->] (0,-2) -- (0,2);
	\draw[->] (-2,0) -- (2,0) ;
	\end{tikzpicture}
\end{minipage}




Η παραπάνω σχέση συμπεριλαμβάνει και πόλους που βρίσκονται \emph{εκτός των ορίων περιοχής σύγκλισης} αλλά
\emph{μέσα στα όρια του κύκλου που αυτή ορίζει}.

\paragraph{Παράδειγμα}
Ένα σύστημα έχει 4 πόλους. Πόσες είναι οι μέγιστες δυνατές περιοχές σύγκλισης;
\subparagraph{Απάντηση}
\textbf{Ένας πόλος, ως \emph{απομονωμένο} ανώμαλο σημείο, δεν μπορεί να βρίσκεται \emph{μέσα} στην περιοχή σύγκλισης.}

Τοποθετούμε τους πόλους στο πραγματικό επίπεδο για ευκολία, και θεωρούμε περιοχές σύγκλισης με ανοιχτά
όρια. Επειδή μια περιοχή σύγκλισης πρέπει να έχει πόλο στα όριά της, αλλά δεν μπορεί να περιέχει πόλο,
οι δυνατές επιλογές θα μοιάζουν ως εξής:

\begin{tikzpicture}[scale=.5]
\filldraw[fill=green!50] (0,0) circle (1);
\filldraw[fill=green!80!red,even odd rule] (0,0) circle (1) -- (0,0) circle (2);
\filldraw[fill=green!30!cyan,even odd rule] (0,0) circle (2) -- (0,0) circle (3);
\filldraw[fill=green!80!blue,even odd rule] (0,0) circle (3) -- (0,0) circle (4);
\fill[fill=white,even odd rule,inner color=green!30!black,outer color=green!20] (0,0) circle (4) -- (0,0) circle (5.5);
\draw[thick] (0,0) circle (4);

\draw (1,0) node[locuspole] {}
(2,0) node[locuspole] {}
(3,0) node[locuspole] {}
(4,0) node[locuspole] {}
;


\draw[->] (0,-5) -- (0,5);
\draw[->] (-5,0) -- (5,0) ;
\end{tikzpicture}

Άρα έχουμε 5 δυνατότητες για περιοχή σύγκλισης.

\paragraph{Υπολογισμός ολοκληρωτικών υπολοίπων}
\phantomsection
\label{sec:rescalc}
Σύμφωνα με τη μιγαδική ανάλυση, τα ολοκληρωτικά υπόλοιπα που ψάχνουμε μπορούν να βρεθούν ως εξής:
\[
\boxed{
\mathop{Res}\left[
X(z)z^{n-1} \ @\ z=z_0
\right] = \frac{1}{(s-1)!} \left.\od[s-1]{}{z} A(z)\right|_{z=z_0}
}
\]
όπου \( z_0 \) ο πόλος, \( s \) η πολλαπλότητά του, και:
\[
A(z) = X(z)z^{n-1}(z-z_0)^s
\]

\begin{exercise}
	Δίνεται ο μετασχηματισμός Z μιας ακολουθίας:\[
	X(z) = \frac{1}{1-az^{-1}} \qquad |z|>|a|
	\]
	
	Ποιά είναι η αρχική ακολουθία \( x(n) \);
	\tcblower
	Το \( X(z) \) γράφεται και ως:
	\[
	X(z) = \frac{z}{z-a}
	\]
	
	Εξετάζω πόσο κάνει το \( X(z)z^{n-1} \):
	\[
	X(z)z^{n-1} = \frac{z^n}{z-a}
	\]
	που έχει \textbf{πόλο} στο \( z_0 = a \) με \textbf{πολλαπλότητα} \( s_0 = 1 \). Στην περίπτωση που \( n = -k <0 \), προστίθεται και ένας παραπάνω πόλος \( z_1=0 \) πολλαπλότητας
	\( s_1 = |n|= k \).
	
	\begin{itemize}
		\item \textbf{Αν \( n\geq 0 \)}, τότε:
		έχουμε \textbf{1 πόλο} στο \( z_0=a \) πολλ/τας \( s_0=1 \). Άρα από τη θεωρία (\hyperref[sec:rescalc]{Σελίδα \pageref*{sec:rescalc}}):
		\begin{align*}
			x(n) &= \res\left[
			\frac{z^n}{z-a} \ @ \ z=a
			\right] = \frac{1}{(s_0-1)!} \left. \frac{\dif^{s_0-1}}{\dif  z^{s_0-1}} z^n \right|_{z=a}
			\\ &= \frac{1}{(1-1)!}\od[0]{}{z}\left. z^n \right|_{z=a}
			= a^n
		\end{align*}
		\item \textbf{Αν \( n < 0 \)}, τότε έχουμε 1 πόλο \( z_0=a,\ s_0=1 \), και επιπλέον \( k \) πόλους \( z_1=0,\ s_0=k \):
		\begin{align*}
			x(n) &= \res\left[
			\frac{1}{(z-a)z^{-n}}\ @ \ z=a
			\right] = \left.\frac{1}{z^{-n}}\right|_{z=a} = a^n
			\\ &+ \res\left[
			\frac{1}{(z-a)z^{-n}}\ @ \ z=0
			\right] = \frac{1}{(k-1)!}\left.\od[k-1]{}{z} \frac{1}{z-a}\right|_{z=0}
			\\ &= a^n + \frac{1}{(k-1)!}(-1)^{k-1}\left.\frac{1}{(z-a)^k}\right|_{z=0}
			\\ &= a^n + (-1)^{k-1} \frac{1}{(-a)^k}
			= a^n + (-1)^{k-1}(-a)^n = a^n - a^n = 0
		\end{align*}
	\end{itemize}

    Τελικά, το αποτέλεσμα στο οποίο καταλήξαμε είναι το εξής:
    \[
    \left.\begin{aligned}
    n \geq 0 &\quad x(n)=a^n\\
    n < 0 &\quad x(n) = 0
    \end{aligned} \right\rbrace \implies x(n) = a^n\mathrm{u}(n)
    \]
    ένα αποτέλεσμα ίδιο με αυτό της "αντίστροφης" άσκησης που λύσαμε προηγουμένως (\hyperref[sec:findz1]{Σελίδα \pageref*{sec:findz1}}).
\end{exercise}

\begin{exercise}
	Να βρεθεί το αρχικό σήμα του μετασχηματισμού:
	\[
	X(z) = \frac{z(z-b) + z(z-a)}{(z-a)(z-b)}
	\qquad \mathcal{R}_x : |a|<|z|<|b|
	\]
	\tcblower
	Αν και η άσκηση λύνεται άμεσα μετά την παρατήρηση ότι \( X(z) = \frac{z}{z-a}+\frac{z}{z-b} \), εδώ
	θα χρησιμοποιήσουμε τη μεθοδολογία των ολοκληρωτικών υπολοίπων.
	
	Έχουμε:
	\begin{align*}
		X(z)z^{n-1} &= \frac{(2z-a-b)}{(z-a)(z-b)}z^n
		\intertext{Άρα:}
		x(n) &= \frac{1}{2\pi j} \ointctrclockwise_C \frac{(2z-a-b)}{(z-a)(z-b)}z^n\dif z
		= \frac{1}{2πj}\ointctrclockwise_C I(z)\dif z
	\end{align*}
	όπου ορίσαμε για ευκολία \( I(z) = \frac{(2z-a-b)}{(z-a)(z-b)}z^n \).
	
	\begin{tikzpicture}
	\filldraw[fill=green!50,even odd rule] (0,0) circle (0.8) -- (0,0) circle (1.5);
	\draw[->] (45:1.5) to[bend left] ++(1,1) node[right,scale=1.2] {$|b|$};
	\draw[->] (-45:0.8) to[bend right] ++(1,-1) node[right,scale=1.2] {$|a|$};
	
	\draw[ultra thick,blue,<-] plot [smooth,tension=0.7] coordinates {(100:1.2) (70:1.0) (25:1.2) ( -30:1.0) (-90:1.3) (-120:1.3) (-150:1.1) (180:1.3) (120:1.3) (100:1.2)} node[below] {$C$} -- (99:1.19);
	
	
	\draw[->] (0,-2) -- (0,2);
	\draw[->] (-2,0) -- (2,0) ;
	
	\draw (1.5,1) node[right] {$z$-plane};
	\end{tikzpicture}
	
	Το \( I(z) \) έχει πόλους \( z \) πολλαπλότητας \( s \):
	\[ I(z) \rightarrow
	\begin{cases}
	z_0 = a &\quad s_0=1\\
	z_1 = b &\quad s_1=1
	\end{cases}
	\]
	
	\begin{itemize}
		\item \textbf{Αν \( n\geq 0 \)}, τότε:
		\[
		x(n) = \res\left[
		I(z) \ @ \ z=a
		\right] =\left. \frac{z^n(2z-a-b)}{(z-b)}\right|_{z=a}
		= \frac{a^n(2a+a-b)}{(a-b)} = a^n
		\]
		
		Εδώ δεν συμπεριλάβαμε τον πόλο \( z_1=b \) επειδή είναι \emph{εκτός} του χωρίου που περικλείεται
		από την περιοχή σύγκλισης.
		
		Επομένως: \[
		x(n) = a^n \quad \text{όταν } n \geq 0
		\]
		
		\item \textbf{Αν \( n < 0 \)}, τότε οι πόλοι του \( I(z) \), λόγω του όρου \( z^n \), είναι:
		\[
		I(z) \rightarrow \begin{cases}
		z_0 = a &\quad s_0 = 1\\
		z_1 = b &\quad s_1 = 1\\
		z_2 = 0 &\quad s_2 = -n = k
		\end{cases}
		\]
		
		Άρα η ακολουθία είναι:
		\begin{align*}
			x(n) &= \res\left[
			I(z) \ @ \ z=a
			\right] + \res\left[
			I(z) \ @ \ z=0
			\right]
			\intertext{επειδή $a,0 \in \mathop{int}(C)$, ενώ $b \notin \mathop{int}(C)$}
			&= \left. \frac{2z-a-b}{z^{-n}(z-b)} \right|_{z=a}
			+ \frac{1}{(-n-1)!}\left. \od[-n-1]{}{z} \left( \frac{2z-a-b}{(z-a)(z-b)} \right)\right|_{z=0}
		\end{align*}
		
		Για να υπολογίσουμε τη "δύσκολη" παραπάνω παράγωγο, εφαρμόζουμε ένα τρικ. Θέτουμε \( z = \sfrac{1}{ρ}  \), οπότε \( \dif z = -\frac{1}{ρ^2}\dif ρ \), και η περιοχή σύγκλισης γίνεται
		\( |a|^{-1} > |ρ|> |b|^{-1} \). Και τότε:
		\begin{align*}
		I(z)\dif z &= -\frac{ρ^{-n}(2ρ^{-1}-a-b)}{\left( ρ^{-1}-a \right)\left( ρ^{-1}-b \right)}\frac{1}{ρ^2} \dif\rho
		\\ &= -\frac{ρ^{-n}(2ρ^{-1}-a-b)}{(1-aρ)(1-bρ)}\dif ρ
		\end{align*}
		
		Άρα τελικά:
		\begin{align*}
			x(n) &= \frac{1}{2πj} \ointclockwise_C \left[
			-\frac{ρ^{-n}(2ρ^{-1}-a-b)}{(1-aρ)(1-bρ)}
			\right]
			\dif ρ
		\end{align*}
		
		Στο νέο υπολογισμό με βάση το \( ρ \) και όχι το \( z \), έχει αλλάξει το επίπεδο όπου προβάλλουμε
		τους πόλους. Η περιοχή σύγκλισης μοιάζει πάλι με donut, αλλά η καμπύλη \( C \) διαγράφεται τώρα
		ωρολογιακά και όχι αντιωρολογιακά, λόγω της αλλαγής μεταβλητής \( \dif z = -\frac{1}{ρ^2}\dif ρ \).
		
		\begin{tikzpicture}
		\filldraw[fill=green!50,even odd rule] (0,0) circle (0.8) -- (0,0) circle (1.5);
		\draw[->] (45:1.5) to[bend left] ++(1,1) node[right,scale=1.2] {$\frac{1}{|a|}$};
		\draw[->] (-45:0.8) to[bend right] ++(1,-1) node[right,scale=1.2] {$\frac{1}{|b|}$};
		
		\draw[ultra thick,blue,->] plot [smooth,tension=0.7] coordinates {(100:1.2) (70:1.0) (25:1.3) ( -30:1.0) (-90:1.0) (-130:1.3) (-150:1.2) (120:1.3) (100:1.2)} node[below] {$C$} -- (99:1.19);
		
		
		\draw[->] (0,-2) -- (0,2);
		\draw[->] (-2,0) -- (2,0) ;
		
		\draw (1.5,1) node[right] {$p$-plane};
		\end{tikzpicture}
		
		Άρα:
		\begin{align*}
			x(n) &= \frac{1}{2πj} \ointctrclockwise_C \left[
			\frac{ρ^{-n}(2ρ^{-1}-a-b)}{(1-aρ)(1-bρ)}
			\right]
			\dif ρ
			\\ &= \res\left[
			\frac{ρ^{-n}(2ρ^{-1}-a-b)}{(1-aρ)(1-bρ)} \ @ \ \rho = \frac{1}{b}
			\right]
			\\ &= \left.\frac{1}{ab}\left[
			\frac{ρ^{-n-1}\left[ 2-(a+b)ρ \right] }{\left( ρ-\frac{1}{a} \right)}
			\right]\right|_{\rho = \sfrac{1}{b} } = \frac{1}{ab} \left[
			\frac{\left(\frac{1}{b}\right)^{-n-1}\left[
				2-\frac{a+b}{b}
				\right]}{\left(\frac{1}{b}-\frac{1}{a}\right)}
			\right]
			\\ &= \frac{b^{n}\left(2b-a-b\right)}{a-b} = \frac{b-a}{a-b} = -b^n
		\end{align*}
		
		Άρα τελικά:
		\[
		x(n) = -b^n \text{ για } n<0
		\]
	\end{itemize}

    Επομένως, η ζητούμενη ακολουθία είναι:
    \[
    x(n) = a^n\mathrm{u}(n) - b^n \mathrm{u}(-n-1)
    \]
\end{exercise}

\subsubsection{Μέθοδος συνεχούς διαίρεσης}
\begin{exercise}
	Δίνεται ο Μ/Σ Z:
	\[
	X(z) = \frac{2z^2 - (a+b)z}{z^2 - (a+b)z+ab}
	\qquad |a|<|b|<|z|
	\]

	Να βρεθεί η \( x(n) \).
	\tcblower
	Η μέθοδος αυτή απαιτεί ένα είδος διαίρεσης των πολυωνύμων \( 2z^2 - (a+b)z \)
	και \( z^2-(a+b)z + ab \).
	Το πηλίκο θα προκύψει \( 2 + (a+b)z^{-1} + (a^2+b^2)z^{-2} + (a^3+b^3)z^{-3} + \dots \), κάτι
	που μοιάζει με τον ορισμό του μετασχηματισμού Z: \( \sum x(n)z^{-n} \), επομένως η \( x(n) = \left(a^n+b^n\right)\mathrm{u}(n) \).
	
	Αντίστοιχα, για περιοχή σύγκλισης \( |z|<|a|<|b| \), θα βρίσκαμε \( x(n)=-\left(a^n+b^n\right)\mathrm{u}(-n-1) \). Όμως δεν μπορούμε να χρησιμοποιήσουμε τη μέθοδο αυτήν
	για περιοχές της μορφής \( |a|<|z|<|b| \).
\end{exercise}

\lecture{6}{19/10/2018}
\subsection{Ιδιότητες του μετασχηματισμού Z}
\begin{enumpar}
	\item \textbf{Γραμμικότητα}
	
	Έστω \( N \) σε πλήθος ακολουθίες \( x_k(n) \) και οι μετασχηματισμοί Z τους:
	\begin{align*}
		x_k(n) &\xrightarrow{\mathcal{Z}T} X_k(z) \qquad k=1,2,\dots,N
		\intertext{και έστω μία ακολουθία $y(n)$ που είναι γραμμικός συνδυασμός των παραπάνω:}
		y(n) &= \sum_{k=1}^{N} a_kx_k(n) \qquad a_k \in \mathbb{C} \text{ σταθερές}
	\end{align*}
	Τότε, η παραπάνω ακολουθία θα έχει μετασχηματισμό Z:
	\begin{align*}
		Y(z) &= \sum_{k=1}^{N} a_k X_k(z)
		\intertext{ο οποίος έχει περιοχή σύγκλισης:}
		\mathcal{R}_{Y(z)} &\supseteq \bigcap_{k=1}^N \mathcal{R}_{X_k(z)}
	\end{align*}
	δηλαδή η \emph{περιοχή σύγκλισης}
	του γραμμικού συνδυασμού είναι \emph{τουλάχιστον} η τομή όλων των περιοχών σύγκλισης των
	επιμέρους ακολουθιών. Ο όρος \emph{τουλάχιστον} (ή αντίστοιχα το σύμβολο \( \supset \)) εκφράζουν
	ότι η περιοχή σύγκλισης της \( Y(z) \) μπορεί να είναι μεγαλύτερη των επιμέρους. Αυτό μπορεί για
	παράδειγμα να συμβαίνει όταν προσθέτουμε τις ακολουθίες με \( \mathcal{Z}\mathrm{T} \): \( \frac{1}{z-1} - \frac{1}{z-1} = 0 \), ή τις ακολουθίες \( \frac{z}{z-1}-\frac{1}{z-1}=\frac{z-1}{z-1}=1 \) όπου απαλείφεται ο πόλος.
	
	\item \textbf{Μετατόπιση}
	
	Έστω η ακολουθία \( x(n) \) και ο μετασχηματισμός της:
	\begin{align*}
		x(n) &\xrightarrow{\mathcal{Z} T} X(z) \qquad \mathcal{R}_X
		\intertext{και έστω ότι τη μετατοπίζουμε κατά \( n_0 \in \mathbb Z \) (είναι απαραίτητο ο \( n_0 \) να είναι \textbf{ακέραιος})}
		\infoboxed{y(n) = x(n-n_0)} &\xrightarrow{\mathcal{Z} T} \infoboxed{z^{-n_0}\, X(z)}
	\end{align*}
	
	\paragraph{Απόδειξη}
	\begin{align*}
		Y(z) &= \mathcal{Z}T \left\lbrace y(n) \right\rbrace
		= \sum_{n=-\infty}^{\infty} x(n-n_0)z^{-n} \underset{n-n_0 \leftarrow n}{=} \sum_{n=-\infty}^{\infty} x(n) z^{-(n+n_0)}
		\\ &= z^{-n_0}\sum_{n=-\infty}^{\infty} x(n)z^{-n}
		= z^{-n_0}X(z)
	\end{align*}
	
	Η περιοχή σύγκλισης εξαρτάται από το ποιούς πόλους εξαφανίζει και εμφανίζει το \( z^{-n_0} \). Είναι ίδια με την αρχική, ή συμπεριλαμβάνονται ή αφαιρούνται τα σημεία \( z=0 \) ή \( z=\infty \).
	
	\item \textbf{Πολλαπλασιασμός με εκθετική ακολουθία (εκθετικό σήμα)}
	
	Δίνεται η ακολουθία:
	\begin{align*}
		x(n) &\xrightarrow{\mathcal{Z}T} X(z) \qquad \mathcal{R}_x : r_- < |z| < z_+
		\intertext{και την πολλαπλασιάζουμε με ένα εκθετικό $a^n$ όπου $a\in\mathbb{C}$:}
		\infoboxed{y(n) = a^n x(n)} &\xrightarrow{\mathcal{Z}T} \infoboxed{Y(z) = X\left(\frac{z}{a}\right)}
	\end{align*}
	
    \paragraph{Απόδειξη} Έχουμε:
    \begin{align*}
    	Y(z) &= \sum_{n=-\infty}^{\infty} a^n x(n) z^{-n} =
    	\sum_{n=-\infty}^{\infty} x(n) \left(\frac{z}{a}\right)^{-n}
    	= X\left(\frac{z}{a}\right)
    \end{align*}
    
    Για να εκτελέσουμε την τελευταία πράξη, πρέπει να ισχύει:
    \begin{gather*}
    	\left|\frac{z}{a} \right|  \in \mathcal{R}_x \implies
    	r_- < \left|\frac{z}{a}\right| < r_+ \implies
    	\boxed{|a|r_- < |z| < |a|r_+}
    \end{gather*}
    
    \item \textbf{Παραγώγιση του μετασχηματισμού}
    \[
    \infoboxed{nx(n) \xrightarrow{\mathcal{Z}T} -z\od{X(z)}{z}}
    \]
    
    \paragraph{Απόδειξη}
    \begin{align*}
    	\mathcal{Z}T\left\lbrace nx(n) \right\rbrace
    	&= \sum_{n=-\infty}^{\infty} nx(n)z^{-n}
    	= \sum_{n=-\infty}^{\infty} x(n) \left( -z \od{z^{-n}}{z} \right)
    	\\ &= -z\od{}{z}\left(\sum_{n=-\infty}^{\infty} x(n)z^{-n}\right)
    	= -z\od{}{z}X(z)
    \end{align*}
    
    \item \textbf{Χρονική αντιστροφή}
    
    Για την ακολουθία \( x(n) \):
    \begin{align*}
    	x(n) &\xrightarrow{\mathcal{Z}T} X(z) \qquad \mathcal{R}_x: r_- < |z| < r_+\\
    	\infoboxed{y(n) = x(-n)} &\xrightarrow{\mathcal{Z}T} \infoboxed{Y(z) = X(z^{-1})}
    \end{align*}
    
    \subparagraph{Απόδειξη}
    Έχουμε:
    \begin{align*}
    	Y(z) &= \sum_{n=-\infty}^{\infty} x(-n)z^{-n}
    	\underset{-n \leftarrow n}{=} \sum_{n=-\infty}^{\infty} x(n)z^{n}
    	= \sum_{n=-\infty}^{\infty} x(n) \left(z^{-1}\right)^n
    	\\ &= X\left( z^{-1} \right)
    \end{align*}
    
    Με την απαίτηση για το πεδίο σύγκλισης:
    \[
    r_- < |z^{-1}| < r_+ \implies \boxed{\frac{1}{r_+} < |z| < \frac{1}{r_-}}
    \]
    
    \item \textbf{Συνέλιξη στο χρόνο}
    
    Έχουμε τη συνέλιξη δύο ακολουθιών \( x \) και \( y \):
    \begin{alignat*}{2}
    	x(n) &\xrightarrow{\mathcal{Z}T} X(z), &&\qquad \mathcal{R}_x\\
    	y(n) &\xrightarrow{\mathcal{Z}T} Y(z), &&\qquad \mathcal{R}_y\\
    	\infoboxed{w(n) = x(n)*y(n)} &\xrightarrow{\mathcal{Z}T} \infoboxed{W(z) = X(z)Y(z)}, &&\qquad \boxed{\mathcal{R}_W \supseteq \mathcal{R}_x \cap \mathcal{R}_y}
    \end{alignat*}
    
    \item \textbf{Γινόμενο σημάτων}
    Έχουμε τον πολλαπλασιασμό δύο ακολουθιών \( x \) και \( y \):
    \begin{alignat*}{2}
    x(n) &\xrightarrow{\mathcal{Z}T} X(z), &&\qquad \mathcal{R}_x\\
    y(n) &\xrightarrow{\mathcal{Z}T} Y(z), &&\qquad \mathcal{R}_y
    \end{alignat*}
    
    Για τον υπολογισμό του στο πεδίο \( Z \), υπολογίζουμε, με βάση τον αντίστροφο μετασχηματισμό Z (\autoref{sec:invz}):
    \begin{align*}
    W(z) &= \sum_{n=-\infty}^{\infty} x(n)y(n)z^{-n} 
    = \sum_{n=-\infty}^{\infty} x(n) \frac{1}{2πj} \ointctrclockwise\limits_{C:υ\in\mathcal{R}_Y} Y(υ)υ^{n-1}\dif υ z^{-n}
    \\ &= \frac{1}{2πj} \ointctrclockwise_{C:υ\in\mathcal{R}_Y}
    Y(υ) υ^{-1} \sum_{n=-\infty}^{\infty} x(n) υ^n z^{-n} \dif υ\\
    &\underset{\frac{Z}{υ} \in \mathcal{R}_x}{=} \frac{1}{2πj} \ointctrclockwise_{C:υ\in\mathcal{R}_Y} Y(υ)υ^{-1} X\left(\frac{z}{υ}\right)\dif υ
    \\
    W(z) &= \frac{1}{2πj} \ointctrclockwise_{C:\substack{υ\in\mathcal{R}_Y \\ \frac{z}{υ}\in\mathcal{R}_x}}
    Y(υ)υ^{-1} X\left( \frac{z}{υ} \right)\dif υ
    \end{align*}
    
    Δεδομένων των περιορισμών, πρέπει:
    \[
    \left.
    \begin{matrix}
    r_-^Y < |υ| < r_+^Y\\
    r_-^X < \left|\frac{z}{υ}\right| < r_+^X
    \end{matrix}
    \right\rbrace
    \mathcal{R}_W: r_-^Xr_-^Y < |z| < r_+^Yr_+^X
    \]
\end{enumpar}

\begin{exercise}
	Να υπολογιστεί ο μετασχηματισμός Z του:
	\[
	x(n) = δ(n)
	\]
	\tcblower
	Έχουμε:
	\[
	X(z) = \sum_{n=-\infty}^{\infty} δ(n)z^{-n} = 1 \quad \forall z\in \mathbb C 
	\]
\end{exercise}

\begin{exercise}
	Να υπολογιστεί ο μετασχηματισμός Z του:
	\[
	x(n) = δ(n-n_0)
	\]
	\tcblower
	Έχουμε:
	\[
	X(z) = \sum_{n=-\infty}^{\infty} δ(n-n_0)z^{-n} = z^{-n_0}
	\]
	
	Η περιοχή σύγκλισης εξαρτάται από το \( n_0 \) και είναι (\hyperref[sec:znroc]{Σελίδα \pageref{sec:znroc}}):
	\[
	\begin{cases}
	n_0 > 0: &\quad 0 < |z|\\
	n_0 < 0: &\quad |z| < \infty
	\end{cases}
	\]
\end{exercise}

\begin{exercise}
	Να βρεθεί ο Μ/Σ Z:
	\[
	x(n) = u(n)
	\]
	\tcblower
	Έχουμε:
	\begin{align*}
		X(z) &= \sum_{n=-\infty}^\infty u(n)z^{-n} = \sum_{n=0}^{\infty} z^{-n}
		= \frac{1}{1-z^{-1}}
	\end{align*}
	
	Πρέπει \( |z^{-1}| < 1 \), άρα η περιοχή σύγκλισης είναι ROC: \( |z|>1 \).
\end{exercise}

\begin{exercise}
	Βρείτε Μ/Σ Z:
	\[
	x(n) = u(n-n_0)
	\]
	\tcblower
	Εκμεταλλευόμενοι την ιδιότητα του μετασχηματισμού Z, έχουμε:
	\begin{align*}
		X(z) &=z^{-n_0} \cdot \mathcal{Z}T\left\lbrace u(n) \right\rbrace
		= z^{-n_0}\frac{z}{z-1}
		\\ &= \frac{z^{-n_0+1}}{z-1}
	\end{align*}
	
	Για την περιοχή σύγκλισης, έχουμε \( |z|>1 \) από το μετασχηματισμό της
	\( \mathrm{u}(t) \).
	\begin{itemize}
		\item Όταν ο εκθέτης είναι αρνητικός, δηλαδή \( -n_0+1 < 0 \iff n_0 > 1 \), έχουμε
		πόλους στο 0 και στο 1. Επειδή αποκλείεται (λόγω του \( |z|>1 \)) να
		βρισκόμαστε μέσα από τον μοναδιαίο κύκλο, αναγκαστικά το \( \mathcal{R}_X \) θα
		είναι \( |z|>1 \).
		\item Για \( -n_0 + 1 > 0 \iff n_0 < 1 \), έχουμε τον περιορισμό \( 1<|z|<\infty \) (βλ. \hyperref[sec:znroc]{Σελίδα \pageref{sec:znroc}}).
	\end{itemize}
\end{exercise}

\begin{exercise}
	Αν:
	\[
	X(z) = \frac{z}{3z^2-4z+1}
	\]
	να βρεθεί η \( x(n) \) για κάθε πιθανή ROC.
	\tcblower
	\begin{minipage}{.5\textwidth}
		Πρώτα πρέπει να βρούμε τους \textbf{πόλους} της συνάρτησης, για να υπολογίσουμε τις πιθανές ROC.
		
		Έχουμε:
		\begin{align*}
		X(z) &= \frac{z}{3\left(z^2-\frac{4}{3}z+\frac{1}{3}\right)} = \frac{z}{3(z-1)\left(z-\frac{1}{3}\right)}\\
		&= z \left[\frac{1}{(z-1)(z-\frac{1}{3})}\right]
		\\ &= z\left(\frac{1}{2}\frac{1}{z-1} - \frac{1}{2}\frac{1}{z-\sfrac{1}{3} }\right)
		\\ &= \frac{1}{2}\cdot \frac{z}{z-1} - \frac{1}{2}\cdot \frac{z}{z-\sfrac{1}{3} }
		\end{align*}
		
		Επομένως έχουμε πόλους στα σημεία \( 1,\frac{1}{3} \).
	\end{minipage}
    \begin{minipage}{.5\textwidth}
    	\centering
    	\begin{tikzpicture}[scale=.5]
    	\fill[fill=white,even odd rule,inner color=green!60!cyan,outer color=white] (0,0) circle (2) -- (0,0) circle (4.5);
    	\filldraw[fill=green!70] (0,0) circle (1);
    	\filldraw[fill=green!80!red!80!white,even odd rule] (0,0) circle (1) -- (0,0) circle (2);
    	
    	\draw (1,0) node[locuspole] {} node[below] {$\sfrac{1}{3}$}
    	(2,0) node[locuspole] {} node[below] {$1$}
    	;
    	
    	\draw[->] (0,-5) -- (0,5);
    	\draw[->] (-5,0) -- (5,0) ;
    	\end{tikzpicture}
    \end{minipage}
	
	Για να υπολογίσουμε τα παρακάτω, χρησιμοποιούμε τους μετασχηματισμούς:
	\begin{knowledgebox}[width=.7\textwidth]{}
	\begin{align*}
		u(n) &\xrightarrow{\mathcal{Z}T} U(z) = \frac{z}{z-1},\quad |z|>1\\
	a^n	u(n) &\xrightarrow{\mathcal{Z}T} U(z) = \frac{z}{z-a},\quad |z|>|a|\\
	  - u(-n-1) &\xrightarrow{\mathcal{Z}T} U(z) = \frac{z}{z-1},\quad |z|<1\\
	-a^nu(-n-1) &\xrightarrow{\mathcal{Z}T} U(z) = \frac{z}{z-a},\quad |z|<|a|
	\end{align*}
	\end{knowledgebox}

    Προσοχή στο ότι κρατήσαμε το \( z \) έξω από το σπάσιμο σε μερικά κλάσματα, έτσι ώστε να μπορούμε να εφαρμόσουμε τους παραπάνω τύπους που έχουν το \( z \) στον αριθμητή.
	
	\begin{itemize}
		\item \textbf{Αν ROC: \( |z|>1 \)}
		
		Τότε, δεδομένου του μετασχηματισμού Z της \( u(n) \), έχουμε:
		\[
		x(n) = \frac{1}{2} \mathrm{u}(n) - \frac{1}{2} \left(\frac{1}{3}\right)^n \mathrm{u}(n)
		\]
		\item \textbf{Αν ROC: \( |z| < \frac{1}{3} \)}:
		\[
		x(n) = -\frac{1}{2}\mathrm{u}(-n-1) + \frac{1}{2}\left(\frac{1}{3}\right)^n \mathrm{u}(-n-1)
		\]
		\item \textbf{Αν ROC: \( \frac{1}{3} < |z| < 1 \)}:
		\[
		x(n) = -\frac{1}{2} \mathrm{u}(-n-1) - \frac{1}{2}\left(\frac{1}{3}\right)^n \mathrm{u}(n)
		\]
	\end{itemize}
\end{exercise}

\begin{exercise}
	Να βρεθεί η \( x(n) \) του μετασχηματισμού Z:
	\[
	X(z) =\frac{z+1 }{3z^2-4z+1} \qquad |z|>1
	\]
	\tcblower
	Έχουμε:
	\begin{align*}
		\frac{X(z)}{z} &= \frac{z+1}{3z(z-1)\left(z-\frac{1}{3}\right)}
		= \frac{A}{z} + \frac{B}{z-1} + \frac{\Gamma}{z-\sfrac{1}{3} }
		\intertext{όπου προκύπτει \( A=1,\quad B=1,\quad \Gamma = -2 \), άρα:}
		X(z) &= 1 + \frac{z}{z-1} - 2\frac{z}{z-\sfrac{1}{3} } \implies\qquad |z| > 1 \\
		x(n) &= δ(n) + u(n) - 2\left(\frac{1}{3}\right)^n \mathrm{u}(n)
	\end{align*}
	
	\paragraph{}
	Εναλλακτικά, χωρίς να διαιρέσουμε αυθαίρετα με το \( z \):
	\begin{align*}
		X(z) &= \frac{z+1}{3z^2-4z+1} = \frac{z}{3z^2 - 4z+1} + \frac{1}{3z^2-4z+1}\implies \qquad |z|>1
		\\ x(n) &= \frac{1}{2}\mathrm{u}(n) - \frac{1}{2}\left(\frac{1}{3}\right)^n \mathrm{u}(n)
		+ \frac{1}{2}\mathrm{u}(n-1) -\frac{1}{2}\left(\frac{1}{3}\right)^{n-1} \mathrm{u}(n-1)
	\end{align*}
	
	Εδώ, αν και φαινομενικά βγάλαμε διαφορετικά αποτελέσματα με τους δύο διαφορετικούς τρόπους προσέγγισης
	του προβλήματος, στην πραγματικότητα τα αποτελέσματα είναι \emph{ίδια}. Πράγματι, θέτοντας \( n=0,n=1,\dots \) θα πρέπει να πάρουμε το ίδιο αποτέλεσμα.
\end{exercise}

\begin{exercise}
	Να βρεθεί ο αντίστροφος μετασχηματισμός Z του:
	\[
	X(z) = \frac{z^4+z^2}{\left(z-\frac{1}{2}\right)\left(z-\frac{1}{4}\right)}
	\qquad \frac{1}{2}<|z|<\infty
	\]
	\tcblower
	Αυθαίρετα διαιρούμε με το \( z \), και έχουμε:
	\begin{align*}
		\frac{X(z)}{z} &= \frac{z^3+z}{\left(z-\frac{1}{2}\right)\left(z-\frac{1}{4}\right)}
		= z + \frac{3}{4} + \frac{\frac{23}{16}z - \frac{3}{32}}{z^2-\frac{3}{4}z+\frac{1}{8}}
		\\ &= z + \frac{3}{4} + \frac{\sfrac{5}{2} }{z-\sfrac{1}{2} } - \frac{\sfrac{17}{6} }{z-\sfrac{1}{4} } \implies \\
		\\ X(z) &= z^2 + \frac{3}{4}z + \frac{5}{2}\frac{z}{z-\sfrac{1}{2} } - \frac{17}{16}\frac{z}{z-\sfrac{1}{4} } \implies 
		\hspace{60pt} \infty > |z| > \frac{1}{2}
		\\
		x(n) &= δ(n+2) + \frac{3}{4} δ(n+1) + \frac{5}{2} \left(\frac{1}{2}\right)^n \mathrm{u}(n)
		-\frac{17}{16} \left(\frac{1}{4}\right)^n \mathrm{u(n)}
	\end{align*}
\end{exercise}

\begin{exercise}
	Να βρείτε το μετασχηματισμό Z της ακολουθίας:
	\[
	x(n) = (n-2)a^{(n-2)}\cos\left( \omega_0 (n-2) \right)
	\mathrm{u}(n-2)
	\]
	\tcblower
	Έχουμε:
	\begin{align*}
		\mathcal{Z}\left\lbrace x(n) \right\rbrace&= z^{-2}
		\mathcal{Z} \left\lbrace n a^n \cos\left(\omega_0 n\right) \mathrm{u}(n)\right\rbrace
		\\ &= z^{-2} \left[
		-z \od{}{z} \left[ \mathcal{Z}
		  \left\lbrace a^n\cos(\omega_0 n)\mathrm{u}(n) \right\rbrace
		 \right]
		\right]
		\\ &= z^{-2}\left[
		  -z \od{}{z}\left.\mathcal{Z}\left\lbrace \cos(\omega_0 n)\mathrm{u}(n) \right\rbrace\right|_{z=\frac{z}{a}}
		\right]
	\end{align*}
	
	Θέτουμε \( \phi(n) = \cos(\omega_0 n)\mathrm{u}(n) \), και θα βρούμε την \( \Phi(z) \). Έχουμε:
	\begin{align*}
		\mathrm{u}(n) \cos(\omega_0 n) &= \frac{e^{j\omega_0 n} + e^{-j\omega_0 n}}{2} \mathrm u(n)
		\\
		\mathrm{u(n)} e^{j\omega_0 n }&\xrightarrow{\mathcal{Z} T} \frac{1}{1-\frac{e^{j\omega_0}}{z}}
		= \frac{z}{z-e^{j\omega_0}} \qquad \left| \frac{e^{j\omega_0}}{z} \right| < 1 \implies |z|>1
		\\
		\mathrm{u}(n) e^{-j\omega_0 n}&\xrightarrow{\mathcal{Z}} \frac{z}{z-e^{-j\omega_0}} \qquad |z|>1
		\\
		\mathrm{u}(n) \cos(\omega_0 n)&\xrightarrow{\mathcal{Z}} \frac{1}{2}\left[
		\frac{z}{z-e^{j\omega_0}} + \frac{z}{z-e^{-j\omega_0}}
		\right]
		= \frac{z^2-z\cos\omega_0}{z^2-2z\cos\omega_0 + 1}\qquad |z|>1
	\end{align*}
	
	Άρα τελικά:
	\begin{align*}
		X(z) &= -z^{-1}\od{}{z} \left(
		\frac{z^2-z\cos\omega_0}{z^2-2z\cos\omega_0+1}\middle|_{z=\frac{z}{a}}
		\right)
		\qquad |z|>|a|
	\end{align*}
\end{exercise}

\lecture{7}{22/10/2018}

\begin{infobox}{Χρήσιμοι τύποι}
	Στις παραπάνω ασκήσεις χρησιμοποιούσαμε συνεχώς τους τύπους:
	\begin{alignat*}{3}
		X(z) &= \frac{z}{z-a}, &&\quad |z|>|a|\ \xrightarrow{\mathcal{Z}T}\ && x(n) = a^n\mathrm{u}(n)
		\\
		X(z) &= \frac{z}{z-a}, &&\quad |z|<|a|\ \xrightarrow{\mathcal{Z}T}\ && x(n) = -a^n\mathrm{u}(-n-1)
	\end{alignat*}
\end{infobox}

\begin{knowledgebox}{Κλάσματα μεγαλύτερης πολλαπλότητας}
	\[
	X(z) = \frac{z}{(z-a)^k},\qquad |z|>|a|\qquad k \in \mathbb{N} - \left\lbrace 0,1 \right\rbrace
	\]
	\tcblower
	\[
	x(n) = \frac{n(n-1)(n-2)\cdots \left(n-(k-2)\right)}{(k-1)!}a^{n-k+1} \mathrm{u}(n)
	\]
\end{knowledgebox}
\subparagraph{Απόδειξη}
Έχουμε:\begin{align*}
	x(n) &= \frac{1}{2πj} \ointctrclockwise_{C\in\text{ROC}} X(z) z^{n-1}\dif z
	\\ &= \frac{1}{2πj} \ointctrclockwise_C \frac{z^n}{(z-a)^k}\dif z
\end{align*}

Λαμβάνουμε περιπτώσεις για τη στιγμή \( n \):
\begin{itemize}
	\item Αν \( n\geq 0 \) τότε υπάρχει ένας πόλος στο \( z_0=a \) με πολλαπλότητα \( s_0 = k \).
	
	\begin{minipage}{.7\textwidth}
	Με βάση το θεώρημα των ολοκληρωτικών υπολοίπων, έχουμε:
	\begin{align*}
		x(n) &= \frac{1}{(k-1)!}\left.\od[k-1]{}{z} \left[z^n\right]\right|_{z=a}
		\\ &= \frac{1}{(k-1)!}n(n-1)(n-2)\cdots\left(n-(k-2)\right)\left.z^{n-(k-1)}\right|_{z=a}
		\\ &= \frac{n(n-1)(n-2)\cdots\left(n-(k-2)\right)}{(k-1)!}a^{n-k+1}
	\end{align*}
	\end{minipage}
    \begin{minipage}{.3\textwidth}
    	\centering
    	\begin{tikzpicture}[scale=.5]
    	\fill[fill=white,even odd rule,inner color=green!60!cyan,outer color=white] (0,0) circle (1.4) -- (0,0) circle (4.5);
    	\draw[] (0,0) circle (1.4);
    	\draw (45:1.6) node[scale=.9,below left] {$|a|$};
    	
    	\draw (2.5,1) node[right] {$z$-plane};
    	
    	\draw[ultra thick,blue] plot [smooth cycle,tension=0.9] coordinates {(0:2.5) (90:2.5) (180:2.5) (270:2.5)} node[below right] {$C$};
    	
    	\draw[->] (0,-4) -- (0,4);
    	\draw[->] (-4,0) -- (4,0) ;
    	\end{tikzpicture}
    \end{minipage}
	
	\item Αν \( n<0 \), θέτω \( \rho = \frac{1}{z} \), άρα η περιοχή σύγκλισης γίνεται \( |ρ| < \frac{1}{|α|} \). Έχουμε:
	
	
	\begin{minipage}{.7\textwidth}
	\begin{align*}
		x(n) &= \frac{1}{2πj} \ointclockwise_{C\in\text{ROC}} \frac{ρ^{-n}}{(ρ^{-1}-a)^k}\frac{1}{ρ^2}\dif\rho
		\\
		&= - \frac{1}{2πj}\ointctrclockwise_C \frac{ρ^{-n}ρ^{k-2}}{(1-aρ)^k}\dif\rho
		= - \frac{1}{2πj}\ointctrclockwise_C \frac{ρ^{-n+k-2}}{\left(-a\middle)^k\middle(ρ-\frac{1}{a}\right)^k}\dif\rho
		\intertext{Αφού \( n-k+2 < 0 \), ο πόλος βρίσκεται εκτός της καμπύλης \( C \), επομένως το παραπάνω ολοκλήρωμα γίνεται:}
		x(n) &= 0
	\end{align*}
    \end{minipage}
    \begin{minipage}{.3\textwidth}
    	\centering
    	\begin{tikzpicture}[scale=.45]
    	\draw[fill=green!50] (0,0) circle (3);
    	\draw (90+45:2.8) node[scale=1.2,above left] {$\frac{1}{|a|}$};
    	
    	\draw (2.5,2) node[right] {$p$-plane};
    	
    	\draw[ultra thick,blue] plot [smooth cycle,tension=0.9] coordinates {(0:1.6) (90:1.6) (180:1.6) (270:1.6)} node[below right] {$C$};
    	
    	\draw[->] (0,-4) -- (0,4);
    	\draw[->] (-4,0) -- (4,0) ;
    	\end{tikzpicture}
    \end{minipage}
\end{itemize}

\begin{theorem}{Γενικός τύπος κλάσματος σε Μ/Σ \( \mathcal{Z} \)}{}
	Τα παραπάνω συνοψίζονται ως εξής:
	\begin{itemize}
		\item Για \( |z| > |a| \):
		\begin{align*}
		X(z) &= \frac{z}{(z-a)^k},\qquad |z|>|a| \qquad k \in \mathbb{N} - \left\lbrace 0,1 \right\rbrace
		\\
		x(n) &= -(-1)^k a^{-k+n+1}
		\frac{(k-n-2)(k-n-3)\cdots(-n)}{(k-1)!}\mathrm{u}(n)
		\end{align*}
		\item Για \( |z| < |a| \):
		\begin{align*}
		X(z) &= \frac{z}{(z-a)^k},\qquad |z|<|a| \qquad k \in \mathbb{N} - \left\lbrace 0,1 \right\rbrace
		\\
		x(n) &= (-1)^k a^{-k+n+1}
		\frac{(k-n-2)(k-n-3)\cdots(-n)}{(k-1)!}\mathrm{u}(-n-1)
		\end{align*}
	\end{itemize}
	
\end{theorem}

\begin{exercise}
	Να βρεθεί ο αντίστροφος μετασχηματισμός \( \mathcal{Z} \) της ακολουθίας:
	\[
	X(z) = \frac{z^2+z}{\left(z-\frac{1}{2}\right)^3\left(z-\frac{1}{4}\right)}
	\]
	για όλες τις πιθανές περιοχές σύγκλισης.
	\tcblower
	Η κάθε πιθανή περιοχή σύγκλισης δεν πρέπει να περιέχει άλλο πόλο, άρα οι πιθανές περιοχές σύγκλισης είναι
	\( |z|>\frac{1}{2} \), \( \frac{1}{4} < |z| < \frac{1}{2}  \), \( |z| < \frac{1}{4} \).
	
	\begin{itemize}
		\item \textbf{Για \( \displaystyle |z|>\frac{1}{2} \)}, μετατρέπουμε σε μερικά κλάσματα:
		\begin{align*}
			\frac{X(z)}{z} = \frac{z+1}{\left(z-\frac{1}{2}\right)^3\left(z-\frac{1}{4}\right)}
			&= \frac{A}{z-\frac{1}{2}}+\frac{B}{\left(z-\frac{1}{2}\right)^2} + \frac{Γ}{\left(z-\frac{1}{2}\right)^3} + \frac{Δ}{z-\frac{1}{4}}
			\intertext{Υπολογίζουμε τις σταθερές:}
			X(z) &= \frac{80z}{z-\frac{1}{2}}+\frac{-20z}{\left(z-\frac{1}{2}\right)^2} + \frac{6z}{\left(z-\frac{1}{2}\right)^3} + \frac{-80z}{z-\frac{1}{4}}
		\end{align*}
		
		Τώρα, αρκεί να υπολογίσουμε ξεχωριστά τον κάθε όρο, με βάση τα παραπάνω:
		\begin{itemize}
			\item \( 
			\displaystyle \frac{80z}{z-\frac{1}{2}}\
			\xrightarrow{\mathcal{Z}}T \
			80\left(\frac{1}{2}\right)^n \mathrm{u}(n)
			 \)
			\item \( 
			\displaystyle \frac{-80z}{z-\frac{1}{4}}\
			\xrightarrow{\mathcal{Z}}T \
			-80\left(\frac{1}{4}\right)^n \mathrm{u}(n)
			\)
			\item \( 
			\displaystyle
			\frac{-20z}{\left(z-\frac{1}{2}\right)^2} + \frac{6z}{\left(z-\frac{1}{2}\right)^3}
			\ \xrightarrow{\mathcal{Z}}T \ 
			-20n\left(\frac{1}{2}\right)^{n-1}\mathrm{u}(n) +
			6\frac{n(n-1)}{2}\left(\frac{1}{2}\right)^{n-2}\mathrm{u}(n)
			 \)
		\end{itemize}
	
	    Άρα τελικά:
	    \[
	    x(n) = \left[
	    80\left(\frac{1}{2}\right)^n - 20n\left(\frac{1}{2}\right)^{n-1} + 3 n (n-1)\left(\frac{1}{2}\right)^{n-2} - 80\left(\frac{1}{4}\right)^n
	    \right]\mathrm{u}(n)
	    \]
	\end{itemize}

    \begin{questionbox}{Άσκηση για το σπίτι}
    	Να υπολογιστεί η \( x(n) \) και για τις άλλες δύο πιθανές περιοχές σύγκλισης.
    	
    	Προσοχή στο ότι δεν είναι απαραίτητο να υπολογιστούν ξανά οι σταθερές και όλα τα κλάσματα, παρά μόνον αυτά που αλλάζουν λόγω της διαφορετικής περιοχής σύγκλισης.
    \end{questionbox}
\end{exercise}

\begin{exercise}[Θέμα 4 Σεπτεμβρίου 2018]
	Δίνεται η κρουστική απόκριση ενός συστήματος:
	\[
	h(n) = \left(\frac{1}{2}\right)^n \mathrm{u}(n) + \left(-\frac{1}{3}\right)^n \mathrm{u}(n)
	\]
	
	Εξετάστε αν το σύστημα είναι:
	\begin{itemize}
		\item Αιτιατό;
		\item Ευσταθές;
		\item Πεπερασμένης κρουστικής απόκρισης;
	\end{itemize}

   Επιπλέον, να βρεθεί ο μετασχηματισμός Fourier και ο μετασχηματισμός Z της \( h(n) \). Να βρεθεί μια εξίσωση διαφορών που να συνδέει τα \( y(n) \) με τις τιμές των \( x(n) \). Να βρεθεί η ενέργεια
   του \( h(n) \).

    \tcblower
    \begin{enumerate}
    	\item Το σύστημα είναι \textbf{αιτιατό}, γιατί \( h(n) = 0 \) για \( n<0 \).
    	\item Για να είναι το σύστημα ευσταθές κατά ΦΕΦΕ, η κρουστική απόκριση πρέπει να είναι απολύτως αθροίσιμη, δηλαδή να ελέγξουμε αν συγκλίνει το \( \sum_{n=-\infty}^{\infty} \left|h(n)\right| \).
    	\todo{Add ref to this theorem}
    	
    	Έχουμε:
    	\begin{align*}
    		\sum_{n=-\infty}^{\infty} \left|h(n)\right|
    		&= \sum_{n=-\infty}^{\infty}\left| \left(\frac{1}{2}\right)^n + \left(-\frac{1}{30}\right)^{n}
    		\right|
    		\\ &\leq \sum_{n=0}^{\infty} \left|\left(\frac{1}{2}\right)^n\right|
    		+ \sum_{n=0}^{\infty} \left|
    		\left(-\frac{1}{3}\right)^n
    		\right|
    		\\ &= \sum_{n=0}^{\infty} \left(\frac{1}{2}\right)^n
    		+ \sum_{n=0}^{\infty} \left(\frac{1}{3}\right)^n
    		= \frac{1}{1-\frac{1}{2}}+\frac{1}{1-\frac{1}{3}}
    		\\ &= 2+\frac{3}{2} < \infty \implies \sum_{n=-\infty}^{\infty} \left|h(n)\right|<\infty
    	\end{align*}
    	
    	Άρα το σύστημα είναι \textbf{ευσταθές} κατά ΦΕΦΕ.
    	\item
    	Η κρουστική απόκριση δεν είναι πεπερασμένη στο χρόνο, αφού δεν υπάρχει κάποια στιγμή μετά από
    	την οποία να μηδενίζονται οι όροι της.
    	
    	Μαθηματικά, το σύστημα \textbf{δεν είναι πεπερασμένης} διάρκειας, γιατί \( \notin k \in \mathbb N \ : \ h(n) = 0 \ \forall n >k \).
    	
    	\item Για το \textbf{μετασχηματισμό Z}, έχουμε:
    	\begin{align*}
    	H(z) &\overset{\triangle}{=}
    	\sum_{n=-\infty}^{\infty} h(n)z^{-n}
    	=\sum_{n=0}^{\infty} \left(\frac{1}{2}\right)^n z^{-n} + \sum_{n=0}^{\infty}
    	\left(-\frac{1}{3}\right)^n z^{-n}
    	\\ &= \sum_{n=0}^{\infty} \left(\frac{1}{2z}\right)^n + \sum_{n=0}^{\infty}
    	\left(-\frac{1}{3z}\right)^n
    	\\ &= \underbrace{\frac{1}{1-\frac{1}{2z}}}_{\mathclap{\text{αν $\left|\frac{1}{2z}\right|<1$}}}
    	+ \underbrace{\frac{1}{1+\frac{1}{3z}}}_{\mathclap{\text{αν $\left|\frac{-1}{3z}\right|<1$}}}
    	\\ &= \frac{z}{z-\sfrac{1}{2} } + \frac{z}{z+\sfrac{1}{3} }\qquad |z|>\frac{1}{2}
    	\intertext{Άρα τελικά:}
    	H(n) &= \frac{z}{z-\sfrac{1}{2} } + \frac{z}{z+\sfrac{1}{3} }\qquad \text{ROC:}\ |z|>\frac{1}{2}
    	\end{align*}
    	
    	\item Για τον υπολογισμό του \textbf{μετασχηματισμού Fourier}, έχουμε τον ορισμό:
    	\[
    	H\left(e^{j\omega }\right) = \sum_{n=-\infty}^{\infty}
    	h(n) e^{-j\omega n}
    	\]
    	Θέτοντας \( z=e^{j\omega } \), μπορούμε να χρησιμοποιήσουμε την πληροφορία από το μετασχηματισμό
    	Z, καθώς \( \left|e^{j\omega }\right| = 1 >\frac{1}{2} \), δηλαδή ανήκουμε στην περιοχή
    	σύγκλισής του.
    	
    	Άρα τελικά:
    	\begin{align*}
    		H\left(e^{j\omega }\right) &= \left. H(z) \right|_{z=e^{j\omega }}
    		\\
    		&= \frac{e^{j\omega }}{e^{j\omega }-\sfrac{1}{2} } + \frac{e^{j\omega }}{e^{j\omega }+\sfrac{1}{3} }
    	\end{align*}
    	
    	\item Το παραπάνω σύστημα εκφράζεται από τη σχέση:
    	
    \vspace{-1ex}
     \begin{minipage}{.5\textwidth}
    			\[
    		y(n) = x(n) * h(n)
    		\]
    		ή, στο πεδίο της συχνότητας:
    		\[
    		X(z)H(z) = Y(z)
    		\]
    	\end{minipage}
    	\begin{minipage}{.5\textwidth}
    		\centering
    		\begin{tikzpicture}[scale=.85]
    		\draw (0,0) node[minimum width=1.7cm,minimum height=0.8cm,rectangle,draw] (h) {};
    		\draw (h.north) node[above] {$h(n)$};
    		\draw[<-] (h) -- ++(-2,0) node[above,midway] {$x(n)$};
    		\draw[->] (h) -- ++(2,0) node[above,midway] {$y(n)$};
    		\end{tikzpicture}
    	\end{minipage}
    	
    	Θα προσπαθήσουμε, επεκτείνοντας την παραπάνω σχέση, να βρούμε μια σχέση μεταξύ \( x(n) \) και
    	\( y(n) \). Έχουμε:
    	\begin{align*}
    	X(z)\left[
    	\frac{z}{z-\sfrac{1}{2} } + \frac{z}{z+\sfrac{1}{3} }
    	\right] &= Y(z)\\
    	X(z)\left[
    	\frac{z^2+\frac{1}{3}z + z^2 -\frac{1}{2}z}{z^2 - \frac{1}{6}z - \frac{1}{6}}\right] &= Y(z)
    	\\
    	X(z)\left[
    	\frac{2z^2-\frac{1}{6}z}{z^2 - \frac{1}{6}z-\frac{1}{6}}
    	\right] &= Y(z)
    	\\
    	X(z)\left[
    	\frac{2-\frac{1}{6}z^{-1}}{1-\frac{1}{6}z^{-1}-\frac{1}{6}z^{-2}}
    	\right] &= Y(z)\\
    	X(z)\left(
    	2-\frac{1}{6}z^{-1}
    	\right) &= Y(z)\left(1-\frac{1}{6}z^{-1}-\frac{1}{6}z^{-2}\right)
    	\intertext{Εφαρμόζουμε inverse $\mathcal{Z}$ transform:}
    	2x(n) - \frac{1}{6}x(n-1) &= y(n) - \frac{1}{2}y(n-1) - \frac{1}{6}y(n-2)\\
    	\Aboxed{
    	y(n) &= \frac{1}{2}y(n-1)+\frac{1}{6}y(n-2) + 2x(n) -\frac{1}{6}x(n-1)
        } \qquad n\geq 0
    	\end{align*}
    	
    	Λάβαμε μία σχέση η οποία συνδέει το \textbf{τρέχον \( y \)} μόνο με τα \textbf{προηγούμενα \( y,x \)} και το \textbf{τρέχον \( x \)}. Αυτό επιβεβαιώνει πως το σύστημά μας είναι αιτιατό.
    	Η σχέση αυτή είναι μια \textbf{εξίσωση διαφορών}.
    	
    	\subparagraph{}
    	Εναλλακτικά, θα μπορούσαμε να μην είχαμε διαιρέσει τους όρους του κλάσματος με \( z^2 \), και θα
    	προέκυπτε μία σχέση όπου θα μπορούσαμε να κάνουμε αντικατάσταση της μεταβλητής \( n \) ώστε να λάβουμε το ίδιο αποτέλεσμα, που να μην εξαρτά τρέχουσες από μελλοντικές στιγμές.
    	
    	\item Η \textbf{ενέργεια} του σήματος είναι:
    	\begin{align*}
    		E &= \sum_{n=-\infty}^{\infty} \left|h(n)\right|^2
    		= \sum_{n=0}^\infty \left|
    		\left(\frac{1}{2}\right)^n + \left(-\frac{1}{3}\right)^n
    		\right|^2
    		\\ &= \sum_{n=0}^{\infty} \left(\frac{1}{2}\right)^{2n}
    		+ \sum_{n=0}^{\infty} \left(-\frac{1}{3}\right)^{2n}
    		+2\left(\frac{1}{2} \left(-\frac{1}{3}\right) \right)^n
    		\\ &= \sum \left(\frac{1}{4}\right)^n + \sum \left( \frac{1}{9} \right)^n
    		+ \sum 2\left(-\frac{1}{6}\right)^n
    		\\ &= \frac{1}{1-\frac{1}{4}} + \frac{1}{1-\frac{1}{9}} + 2\frac{1}{1+\frac{1}{6}}
    		\\ &= \frac{4}{3} + \frac{9}{8} + \frac{12}{7} = \frac{701}{168}
    	\end{align*}
    \end{enumerate}
\end{exercise}

\lecture{8}{29/10/2018}

\begin{exercise}
	Δίνεται η συνάρτηση:
	\[
	X(z) = \frac{z}{z-a}
	\]
	
	Να βρεθούν οι πιθανές περιοχές σύγκλισης του μετασχηματισμού \( Z \) που εκφράζει η \( X(z) \).
	\todo{Graph 24}
	\tcblower
	Ο μετασχηματισμός μπορεί να συγκλίνει είτε για \( |z|>|a| \) ή \( |z|<|a| \). Αν θέσω
	\( z=a \), τότε ο μετασχηματισμός δεν θα ορίζεται λόγω του παρονομαστή, δηλαδή δεν θα συγκλίνει.
	Όμως αν θέσω διαφορετικές τιμές \( z=a+0.1 \) ή \( z=a-0.1 \), τότε η \( X(z) \) θα δίνει ένα
	φυσιολογικό νούμερο. Από αυτό, προκύπτει το ερώτημα γιατί πρέπει να κρατάμε μόνο μία περιοχή
	\( |z|>|a| \) ή \( |z|<|a| \) και όχι ολόκληρη τη \( |z|\neq|a| \).
	
	Αυτό απαντάται λόγω του ότι η \( X(z) \) πρέπει να είναι \textbf{συνεχής}, γιατί μόνο τότε
	μπορεί να εκφραστεί σαν το άπειρο άθροισμα των όρων που προκύπτει από τον ορισμό του
	μετασχηματισμού \( Z \):\[
	X(z) = \sum_{n=-\infty}{\infty} x(n)z^{-n}
	\]
	
	Το παραπάνω αποτέλεσμα μοιάζει με τη σειρά \( \frac{1}{1+x} \), που έχει διαφορετικά αναπτύγματα για
	\( |x|<1 \) και \( |x|>1 \).
\end{exercise}

\subsection{Εξίσωση διαφορών για γραμμικό \& ΑΚΜ σύστημα}
Το αντίστοιχο των διαφορικών εξισώσεων στο αναλογικό σήμα είναι οι \textbf{εξισώσεις διαφορών} στα
ψηφιακά συστήματα, οι οποίες σχετίζουν τιμές των συναρτήσεών μας με τιμές άλλων συναρτήσεων άλλες στιγμές.

\begin{defn}{Εξίσωση διαφορών}{}
	Ως \textbf{γραμμική εξίσωση διαφορών} ορίζεται η:
	\[
	\sum_{k=0}^{N} a_k y(n-k) = \sum_{r=0}^{M} b_r x(n-r)\quad a_0 \neq 0
	\]
	ή, ισοδύναμα:
	\[
	y(n) = -\sum_{k=1}^{N} \frac{a_k}{a_0} y(n-k) + \sum_{r=0}^{M} \frac{b_r}{a_0} x(n-r)
	\]
\end{defn}

Η \textbf{γραμμικότητα} στις παραπάνω σχέσεις εκφράζεται από την έλλειψη γινομένων \( y \) και \( x \),
και την έλλειψη άλλων \emph{περίεργων} όρων.

\paragraph{Παράδειγμα}
\[
y(n) - ay(n-1) = x(n)
\]

Για να έχει νόημα η εξίσωση διαφορών, πρέπει να ορίσουμε και την \textbf{περιοχή} στην οποία
ορίζεται. Σε αυτό το παράδειγμα, θα μπορούσε να μας δοθεί:
\[
n \geq 0 \qquad y(n) = 0 \ \forall n < 0
\]

\subparagraph{}
Έστω ότι η είσοδος είναι κρουστική: \[
x(n) = \delta(n)
\]
άρα η έξοδος θα είναι η κρουστική απόκριση του συστήματος:
\[
h(n) = ah(n-1) + \delta(n)
\]

Τώρα, μπορούμε να κάνουμε μια \emph{αφελή} λύση της εξίσωσης, υπολογίζοντας \( n \) after \( n \):
\[
\begin{array}{rl}
n=0 & h(0) = \cancelto{0}{ah(-1)}+1 = 1\\
n=1 & h(1) = ah(0) + \delta(1) = a\\
n=2 & h(2) = ah(1) + \delta(2) = a^2\\
\vdots & \vdots 
\end{array}
\]

Με επαγωγή μπορούμε να αποδείξουμε ότι:
\[
h(n) = a^n \mathrm{u}(n)
\]
οπότε βρήκαμε τη λύση της εξίσωσης.

\subparagraph{}
Από τη μια μεριά, αν μας δινόταν ότι \( y(n) = 0\ \forall n \geq 0 \), τότε θα βρίσκαμε ότι
\begin{gather}
	h(0) = 0\\h(1) = 0 \\ \vdots
\end{gather}
αλλά θα μπορούσαμε, υπολογίζοντας μελλοντικούς χρόνους, να βρούμε τι γίνεται για αρνητικά \( n \):
\begin{align*}
	y(n-1) &= \frac{1}{a}y(n) - \frac{x(n)}{a}\\
	y(-1) &= \frac{1}{a}\cancelto{0}{y(0)} - \cancelto{1}{\frac{x(0)}{a}} = -\frac{1}{a}\\
	y(-2) &= \frac{1}{a}y(-1) - \cancelto{0}{\frac{x(-1)}{a}} = \frac{1}{a}\left(-\frac{1}{a}\right)=-\frac{1}{a^2} \\
	\vdots & \qquad \vdots \\
	y(n) &= -a^n\mathrm u(-n-1)
\end{align*}

Το παραπάνω συμπέρασμα θυμίζει και τα διαφορετικά αποτελέσματα που προκύπτουν όταν έχουμε διαφορετικές περιοχές
σύγκλισης στο μετασχηματισμό \( \mathcal{Z} \).

\subsubsection{Εξαγωγή συνάρτησης μεταφοράς}
Έστω ότι γνωρίζουμε για μια συνάρτηση \( H(z) \) τις \textbf{θέσεις των πόλων } \( q \), τις θέσεις των
μηδενικών \( p \), και τις πολλαπλότητές τους. Δηλαδή ξέρουμε ότι η συνάρτηση είναι της μορφής:
\[
H(z) = A
\frac{(z-q_1)^{s_1^q}(z-q_2)^{s_2^q} \cdots (z-q_n)^{s_n^q} }{(z-p_1)^{s_1^p}(z-p_2)^{s_2^p} \cdots (z-p_m)^{s_m^p}}
\]

Τότε, πραγματοποιώντας τις πράξεις στον παρονομαστή και τον αριθμητή, θα λάβουμε πολυώνυμα μέσα από
τα οποία θα προκύπτει ουσιαστικά η εξίσωση διαφορών που παράγει την \( h(n) \).

\paragraph{Παράδειγμα}
\begin{align*}
	\Aboxed{H(z) &= \frac{z-3}{z-\frac{1}{3}}} = \frac{Y(z)}{X(z)} \implies \qquad |z|>\frac{1}{3}
	\\ (1-3z^{-1})X(z) &= \left(1-\frac{1}{3}z^{-1}\right)Y(z)\\
	X(z) - 3z^{-1}X(z) &= Y(z)-\frac{1}{3}z^{-1} Y(z) \xRightarrow{\text{I}\mathcal{Z}\text{T}} \\
	x(n) - 3x(n-1) &= y(n) - \frac{1}{3}y(n-1) \\
	y(n) &= \frac{1}{3}y(n-1) + x(n) -3x(n-1) \qquad n\geq 0
\end{align*}

\begin{exercise}
	Δίνεται μία \( H(z) \) με πόλο \( z=a \) και μηδενικό \( z=\frac{1}{a^*} \). Ισχύει
	\( |a|<1 \), και το σύστημα είναι αιτιατό.
	
	Να βρεθεί η απόκριση συχνότητας του συστήματος.
	
	\tcblower
	\underline{Θεωρούμε ότι \( a\in\mathbb R \)}. Για να έχουμε το δικαίωμα να βρούμε απόκριση συχνότητας (δηλαδή
	να βάλουμε το \( z=e^{j\omega } \)), πρέπει να επιβεβαιώσουμε ότι ο μοναδιαίος κύκλος ανήκει στην περιοχή σύγκλισης.
	\todo{find roc}
	
	Το σύστημα έχει τη μορφή:
	\[
	H(z) = \frac{z-\frac{1}{a}}{z-a}
	\]
	(χωρίς να μας ενδιαφέρει η σταθερά \( Α \) που μπαίνει από μπροστά).
	
	Για να βρούμε την απόκριση συχνότητας, θεωρούμε \( z = e^{j\omega } \):
	\begin{align*}
		H(\omega ) &= \frac{e^{j\omega } - \frac{1}{a}}{e^{j\omega } - a}
		\\
		\left| H(\omega ) \right|^2
		&= \frac{\left(e^{j\omega }-\frac{1}{a}\right)\left(e^{-j\omega }-\frac{1}{a}\right)}{
	\left( e^{j\omega } - a \right)	\left( e^{-j\omega } -a \right)
	} = \frac{1+\frac{1}{a^2}-\frac{1}{a}\left( e^{j\omega }+e^{-j\omega } \right)}{1+a^2-a\left(
	e^{j\omega }+e^{-j\omega }\right)}
        \\ &= \frac{1+\frac{1}{a^2}-\frac{1}{a}2\cos \omega }{1+a^2-a^2\cos\omega} = \frac{1}{a^2}.
	\end{align*}
	
	\todo{Graph 25: A straight line of |H(omega)|2 from 0 to 2pi}
	
	Όλες οι συχνότητες έχουν σταθερό κέρδος, άρα το σύστημα είναι \textbf{all-pass}.
	
	\paragraph{}
	Εναλλακτικά, μπορούσαμε να έχουμε:
	\begin{align*}
	H(z) &= \frac{z-\frac{1}{a}}{z-a}\\
		\left|H(\omega )\right| &= \left|H(z)\right|_{z=e^{j\omega }}\\
		&= \frac{\left| \left(z-\sfrac{1}{a} \right) \right|_{z=e^{j\omega }}}{
	    \left| (z-a) \right|_{z=e^{j\omega }}
	} = \frac{B}{A}
	\end{align*}
	
	Το παραπάνω αποτέλεσμα εκφράζει ότι ο \emph{λόγος των αποστάσεων ενός σημείου του μοναδιαίου
	κύκλου από τους δύο πόλους/μηδενικά είναι σταθερός}.
	
	\begin{tikzpicture}
	\draw[blue] (0.765,0.644) -- (0.7,0) node[midway,sloped,above,scale=.6] {$A$};
	\draw[blue] (0.765,0.644) -- (1.4,0) node[midway,sloped,above,scale=.6] {$B$};
	
	\draw (-2,0) -- (2,0);\draw (0,-1.4) -- (0,1.4);
	\fill (0.7,0) circle (2pt) node[below] {$a$};
	\fill (1.4,0) circle(2pt) node[below] {$\frac{1}{a}$};
	\draw[very thick,magenta!50!black] (0,0) circle(1cm);
	
	\filldraw[opacity=.5,blue] (0.765,0.644) circle (1pt);
	\end{tikzpicture}
	
	Για το παραπάνω υπάρχει και γεωμετρική απόδειξη που βασίζεται στο γενικευμένο πυθαγόρειο θεώρημα.
	
	\paragraph{}
	Αν είχαμε θεωρήσει ότι \( a\in\mathbb C \), το μιγαδικό επίπεδο του \( z \) θα έμοιαζε ως εξής:

	\begin{tikzpicture}
	\draw (-2,0) -- (2,0);\draw (0,-1.4) -- (0,1.4);
	\draw[dashed] (0,0) -- ++(45:0.6);
	\draw[dashed] (0,0) -- ++(-45:{1/0.6});
	\fill (45:0.6) circle (2pt) node[below] {$a$};
	\draw (-45:{1/0.6}) circle(2pt) node[below] {$\frac{1}{a}$};
	\draw (45:{1/0.6}) circle(2pt) node[above] {$\displaystyle \frac{1}{a^*}$};
	\draw[very thick,magenta!50!black] (0,0) circle(1cm);
	
	\filldraw[opacity=.5,blue] (0.765,0.644) circle (1pt);
	\end{tikzpicture}
	
	Δεδομένου ότι η εκφώνηση μας δίνει τα σημεία \( a \) και \( \frac{1}{a^*} \), το αποτέλεσμα θα είναι
	το ίδιο με πριν, αφού μπορούμε απλώς να περιστρέψουμε το επίπεδο και να φτάσουμε τις ίδιες συνθήκες
	με πριν.
	
	Αντίστοιχα, προσθέτοντας περισσότερα τέτοια ζευγάρια πόλων-μηδενικών μπορούμε να έχουμε πάλι
	all-pass συστήματα:
	
	\begin{tikzpicture}
	\draw[thick,blue!50!green!50!black,fill=blue!50!green!50!black,fill opacity=.3]
	plot [smooth cycle] coordinates {(45:-0.4) (70:1) (45:2.2) (20:1)} (45:2.1) node[opacity=1,above right] {all-pass};
	\draw[thick,blue!50!green!50!black,fill=blue!50!green!50!black,fill opacity=.3]
	plot [smooth cycle] coordinates {(45:-0.4) (-70:1) (-45:2.2) (-20:1)} (-45:2.1) node[opacity=1,below right] {all-pass};
	
	\draw (-2,0) -- (2,0);\draw (0,-1.4) -- (0,1.4);
	\draw[dashed] (0,0) -- ++(45:0.6);
	\draw[dashed] (0,0) -- ++(-45:{1/0.6});
	\fill (45:0.6) circle (2pt) node[below,scale=.7] {$a$};
	\fill (-45:0.6) circle (2pt) node[below,scale=.7] {$a$};
	\draw (-45:{1/0.6}) circle(2pt) node[below,scale=.7] {$\frac{1}{a}$};
	\draw (45:{1/0.6}) circle(2pt) node[above,scale=.7] {$\displaystyle \frac{1}{a^*}$};
	\draw[very thick,magenta!50!black] (0,0) circle(1cm);
	\end{tikzpicture}
\end{exercise}

\begin{exercise}
	Να χαρακτηριστούν τα δύο συστήματα:
	\begin{align*}
		S_1: \qquad & y_1(n) = \frac{x(n) + x(n-1)}{2}\\
		S_2: \qquad & y_2(n) = \frac{x(n) - x(n-1)}{2}
	\end{align*}
	
	\tcblower
	Το σύστημα είναι \textbf{ευσταθές} όταν ο μοναδιαίος κύκλος ανήκει στην \textbf{περιοχή σύγκλισης}. Η κρουστική απόκριση
	του συστήματος είναι \( h(n) = \frac{1}{2}δ(n) + \frac{1}{2}δ(n-1) \) (αφού \( y=x*h \)). Έχει δύο
	όρους, πολύ λιγότερους από \( \infty \), άρα η ακολουθία είναι απολύτως αθροίσιμη. Επομένως το σύστημα είναι ευσταθές.
	
	Εναλλακτικά, το σύστημα είναι ευσταθές αφού η έξοδος προκύπτει από άθροιση πεπερασμένου πλήθους δειγμάτων της εισόδου χωρίς ανάδραση (προηγούμενες τιμές \( y \)).
	
	Αφού και τα δύο συστήματος είναι ευσταθή, ο μοναδιαίος κύκλος ανήκει στην περιοχή σύγκλισης, και
	μπορούμε άφοβα να θέσουμε \( z=e^{j\omega } \).
	
	Το παραπάνω συμπέρασμα μοιάζει με αυτό που είχαμε εξάγει στο αναλογικό σήμα. Ότι δηλαδή το σύστημα
	είναι ευσταθές όταν \emph{όλοι οι πόλοι βρίσκονται στο αριστερό ημιεπίπεδο}, ή αντίστοιχα όταν ο
	φανταστικός άξονας ανήκει στην περιοχή σύγκλισης.
	
	\paragraph{}
	
	Έχουμε:
	
	\begin{minipage}{.6\textwidth}
	\begin{align*}
		S_1: \qquad Y_1(z) &= \frac{1}{2} \left( X(z) +z^{-1}X(z) \right)\\
		H_1(z) &= \frac{Y_1(z)}{X(z)} = \frac{1}{2}\left( 1+z^{-1} \right)\\
		H_1(\omega ) &= \left. H_1(z) \right|_{z=e^{j\omega }} = \frac{1}{2}\left( 1+e^{-j\omega } \right)
		\\
		\left|H_1(\omega )\right|&= \left|e^{-j\frac{\omega }{2}}\frac{1}{2}\left(
		e^{j\frac{\omega }{2}} + e^{-j\frac{\omega }{2}}
		\right)\right|
		\\ &= 1 \cdot \frac{1}{2} \left|
		2\cos\frac{\omega }{2}
		\right| = \left| \cos\frac{\omega }{2} \right|
	\end{align*}
	\end{minipage}\begin{minipage}{.4\textwidth}
	\centering
	\begin{tikzpicture}[scale=1.4]
	\draw[brown,dashed] (2,0) -- ++(0,2);
	\draw[brown,densely dashed] (1,0) -- ++(0,2);
	
	\draw[->] (0,0) -- (3,0);
	\draw[->] (0,0) -- (0,2) node[right] {$\left|H_1(\omega)\right|$};
	
	\draw[ultra thick,red!50!orange!90!brown] (1,0) sin (0,1.2) (1,0) sin (2,1.2);
	
	\fill (0,0) circle (2pt) node[below] {$0$};
	\fill (1,0) circle (2pt) node[below] {$\vphantom{2}\pi$};
	\fill (2,0) circle (2pt) node[below] {$2\pi$};
	\end{tikzpicture}
\end{minipage}
	
	\textbf{Για να εξάγουμε συμπέρασμα για το χαρακτήρα του συστήματος, κοιτάμε μόνο το κομμάτι
	από \( 0 \) ως \( π \).} Επομένως το παραπάνω σύστημα είναι \textbf{low-pass}. Το δεξί κομμάτι
    είναι το αντίστοιχο \emph{αρνητικό κομμάτι} του αναλογικού μετασχηματισμού Fourier.
    
    \paragraph{}
    Για το δεύτερο σύστημα:
   
    \begin{minipage}{.6\textwidth}
        \begin{align*}
    S_2 \qquad Y_2(z) &= \frac{X(z) - z^{-1}(z)}{2} \\
    H_2(z) &= \frac{Y_2(z)}{X(z)} = \frac{1}{2}(1-z^{-1})\\
    H_2(\omega ) &= \frac{1}{2} \left(1-e^{-j\omega }\right) = e^{-j\frac{\omega }{2}}
    \frac{1}{2} \left( e^{\frac{j\omega }{2}} - e^{-\frac{j\omega }{2}} \right)\\
    \left|H_2(\omega)\right| &= \left|\sin\left(\frac{\omega }{2}\right)\right|
    \end{align*}
    \end{minipage}
    \begin{minipage}{.4\textwidth}
    	\centering
    	\begin{tikzpicture}[scale=1]
    	\draw[brown,dashed] (2,0) -- ++(0,2);
    	\draw[brown,densely dashed] (1,0) -- ++(0,2);
    	
    	\draw[->] (0,0) -- (3,0);
    	\draw[->] (0,0) -- (0,2) node[right] {$\left|H_2(\omega)\right|$};
    	
    	\draw[ultra thick,red!50!orange!90!brown] (1,1.2) cos (0,0) (1,1.2) cos (2,0);
    	
    	\fill (0,0) circle (2pt) node[below] {$0$};
    	\fill (1,0) circle (2pt) node[below] {$\vphantom{2}\pi$};
    	\fill (2,0) circle (2pt) node[below] {$2\pi$};
    	\end{tikzpicture}
    \end{minipage}
    
    Εδώ, κοιτώντας από \( 0 \) ως \( π \), διαπιστώνουμε ότι το σύστημα είναι \textbf{high pass}.
    
    \paragraph{}
    Στα παραπάνω συμπεράσματα μπορούσαμε να φτάσουμε και πριν λύσουμε τα μαθηματικά. Πράγματι, τα
    συστήματα μπορούν να γραφτούν και ως εξής:
    \begin{align*}
    	y_1(n) &= \frac{1}{2}\left( x(n) + x(n-1) \right)\\
    	y_2(n) &= \frac{1}{2}\left( x(n) - x(n-1) \right)
    \end{align*}
    
    Το πρώτο σύστημα είναι ουσιαστικά ένα \textbf{τοπικό ολοκλήρωμα}, και το δεύτερο μια \textbf{τοπική παράγωγος} στον ψηφιακό κόσμο. Οπότε, μπορούμε να θυμηθούμε τις αντιστοιχίες από το αναλογικό
    σήμα και να εξάγουμε τα ίδια συμπεράσματα.
\end{exercise}

\begin{exercise}
	Να χαρακτηριστεί \emph{πρόχειρα} το σύστημα:
	\[
	y(n) = \frac{x(n) -2x(n-1) + x(n-2) }{6}
	\]
	\tcblower
	Ισχύει:
	\[
	y(n) = \frac{x(n) - x(n-1)}{6}
	- \frac{x(n-1) - x(n-2)}{6}
	\]
	
	Εδώ έχουμε ουσιαστικά \textbf{διαφορά πρώτης παραγώγου μείον δεύτερης παραγώγου}. Αφού η κάθε
	παράγωγος είναι high pass, και το ίδιο το σύστημα είναι high pass.
	\todo{Really? Do maths.}
\end{exercise}

\lecture{9}{2/11/2018}

\subsubsection{Σύνδεση συστημάτων}
Είναι απλό να δούμε τι συμβαίνει με συστήματα που συνδέονται σε συγκεκριμένες συνδεσμολογίες, τις
οποίες θέλουμε να μετατρέψουμε σε ένα σύστημα \( h(n) \).

\paragraph{Εν σειρά (καταρράκτης)}
\hspace{0pt}

\begin{tikzpicture}
	\draw (0,0) node[draw] (h1){$h_1(n)$};
	\draw (2,0) node[draw] (h2){$h_2(n)$};
	
	\draw[->] (h1) -- (h2) node[midway] (m) {};
	
	\filldraw (m.center) circle (2pt) -- ++(0,0.5) node[above,opacity=.8] {$w(h)$};
	
	\draw[<-] (h1) -- ++(-1.5,0) node[above,midway] {$x(n)$};
	\draw[->] (h2) -- ++(1.5,0) node[above,midway] {$y(n)$};
\end{tikzpicture}

Έχουμε:
\begin{align*}
	w(n) &= x(n) * h_1(n)\\
	y(n) &= w(n) * h_2(n) = \left( x(n)*h_1(n) \right)*h_2(n)
	\\ &= x(n) * \left( h_1(n) * h_2(n \right)\\
	Y(z) &= X(z) \cdot H(z) 
\end{align*}

\paragraph{Παράλληλη σύνδεση} \hspace{0pt}

        \begin{tikzpicture}[scale=1]
\def\cr{4pt};

\draw[->] (-1,0) -- (0,0) node[above,midway] {$x(n)$} ;
\draw[->] (0,0) -- (0,0.75) -- ++(1,0);
\draw (1,1) rectangle ++(1.3,-0.5) node[midway] {$h_1(n)$};
\draw[->] (2.3,0.75) -- ++(1,0) -- (3.3,\cr);
\draw[->] (0,0) -- (0,-0.75) -- ++(1,0);
\draw (1,-1) rectangle ++(1.3,0.5) node[midway] {$h_2(n)$};
\draw[->] (2.3,-0.75) -- ++(1,0) -- (3.3,-\cr);

\draw (3.3,0) node {$+$} circle (\cr);
\draw[->] (3.3cm+\cr,0) -- ++(1,0) node[above,midway] {$y(n)$};

\draw ({(1+2.3)/2},-1.4)
node {$\mathlarger{\mathlarger{\mathlarger{\mathlarger{\Updownarrow}}}}$};

\begin{scope}[yshift=-2.1cm]
\draw[->] (0,0) -- (1,0) node[above,midway] {$x(n)$} ;
\draw (1,0.25) rectangle (2.3,-0.25) node[midway] {$\mathsmaller{h(n)}$};
\draw[->] (2.3,0) -- (3.3,0) node[above,midway] {$y(n)$};
\end{scope}
\end{tikzpicture}

\begin{align*}
	y(n) &= x(n) * h_1(n) \pm x(n) * h_2(n) \\ &= x(n) * \left( h_1(n) \pm h_2(n) \right) \\
	Y(z) &= H(z)X(z) \qquad \text{ όπου } H(z) = H_1(z) \pm H_2(z)
\end{align*}

\begin{exercise}
	Δίνεται το σύστημα:
	
	\begin{tikzpicture}
	\draw (0,0) node[draw] (h1) {$h_1(n)$};
	\draw (2,1) node[draw] (h2) {$h_2(n)$};
	\draw (2,-1) node[draw] (h3) {$h_3(n)$};
	\draw (3.5,-1) node[draw] (h4) {$h_4(n)$};
	
	\draw (5,0) node[draw,circle,scale=1.3] (a) {$+$};
	
	\draw[<-] (h1) -- ++(-2,0) node[left] {$x(n)$};
	\draw[->] (h1.east) to[in=180,out=0] (h2.west);
	\draw[->] (h1.east) to[in=180,out=0] (h3.west);
	\draw[->] (h3) -- (h4);
	\draw[->] (h2) -| (a.north) node[above left] {$+$};
	\draw[->] (h4) -| (a.south) node[below left] {$-$};
	
	\draw[->] (a.east) -- ++(2,0) node[right] {$y(n)$};
	
	\draw[red!80!black] (3.2,0) node [cloud, draw,cloud puffs=10,cloud puff arc=120, aspect=1.2, inner ysep=1.4cm] {} (4,2) node[above right] {\color{red!80!black}\boxed{A}};
	\draw[green!80!black] (2.7,-1) node [cloud, draw,cloud puffs=10,cloud puff arc=120, aspect=1.8, inner ysep=0.6cm] {} (3.8,-0.4) node[above right] {\color{green!80!black}\boxed{B}};
	\end{tikzpicture}
	
	με τις κρουστικές αποκρίσεις του κάθε μπλοκ:
	\begin{align*}
		h_1(n) &= \left\lbrace \frac{1}{2},\frac{1}{4},\frac{1}{2} \right\rbrace\\
		h_2(n) &= h_3(n) = (n+1) \mathrm{u}(n)\\
		h_4(n) &= \delta(n-2)
	\end{align*}
	
	Να βρεθεί η ισοδύναμη \( h(n) \) του συστήματος.
	
	\tcblower
	
	Πρώτα, μετατρέπουμε την \( h_1(n) \) σε μια πιο "μαθηματική" μορφή:
	\[
	h_1(n) = \frac{1}{2}δ(n) + \frac{1}{4}δ(n-1) + \frac{1}{2}δ(n-2)
	\]
	
	Άρα, με βάση τα παραπάνω, η κρουστική απόκριση του συστήματος θα είναι:
	\todo{add ref 'παραπάνω'}
	\begin{align*}
		h(n) &= h_1(n) * {\color{red!80!black}\boxed{A}}
		\\ &= h_1(n) * \left[ h_2(n) - {\color{green!80!black}\boxed{B}} \right]
		\\ &= h_1(n) * \left[ h_2(n) - h_3(n) * h_4(n) \right]
		\\ &= h_1(n) * \left[
		n\mathrm{u}(n)+\mathrm{u}(n) - n\mathrm{u}(n-2) + \mathrm{u}(n-2)
		\right]
		\intertext{Εδώ, επειδή έχουμε διακριτά $n$, μπορούμε να μετατρέψουμε τη διαφορά \( nu(n)-nu(n-2) \) σε συναρτήσεις \( \delta \)}
		&= h_1(n) * \left[
		2\mathrm{u}(n) - \delta(n)
		\right] = \left[\frac{1}{2}δ(n)+\frac{1}{4}δ(n-1)+\frac{1}{2}δ(n-2)\right]*\left[2\mathrm{u}(n)-\delta(n)\right]
		\\
		&= \frac{5}{2}\mathrm{u}(n-3)
		+\frac{1}{2}δ(n) + \frac{5}{4}δ(n-1) + 2δ(n-2)
    \end{align*}
\end{exercise}

\begin{exercise}
	Για το σύστημα:
	
\begin{tikzpicture}
\draw (0,0) node[draw] (u) {$u(n)$};
\draw (0,-1) node[draw] (u2) {$u(n-2)$};
\draw (5,1) node[draw] (h1) {$11\delta(n-1)$};
\draw (5,0) node[draw] (h2) {$\delta(n-1)$};
\draw (5,-1) node[draw] (h3) {$2\delta(n)-3\delta(n-1)$};

\draw (1.5,0) node[draw,circle,scale=1] (a) {$+$};
\draw (3,0) node[draw,circle,scale=1] (b) {$+$};

\draw[<-] (u) -- ++(-2.5,0) node[above,midway] {$x(n)$} node[midway] (m1) {};
\draw[->] (m1.center) |- (u2);
\draw[->] (u) -- (a);
\draw[->] (u2) -| (a.south) node[below left] {$-$};
\draw[->] (a) -- (b) node[midway] (m2) {};
\draw (m2.center) node[circle,inner sep=1pt,fill] {} -- ++(0,1) node[above] {$v(n)$};
\draw[->] (b) -- (h2);
\draw[->] (h2) -- ++(2,0) node (f) {};
\draw[->] (f.center) -- ++(1,0) node[above] {$y(n)$};
\draw[->] (f.center) |- (h1);
\draw[->] (h1) -| (b);
\draw[->] (f.center) |- (h3);
\draw[->] (h3) -| (b);
\draw (current bounding box.south east) node[above right] {ΑΙΤΙΑΤΟ};
\end{tikzpicture}
	
	ζητούνται:
	\begin{enumpar}
		\item Η εξίσωση διαφορών
		\item Η \( H(z) \) του μαζί με τη ROC (περιοχή σύγκλισης)
		\item Να μελετηθεί η ευστάθεια του συστήματος.
	\end{enumpar}

    \tcblower
    \begin{enumpar}
    	\item
    Πρώτα, ασχολούμαστε με τη βοηθητική συνάρτηση \( v(n) \):
    \begin{align*}
    	v(n) &= x(n) * u(n) - x(n) * u(n-2) = x(n) * \left( u(n)-u(n-2) \right)
    	\\ &= x(n) * \left[ δ(n)+δ(n-1) \right]
    	= x(n) + x(n-1)
    \end{align*}
    
    Προχωράμε και στο δεύτερο μέρος:
    \begin{align*}
    	y(n) &= w(n) * δ(n-1) \\
    	&= \left[
    	v(n) + 11δ(n-1) * y(n) + \left(2δ(n)-3δ(n-1)\right)*y(n)
    	\right]*δ(n-1)\\
    	&= x(n-1) + x(n-2) + \left[
    	11y(n-1) + 2y(n) -3y(n-1)
    	\right] * δ(n-1)
    	\\ &= x(n-1)+x(n-2) + 8y(n-2) + 2y(n-1), \qquad \text{για } n \geq 0
    \end{align*}
    
    \item
    
    Με βάση την παραπάνω έκφραση της \( H(z) \), έχουμε:
    \begin{align*}
    	Y(z) &= z^{-1}X(z) + z^{-2}X(z) + 8z^{-2} Y(z) + 2z^{-1}Y(z) \implies \\
    	H(z) &= \frac{Y(z)}{X(z)} = \frac{z^{-1} + z^{-2}}{1-2z^{-1}-8z^{-2}} = \frac{z+1}{z^2-2z-8}
    \end{align*}
    
    Οι πόλοι είναι \( z_1=4 \) και \( z_2=-2 \), με πιθανές περιοχές σύγκλισης:
    \begin{itemize}
    	\item \( |z|<2 \) \item \( 2<|z|<4 \) \item \( 4<|z| \)
    \end{itemize}
    \todo{plot poles with possible ROC on float-right minipage}
    
    Αφού το σύστημα είναι \textbf{αιτιατό}, το ROC τελικά είναι \( |z|>4 \).
    
    \item Αφού \( \left|e^{j\omega }\right| \notin \text{ROC} \), το σύστημα είναι ασταθές.
    
    \end{enumpar}
\end{exercise}

\todo{Better explanation and checks}
\paragraph{Παράδειγμα "μονόπλευρου" μετασχηματισμού \( \mathcal{Z} \)}
\begin{align*}
	y(n) - \frac{1}{2}y(n-1) &= x(n) - \frac{1}{4}x(n-1) \qquad n \geq 0\\
	y(n)z^{-n} - \frac{1}{2}y(n-1) z^{-n} &= x(n)z^{-n} - \frac{1}{4}x(n-1)z^{-n}\\
	\sum_{n=0}^{\infty} y(n) z^{-n} - \frac{1}{2} \sum_{n=0}^{\infty}y(n-1)z^{-n}
	&= \sum_{n=0}^{\infty} x(n)z^{-n} - \frac{1}{4}\sum_{n=0}^{\infty} x(n-1) z^{-n}\\
	Y(z) - \frac{1}{2} \sum_{k=-1}^{\infty} y(k) z^{-k-1} &= X(z) -\frac{1}{4}\sum_{k=-1}^{\infty}
	x(k)z^{-k-1}\\
	Y(z) -\frac{1}{2}z^{-1} \sum_{k=-1}^{\infty} y(k)z^{-k} &= X(z) -\frac{1}{4}z^{-1} \sum_{k=-1}^{\infty} x(k)z^{-k}\\
	Y(z) -\frac{1}{2}z^{-1} \left(
	\sum_{k=0}^{\infty} y(k) z^{-k} + y(-1)z
	\right) &= X(z) - \frac{1}{4}z^{-1} \left(
	\sum_{k=0}^{\infty} x(k)z^{-k} + x(-1)z
	\right)\\
	Y(z) -\frac{1}{2} z^{-1} \left(
	Y(z) + y(-1)z
	\right) &= X(z) -\frac{1}{4} z^{-1} \left[
	X(z) + x(-1)z
	\right]
	\\
	Y(z) -\frac{1}{2}z^{-1} Y(z) - \frac{1}{2} y(-1) &=
	X(z) - \frac{1}{4} z^{-1} X(z) - \frac{1}{4} x(-1)\\
	Y(z) &= X(z) \underbrace{\frac{1-\frac{1}{4}z^{-1}}{1-\frac{1}{2}z^{-1}}}_{\text{εξαναγκασμένη απόκριση}} + \underbrace{\frac{\sfrac{1}{2}y(-1)-\sfrac{1}{4}x(-1)  }{1-\frac{1}{2}z^{-1}}}_{\text{ελεύθερη απόκριση}}
\end{align*}
\begin{questionbox}{Άσκηση για το σπίτι}
	Ποιά είναι η \( y(n)=? \) όταν \( x(n) = \left(\frac{1}{3}\right)^n \mathrm{u}(n) \) για
	\( y(-1) = 1 \) με το σύστημα που περιγράφεται από την παραπάνω εξίσωση διαφορών;
	\tcblower
	Η απάντηση θα είναι:
	\[
	y(n) = \left[
	\left(\frac{1}{2}\right)^n \frac{3}{2} - \left(\frac{1}{3}\right)^n \frac{1}{2}
	\right]\mathrm{u}(n) + \frac{1}{2}\left( \frac{1}{2} \right)^n \mathrm{u}(n)
	\]
\end{questionbox}

\begin{exercise}
	\begin{minipage}{.5\textwidth}
	Δίνεται το σύστημα \( y(n) = (x(n)a^{-n}) * (h(n)a^n) \)
	όπου:
	\[
	H(z) = \frac{1-z^{-1}}{1-\frac{1}{2}z^{-1}}
	\]
	μία αιτιατή συνάρτηση.
	
	Να βρεθεί το ισοδύναμό του σύστημα \( g(n) \).
\end{minipage}
\begin{minipage}{.5\textwidth}
	\begin{tikzpicture}[scale=.8]
	\draw (0,0) node[draw] (h) {$h(n)$};
	\draw (2,0) node[circle,draw] (m2) {$\times$};
	\draw (-2,0) node[circle,draw] (m1) {$\times$};
	
	\draw[gray!50!black] (-3,-2.5) rectangle (3,1) node[above left] {$g(n)$};
	
	\draw[->] (m1) -- (h) node[midway] (m3) {};
	\draw[->] (h) -- (m2) node[midway] (m4) {};
	
	\draw (m3) node[circle,fill,inner sep=1pt] {} node[below] {$r(n)$};
	\draw (m4) node[circle,fill,inner sep=1pt] {} node[below,scale=.8] {$w(n)$};
	
	\draw[<-] (m1) -- ++(0,-1.5) node[below] {$a^{-n}$};
	\draw[<-] (m2) -- ++(0,-1.5) node[below] {$a^n$};
	
	\draw[->] (m2) -- ++(2,0) node[right] {$y(n)$};
	\draw[<-] (m1) -- ++(-2,0) node[left] {$x(n)$};
	\end{tikzpicture}
\end{minipage}
	\tcblower
	Από το διάγραμμα, παρατηρούμε ότι:
	\begin{align*}
		\left.\begin{array}{l}
		r(n) = x(n)a^{-n}\\
		w(n) = r(n)*h(n)\\
		y(n) = w(n)a^n
		\end{array}\right\rbrace
		&\implies y(n) = a^n\left( r(n)*h(n) \right)
	\end{align*}
	
	Άρα μπορούμε να εκτελέσουμε τις πράξεις:
	\begin{align*}
		y(n) &= a^n\left[
		\left( a^{-n} x(n) \right) * h(n)
		\right] = a^n \sum_{k=-\infty}^{\infty} h(k) a^{-(n-k)}x(n-k)
		\\ &= a^n a^{-n} \sum_{k=-\infty}^{\infty} h(k) a^k x(n-k)
		= x(n) * \left[h(n)a^n\right] = x(n) * g(n) \\
		\text{Άρα } \quad g(n) &= a^n h(n) \implies \\
		G(z) &= H\left(\frac{z}{a}\right) = \frac{1-\left(\frac{z}{a}\right)^{-1}}{1-\frac{1}{z}\left(
			\frac{z}{a}
			\right)^{-1}}
	\end{align*}
	
	\begin{minipage}{.5\textwidth}
			Για την περιοχή σύγκλισης, παρατηρούμε πως η \( H \) έχει πόλο στο \( \frac{1}{2} \). Άρα:
		\[
		\text{ROC}_{H}: \ |z|>\frac{1}{2} \implies
		\text{ROC}_{G}: \ \left|\frac{z}{a}\right| > \frac{1}{2}
		\]
		άρα \( \displaystyle |z|>\frac{|a|}{2} \).
	\end{minipage}
	\begin{minipage}{.5\textwidth}
		\begin{center}
		\begin{tikzpicture}[scale=.5]
		\fill[fill=white,even odd rule,inner color=green!60!cyan,outer color=white] (0,0) circle (1) -- (0,0) circle (4.5);
		\draw[] (0,0) circle (1) ;
		
		\draw (1,0) node[locuspole] (p) {} node[below right] {$\sfrac{1}{2}$}    	;
		
		\draw[thick,dashed,blue!50!black] circle (2) (2,0) node[opacity=.8,scale=.6,above right] {$1$};
		
		\draw[opacity=.9,<-] (p) to[bend left] ++(2,1) node[right,scale=.8] {ευσταθές γιατί $\left|e^{j\omega}\right| \in $ ROC};
		
		\draw[->] (0,-5) -- (0,5);
		\draw[->] (-5,0) -- (5,0) ;
		\end{tikzpicture}
		\end{center}
	\end{minipage}
	
	Λαμβάνοντας υπ' όψιν το κριτήριο για τον μοναδιαίο κύκλο \( e^{j\omega } \): Αν \( \frac{|a|}{2} < 1 \), τότε \( G \) ευσταθές, διαφορετικά το \( G \) είναι ασταθές.
\end{exercise}

\begin{exercise}
	Να βρεθεί η \( x(n) \), αν:
	\[
	x(n) = \text{I}\mathcal{Z}\text{T} \left\lbrace 
	\log \left(1+az^{-1}\right)
	 \right\rbrace \qquad |z|>|a|
	\]
	\tcblower
	Μία ιδέα για να βρούμε τη \( x(n) \) θα ήταν να αξιοποιήσουμε τη \textbf{σειρά Taylor} του λογαρίθμου:
	\begin{align*}
		\log(1+x) &= x-\frac{x^2}{2} + \frac{x^3}{3} - \frac{x^4}{4} + \dots \qquad -1<x<1\\
		X(z) &= az^{-1} - \frac{a^2}{2}z^{-2} + \frac{a^3}{3}z^{-3} - \frac{a^4}{4} z^{-4} + \dots \\
		x(n) &= \left\lbrace 
		0, a , -\frac{a^2}{2}, \frac{a^3}{3},-\frac{a^4}{4},\dots
		 \right\rbrace = (-1)^{n-1}\frac{a^n}{n}
	\end{align*}
	
	Δηλαδή, βρίσκοντας τη σειρά Laurent της συνάρτησης, μπορούμε να βρούμε και τους όρους της ακολουθίας,
	με βάση και τον ορισμό \( X(z) = \sum_{n=-\infty}^{\infty} x(n)z^{-n}. \)
	
	\paragraph{}
	Εναλλακτικά, χωρίς τη σειρά Taylor, εκμεταλλευόμαστε τις σχέσεις:
	\begin{align*}
		nx(n) &\xrightarrow{\mathcal{Z}\text{T}} -z\od{x(z)}{z}
		= -z\frac{1}{1+az^{-1}}(-az^{-2})=\frac{az^{-1}}{1+az^{-1}}
		\\ &\hphantom{\xrightarrow{\mathcal{Z}\text{T}}} = az^{-1} \frac{z}{z+a}
        \\
        \frac{z}{z+a} &\xrightarrow{\text{I}\mathcal{Z}\text{T}} a^n \mathrm{u}(n) \qquad |z|>|a|\\
        z^{-1}\frac{z}{z+a} &\xrightarrow{\text{I}\mathcal{Z}\text{T}}
        (-a)^{n-1}\mathrm{u}(n-1)
	\end{align*}
	
	Άρα \[
	nx(n) = (-1)^{n-1}a^n\mathrm{u}(n-1)
	\]
\end{exercise}
\todo{finish}

\lecture{10}{5/11/2018}

\todo{Add sampling PDF link}

\section{Δειγματοληψία}
Στο παρόν θα εξετάσουμε το μετασχηματισμό \textbf{Fourier} που δίνει ένα
\textbf{διακριτό δειγματοληπτημένο} σήμα, και θα τον συγκρίνουμε με το
μετασχηματισμό Fourier του αρχικού \textbf{αναλογικού} σήματος.
Πρακτικά, μέσα από το μετασχηματισμό Fourier που δίνει ένας υπολογιστής
θέλουμε να δούμε τις πληροφορίες που μπορούμε να εξάγουμε για το διακριτό
σήμα.

\paragraph{Συνεχής μετασχηματισμός Fourier διακριτού σήματος}
Υπενθυμίζουμε πως ο συνεχής ΜF μιας ακολουθίας ορίζεται ως εξής:
\[
x(n) \to X\left(e^{j\omega }\right) = X(\omega )
\overset{\triangle}{=} \sum_{n=-\infty}^{\infty} x(n) e^{-j\omega n}
\]
όπου η \( \omega  \) είναι \textbf{συνεχής}, με εύρος π.χ.
\( (-π,π) \) ή \( (0,2π) \).

Ο αντίστροφος ορίζεται ως \( x(n) = \frac{1}{2π}\int_{-π}^{π} X\left(e^{j\omega }\right)e^{j\omega n}\dif\omega \).

Αυτός είναι ο \textbf{συνεχής μετασχηματισμός Fourier} ενός \textbf{διακριτού σήματος}.

\subparagraph{Σε περιοδικά σήματα}
Έστω ότι έχουμε ένα \textbf{περιοδικό} σήμα \( \tilde x(n) \) με περίοδο \( N \) δείγματα.

Το περιοδικό σήμα αυτό περιέχει στην πραγματικότητα μόνο \textbf{\( N \) αριθμούς πληροφορίας}. Αφού τα
\( N \) δείγματα επαναλαμβάνονται συνεχώς, είναι το μόνο δεδομένο που περιγράφει το σήμα. Επομένως, και
ο μετασχηματισμός Fourier του δεν μπορεί να περιέχει παραπάνω ή λιγότερη πληροφορία, άρα θα πρέπει και
αυτός να περιέχει \( N \) αριθμούς.

Τότε αποδεικνύεται ότι: \todo{Why?}
\begin{align*}
	\tilde x(n) &= \frac{1}{N} \sum_{k=0}^{N-1} \tilde X(k) e^{j\left( \frac{2π}{N} \right)nk}
	\qquad \forall n\\
\tilde X(k) &= \sum_{n=0}^{N-1} \tilde x(n) e^{-j\left(\frac{2π}{N}\right)nk}
\end{align*}

Οι παραπάνω σχέσεις προκύπτουν από τον ορισμό του συνεχή μετασχηματισμού Fourier, στον οποίο όμως
το \( n \) κινείται μόνο από \( 0 \) μέχρι \( N-1 \) και αυτό επαναλαμβάνεται, όπου θέσαμε \( \omega = \frac{2π}{N}k \). Το \( X(k) \) είναι η \textbf{διακριτή σειρά Fourier}.

Ακόμα, αν έχουμε δύο περιοδικά σήματα \( \tilde x_1 \), \( \tilde x_2 \) με ίδια περίοδο \( N \), τότε
για το σήμα \( \tilde x_3(n) = \tilde x_1(n) \tilde x_2(n) \) ισχύει:
\[
\tilde X_3(k) = \frac{1}{N} \sum_{l=0}^{N-1} \tilde X_1(l) \tilde X_2(k-l) = X_1(k) * X_2(k)
\]

\todo{Fix above}
\todo{Explain better}

\paragraph{Σε σήματα πεπερασμένης διάρκειας}
Έστω ότι ένα σήμα έχει πεπερασμένη διάρκεια:
\[
x(n) \quad n = 0,1,\dots, N-1
\]

Τότε ο μετασχηματισμός Fourier του θα είναι:
\[
X(k) \overset{\triangle}{=} \sum_{n=0}^{N-1}
x(n) e^{-j\frac{2π}{N} kn}
\] για \( k=0,1,\dots,N-1 \)

Αυτός ορίζεται ως \textbf{Διακριτός Μετασχηματισμός Fourier (Discrete Fourier Transform)}.

\todo{Inverse DFT?}
%Ο αντίστροφός του θα είναι:
%\[
%x(n) = \frac{1}{N} 
%\]

Ο \textbf{DFT} ενός σήματος με \( N \) δείγματα θα έχει, όπως είδαμε παραπάνω, αναγκαστικά και αυτός
\( N \) αριθμούς πληροφορίας.

Συγκρίνοντάς τον με τον CFTD (συνεχή μετασχηματισμό Fourier σε διακριτό σήμα):
\[
X\left(e^{j\omega }\right) \overset{\triangle}{=} \sum_{n=0}^{N-1} x(n)e^{-j\omega n}
\]
δηλαδή:
\[
\underbrace{X(k)}_{\text{DFT}} = \left. \underbrace{X\left(e^{j\omega }\right)}_{CFT} \right|_{\omega = \frac{2π}{N}k},\quad k=0,\dots,N-1
\]

\begin{center}
\begin{tikzpicture}[scale=.9]

\def\pointsc{(0,0),(0.5,0.8),(1,1.4),(1.5,1.6),(2,1),(2.5,0)
}
\def\pointsr{(0,0),(0.2,0.4),(0.6,0.7),(0.8,1),(1,1.2),(1.2,1.5)
}

\draw[->] (0,0) -- (3,0);
\draw[->] (0,0) -- (0,2) node[left] (xn) {$x(n)$};

\foreach \p in \pointsc
\filldraw[draw=black,top color=white,bottom color=blue,opacity=.4] \p circle(0.08);
\draw (2.5,0) node[below] {5};
\draw (2.5,-0.5) node[below right] {$N=6$};

\draw[thick,->] (3,1.2) -- ++(1.5,1.3) node[midway,above,sloped] {CFT};
\draw[thick,->] (3,0.8) -- ++(1.5,-1.3) node[midway,below,sloped] {DFT};


\begin{scope}[xshift=5cm,yshift=1.5cm]
\draw[->] (0,0) -- (4.5,0) node[right] {$\omega$};
\draw[->] (0,0) -- (0,2);
\draw[orange!50!black] plot [smooth] coordinates {(0,0) (0.2,0.4) (0.6,0.7) (0.8,1) (1,1.2) (1.2,1.5) (1.4,0)};
\draw[orange!50!black,xshift=1.4cm] plot [smooth] coordinates {(0,0) (0.2,0.4) (0.6,0.7) (0.8,1) (1,1.2) (1.2,1.5) (1.4,0)};
\draw[orange!50!black,xshift=2.8cm] plot [smooth] coordinates {(0,0) (0.2,0.4) (0.6,0.7) (0.8,1) (1,1.2) (1.2,1.5) (1.4,0)};
\foreach \p in \pointsr
\filldraw[draw=black,top color=white,bottom color=red!50!orange,opacity=.4] \p circle(0.06);
\end{scope}
\begin{scope}[xshift=5cm,yshift=-1.5cm]
\draw[->] (0,0) -- (2,0);
\draw[->] (0,0) -- (0,2);
\foreach \p in \pointsr
\filldraw[draw=black,top color=white,bottom color=red!50!orange,opacity=.4] \p circle(0.07);
\end{scope}
\end{tikzpicture}
\end{center}

Όπως παρατηρούμε, ο \textbf{DFT είναι στην πραγματικότητα ο δειγματοληπτημένος συνεχής μετασχηματισμός
Fourier}.

\subsection{Χρήσιμα Σήματα}

\begin{minipage}{.5\textwidth}
\paragraph{Παλμοσειρά δειγματοληψίας}
Το αναλογικό σήμα που χρησιμοποιούμε για δειγματοληψία είναι το γνωστό τραίνο ώσεων:
\[
s_{Δt} = \sum_{n=-\infty}^{\infty} δ(t-nΔt)
\]
\end{minipage}
\begin{minipage}{.5\textwidth}
	\begin{tikzpicture}[scale=.9]
	\draw[->] (-3,0) -- (3,0) node[right] {$t$};
	\draw[->] (0,0) -- (0,3);
	
	\draw[thick,blue,->] (-2,0) -- (-2,1.5);
	\draw[thick,blue,->] (-1,0) -- (-1,1.5);
	\draw[thick,blue,->] (0,0) -- (0,1.5);
	\draw[thick,blue,->] (1,0) -- (1,1.5);
	\draw[thick,blue,->] (2,0) -- (2,1.5);
	
	\draw[<->] (1,-0.2) --(2,-0.2) node[below,midway] {$\Delta t$};
	\end{tikzpicture}
\end{minipage}


Αυτό, στο συνεχή κόσμο, έχει μετασχηματισμό Fourier όπως έχουμε αποδείξει:
\[
s_{Δt} \xrightarrow{\text{CFT-C}} \frac{1}{Δt} \sum_{n=-\infty}^{\infty} δ\left(f-n\frac{1}{Δt}\right)
\]
ή, πιο συνοπτικά, το παραπάνω μπορεί να γραφτεί:
\[
\boxed{
s_{Δt} \xrightarrow{\text{CFT-C}} F_s S_{F_s}(f)
}
\]
όπου ορίσαμε τη \textbf{συχνότητα δειγματοληψίας}:\[
\boxed{F_s = \frac{1}{Δt}}
\]

\begin{minipage}{.5\textwidth}
	\paragraph{Παράθυρο}
	\[
	W_T(t) = \begin{cases}
	1 &\quad |t| < \frac{T}{2} \\
	0 &\quad |t| > \frac{T}{2}
	\end{cases}
	\]
\end{minipage}
\begin{minipage}{.5\textwidth}
	\begin{center}
	    \begin{tikzpicture}[yscale=.7]
	\draw[->] (0,-0.5) -- (0,3) node[right] {$\mathrm W_T(t)$};
	\draw[->] (-2,0) -- (2,0) node[below] {$t$};
	
	\draw[very thick,blue]
	(-1,0) node[below,black] {$\sfrac{-T}{2}$} --
	(-1,1.5)  --
	(1,1.5) node[above right,midway, black] {$1$} --
	(1,0) node[below,black] {$\sfrac{T}{2}$};
	\end{tikzpicture}
	\end{center}
\end{minipage}

Και από το αναλογικό σήμα γνωρίζουμε ότι:
\[
\boxed{W_T(t) \xrightarrow{\text{CFT-C}} T\sinc(Tf)}
\]
όπου \( \sinc(x)=\frac{\sin(πx)}{πx} \), και μάλιστα αν \( x\in\mathbb Z^* \implies \sinc(x) = 0 \), και \( x=0 \implies \sinc(x) = 1 \).

\begin{minipage}{.5\textwidth}
	\paragraph{Μετατοπισμένο Παράθυρο}
	Για να έχουμε ακολουθίες που ξεκινούν από \( n=0 \), χρησιμοποιούμε ένα παράθυρο που βρίσκεται λίγο
	πιο μπροστά:
	\[
	W_{0,T} = W_T\left(t-\frac{T}{2}\right)
	= \begin{cases}
	1 &\quad 0\leq t < T\\
	0 &\quad αλλού
	\end{cases}
	\]
\end{minipage}
\begin{minipage}{.5\textwidth}
	\begin{center}
		    \begin{tikzpicture}[yscale=.7]
		\draw[->] (0,-0.5) -- (0,3) node[right] {$\mathrm W_{0,T}(t)$};
		\draw[->] (0,0) -- (2,0) node[below] {$t$};
		
		\draw[very thick,blue]
		(0,1.8)  node[above right,black] {$1$}  --
		(1.2,1.8) --
		(1.2,0) node[below,black] {$T$};
		\end{tikzpicture}
		
	\end{center}
\end{minipage}

Χρησιμοποιώντας ξανά ιδιότητες του αναλογικού σήματος, θα ισχύει:
\[
\boxed{
W_{0,T} (t) \xrightarrow{\text{CFT-C}} T\sinc(Tf) e^{-j2πf\sfrac{T}{2}}
}
\]

\subsection{Η διαδικασία της δειγματοληψίας}
Ο υπολογιστής μας μπορεί να αποθηκεύσει μόνον έναν πεπερασμένο αριθμό δειγμάτων. Επομένως, πρέπει:
\begin{enumerate}
	\item Να \textit{παραθυρώσουμε} με ένα \( W_{0,T} \) το σήμα, ώστε να μην εκτείνεται στο άπειρο.
	\item Να \textit{δειγματοληπτήσουμε} το σήμα, ώστε να γίνει διακριτό.
\end{enumerate}

\begin{center}
	\begin{tikzpicture}[yscale=0.7,scale=1.2]
	\draw[->] (0,-0.5) -- (0,3) node[right] {$x(t)$};
	\draw[->] (-1.5,0) -- (3,0) node[below] {$t$};
	
	\draw[very thick,blue!50!cyan] plot [smooth,tension=.8] coordinates {(-1,0.2) (-0.8,0.4) (0,0.4)  (1,1.8) (2.5,0.8) (3,1.0)};
	
	\draw (4,1.5) node[scale=2] {$\times$};
	
	\begin{scope}[xshift=5cm]
	\draw[->] (0,-0.5) -- (0,3) node[right] {$\mathrm W_{0,T}(t)$};
	\draw[->] (0,0) -- (2,0) node[below] {$t$};
	
	\draw[very thick,blue]
	(0,1.8)  node[above right,black] {$1$}  --
	(1.2,1.8) --
	(1.2,0) node[below,black] {$T$};
	\end{scope}
	
	\begin{scope}[yshift=-4cm]
	\draw[->,thick] (-3,1.5) -- ++(1,0);
	\draw[->] (0,-0.5) -- (0,3);
	\draw[->] (-1.5,0) -- (3,0) node[below] {$t$};
	
	\draw[very thick,blue!50!cyan] (0,0) -- plot [smooth,tension=.8] coordinates {(0,0.4)  (0.7,1.8) (1.5,1.7)} -- (1.5,0) -- (2.9,0);
	
	\draw (4,1.5) node[scale=2] {$\times$};
	\end{scope}
	\begin{scope}[yshift=-4cm,xshift=6cm,xscale=0.5]
	\draw[->] (-3,0) -- (3,0) node[right] {$t$};
	\draw[->] (0,0) -- (0,3);
	
	\draw[thick,blue,->] (-2,0) -- (-2,1.5);
	\draw[thick,blue,->] (-1,0) -- (-1,1.5);
	\draw[thick,blue,->] (0,0) -- (0,1.5);
	\draw[thick,blue,->] (1,0) -- (1,1.5);
	\draw[thick,blue,->] (2,0) -- (2,1.5);
	
	\draw[<->] (1,-0.2) --(2,-0.2) node[below,midway] {$\Delta t$};
	\end{scope}
	\begin{scope}[yshift=-8cm]
	\draw[->,thick] (-3,1.5) -- ++(1,0);
	\draw[->] (0,-0.5) -- (0,3);
	\draw[->] (-1.5,0) -- (3,0) node[below] {$t$};
	
	\draw[dashed,opacity=.4,blue!50!cyan] (0,0) plot [smooth,tension=.8] coordinates {(0,0.4)  (0.7,1.8) (1.5,1.7)};
	
	\draw[thick,blue,->] (0,0) -- ++(0,0.5);
	\draw[thick,blue,->] (0.25,0) -- ++(0,1.0);
	\draw[thick,blue,->] (0.5,0) -- ++(0,1.5);
	\draw[thick,blue,->] (0.75,0) -- ++(0,1.8);
	\draw[thick,blue,->] (1.00,0) -- ++(0,1.9);
	\draw[thick,blue,->] (1.25,0) -- ++(0,1.84);
	\draw[thick,blue,->] (1.50,0) -- ++(0,1.7);
	\end{scope}
	\end{tikzpicture}
	
\end{center}

Το παραθυροποιημένο και δειγματοληπτημένο σήμα (\textbf{sampled \& windowed}) ονομάζεται \( x_{\text{SW}}(t) \). Να σημειωθεί ότι αυτό το σήμα είναι ακόμα αναλογικό, καθώς αποτελείται από
συναρτήσεις \( δ \). Για να γίνει ψηφιακό, αρκεί να πάρουμε τις τιμές αυτών των \( δ \).

\begin{center}
	\begin{tikzpicture}[yscale=0.7,scale=1.5]
	\tikzstyle{sample}=[draw,bottom color=orange!50!blue,top color=\timecolour,fill opacity=.7,inner sep=2pt,rounded corners=1.5pt]
	\draw[->] (0,-0.5) -- (0,3) node[right] {$x(n)$};
	\draw[->] (-1,0) -- (2.5,0) node[below] {$t$};
	
	\draw[dashed,opacity=.1,blue!50!cyan] (0,0) plot [smooth,tension=.8] coordinates {(0,0.4)  (0.7,1.8) (1.5,1.7)};
	
	\draw (0,0.5) node[sample] {};
	\draw (0.25,0) ++(0,1.0) node[sample] {};
	\draw (0.5,0) ++(0,1.5) node[sample] {};
	\draw (0.75,0) ++(0,1.8) node[sample] {};
	\draw (1.00,0) ++(0,1.9) node[sample] {};
	\draw (1.25,0) ++(0,1.84) node[sample] {};
	\draw (1.50,0) ++(0,1.7) node[sample] {};
	\end{tikzpicture}
	
\end{center}

\todo{capital S}

\paragraph{}
Η παραπάνω διαδικασία μπορεί να περιγραφεί μαθηματικά. Δεδομένου ότι \( W_{0,T} \) είναι το παράθυρο
και \( s_{Δt} \) η παλμοσειρά της δειγματοληψίας, έχουμε:
\begin{align*}
	x_{SW}(t) &= x_W(t)\cdot s_{Δt}(t) = 
%\left[
%	x(t) \cdot W_{0,T}
%	\right] \cdot s_{Δt}
    \\ &= \sum_{n=0}^{N-1} δ(t-nΔt)
\end{align*}
\todo{add math}

Στο πεδίο των συχνοτήτων, λαμβάνοντας το \textit{συνεχή} μετασχματισμό Fourier του \( x_{SW}(t) \), έχουμε:
\begin{align*}
	X_{SW}(f) &= \mathscr{F}\left\lbrace x_{SW}(t) \right\rbrace
	= \mathscr{F} \left\lbrace x(t) W_{0,N\ Δt}(t) S_{Δt} \right\rbrace
	\\ &= \mathscr{F} \left\lbrace x(t) \right\rbrace
	* \mathscr{F} \left\lbrace W_{0,N\ Δt}(t) \cdot S_{Δt}(τ) \right\rbrace
	\\ &= X(f) * \left[
	N\,Δt \sinc(N\,Δt\, f) e^{-j2πf\frac{NΔt}{2}}
	\right] * \left[ F_S S_{F_S}(f) \right]
\end{align*}

Εδώ παρατηρούμε ότι ο μετασχηματισμός Fourier του σήματος που έχει δειγματοληπτηθεί αποτελείται από:
\begin{itemize}
	\item Το μετασχηματισμό Fourier \( X(f) \) του \textbf{αρχικού σήματος}
	\item Την επίδραση της παραθυροποίησης με το \( \sinc \)
	\item Την επίδραση της παλμοσειράς \( S_{F_S} \)
\end{itemize}

Με μερικές παραπάνω πράξεις, προκύπτει τελικά:
\[
X_{SW}(f) = X(f) * \left[
N\sinc(N\,Δt\,f)e^{-j2πfN\sfrac{Δt}{2} }
\right] * S_{F_S}(f)
\]

\begin{center}
	\begin{tikzpicture}
	\draw (-2,0) -- (2,0);
	\draw (0,0) -- (0,2);
	\draw[orange!50!red,very thick]
	plot [smooth,tension=1] coordinates {(-2,0) (0,1) (2,0)};
	\draw (-2,0) node[below] {$-S_{L_{\mathrm{max}}}$};
	\draw (2,0) node[below] {$S_{L_{\mathrm{max}}}$};
	\draw (3,1) node[scale=3] {$*$};
	
	\begin{scope}[xshift=6cm]
	\draw (-2,0) -- (2,0);
	\draw (0,0) -- (0,2);
	\draw[orange!50!red,very thick]
	plot [smooth,variable=\x,domain=-2:2,samples=\midsamples] (\x,{1.5*sinc(10*\x)});
	\draw (3,1) node[scale=3] {$=$};
	\end{scope}
	
	\begin{scope}[xshift=12cm]
	\draw (-2,0) -- (2,0);
	\draw (0,0) -- (0,2);
	\draw[orange!50!red,very thick]
	plot [smooth,variable=\x,domain=-2:2,samples=\midsamples] (\x,{0.1+1.5*sinc(10*sin(\x^1.5 r/1.3))});
	\end{scope}
	
	\begin{scope}[yshift=-4cm]
	\draw (-2,0) -- (2,0);
	\draw (0,0) -- (0,2);
	\draw[orange!50!red,very thick]
	plot [smooth,tension=1] coordinates {(-2,0) (0,1) (2,0)};
	\draw (-2,0) node[below] {$-S_{L_{\mathrm{max}}}$};
	\draw (2,0) node[below] {$S_{L_{\mathrm{max}}}$};
	\draw (3,1) node[scale=3] {$*$};
	
	\begin{scope}[xshift=6cm]
	\draw (-2,0) -- (2,0);
	\draw (0,0) -- (0,2);
	\foreach \x in {-2,-1,...,2}
	\draw[very thick,orange!50!red,->] (\x,0) -- ++(0,1.2);
	\draw (3,1) node[scale=3] {$=$};
	\end{scope}
	
	\begin{scope}[xshift=12cm]
	\draw (-2,0) -- (2,0);
	\draw (0,0) -- (0,2);
	\foreach \x in {-2,-1,...,2}
	\draw[orange!50!red,very thick,xscale=.5,xshift={\x cm}]
	plot [smooth,tension=1] coordinates {(-2,0) (0,1) (2,0)};
	\end{scope}
	\end{scope}
	\end{tikzpicture}
	
\end{center}

Παρατηρούμε ότι, αφού το σήμα είναι χρονοπερατό μετά την παραθύρωση, το φάσμα του θα είναι άπειρο. Επομένως,
μετά από την εφαρμογή της παλμοσειράς, θα είναι βέβαιο ότι θα υπάρχει επικάλυψη. Για να μειωθεί,
αυξάνουμε τη συχνότητα δειγματοληψίας, δηλαδή μειώνουμε την απόσταση \( \Delta t \).

\paragraph{}

Έχοντας τώρα ένα ψηφιακό σήμα, μπορούμε να υπολογίσουμε:
\begin{align*}
	X_{SW}(f) &= \mathscr{F} \left\lbrace x_{SW}(t) \right\rbrace
    = \mathscr{F} \left\lbrace \sum_{n=0}^{N-1} x(n) δ(t-nΔt) \right\rbrace
    \\ &= \int_{-\infty}^{\infty} \sum_{n=0}^{N-1} x(n) δ(t-nΔt) e^{-j2πft}\dif t
    = \sum_{n=0}^{N-1} x(n) e^{-j2πfΔt n}
\end{align*}

Θέτοντας \( f=kΔf \), θα ισχύει:
\begin{align*}
X_{SW}(kΔf) &= \sum_{n=0}^{N-1} x(n) e^{-j2πΔt n Δf k}
\\ &= \sum_{n=0}^{N-1} x(n) e^{-j\frac{2π}{N} (NΔfΔt) kn}
\end{align*}

Στην παραπάνω σχέση, μπορούμε \textbf{αυθαίρετα να θέσουμε} τους χρόνους δειγματοληψίας και παραθύρωσης
ώστε:
\[
\boxed{NΔfΔt = 1}
\]
οπότε θα προκύψει:
\[
\boxed{X_{SW}(k) = \sum_{n=0}^{N-1} x(n) e^{-j\frac{2π}{N}kn}}
\]
που είναι ο \textbf{ορισμός του DFT} που είχαμε ορίσει και παραπάνω.

\paragraph{}
Για ένα παράθυρο \( N \) δειγμάτων, προκύπτει μια ακολουθία \( x(n)\ n=0,\dots,N-1 \). Εφαρμόζοντας
DFT, θα λάβουμε μια ακολουθία \( Χ(κ) \), η οποία αποτελείται από \textit{δείγματα του φάσματος} του
\( X_{SW}(f) \) σε θέσεις και συχνότητες \( 0, \ Δf,\ 2Δf,\ \dots,\ (N-1)Δf \).

Ισχύει:
\[
Δf = \frac{1}{NΔt}
\]

Αυτό που επιθυμούμε είναι:
\begin{itemize}
	\item \textbf{Μικρό } \( Δf \) για να έχουμε αρκετά μεγάλη ανάλυση στη συχνότητα, και μια πιο
	ακριβή αναπαράσταση του πραγματικού μετασχηματισμού Fourier του αρχικού σήματος.
	\item \textbf{Μεγάλο } \( N \), για να περιορίζεται η \textbf{φασματική διαρροή (spectral leakage)} που
	προκύπτει από το πλάτος του παλμού \( \sinc \) λόγω της παραθύρωσης.
	\item \textbf{Μεγάλο } \( Δt \) ώστε να περιορίζεται το \textbf{aliasing}. \todo{or other way around?}
\end{itemize}

Η τελική μορφή του DFT είναι:
\[
X[k] = \left\lbrace 
X(f) *
\underbrace{\left[N\sinc(NΔtf)e^{-jπfNΔt}\right]}_{L(f)}
* \underbrace{S_{F_S}(f)}_{A(f)}
 \right\rbrace
\]
όπου ο όρος \( L(f) \) αναφέρεται στη φασματική διαρροή, και ο όρος \( A(f) \) αναφέρεται στο aliasing.

\begin{tikzpicture}
\draw (-0.1,0) -- (3.7,0) node[right] {$k$};
\draw (0,-0.05) -- (0,2) node[right] {$X[k]$};

\foreach \x in {0,1,...,5}
\draw[thick,red!50!orange!80!green] (\x/2,0) node[below,black] {$\x$} -- ++(0,0.8) node[circle,fill,inner sep=1pt] {};
\draw (3-0.075,0.4) node[scale=1] {$\cdots$};
\draw[thick,red!50!orange!80!green] (6/2+0.3,0) node[below,black] {$N-1$} -- ++(0,0.8) node[circle,fill,inner sep=1pt] {};

\draw[->] (0,-1) node[left] {$0$} -- ++(3.7,0) node[right] {$2\pi$} node[below,midway] {"ψηφιακή" συχνότητα};
\end{tikzpicture}


Ο DFT κινείται μεταξύ των τιμών \( 0 \) και \( N-1 \), οι οποίες αντιστοιχούν άμεσα στις "ψηφιακές"
συχνότητες από \( 0 \) ως \( 2π \). Για να τις αντιστοιχήσουμε στις πραγματικές αναλογικές συχνότητες,
πρέπει να γνωρίζουμε τη συχνότητα δειγματοληψίας. \todo{Add maths}

\paragraph{Παράδειγμα}
Δίνεται ένα σήμα:
\[
x(t) = e^{j2πf_0t} \rightarrow X(f) = δ(f-f_0)
\]

δειγματοληπτείται με συχνότητα δειγματοληψίας \( F_s \). Παίρνουμε \( N \) δείγματα \( 0,Δt,\dots,(N-1)Δt \), όπου \( Δt = \frac{1}{F_s} \).

Τότε:
\begin{align*}
	X[k] &= \left[
	N\sum_{n=-\infty}^{\infty} \int_{-\infty}^{\infty}
	X(f-f'-nF_s)\sinc(NΔtf')e^{-jnf'ΝΔt}
	\dif f'
	\right]_{f=kΔf}
	\\ &= N\sum_{n=-\infty}^{\infty} \sinc\left( ΝΔt (kΔf - f_0 - nFs) \right)
	e^{-jn (kΔf-f_0-nF_s)NΔt}
\end{align*}

Ο όρος \( kΔf - f_0 -nFs \) εκφράζει τη διαφορά της πραγματικής συχνότητας που υπάρχει στο σήμα, από
τη συχνότητα επάνω στην οποία κάνουμε δειγματοληψία του Fourier εμείς. Αν τύχει και πέσουμε ακριβώς
επάνω στη σωστή συχνότητα, η \( \sinc \) δε θα επιδράσει και θα έχουμε ένα καθαρό φάσμα. Όμως αν έχουμε
μια μικρή διαφορά, θα "γεμίσουν" κι άλλες συχνότητες στο φάσμα, οι οποίες όμως στο αρχικό σήμα δεν είχαν
πληροφορία.

\todo{Graphs, examples and explanation}

\lecture{11}{9/11/2018}

\subsection{Aliasing (φασματική επικάλυψη)}
\todo{A graph if needed}
Ο παράγοντας \( A(f) \) αποτελεί ένα "παράσιτο" που εισάγεται στο σήμα μετά από τον πολλαπλασιασμό
του με την παλμοσειρά των \( δ \). Στο ψηφιακό σήμα δεν μπορεί να γίνει 0, καθώς τα φάσματά μας είναι
άπειρα, αφού τα σήματα είναι \emph{ζωνοπερατά} (όπως αποδείχθηκε στο αναλογικό σήμα).

Στην ιδανική περίπτωση που το σήμα \( x(t) \) είναι \emph{ζωνοπερατό}, η επικάλυψη μπορεί να καταργηθεί
με συχνότητα δειγματοληψίας \( F_s > 2F_{\max} \) (συνθήκη Nyquist) (πρωτογενής επικάλυψη).

Στην περίπτωση που το σήμα \emph{δεν} είναι ζωνοπερατό υπάρχει οπωσδήποτε επικάλυψη, η οποία μπορεί μόνο
να \emph{μειωθεί} αυξάνοντας τη συχνότητα δειγματοληψίας \( F_s \) (δευτερογενής επικάλυψη).

\subsection{Spectral leakage (φασματική διαρροή)}

Ο δεύτερος "ενοχλητικός" όρος είναι ο \( L(f) \):
\[
L(f) = N \sinc (N\, \Delta t\, f) e^{jπ\,f\,N\,Δt}
\] \todo{check spelling}
το φάσμα του οποίου συνελίσσεται με το αρχικό φάσμα \( X(f) \).

Για παράδειγμα, όταν έχουμε ένα "ημίτονο" \( x(t) =e^{j2πf_0t} \), τότε το παραθυρωμένο σήμα θα έχει
φάσμα:
\[
X(f) * L(f) = \int_{-\infty}^{\infty} X(f-f') L(f)\dif f'
= N \sinc\left( N\, Δt (f-f_0) \right) e^{-jπ(f-f_0)NΔt}
\]

\todo{add a lot of graphs}
Το παραπάνω αποτέλεσμα σημαίνει πως το φάσμα που θα προκύψει δεν θα αποτελείται απλώς από μία \( δ \)
πάνω στο \( f_0 \), αλλά πάνω στην \( f_0 \) θα κάθεται μία \( \sinc \). Φασματικό περιεχόμενο δεν θα
εμφανίζεται μόνο στην \( f_0 \), αλλά και γύρω από αυτήν, ενώ δεν υπήρχε μεγαλύτερο σήμα. Αυξάνοντας
το μέγεθος \( N \) του παραθύρου, στενεύει και η επίδραση της \( \sinc \).

\begin{exercise}[Παλιό θέμα]
	Έστω ένα σήμα:
	\[
	x_a(t) = \sin(2π f_1 t) + \sin(2π f_2 t)
	\]
	(υποθέτουμε πως από τη φυσική του συστήματος γνωρίζουμε πως είναι δύο τα ημίτονα).
	
	Το δειγματοληπτούμε με συχνότητα \( F_s = \SI{360}{\hertz} \) για διάρκεια
	\( N = 2400 \) samples.
	
	Διαπιστώνουμε ότι το φάσμα του DFT είναι:
	\[
	X[k] = \begin{cases}
	\neq 0,& \quad \text{για } k=200,\ k=800,\ k=1600,\ k=2200 \\
	= 0,&\quad \text{αλλού}
	\end{cases}
	\]
	
	\begin{tikzpicture}[xscale=1.5]
	\draw[->] (-0.1,0) -- (3,0);
	\draw[->] (0,-0.05) -- (0,2);
	
	\foreach \x in {0.1,0.2,...,2}
	\draw[red!50!orange!90!green] (\x,0) node[circle,fill,inner sep=0.7pt] {};
	
	\draw[thick,red!50!orange!90!green] (0.2,0) node[below,black] {$200$} -- ++(0,0.8) node[circle,fill,inner sep=1pt] {};
	\draw[thick,red!50!orange!90!green] (0.8,0) node[below,black] {$800$} -- ++(0,0.8) node[circle,fill,inner sep=1pt] {};
	\draw[thick,red!50!orange!90!green] (1.6,0) node[below,black] {$1600$} -- ++(0,0.8) node[circle,fill,inner sep=1pt] {};
	\draw[thick,red!50!orange!90!green] (2.2,0) node[below,black,xshift=2mm] {$2200$} -- ++(0,0.8) node[circle,fill,inner sep=1pt] {};
	
	\end{tikzpicture}
	
	
	Ποιές είναι οι μικρότερες πιθανές τιμές των \( f_1, f_2 \);
	
	\tcblower
	
	Μετά από τη δειγματοληψία, θα δημιουργηθεί ένα σήμα \( x[n] \) με \( n=0,1,\dots,2399 \). Με εφαρμογή
	του DFT (Discrete Fourier Transform), θα δημιουργηθεί το φάσμα \( X[k] \) με \( k=0,1,\dots,2399 \).
	
	Από το γνωστό τύπο \( N\, Δt\, Δf = 1 \), έχουμε:
	\[
	Δf = \frac{1}{Ν\,Δt}=\frac{F_s}{N}
	\]
	
	Επομένως, για όλες τις τιμές του φάσματος:
	\begin{align*}
		f_1 = k_1 Δf = 200 \cdot \frac{360}{2400} &= \SI{30}{\hertz}\\
		f_2 = k_2 Δf = 800 \cdot \frac{360}{2400} &= \SI{120}{\hertz}\\
		f_3 = k_3 Δf = 1600 \cdot \frac{360}{2400} &= \SI{240}{\hertz}\\
		f_4 = k_4 Δf = 2200 \cdot \frac{360}{2400} &= \SI{330}{\hertz}
	\end{align*}
	
	Εφ' όσον ζητάμε τις ελάχιστες δυνατές συχνότητες, απαντάμε με \( \SI{30}{\hertz} \) και \( \SI{120}{\hertz} \).
	Ο περιορισμός αυτός που δίνει η εκφώνηση ουσιαστικά δηλώνει ότι δεν έχουμε πρωτογενές aliasing, δηλαδή
	ότι η συχνότητα της δειγματοληψίας είναι σωστά επιλεγμένη, ώστε να είναι διπλάσια αυτής του
	γρηγορότερου ημιτόνου, και να ικανοποιείται το κριτήριο του Nyquist.
	
	Αν δεν υπήρχε ο συγκεκριμένος περιορισμός μάλιστα, οι δυνατές απαντήσεις θα ήταν \emph{άπειρες}
	σε πλήθος. Μία μεγαλύτερη συχότητα μπορεί να εμφανίσει alias στην "ορατή" περιοχή \( k \in (0,1200) \). Για παράδειγμα, αν \( x \) είναι μια συχνότητα, τότε θα πέφτουμε πάνω στα \( \SI{30}{\hertz} \)
	όταν:
	\[
	30 = x + κ360
	\]
	Δηλαδή για \( x=30,390,750,\dots \) Μάλιστα παρατηρούμε ότι οι συχνότητα \( \SI{330}{\hertz} \)
	που βρήκαμε παραπάνω
	δεν εμφανίζεται καν σαν πιθανή αρχική συχνότητα του σήματος.
	
	\todo{solve in another way}
\end{exercise}

\lecture{12}{12/11/2018}

\subsection{Under-Sampling (Υποδειγματοληψία)}

\begin{center}
\begin{tikzpicture}[scale=1]
\draw[->] (-2,0) -- (2,0) node[right] {$f$};
\draw[->] (0,0) -- (0,1.7);
\draw[thick,fill=red!50!orange,fill opacity=.4] (-1.5,0) node[black,opacity=1,below,scale=.6] {$-f_H$}-- (-0.5,1.4) -- (-0.5,0) node[black,opacity=1,below,scale=.6] {$-f_L$};
\draw (-0.75,0.7) node {Α};
\draw[thick,fill=red!50!orange!50!yellow,fill opacity=.4] (1.5,0) node[black,opacity=1,below,scale=.6] {$f_H$}-- (0.5,1.4) -- (0.5,0) node[black,opacity=1,below,scale=.6] {$f_L$};
\draw (0.75,0.7) node {Δ};

\draw (current bounding box.east) node[right,xshift=1.4cm] {$\left.
	\begin{aligned}f_L &= 1\;\mathrm{GHz}\\f_H &= 101\;\mathrm{GHz}
	\end{aligned} \right\rbrace BW = 10\;\mathrm{MHz}
	$};
\end{tikzpicture}
\end{center}

Έστω ότι έχουμε ένα σήμα σε μεγάλη συχνότητα, δηλαδή στο \( \SI{1}{\giga\hertz} \), το οποίο όμως έχει μικρό
εύρος ζώνης, της τάξης των \( \SI{0.01}{\giga\hertz} \).

Για να δειγματοληπτήσουμε αυτό το σήμα κανονικά, θα πρέπει να έχουμε συχνότητα δειγματοληψίας \( f_s \):
\[
f_s > 2 f_{\max} = 2f_H = \SI{2.02}{\giga\hertz}
\]

Αυτή όμως η συχνότητα είναι τεράστια για ένα σήμα το οποίο έχει τόσο μικρό εύρος ζώνης! Επομένως θα προσπαθήσουμε
να βρούμε ένα trick για να αποφύγουμε αυτόν τον περιορισμό, χωρίς να έχουμε επικάλυψη του δειγματοληπτημένου
σήματος στο φάσμα.

Αφού εφαρμοστεί η δειγματοληψία, αν δεν υπάρχει επικάλυψη, το φάσμα του δειγματοληπτημένου
σήματος θα μοιάζει ως εξής:

\begin{tikzpicture}[scale=1]
\draw[->] (-2,0) -- (5,0) node[right] {$f$};
%\draw[->] (0,0) -- (0,1.7);
\draw[thick,fill=red!50!orange,fill opacity=.4] (-1.5,0) node[black,opacity=1,below,scale=.6] {$-f_H$}-- (-0.5,1.4) -- (-0.5,0) node[black,opacity=1,below,scale=.6] {$-\vphantom{-f_H}f_L$};
\draw (-0.75,0.7) node {Α};

\draw[opacity=.4] (-1,0.7) ellipse [x radius=0.8,y radius=1.2];
\draw (-1,0.7) ++(90:1.2) node (a) {};
\draw (-1,0.7) ++(-90:1.2) node (b) {};
\draw[->,opacity=.4] (a.center) to[bend left=70] ++(2.3,-0.5);
\draw[->,opacity=.4] (b.center) to[bend right=30] ++(4.2,0.3);

\begin{scope}[xshift=2cm]
\draw[thick,fill=red!50!orange,fill opacity=.4] (-1.5,0) -- (-0.5,1.4) -- (-0.5,0);
\draw (-0.75,0.7) node {Α};
\draw (-1,0) node[below,red!50!orange,opacity=.6] {$A_\kappa$};
\draw[opacity=.7,dashed] (-0.5,0) -- ++(0,-1.5) node[below,xshift=-4mm] {$\kappa f_s -f_L$};
\end{scope}
\begin{scope}[xshift=4.5cm]
\draw[thick,fill=red!50!orange,fill opacity=.4] (-1.5,0) -- (-0.5,1.4) -- (-0.5,0);
\draw (-0.75,0.7) node {Α};
\draw (-1,0) node[below,red!50!orange,opacity=.6,xshift=2mm] {$A_{\kappa+1}$};
\draw[opacity=.7,dashed] (-1.5,0) -- ++(0,-1.5) node[below,xshift=4mm] {$(\kappa+1) f_s -f_H$};
\end{scope}

\begin{scope}[xshift=1.3cm]
\draw[thick,fill=red!50!orange!50!yellow,fill opacity=.4] (1.5,0) -- (0.5,1.4) -- (0.5,0);
\draw (0.75,0.7) node {Δ};
\draw[opacity=.7,dashed] (0.5,0) -- ++(0,-1) node[below] {$f_L$};
\draw[opacity=.7,dashed] (1.5,0) -- ++(0,-1) node[below] {$f_H$};
\end{scope}

\end{tikzpicture}

Εδώ υποθέτουμε ότι υπάρχει ένα δεξί "πλακίδιο" που περιβάλλεται από δύο αριστερά πλακίδια.
Το αριστερό πλακίδιο προκύπτει από το \emph{αντίγραφο} του αρχικού
\begin{tikzpicture}[scale=.3,baseline]
	\draw(-2,0) -- (2,0);
	\draw[opacity=.9] (0,0) -- (0,1.7);
	\draw[very thick,fill=green,fill opacity=.4] (-1.5,0) node[black,opacity=1,below,scale=.6] {$-f_H$}-- (-0.5,1.4) -- (-0.5,0) node[black,opacity=1,below,scale=.6] {$-f_L$};
\end{tikzpicture}
που, λόγω της παλμοσειράς, μετατοπίστηκε κατά μια \emph{ακέραια} σταθερά \( κ \) και \( κ+1 \).

Για να μην υπάρχει επικάλυψη, θα πρέπει να μην "χτυπούν" τα 3 πλακίδια:\[
\begin{cases}
	κf_s-f_L \leq f_L &\implies f_s \leq \frac{2f_L}{κ} \\
	(κ+1)f_S - f_H \geq f_s &\implies \geq \frac{2f_H}{κ+1}
\end{cases}
\]
άρα:\begin{align*}
	\frac{2f_H}{κ+1} &\leq f_s \leq \frac{2f_L}{κ} \implies \\
	\frac{2f_H}{κ+1} &\leq \frac{2f_L}{κ} \implies κf_H \leq (κ+1)f_L \implies  \\
	κ(f_H-f_L) &\leq f_L \implies κ \leq \frac{f_L}{f_H-f_L} \in \mathbb N \\
\end{align*}

Αυτό που θέλουμε είναι να έχουμε \emph{ελάχιστη συχνότητα δειγματοληψίας \( f_s \)} (καθώς
είναι πιο εύκολη η φυσική υλοποίηση), οπότε επιλέγουμε το μέγιστο \( κ \):
\[
κ^* = \left\lfloor \frac{f_L}{f_H - f_L} \right\rfloor
\]
και μπορούμε να επιλέξουμε απλώς μια \( f_s \) που να ικανοποιεί το κριτήριο που βρήκαμε
παραπάνω:
\[
\frac{2f_H}{κ^*+1} \leq f_s \leq \frac{2f_L}{κ^*}
\]

\paragraph{Κριτήριο Nyquist}
Για ένα χαμηλοπερατό σήμα (δηλαδή με ελάχιστη συχνότητα \( f_L = 0 \)), αν εφαρμόσουμε τον
παραπάνω τύπο, θα πρέπει να λάβουμε το γνωστό κριτήριο του Nyquist. Πράγματι:

\[
κ^* = \left\lfloor \frac{f_L}{f_H - f_L} \right\rfloor = \left\lfloor \frac{1}{f_H} \right\rfloor = 0
\]
άρα η συχνότητα δειγματοληψίας είναι:
\[
\frac{2f_H}{0+1} \leq f_s \leq \frac{2f_L}{0} \implies \boxed{f_S \geq 2 f_H}
\]

\paragraph{}
Στη γενική περίπτωση, αν \( κ^* = \left\lfloor\frac{f_L}{f_H-f_L}\right\rfloor > 0 \), τότε:
\begin{gather*}
\frac{2f_H}{\left\lfloor \frac{f_L}{f_H-f_L} \right\rfloor + 1} \leq f_s \leq \frac{2f_L}{\left\lfloor \frac{f_L}{f_H-f_L} \right\rfloor}\\
\implies
2(f_H-f_L) \leq f_s \leq 2(f_H+f_L) \implies \boxed{f_s > 2(f_H-f_L)}
\text{ (γενικότερο κριτήριο Nyquist)}
\end{gather*}
\todo{check result}

Αν βέβαια το floor δεν είναι 0. \todo{explain}

Επομένως, στο παραπάνω παράδειγμα:
\[
f_H - f_L = 1.01 - 1 = \SI{10}{\mega\hertz}
\]
θα είναι \( f_s = 2(f_H-f_L) = \SI{20}{\mega\hertz} \)

\begin{exercise}
	Δίνεται η σχέση:
	\[
	\frac{x-1}{x-2} = \frac{x-a}{x-6}
	\]
	
	Να βρεθούν οι ακέραιοι \( a \in \mathbb{Z} \), για τους οποίους η παραπάνω
	σχέση να καθιστά το \( x \in \mathbb{Z} \) ακέραιο.
	\tcblower
	Κάνουμε πράξεις στη δοθείσα σχέση:
	\[
	(x-1)(x-6) = (x-2)(x-a)
	\]
	άρα έχουμε:
	\begin{align*}
		x^2 - 7x + 6 &= (-2-a)x+2a \implies x(a-5) = 2a-6 \implies \\
		x&= \frac{2a-6}{a-5} = \frac{2a-10+4}{a-5} = 2+\underbrace{\frac{4}{a-5}}
	\end{align*}
	
	Για να είναι ο \( x \) ακέραιος, θα πρέπει και το κλάσμα \( \frac{4}{a-5} \)
	να είναι ακέραιο, δηλαδή το \( a-5 \) να είναι διαιρέτης του 4. Τα \( a \)
	που το ικανοποιούν αυτό είναι:
	\[
	(a-5) = -4,-2, -1, 1, 2, 4 \implies \underline{a=1,3,4,6,7,9}
	\]
\end{exercise}

\subsection{Διακριτές σχέσεις Kramers-Kronig}
Έστω μια \emph{αιτιατή} ακολουθία \( x(n) \in \mathbb R \) (\( x(n) = 0 \quad \forall n >0 \))

Γνωρίζουμε \todo{add ref} ότι ένα σήμα μπορεί να γραφτεί σαν άθροισμα ενός άρτιου και
ενός περιττού μέρους:
\[
x(n) = x_e(n) + x_o(n)
\]
άρα, μετασχηματίζοντας κατά Fourier (που έχει ένα πραγματικό και ένα φανταστικό μέρος):
\[
X(e^{j\omega }) = X_R\left(e^{j\omega }\right) + jX_I\left(e^{j\omega }\right)
= \sum_{n=-\infty}^{\infty} x_e(n)e^{-j\omega n} + \sum_{n=-\infty}^\infty x_o(n)e^{-j\omega n}
\]

Επιπλέον, εκμεταλλευόμενοι την αρτιότητα \& περιττότητα των \( \sin \) \& \( \cos \):
\[
\sum_{-\infty}^{\infty} x_e \cdot \cos \neq 0
\qquad
\sum_{-\infty}^{\infty} x_e \cdot \sin = 0
\qquad 
\sum_{-\infty}^{\infty} x_o \cdot \cos = 0
\qquad
\sum_{-\infty}^{\infty} x_o \cdot \sin =0
\]

Άρα τελικά:
\begin{align*}
	X_R\left(e^{j\omega }\right) &= \sum_{n=-\infty}^{\infty} x_e(n)e^{-j\omega n}
	\implies x_e(n) = \frac{1}{2π}\int_{-π}^{π} X_R\left(e^{j\omega }\right)e^{j\omega n}\dif \omega 
	\intertext{Ομοίως:}
	jX_I\left(e^{j\omega }\right) &= \sum_{n=-\infty}^{\infty} x_o(n)e^{-j\omega n}
	\implies x_0(n) = \frac{1}{2π} \int_{-π}^{π} jX_I\left(e^{j\omega }\right)e^{j\omega }
	\dif\omega
\end{align*}

Άρα τελικά:
\[
\boxed{
\begin{aligned}
x(n) &= x_e(n) + x_o(n) \\
x(-n) &= x_e(-n) + x_o(-n) = x_e(n)-x_o(n)
\end{aligned}
}
\]

Και, όταν το \( n \) είναι θετικό \( (n>0) \):
\[
\boxed{
	\begin{aligned}
	x(n) &= x_e(n) + x_o(n) \\
	0 &= x_e(n) - x_o(n) = x_e(n)-x_o(n)
	\end{aligned}
} \implies \boxed{
\begin{aligned}
x(n) &= 2x_e(n)\\
x(n) &= 2x_o(n)
\end{aligned}
}
\]

Ενώ, επάνω στο \( n=0 \), οι σχέσεις γίνονται:
\[
\left.
\begin{aligned}
x(0) &= x_e(0) + \cancelto{0}{x_o(0)} \\
x(0) &= x_e(0) - \cancelto{0}{x_o(0)}
\end{aligned}\right\rbrace \implies \boxed{x(0) = x_e(0)}
\]

Τελικά:
\[
\boxed{
x(n) = \begin{cases}
0 &\quad n < 0 \quad \text{(αιτιατότητα)} \\
x_e(0) &\quad n=0\\
2x_e(n) = 2x_o(n) &\quad n>0
\end{cases}
}
\]

Οι παραπάνω σχέσεις δηλώνουν πως γνωρίζοντας μόνο το άρτιο ή περιττό κομμάτι μιας αιτιατής
\& πραγματικής ακολουθίας, μπορούμε να τη βρούμε ολόκληρη (εκτός από την τιμή \( n=0 \), που
απαιτεί το άρτιο κομμάτι).

Τα παραπάνω οδηγούν στο εξής συμπέρασμα:
\begin{theorem}[title=Πόρισμα 4.1]{Πόρισμα}{}
	Αν \( x(n) \in \mathbb R \) ένα \emph{αιτιατό} σήμα:
	\begin{enumgreekpar}
		\item Αν μας δίνεται μόνο το πραγματικό μέρος του μετασχηματισμού Fourier \( X_R\left(e^{j\omega }\right) \) του, τότε μπορώ να βρω το \( x(n) \) ως εξής:
		\[
		x(n) = \begin{cases}
		2x_e(n) = \frac{1}{π} \displaystyle \int_{-π}^{π} X_R\left(e^{j\omega }\right)e^{j\omega n}\dif\omega &\quad n>0\\
		x_e(0) = \frac{1}{2π}\displaystyle \int_{-π}^{π} X_R\left(e^{j\omega }\right)\dif \omega& \quad n=0
		\end{cases}
		\]
		\item Αν μας δίνεται μόνο το φανταστικό μέρος του μετασχηματισμού Fourier \( X_I\left(e^{j\omega }\right) \), έχουμε:
		\[
		x(n) = \begin{cases}
		2x_0(n) = \frac{j}{π}
		\displaystyle\int_{-π}^{π} X_I\left(e^{j\omega }\right)e^{j\omega n}\dif\omega
		&\quad n>0\\
		x(0) = \text{άγνωστο} &\quad n=0
		\end{cases}
		\]
	\end{enumgreekpar}
\end{theorem}

Τα παραπάνω δηλώνουν ότι αν έχουμε ένα \textbf{πραγματικό σήμα}, ο μετασχηματισμός Fourier
του (που περιέχει πραγματικό+φανταστικό μέρος) περιέχει \textbf{διπλάσια πληροφορία απ' όση χρειάζεται}. Και αυτό, επειδή μπορούμε μόνο από το \textbf{πραγματικό μέρος} του Fourier να
λάβουμε \textbf{ολόκληρο το σήμα}. Αυτό όμως δεν ισχύει σε μιγαδικά σήματα.

\begin{exercise}
	Έστω ένα πραγματικό αιτιατό σήμα με πραγματικό μέρος Fourier:
	\[
	X_R\left(e^{j\omega }\right) = \begin{cases}
	1 &\quad |\omega | < \sfrac{π}{2}  \\
	0 &\quad \sfrac{π}{2}  < |\omega  | < π
	\end{cases}
	\]
	
	Να ανακτηθεί το \( x(n) \).
	\tcblower
	Από το πόρισμα \todo{add ref}, έχουμε:
	\begin{align*}
		x(n) &= 2x_e(n) = \frac{1}{π} \int_{-π}^{π} X_R\left(e^{j\omega }\right) e^{j\omega n}
		\dif \omega 
		\\ &= \frac{1}{π} \int_{\sfrac{-π}{2} }^{\sfrac{π}{2} } e^{j\omega n}\dif\omega
		= \left.\frac{1}{jnπ} e^{j\omega n} \right|_{\sfrac{-π}{2} }^{\sfrac{π}{2} }
		\\ &=
		\frac{1}{jnπ} \left( e^{jn\sfrac{π}{2} } - e^{-jn\sfrac{π}{2} } \right)
		= \frac{2}{πn} \sin\left(n\frac{π}{2}\right)
		\intertext{Και για την τιμή στο \( x(0) \):}
		x(0) &= \frac{1}{2π}\displaystyle \int_{-π}^{π} X_R\left(e^{j\omega }\right)\dif \omega
		= \frac{1}{2π} \int_{\sfrac{-π}{2} }^{\sfrac{π}{2} } 1 \dif\omega
		= \frac{1}{2}.
	\end{align*}
	\todo{check calculations}
\end{exercise}

\lecture{14}{23/11/2018}
\section{Σχεδίαση ψηφιακών φίλτρων}

\subsection{Αναλογικά φίλτρα Butterworth}

\begin{defn}{Αναλογικό φίλτρο Butterworth}{}
	Το φίλτρο Butterworth τάξης \( n \) έχει απόκριση πλάτους:
	\[
	\left|
	H_n(j\Omega)
	\right|^2 = \frac{1}{1+\left( \frac{\Omega}{\Omega_c} \right)^{2n}}
	\]
\end{defn}

\paragraph{Ιδιότητες}
\begin{enumgreek}
	\item
	\( \displaystyle \left. \left| H_n(j\Omega)^2 \right| \right|_{\Omega = 0}  = 1 \quad \forall n \)
	\item
	\( \displaystyle \left. \left| H_n(j\Omega)^2 \right| \right|_{\Omega = \Omega_c}  = \frac{1}{2} \quad \forall n \)
	 \item
	\( \displaystyle \left. \left| H_n(j\Omega) \right| \right|_{\Omega = \Omega_c}  = 0.707 = \frac{\sqrt{2}}{2} \quad \forall n \)
	
	Δηλαδή η \( \Omega_c \) είναι η \textbf{συχνότητα ημίσειας ισχύος} του φίλτρου.
	
	\item Η \( 
	\displaystyle \left|H_n(j\Omega)\right|^2
	 \) είναι μονότονη φθίνουσα συνάρτηση του \( \Omega \).
	\item Για \( 
	\displaystyle \lim_{n\to \infty} \left| H_n(j\Omega) \right|^2
	 \), το \( H_n(j\Omega) \) τείνει να γίνει \emph{ιδανικό φίλτρο}.
	\item Η \(  \left|
	\displaystyle H_n(j\Omega) \right|^2
	 \) \textbf{μεγιστοποιείται} για \( \Omega = 0 \).
\end{enumgreek}

\paragraph{Κανονικοποίηση}
Στη σχεδίαση, μπορούμε να δουλεύουμε σε ένα κανονικοποιημένο φίλτρο, με κεντρική συχνότητα \( 1 \).
Πράγματι, αν ορίσουμε \( \Omega' = \frac{\Omega}{\Omega_c} \), τότε το φίλτρο έχει κέντρο στο
\( \Omega_c' = 1 \).

\begin{center}
	\begin{tikzpicture}[scale=1.1]
	\draw[->] (0,0) -- (3,0) node[right] {$\Omega$};
	\draw[->] (0,0) -- (0,2) node[above] {};
	
	\draw[very thick,orange!50!red!90!green]
	(0,1.5) cos (1.5,1) sin (3,0.4);
	\draw (0,1.5) node[left] {$1$};
	\draw[dashed] (1.5,0) node[below] {$\Omega_r$} |- (0,1) node[left] {$A_c=0.707$};
	\draw[dashed] (2.4,0) node[below] {$\Omega_r$} |- (0,0.5) node[left] {$A_r$};
	\end{tikzpicture}
	\hfill
	\begin{tikzpicture}[scale=1.1]
	\draw[->] (0,0) -- (3,0) node[right] {$\Omega'$};
	\draw[->] (0,0) -- (0,2) node[above] {};
	
	\draw[very thick,orange!50!red!90!green]
	(0,1.5) cos (1.5,1) sin (3,0.4);
	\draw[dashed] (1.5,0) node[below] {$1$} |- (0,1) node[left] {$A_c=0.707$};
	\end{tikzpicture}
\end{center}

\begin{defn}{Κανονικοποιημένο Butterworth με \( \Omega_c = \SI{1}{\radian/\second} \)}{}
	Το κανονικοποιημένο Butterworth είναι:\[
	\left|H_n(j\Omega)\right|^2 = H_n(j\Omega) H_n(-j\Omega) = \frac{1}{1+\Omega^{2n}}
	\]
\end{defn}
Στο πεδίο Laplace, αντικαθιστώντας με \( s = j\Omega \):
\[
\left| H_n(s) \right|^2 = \frac{1}{1+\left(\frac{s}{j}\right)^2}
\]

Για να παράξουμε το παραπάνω φίλτρο, χρειάζεται ο πολλαπλασιασμός των συναρτήσεων \( H_n(j\Omega) \) και
\( H_n(-j\Omega) \). Αυτές πρέπει να έχουν τους ίδιους πόλους με τους πόλους του τελικού φίλτρου:
\[
1+\left(\frac{s}{j}\right)^{2n} = 0 \implies s^{2n} = -1(j)^{2n} = (-1)^{n+1}
\]
όπου θέτοντας το \( n \), μπορούμε γρήγορα να βρούμε τις ρίζες του παρανομαστή:
\[
\begin{cases}
n\text{ odd} &\implies s_k = 1\angle{\sfrac{kπ}{n} } \quad k=0,1,\dots,2n-1\\
n\text{ even} &\implies s_k = 1\angle{\frac{π}{2n} + \frac{kπ}{n}} \quad k=0,1,\dots,2n-1
\end{cases}
\]
όπου μπορούμε να μοιράσουμε τις odd και even ρίζες μεταξύ των \( H_n(j\Omega) \) και \( H_n(-j\Omega) \).

Άρα έχουμε:\[
H_n(s) = \frac{1}{Π(s-s_k)}=\frac{1}{B_k}
\]
όπου, για να έχουμε ευστάθεια, οι \( s_k \) είναι στο \emph{αριστερό ημιεπίπεδο}, και \( B_n(s) \) το
πολυώνυμο Butterworth.

\paragraph{Επέκταση}
Η συνάρτηση Butterworth που βρήκαμε παραπάνω είναι εξ' ορισμού \emph{χαμηλοπερατή}. Για το σχεδιασμό
άλλων ειδών φίλτρων Butterworth, μπορούμε να συνδυάσουμε πολλά Butterworth φίλτρα κατάλληλα. Στα
τυπολόγια, υπάρχουν εξισώσεις που πραγματοποιεί τη σχεδίαση του φίλτρου, δεδομένων των προδιαγραφών.

\paragraph{Παράδειγμα σχεδιασμού}
Μπορεί να μας ζητηθούν προδιαγραφές:

\begin{minipage}{.7\textwidth}
	\begin{quote}
		\begin{itemize}
			\item Για \( \Omega < \Omega_1 \): \( 
			\leq 20\log\left|H_n(j\omega )\right| \geq k_1 \geq 0
			\)
			\item Για \( \Omega > \Omega_2 \): \( 
			\log\left|H_n(j\omega )\right| \leq k_2
			\)
		\end{itemize}
	\end{quote}
\end{minipage}
\begin{minipage}{.3\textwidth}
	\begin{center}
	\begin{tikzpicture}[scale=.8]
	\draw[->] (0,0) -- (3,0) node[right] {};
	\draw[->] (0,0) -- (0,2) node[above] {};
	
	\draw[very thick,orange!50!red!90!green]
	(0,1.5) cos (1.5,1) sin (3,0.4);
	\draw[dashed] (1.2,0) node[below] {$\Omega_1$} |- (0,1.16) node[left] {$k_1$};
	\draw[dashed] (2.4,0) node[below] {$\Omega_2$} -- ++(0,0.5) ;
	\end{tikzpicture}
	\end{center}
\end{minipage}

Επομένως, λύνοντας τις παραπάνω ανισώσεις (θέτονας \( H(\Omega) = \frac{1}{1+\left(\frac{\Omega}{\Omega_c}\right)^{2n}} \)), θα προκύψει:
\[
n = \left\lceil
\frac{\cdots}{2\log\left(\sfrac{\Omega_1}{\Omega_2} \right)}
\right\rceil
\]
%TODO: Συμπλήρωση
με τη δυνατότητα επιλογής οποιουδήποτε \( \Omega_c \) εντός της περιοχής:
\[
\frac{\Omega_1}{\left(10^{\sfrac{-k_1}{10} } - 1\right)^{\sfrac{1}{2n} }}
\leq \Omega_c \leq 
\frac{\Omega_2}{\left(10^{\sfrac{-k_2}{10} } - 1\right)^{\sfrac{1}{2n} }}
\]

\subsection{Αριθμητική επίλυση διαφορικής εξίσωσης}
Τα αναλογικά φίλτρα και συστήματα εκφράζονται από διαφορικές εξισώσεις. Αν καταφέρουμε να μετασχηματίσουμε
αυτά τα συστήματα με κάποιον τρόπο στον ψηφιακό κόσμο, θα μπορούμε να τα εφαρμόσουμε και στα ψηφιακά
μας σήματα.

Οι "αναλογικές" διαφορικές εξισώσεις έχουν γενικά την εξής μαθηματική μορφή:
\[
\sum_{k=0}^{N} c_k \od[k]{}{t} y_a(t) = \sum_{k=0}^{M} d_k \od[k]{}{t} x_a(t)
\]
και, εφαρμόζοντας μετασχηματισμό Laplace:
\[
H_a(s) = \frac{\displaystyle \sum_{k=0}^{M} d_k s^k}{\displaystyle \sum_{k=0}^{N} c_k s^k}
\]

\begin{defn}{Διαφορά $k$-τάξης}{}
	Για την αριθμητική επίλυση των διαφορικών εξισώσεων, ορίζουμε αναδρομικά τις \textbf{διαφορές \( k \) τάξης}:\begin{align*}
		\nabla^{(1)} \left[y(n)\right] &= \frac{y(n)-y(n-1)}{T}\\
		\nabla^{(k)} \left[y(n)\right] &= \nabla^{(1)}\left[ \nabla^{(k-1)}\left[y(n)\right] \right]
	\end{align*}
\end{defn}

Η χρησιμότητά τους έγκειται στο ότι μοιάζουν με τις κλασικές παραγώγους:
\[
\left. \od{}{t} y_a(t) \right|_{t=nT}
\approx \frac{y(n) - y(n-1)}{T}
\]
επομένως προσεγγιστικά μπορούμε άμεσα να \emph{διακριτοποιήσουμε} την αρχική διαφορική εξίσωση:
\begin{align*}
	\sum_{k=0}^{N} c_k \nabla^{(k)} y_a(nT) &\approx \sum_{k=0}^{N} d_k \nabla^{(k)}x_a(nT) \\
	\intertext{και, εφαρμόζοντας \textbf{μετασχηματισμό Z}:}
	\mathcal{Z} \left\lbrace \nabla^{(1)} \left[y(n)\right] \right\rbrace
	&= \mathcal{Z} \left[\frac{y(n)-y(n-1)}{T}\right] = Y(z) \left[\frac{1-z^{-1}}{T}\right]\\
	\mathcal{Z}\left\lbrace \nabla^{(k)} \left[y(n)\right]\right\rbrace
	&= Y(z)\left[\frac{1-z^{-1}}{T}\right]^k
	\intertext{Δηλαδή τελικά:}
	H(z) &= \frac{Y(z)}{X(z)} = \cdots
\end{align*}
\todo{fill}

Από το παραπάνω αποτέλεσμα προκύπτει πως μπορούμε να γράψουμε το \( H(z) \) από το \( H(s) \) με μια
απλή αντικατάσταση μεταβλητής:
\[
H(z) = \left. H(s) \right|_{s\leftarrow \frac{1-z^{-1}}{T}}
\]

\begin{tikzpicture}[scale=.8]
\draw (-2,0) -- (2,0);
\draw (0,-2) -- (0,2);
\draw (1,-1) node[below right] {$s$-plane};
\draw[thick,opacity=.8,->,yshift=2mm] (2.5,0) -- ++(1,0);

\begin{scope}[xshift=6cm]
\draw (-2,0) -- (2,0);
\draw (0,-2) -- (0,2);
\draw[green!50!blue,very thick] (0,0) circle (1.7);
\draw[green!50!blue,very thick] (1.7/2,0) circle (1.7/2);
\draw[green!50!blue,<-] (1.7/2,0) ++(60:1.7/2) to[bend left] ++(1,0.7) node[right] {$\Omega=\frac{1}{T}$};
\fill[green!70!blue] circle (3pt);
\draw[green!70!blue,<-] (0,0) ++(90+60:3pt) to[bend right] ++(90+60:2) node[left] {$\Omega=\infty$};
\draw (1.2,-1) node[below right] {$z$-plane};
\end{scope}
\end{tikzpicture}

Ο μετασχηματισμός που πραγματοποιούμε είναι ο εξής:
\[
s = \frac{1-z^{-1}}{T}
\]
και πραγματοποιούμε πράξεις:
\begin{gather*}
z = \frac{1}{1-sT} = \frac{1}{1-j\Omega T} = \frac{1}{1+\Omega^2 T^2} + j\frac{\Omega T}{1+\Omega^2 T^2} = \mathfrak{X}+j\mathfrak{Y}
\end{gather*}
όπου ισχύει \( \mathfrak{X}^2+\mathfrak{Y}^2 = x \) και \( \left(\mathfrak{X}-\frac{1}{2}\right)^2 + \mathfrak{Y}^2 = \frac{1}{y} \)

Δεν υπάρχει ακριβής απεικόνιση των αναλογικών συχνοτήτων σε ψηφιακές. Όμως μπορεί να απαιτηθεί οι αναλογικές συχνότητες να είναι πολύ κοντά στο μοναδιαίο κύκλο, παίρνοντας τον ελάχιστο δυνατό χρόνο
δειγματοληψίας \( T \). Επίσης, αν ένα αναλογικό σύστημα είναι ευσταθές, τότε αναγκαστικά και το ψηφιακό
αντίστοιχο θα είναι ευσταθές.

\paragraph{Σημείωση}
Ορίζεται και η \emph{προς τα εμπρός} διαφορά (forward difference):
\begin{align*}
	\Delta^{(1)} y(n) &= \frac{y(n+1)-y(n)}{T} \\
	\left. \od{y(t)}{t} \right|_{t=nT} &\simeq \frac{y(n+1)-y(n)}{T}
\end{align*}
Η παραπάνω διαφορά ορίζει διαφορετική απεικόνιση στις ψηφιακές συχνότητες \( s\leftarrow \frac{z-1}{T} \),
και δεν εγγυάται ευστάθεια και στον ψηφιακό κόσμο.

Επιπλέον, ορίζονται κεντρικές διαφορές ως εξής:
\[
\left. \od{y(h)}{t} \right|_{t=nT} = \frac{y(n+1)-y(n-1)}{2T} \quad \text{ με } s \leftarrow \frac{z+z^{-1}}{T}
\]

\lecture{15}{26/11/2018}
\paragraph{Ένα παράδειγμα}
Έστω ότι δειγματοληπτούμε ένα αναλογικό σήμα \( H_a(\Omega) \), με συχνότητα δειγματοληψίας \( \Omega_s \),
που απεικονίζεται στον ψηφιακό κόσμο από \( 0 \) ως \( 2π \). Το \( \omega = 2π \) αντιστοιχεί στην
αναλογική συχνότητα \( \Omega_s \), και το \( \omega = \pi \) αντιστοιχεί στην \( \frac{\Omega_s}{2} \).

\begin{minipage}{.5\textwidth}
	\begin{center}
		\begin{tikzpicture}[scale=.6]
		\draw[->] (-2,0) -- (3,0) node[below] {$\Omega$};
		\draw[->] (0,0) -- (0,2) node[right] {$H_a(\Omega)$};
		
		\draw[very thick,red!50!orange] plot[smooth,tension=0.7]
		coordinates {(-2,0.3) (0,1.5) (2,0.4) (3,0.15)};
		\draw[dashed,red!10!black] (1,0) node[below] {$\Omega_i$} -- ++(0,1.08);
		\draw[fill opacity=0.3,fill=white] (1,1.08) circle (2.4pt);
		\draw (2.5,0.05) -- ++(0,-0.1) node[below] {$\Omega_s$};
		
		\begin{scope}[xshift=6cm]
		\draw[->] (-2,0) -- (4,0) node[below] {$\omega$};
		\draw[->] (0,0) -- (0,2);
		
		\draw[very thick,red!50!orange] plot[smooth,tension=0.7]
		coordinates {(-2,0.3) (-0.6,0.7) (0,1.5) (0.6,0.7) (2,0.4) (3,0.15)};
		\draw[very thick,red!70!orange,xshift=2.2cm,path fading=east] plot[smooth,tension=0.7]
		coordinates {(-2,0.3) (-0.6,0.7) (0,1.5) (0.6,0.7) (2,0.4) (3,0.15)};
		\draw (1.15,0.05) -- ++(0,-0.1) node[below] {$\vphantom{2}\pi$};
		\draw (2.2,0.05) -- ++(0,-0.1) node[below] {$2\pi$};
		\end{scope}
		\end{tikzpicture}
	\end{center}
\end{minipage}
\begin{minipage}{.5\textwidth}
\begin{center}
\begin{tikzpicture}[scale=.8]
\draw[->] (-2,0) -- (2,0);
\draw[->] (0,-2) -- (0,2);
\draw (1,-1) node[below right] {$s$-plane};
\draw[thick,opacity=.8,->,yshift=2mm] (2.5,0) -- ++(1,0);

\draw[green!50!black] (0,1.8) node[circle,fill,inner sep=1.5pt] (a) {} node[right] {$\Omega_s$};
\draw[green!50!black] (0,1.8/2) node[circle,fill,inner sep=1.5pt] (b) {} node[right] {$\frac{\Omega_s}{2}$};
\draw[green!50!black] (0,0.3) node[circle,fill,inner sep=1.5pt] (c) {} node[left] {$\Omega_i$};
\draw[green!50!black] (0,0) node[circle,fill,inner sep=1.5pt] (d) {} node[right] {$\Omega_s$};

\begin{scope}[xshift=6cm]
\draw (-2,0) -- (2,0);
\draw (0,-2) -- (0,2);
\draw[green!50!blue,very thick] (0,0) circle (1.5) (180+45:1.5) node[below left] {$1$};
\draw (1,-1) node[below right] {$z$-plane};

\draw[green!50!blue!70!black,<-] (0:1.5) to[bend left=120] (d);
\draw[green!70!blue!70!black,<-] (0:1.5) to[bend right=120] (a);
\draw[green!90!blue!80!black,<-] (50:1.5) to[bend right=50] (c);
\draw[green!40!blue!50!black,<-] (180:1.5) to[bend right=30] (b);
\end{scope}
\end{tikzpicture}
\end{center}
\end{minipage}

Η σχέση που συνδέει την "αναλογική" με την "ψηφιακή" συχνότητα είναι γραμμική:
\[
\boxed{\omega = \frac{2πΩ}{Ω_s}}
\]

Επίσης, αν φανταστούμε ότι το σήμα είχε μια συχνότητα \( Ω_H > \Omega_s \), μεγαλύτερη δηλαδή από το
μισό της συχνότητας δειγματοληψίας, αυτή θα εμφανιζόταν σε λανθασμένο σημείο στο φάσμα, οδηγώντας
σε παραπλανητικά αποτελέσματα.

\paragraph{Μετάφραση ψηφιακής σε αναλογική συχνότητα}
Έστω ότι έχουμε ένα φίλτρο Butterworth. Το αρχικό αναλογικό φάσμα του είναι πολύ καθαρό:

\begin{tikzpicture}[scale=.8,xscale=1.4]
\draw[->] (0,0) -- (2,0) node[right] {$\omega$};
\draw[->] (0,0) -- (0,2) node[left] {$H_a(s)$};
\draw (0,0) node[left] {$0$};

\draw[very thick,red!50!orange] plot[smooth,tension=.4] coordinates {(0,1.5) (0.4,1.7) (0.7,1.3) (1,0.4) (1.3,0.4) (1.4,0)};
\draw (1.4,0) node[below] {$\pi$};

\draw[thick,opacity=.8,->] (3,1) -- ++ (1,0) node[midway,above] {$\omega\to\Omega$};

\begin{scope}[xshift=5cm]
\draw[->] (0,0) -- (2,0) node[right] {$\Omega$};
\draw[->] (0,0) -- (0,2) node[left] {$H_a'(\Omega)$};
\draw (0,0) node[left] {$0$};

\draw[very thick,red!50!orange] plot[smooth,tension=.4] coordinates {(0,1.5) (0.15,1.7) (0.3,1.3) (0.5,0.4) (0.9,0.4) (1.4,0)};
\draw (1.4,0) node[below] {$\frac{\Omega_s}{2}$};
\end{scope}
\end{tikzpicture}

Στον ψηφιακό κόσμο όμως, το φάσμα προκύπτει ελαφρά παραμορφωμένο. Αν μεταφράσουμε την ψηφιακή συχνότητα
σε αναλογική με τη σχέση \( ω = \frac{2πΩ}{Ω_s} \), θα λάβουμε ένα εναφρά διαφορετικό σήμα \( H_a'(Ω) \),
που εν γένει θα είναι ελαφρά διαφορετικό από το αρχικό \( H_a(Ω) \).

\paragraph{Για τις forward διαφορές}
Παραπάνω ορίσαμε ως εξής, πέρα από τις \emph{προς τα πίσω} διαφορές που χρησιμοποιήσαμε παραπάνω,
και τις \emph{προς τα εμπρός} διαφορές:
\begin{align*}
\Delta^{(1)} y(n) &= \frac{y(n+1)-y(n)}{T} \\
\left. \od{y(t)}{t} \right|_{t=nT} &\simeq \frac{y(n+1)-y(n)}{T}
\end{align*}

Εδώ θα αποδείξουμε υπό συνθήκη (αλλά όχι πάντα) οδηγούν σε \emph{ευστάθεια} και του ψηφιακού συστήματος,
αν το αντίστοιχο αναλογικό είναι ασταθές.

Με πράξεις όπως και στις προς τα πίσω διαφορές, βρίσκουμε την αντιστοιχία μεταξύ των \( s \)-plane και
\( z \)-plane:
\[
s \leftarrow \frac{z - 1}{T}f
\]
(όπου \( T=Δt \)).

Έχουμε:
\begin{align*}
    s &= \frac{z-1}{T} \implies z = sT + 1 = (a+jb)T + 1
    \intertext{όπου το κριτήριο για ευστάθεια είναι \( a<0 \).}
    z &= (aT+1) + jbT\\
    |z|^2 &= (aT+1)^2 + b^2T^2 = a^2T^2+2aT + 1 + b^2T^2
    \intertext{Από τη θεωρία, το ψηφιακό σύστημα είναι ευσταθές αν \( |z|^2<1 \):}
    a^2T^2 + 2aT + 1 + b^2T^2 &< 1 \\
    T(a^2+b^2) &< -2a \implies T < \frac{-2a}{(a^2+b^2)}
\end{align*}
Το παραπάνω αποτέλεσμα σημαίνει ότι \textbf{για κάθε πόλο \( a+jb \), θα πρέπει να επιλέξουμε συχνότητα
δειγματοληψίας τέτοια ώστε \( T<\frac{-2a}{a^2+b^2} \) για να έχουμε ευστάθεια και στο ψηφιακό σύστημα}.

Για πολλούς πόλους \( p_i = a_i + jb_i \), η παραπάνω συνθήκη γράφεται ως εξής:
\[
T < \frac{-2A}{B}
\]
όπου:
\begin{align*}
	A &= \max_i \left\lbrace \Re \left\lbrace p_i \right\rbrace \right\rbrace\\
	B &= \max_i \left\lbrace |p_i|^2 \right\rbrace
\end{align*}

\begin{questionbox}{Άσκηση για το σπίτι}
	Να παρασταθεί γεωμετρικά η απεικόνιση του φανταστικού άξονα από το \( s \)-plane στο \( z \)-plane.
\end{questionbox}
\begin{questionbox}{Παιχνίδι για το σπίτι}
	Να εφαρμοστεί φίλτρο Butterworth (π.χ. της μορφής \( H(s)=\frac{1}{s+1} \)) και να εφαρμοστεί σε
	ανθρώπινη φωνή. Να ακουστεί η διαφορά της φωνής όταν εφαρμοστεί φίλτρο Butterworth σε αυτήν.
\end{questionbox}

\lecture{16}{30/11/2018}

\subsection{Διγραμμικός Μετασχηματισμός}
Έστω η διαφορικής εξίσωση:\[
a_1 \od{}{t}y_a(t) + a_0 y_a(t) = b_0x(t)
\]
όπου το \( y_a \) δηλώνει ένα \emph{analog} σήμα εισόδου.

Το σύστημα αυτό έχει, κατά Laplace, συνάρτηση μεταφοράς:
\[
H(s) = \frac{b_0}{a_1s+a_0}
\]
και η λύση του είναι:
\[
y_a(t) = \int_{t_0}^{t}y_a'(t) \dif t + y_a(t_0)
\]
όπου \( y_a'(t) = \od{y_a(t)}{y_t} \).

Γενικότερα, η παράγωγος γράφεται (από τη ΔΕ) ως εξής:
\[
y_a'(t) = \frac{b_0x(t) - a_0y_a(t)}{a_1}
\]

\begin{minipage}{.5\textwidth}
Μπορούμε να διακριτοποιήσουμε τη λύση του ως εξής:
\[
y_a(nT) = \int_{(n-1)T}^{nT} y_a'(t)\dif t + y_a\left[(n-1)T\right]
\]
\end{minipage}
\begin{minipage}{.5\textwidth}
	\begin{center}
		\begin{tikzpicture}[scale=0.9]
		\draw[] (0,0) -- (3,0) node[right] {$\omega$};
		\draw[] (0,0) -- (0,3) node[left] {};
		\draw (0,0) node[left] {$0$};
		
		{
			\pgfmathsetseed{51398}
			\draw[thick,blue] (0,0) -- plot [smooth,domain=0.2:3,samples=20] (\x,\x+0.14*rand)
			(2.4,2) node[right] {$y_a'(t)$};
		}
		\filldraw[fill=blue,fill opacity=.4] (1.25,0) -- ++(0,1.15) -- (2.15,2.22) |- cycle;
		
		\draw (1.25,0) node[below,xshift=-3mm] {$(n-1)T$};
		\draw (2.15,0) node[below,xshift=2mm] {$nT$};
		\end{tikzpicture}
	\end{center}
\end{minipage}
και, μπορούμε αριθμητικά να προσεγγίσουμε το ολοκλήρωμα (με τη μέθοδο τραπεζίου):
\begin{align*}
y_a(nT) &= T\frac{y_a'\left( (n-1)T \right) +y_a'(nT) }{2} + y_a\left[ (n-1)T \right]
\\ &= \frac{T}{2}\left\lbrace 
-\frac{a_0}{a_1}y_a(nT) + \frac{b_0}{a_1} x(nT)
- \frac{a_0}{a_1}y_a\left[ (n-1)T \right] + \frac{b_0}{a_1} x\left[(n-1)T\right]
 \right\rbrace + y_a\left[(n-1)T\right]
\end{align*}

Στη συνέχεια, μετασχηματίζουμε κατά \( \mathcal{Z} \):
\[
Y(z) = \frac{T}{2}\left[
-\frac{a_0}{a_1}Y(z) + \frac{b_0}{a_1}X(z) - \frac{a_0}{a_1}z^{-1}Y(z) + \frac{b_0}{a_1}z^{-1}X(z)
\right] + z^{-1}Y(z)
\]
και με λίγες πράξεις μπορούμε να βρούμε και τη \emph{συνάρτηση μεταφοράς του ψηφιακού συστήματος}:
\[
H(z)=\frac{Y(z)}{X(z)} = \cdots = \frac{b_0}{a_1\left(\frac{2}{T}\right)\left(\frac{1-z^{-1}}{1+z^{-1}}\right)+a_0}
\]

Αν θυμηθούμε ότι στο αναλογικό σύστημα η συνάρτηση μεταφοράς ήταν \( H(s) = \frac{b_0}{a_1s+a_0} \),
τότε ο διγραμμικός μετασχηματισμός μπορεί να περιγραφεί από την αντικατάσταση:
\[
\boxed{s \to \frac{2}{T} \frac{1-z^{-1}}{1+z^{-1}}}
\]

Ο \textbf{διγραμμικός μετασχηματισμός} επομένως είναι μία ακόμα μέθοδος αριθμητικής αναπαράστασης \&
επίλυσης ενός αναλογικού συστήματος, ο οποίος μπορεί να προκύψει, όπως και οι παραπάνω μετασχηματισμοί,
θέτοντας το \( s \) της συνάρτησης μεταφοράς σε μία κατάλληλη τιμή.

\paragraph{Μελέτη απεικόνισης συχνοτήτων}
Ένα ερώτημα που πρέπει να απαντήσουμε είναι αν απεικονίζονται όλες οι αναλογικές συχνότητες \( s=jΩ \)
στον ψηφιακό κόσμο.

Θέλουμε το \( j\Omega \) να απεικονιστεί στο \( e^{j\Omega} \). Τότε θέτουμε:
\begin{align*}
	jΩ &= \frac{2}{T} \frac{1-e^{-j\omega }}{1+e^{-j\omega }} = \frac{2}{T} \frac{1-\cos \omega +j\sin \omega}{1+\cos \omega - j \sin \omega}
	\\ &= \frac{2}{T} \frac{
	(1-\cos \omega + j\sin \omega)(1+\cos \omega + j \sin \omega)
    }{(1+\cos \omega)^2 + \sin^2 \omega}
    \\ &= \frac{2}{Τ} \frac{(1+j\sin \omega)^2 - \cos^2\omega}{(1+\cos\omega)^2 + \sin^2\omega}
    \\ &= \frac{2}{T} \frac{1-\sin^2\omega + 2j\sin\omega - \cos^2\omega}{(1+\cos\omega)^2 + \sin^2\omega} \implies
    \\ \Omega &= \frac{2}{T} \frac{\sin\omega}{1+\cos \omega} = \frac{2}{T} \tan\left(\frac{\omega}{2}\right)
\end{align*}

Επομένως υπάρχει απεικόνιση του \( j\Omega \to e^{j\omega} \), η οποία είναι η \( \Omega = \frac{2}{T}\tan\left(\frac{\omega}{2}\right) \), ή αντιστρόφως \( \omega = 2\tan^{-1}\frac{\Omega T}{2} \).

\begin{tikzpicture}
\draw (-2,0) -- (2,0);
\draw (0,-2) -- (0,2);
\draw[ultra thick, green!60!blue, decorate,
decoration={snake,amplitude=.3mm}
] (0,-2) -- (0,2);
\draw (1,-1) node {$s$-plane};

\begin{scope}[xshift=6cm]
\draw (-2,0) -- (2,0);
\draw (0,-2) -- (0,2);
\draw[ultra thick, green!60!blue, decorate,
decoration={snake,amplitude=.3mm}
] circle (1);
\draw (1,-1.2) node {$z$-plane};
\end{scope}

\end{tikzpicture}

Μερικά παραδείγματα της συχνότητας \( \omega_{\mathrm{bl}} \) που προκύπτει από το διγραμμικό μετασχηματισμό
(σε σύγκριση με τη συχνότητα \( \omega_{\mathrm{ST}} = \Omega T \) που προκύπτει από το θεώρημα
δειγματοληψίας) είναι:
\begin{ceqn}
\[
\begin{array}{|c|c|c|}
\hline
\Omega & \omega_{\mathrm{bl}} & \omega_{\mathrm{ST}} \\ \hline \hline
0 & 0 & 0 \\ \hline
\frac{2}{T} & \sfrac{\pi}{2}  & 2 \\ \hline
\infty & \pi & \infty \\ \hline
\Omega_s = \frac{2π}{T} & 2\tan^{-1}(π) \approx 2\cdot1.26262 \approx 2\cdot0.402π & 2π \\ \hline
\end{array}
\]
\end{ceqn}

Σε αυτόν το μετασχηματισμό, παρατηρούμε πως \emph{όλες οι συχνότητες} από το 0 ως το \( \infty \) απεικονίζονται
από το 0 ως το \( π \). Αυτό βέβαια απαιτεί μια στρέβλωση και ανομοιομορφία.

\paragraph{Μελέτη ευστάθειας}
Έχουμε:
\[
s = \frac{2}{T}\frac{1-z^{-1}}{1+z^{-1}} \implies z = \frac{1+\frac{sT}{2}}{1-\frac{sT}{2}}
\]

Έστω ότι υπάρχει ένας πόλος \( s_0 = a+jb \).

\begin{align*}
	z_0 &= \frac{1+s_0\frac{T}{2}}{1-s_0\frac{T}{2}}
	= \frac{1+(a+jb)\frac{T}{2}}{1-(a+jb)\frac{T}{2}}
	\\ &= \frac{\left(1+\frac{Ta}{2}\right)+j\frac{bT}{2}}{\left(1-\frac{Ta}{2}\right)-j\frac{bT}{2}}
\end{align*}

Αν έχουμε ένα \textit{ευσταθές} αναλογικό σύστημα, ο πόλος θα έχει \( a<0 \), οπότε:
\[
\left|z_0\right|^2 = \frac{\left(1+\frac{Ta}{2}\right)^2 + \frac{b^2T^2}{4}}{\left(1-\frac{Ta}{2}\right)^2 + \frac{b^2T^2}{4}}
\]
και, με λίγα μαθηματικά, ισχύει \underline{\( |z_0|<1 \)}. Επομένως, και το ψηφιακό σύστημα είναι
ευσταθές.

\begin{exercise}{}
Να σχεδιαστεί ψηφιακό φίλτρο με Διγραμμικό Μετασχηματισμό, το οποίο να αντικαταστήσει ένα αναλογικό
χαμηλοπερατό, με μονότονη απόκριση:

\begin{minipage}{.5\textwidth}
	\begin{align*}
		\Omega_c = 2π \cdot 500\, \si{\radian/\second} & \quad \SI{-3}{\decibel}\\
		\Omega \geq \Omega_2 = 2π \cdot 750\, \si{\radian/\second} & \quad < k_2 = \SI{-15}{\decibel}
	\end{align*}
\end{minipage}
\begin{minipage}{.5\textwidth}
	\begin{center}
		\begin{tikzpicture}[scale=1.2,every node/.style={scale=0.8}]
		\draw[->] (0,0) --(0,2.2);
		\draw[->] (0,0) -- (2.2,0);
		
		\draw[red!50!orange,very thick]
		plot[smooth] coordinates {(0,1.5) (0.5,1.4) (1.2,0.5) (2,0.4)};
		
		\draw[dashed] (0,1.3) node[left] {$-3$} -| (0.56,0) node[below] {$\Omega_c$};
		\draw[dashed] (0,0.6) node[left] {$-15$} -| (1.08,0) node[below] {$\Omega_2$};
		\end{tikzpicture}
	\end{center}
\end{minipage}

\tcblower
Θα υλοποιήσουμε ένα φίλτρο Butterworth, με χρόνο δειγματοληψίας \( Δt = 0.5 \cdot 10^{-3} \si{second} \),
όπως προκύπτει από την \( Omega_c \).

Έχουμε:
\begin{align*}
	\Omega_1 = 2π\cdot 500 &\quad k_1 = -3\\
	\Omega_2 = 2π\cdot 750 &\quad k_2 = -15
\end{align*}

Από τον τύπο που βρήκαμε για το Butterworth, έχουμε:
\begin{align*}
	n &= \lceil \frac{\log\left( 10^{-\frac{k_1}{10}} -1 \right)/\left(10^{-\frac{k_2}{10}}-1\right)}{2\log\left(\frac{\Omega_1}{\Omega_2}\right)} \rceil
	\\ &= \lceil 4.2254\dots \rceil = 5
\end{align*}

Άρα, από τυπολόγιο, το κανονικοποιημένο Butterworth είναι:
\[
H(s) = \frac{1}{(s+1)(s^2+0.618s+1)(s^2+1.618s+1)}
\]
και, αν θέλουμε την κανονική συχνότητα:
\[
\left. H_a(s) = H_s(s) \right|_{s\leftarrow\frac{s}{\Omega_c = 2\pi \cdot 500}}
\]
άρα:
\[
H_a(s) = \frac{1}{\left( \frac{s}{\Omega_0} \right) \left(
	\left(\frac{s}{\Omega_0}\right)^2
	+0.618\left(\frac{s}{\Omega_0}\right)+1
	\right)\left( \left(\frac{s}{\Omega_0}\right)^2 + 1.618\left(\frac{s}{\Omega_0}\right)+1 \right) }
\]

Για να μετασχηματίσουμε στη συχνότητα και να βρούμε το \( H(z) \), αρκεί να θέσουμε \( s \leftarrow \frac{2}{Δt}\frac{1-z^{-1}}{1+z^{-1}} \) στο παραπάνω.

\subparagraph{}
Η σχεδίασή μας όμως αυτή μπορεί να οδηγήσει σε λάθος αποτέλεσμα, καθώς δεν λαμβάνει υπ' όψιν το
μετασχηματισμό που προκύπτει από το διγραμμικό μετασχηματισμό για τη ψηφιοποίηση του
συστήματος. Εφαρμόζοντας το μετασχηματισμό \( \Omega = \frac{2}{Δt}\tan\left(\frac{\omega}{2}\right) \)
έχουμε:
\begin{align*}
	\Omega_1' &= \frac{2}{Δt} \tan\left(\frac{\omega_1}{2}\right) = \SI{4000}{\radian/\second} %TODO fix result
	\\ \Omega_2' &= \frac{2}{Δt} \tan\left(\frac{\omega_2}{2}\right) = \SI{9000}{\radian/\second} %TODO fix result
\end{align*}
και η σχεδίαση μπορεί να γίνει:
\[
n = \left\lceil \frac{\log\left( 10^{-\frac{k_1}{10}} -1 \right)/\left(10^{-\frac{k_2}{10}}-1\right)}{2\log\left(\frac{\Omega_1'}{\Omega_2'}\right)} \right\rceil
= \lceil 1.9438 \rceil = 2
\]
με συνάρτηση μεταφοράς (από τυπολόγιο):
\[
H_2(s) = \frac{1}{s^2+1.4142s+1}
\]
στη μη-κανονικοποιημένη συχνότητα:
\[
H_a'(s) = \left. H_2(s) \right|_{s\to\frac{s}{\Omega_c'}}
\]
και στην ψηφιακή:
\[
H(z) = \left. H_a'(s) \right|_{s\leftarrow \frac{2}{Δt} \frac{1-z^{-1}}{1+z^{-1}}}
\]
\end{exercise}

\lecture{17}{3/12/2018}

\subsection{Συνελικτικά ολοκληρώματα}
Κάποιες διαφορικές εξισώσεις, δεδομένων των γνώσεων που έχουμε για την \emph{κρουστική απόκριση},
λύνονται ως εξής:
\begin{align*}
	y(t) &= \int_{-\infty}^{\infty} h(τ)\cdot x(t-τ) \dif τ \\
	&= \int_{-\infty}^{\infty} x(τ)h(t-τ)\dif τ
	=\int_{-\infty}^{t} x(τ) h(t-τ)\dif τ \text{ (για αιτιατό σύστημα)}
\end{align*}

Θα μπορούσαμε να σκεφτούμε να μετατρέψουμε σε άθροισμα το ολοκλήρωμα, θέτοντας \( t=nT \), άρα
\( y(nT) = T\sum_{k=-\infty}^{n} x(kT)h(nT-kT) \implies y(n) = T\sum_{k=-\infty}^{n} x(k)h(n-k) = T x(n)*h(n) \). Δηλαδή, γνωρίζοντας την κρουστική απόκριση του αναλογικού συστήματος, και δειγματοληπτώντας
κατάλληλα, μπορούμε να μοντελοποιήσουμε και το ψηφιακό σύστημα.

Έστω ένα φίλτρο \( H_a(s) \):
\[
H_a(s) =\frac{1}{s+a}
\]
με κρουστική απόκριση:
\[
h_a(t) = e^{-at} \mathrm{u}(t)
\]
την οποία μπορούμε να δειγματοληπτήσουμε ως εξής:
\[
\boxed{h[n] = h_a(nT) = e^{-anT}\mathrm{u}(n)}
\]

Αφού το παραπάνω είναι η κρουστική απόκριση του ψηφιακού συστήματος, για να περιγράψουμε το ίδιο το
σύστημα έχουμε:
\begin{align*}
H(z) &= \mathcal{Z}\mathrm{T}\left\lbrace h(n) \right\rbrace = \sum_{n=0}^{\infty} e^{-anT} z^{-n}
\\&= \sum_{n=0}^{\infty} \left(\frac{e^{-aT}}{z}\right)^n
=\frac{1}{1-\frac{e^{-aT}}{z}} \qquad \text{με } \left|\frac{e^{-aT}}{z}\right|<1
\\ &= \frac{z}{z-e^{-aT}}
\end{align*}

Μελετώντας τους πόλους, παρατηρούμε ότι ο πόλος του αναλογικού συστήματος είναι \( (s_0) = -a \),
και ο πόλος του ψηφιακού είναι \( (z_0) = e^{-at} \). Αν \( (s_0) < 0 \), τότε \( (z_0) < 1 \), άρα
η ευστάθεια του αναλογικού συστήματος οδηγεί και στην ευστάθεια του ψηφιακού.

Μελετώντας το σύστημα στη συχνότητα, παρατηρούμε ότι έχουμε αποτελέσματα αντίστοιχα με αυτά του θεωρήματος δειγματοληψίας, καθώς δειγματοληπτούμε την \( h(t) \). Δεν θα υπάρχει καμία στρέβλωση στη
συχνότητα.

\begin{center}
	\begin{tikzpicture}[scale=1]
	\draw[->] (-2,0) -- (2,0) node[right] {$\Omega$};
	\draw[->] (0,0) -- (0,2) node[right] {$H(s)$};
	
	\draw[orange!50!red,very thick]
	(-1.8,0.2) .. controls (0.2,0) and (-0.2,1.5)  .. (0,1.5)
	(0,1.5) .. controls (0.2,1.5) and (-0.2,0) .. (1.8,0.3);
	
	\begin{scope}[xshift=6cm]
	\draw[->] (-2,0) -- (2,0) node[right] {$\Omega$};
	\draw[->] (0,0) -- (0,2) node[right] {$H_{S_a}(s)$};
	
	\foreach \x in {-1,-0.5,...,1}
	\draw[orange!50!red,very thick,xshift={\x cm}]
	(-1.8,0.2) .. controls (0.2,0) and (-0.2,1.5)  .. (0,1.5)
	(0,1.5) .. controls (0.2,1.5) and (-0.2,0) .. (1.8,0.3);
	
	\draw[dashed] (0.5,0) node[below] {$\Omega_s = \frac{2\pi}{\Delta t}$} -- (0.5,1.5) ;
	
	\end{scope}
	
	\begin{scope}[xshift=11cm]
	\draw[->] (-2,0) -- (2,0) node[right] {$\omega$};
	\draw[->] (0,0) -- (0,2) node[left] {$H\left(e^{j\omega}\right)$};
	
	\begin{scope}[xscale=1.8]
	\clip (0,0) rectangle (0.5,1.5);
	\foreach \x in {0,0.5}
	\draw[orange!80!red,very thick,xshift={\x cm}]
	(-1.8,0.2) .. controls (0.2,0) and (-0.2,1.5)  .. (0,1.5)
	(0,1.5) .. controls (0.2,1.5) and (-0.2,0) .. (1.8,0.3);
	\end{scope}
	
	\draw[dashed] (1.8*0.5,0) node[below] {$2\pi$} -- ++(0,1.6) ;
	
	\end{scope}
	\end{tikzpicture}
\end{center}

\subsubsection{Ακρίβεια της ψηφιακής προσέγγισης}

Έστω ένα σύστημα, που μετά από την αντικατάσταση \( z \leftarrow e^{j\omega } \), γίνεται:
\begin{align*}
	H\left(e^{j\omega }\right) = \frac{Ae^{j\omega }}{e^{j\omega }-e^{-aT}}
\end{align*}
και το ισοδύναμο δειγματοληπτημένο:
\begin{align*}
	H_{eq}(j\Omega) &= \left. H\left(e^{j\omega }\right) \right|_{\omega \leftarrow \Omega T}
	= \frac{Ae^{j\Omega T}}{e^{j\Omega T}-e^{-aT}} \qquad \text{ με } \Omega < \frac{π}{T}
	\\ H_a(j\Omega) &= \frac{A}{j\Omega + a}\\
	H_{eq}(j\Omega) &= \frac{A}{1-(1-aT)\cos(\Omega T) + j(1-aT)\sin(\Omega T)}
	\\ &= \frac{\sfrac{A}{T} }{1 + j\Omega - jT \Omega } = \frac{A}{T}\frac{1}{a+j\Omega}
	\\ &= \frac{A}{1-1 + aT\cos(\Omega T) + j \sin(\Omega T) - jaT\sin(\Omega T)}
	\\ &= \frac{1}{aT + j\Omega T - jaT^2 \Omega}
\end{align*}
Παρατηρούμε ότι μειώνοντας το χρόνο δειγματοληψίας \( T \), μειώνεται και η παραμόρφωση που προκαλείται
λόγω της προσέγγισης μειώνεται.

\paragraph{Παράδειγμα}
Έστω ένα σύστημα \( h_a(t) \) με είσοδο \( u(t) \) και έξοδο \( s_a(t) \). Μέσω της παραπάνω διαδιασίας, μετατρέπουμε την \( h_a(t) \) σε \( h(n) \), για να πάρουμε έξοδο
\( s(n) \), και το σύστημα να έχει μετασχηματισμό Z τον \( H(z) \).

\subparagraph{Ερώτημα}

Αν \( H(n) = h_a(nT) \), είναι ή όχι \( s(n) = \sum_{k=-\infty}^{n} h_a(kT) \);


Έχουμε:
\begin{align*}
	u(n) &= \sum_{k=-\infty}^{n}δ(k) \xRightarrow{H(z)} s(n) = \sum_{k=-\infty}^{n} h(k) = \sum_{k=-\infty}^{\infty} h_a(kT)
\end{align*}

Άρα είναι.

\subparagraph{Ερώτημα}

Αν \( s(n) = s_a(nT) \), είναι ή όχι \( h(n) = h_a(nT) \);

Έχουμε:
\begin{align*}
	δ(n) &= u(n) - u(n-1) \xRightarrow{H(z)} h(n) = s(n) - s(n-1)
	\\ &= s_a(nT) - s_a\left( (n-1)T \right)
\end{align*}
όπου:
\begin{align*}
	s_a(nT) &= \int_{-\infty}^{nT}h(τ)u(nT-τ)\dif τ = \int_{-a}^{nT}h(τ)\dif τ\\
	s_a\left( (n-1)T \right) &= \cdots = \int_{-\infty}^{(n-1)T} h(τ)\dif τ
\end{align*}
άρα:
\[
s_a(nT) - s_a\left((n-1)T\right) = \int_{(n-1)T}^{nT} h(τ)\dif τ \neq h_a(nT)
\]
δηλαδή η δοθείσα σχέση δεν ισχύει.

\begin{questionbox}{Ερώτηση για το σπίτι}
	Ποιό είναι το νόημα της παραπάνω άσκησης;
\end{questionbox}

\lecture{18}{7/12/2018}
\begin{exercise}
	Έστω το σύστημα που περιγράφεται από την εξίσωση διαφορών:
	\[
	y(n) - \frac{1}{2}y(n-1) = x(n) - \frac{1}{4}x(n-1) \qquad n\geq0
	\]
	
	\begin{enumpar}
		\item Να βρεθεί η \textbf{κρουστική απόκριση} \( h(n) \)
		\item Να βρεθεί η \( H(z)\) είτε ως \( \frac{Y(z)}{X(z)} \), είτε ως \( \mathcal{Z}T\left\lbrace h(n) \right\rbrace \).
		\item Να βρεθεί η \( y(n) \) αν \( \displaystyle x(n) = \left(\frac{1}{3}\right)^n \mathrm{u}(n) \) με \( y(-1) = 0 \).
		\item Να βρεθεί η \( y(n) \) αν \( x(n) = \left(\frac{1}{3}\right)^n u(n) \) και
		\( y(-1) = 1 \).
		\item Αν \( x(n) = δ(n) \) και \( y(-1) = 1 \), ποιά θα είναι η \( y(n) \);
	\end{enumpar}
	\tcblower
	Αφού \( n \geq 0 \), το σύστημα είναι αιτιατό.
	\begin{enumpar}
		\item
		\begin{enumgreekpar}
			\item \textbf{α' τρόπος}
			
			Το ότι μας ζητείται κρουστική απόκριση, σημαίνει πρακτικά ότι οι αρχικές συνθήκες τίθενται ίσες με 0, και ότι η είσοδος είναι \( x(n)=δ(n) \).
			
			Λαμβάνουμε παραδείγματα τιμών:\[
			\begin{array}{crl}
			n=0 & y(0)-\frac{1}{2}y(-1)=\delta(0)-\frac{1}{4}δ(-1) \implies & y(0)=1\\
			n=1 & y(1)-\frac{1}{2}y(0) =δ(1)-\frac{1}{4}δ(0)\implies & y(1)=\frac{1}{4}\\
			n=2 & y(2)-\frac{1}{2}y(1) = δ(2)-\frac{1}{4}δ(1)\implies & y(2) = \frac{1}{2}\cdot\frac{1}{4}\\
			n=3 & y(3)-\frac{1}{2}y(2) = 0 \implies & y(3) = \left(\frac{1}{2}\right)^{2}\frac{1}{4}\\
			n=\underset{>3}{k} & y(k)-\frac{1}{2}y(k-1) & y(k) = \left(\frac{1}{2}\right)^{k-1}\frac{1}{4}
			\end{array}
			\]
			
			Δηλαδή, επαγωγικά βρίσκουμε ότι:
			\[
			y(n) = h(n) = \left(\frac{1}{2}\right)^{k-1} \cdot \frac{1}{4} \text{ για } n>3
			\]
			ή, γενικότερα:
			\begin{align*}
			y(n) = h(n) &= δ(n) + \left(\frac{1}{2}\right)^{n-1}\frac{1}{4}\mathrm{u}(n-1)
			\\ &= \left(\frac{1}{2}\right)^n\left[u(n) - \frac{1}{2}u(n-1)\right]
			\end{align*}
			
			Παρατηρούμε την ενδιαφέρουσα συμπεριφορά του συστήματος επάνω στο σημείο 0, η οποία διαφέρει
			από την υπόλοιπη δυναμική συμπεριφορά, λόγω των "μεταβατικών" όρων με τα \( δ \).
			
			\item \textbf{β' τρόπος}
			
			Θα χρησιμοποιήσουμε το μετασχηματισμό \( \mathcal{Z} \) (αδιαφορώντας αν είναι μονόπλευρος
			ή δίπλευρος - αφού εξ' ορισμού οι αρχικές συνθήκες πριν το 0 είναι μηδενικές).
			
			Έχουμε:
			\begin{align*}
				\mathcal{Z}\mathrm{T}\left\lbrace y(n) - \frac{1}{2}y(n-1) \right\rbrace
				&= \mathcal{Z}\mathrm{T}\left\lbrace x(n)\frac{1}{4}x(n-1) \right\rbrace
				\\
     			Y(z) - \frac{1}{2}z^{-1}Y(z) &= X(z)-\frac{1}{4}z^{-1}X(z)\\
     			Y(z)\left[1-\frac{1}{2}z^{-1}\right] &= X(z) \left[1-\frac{1}{4}z^{-1}\right] \implies \\
     			\frac{Y(z)}{X(z)} = H(z) &= \frac{1-\sfrac{1}{4}z^{-1} }{1-\sfrac{1}{2}z^{-1} }
     			=\frac{z-\sfrac{1}{4} }{z-\sfrac{1}{2} }=\frac{z}{z-\sfrac{1}{2} }-\frac{\sfrac{1}{4} }{z-\sfrac{1}{2} }\qquad \text{ROC} > \sfrac{1}{2} 
			\end{align*}
			
			Άρα η κρουστική απόκριση, ως αντίστροφος μετασχηματισμός Laplace, είναι:
			\begin{align*}
				h(n) &= \mathrm{I}\!\mathcal{Z}\mathrm{T}\left\lbrace H(z) \right\rbrace
				\intertext{Έχουμε ότι:\( 
					\frac{\sfrac{1}{4} }{z-\sfrac{1}{2} }=z^{-1}\frac{\sfrac{1}{4}z }{z-\sfrac{1}{4} }
					\to \left. \frac{1}{4}\left(\frac{1}{2}\right)^n u(n)\right|_{n\leftarrow n-1}
					 \)}
				\\ &				= \left(\frac{1}{2}\right)^n\mathrm{u}(n)-\frac{1}{4}\left(\frac{1}{2}\right)^{n-1}u(n-1)
			\end{align*}
		\end{enumgreekpar}
	
	\item
	

	Θα υπολογίσουμε την \( H(z) \) ως μετασχηματισμό Laplace της \( h(n) \) του πρώτου ερωτήματος.
	Από τον ορισμό του μετασχηματισμού Laplace:
	
	\begin{align*}
		H(z) &= \sum_{n=-\infty}^{\infty} h(n)z^{-n} = \sum_{n=-\infty}^{\infty}\left(\frac{1}{2}\right)^n z^{-n}\mathrm{u}(n)
		-\frac{1}{4}\sum_{n=-\infty}^{\infty}\left(\frac{1}{2}\right)^{n-1}z^{-n}\mathrm{u}(n-1)
		\\ &= \sum_{n=0}^{\infty} \left(\frac{1}{2z}\right)^n = \frac{1}{4}\sum_{n=1}^{\infty}\left(\frac{1}{2z}\right)^n 2
		\\ &= \underbrace{\frac{1}{1-\frac{1}{2z}}}_{|z|>\frac{1}{2}}
		- \frac{1}{4}\left[\sum_{n=0}^{\infty} \left(\frac{1}{2z}\right)^n \cdot 2 - 2 \right]
		\\ &= \frac{z}{z-\frac{1}{2}}-\frac{1}{2}\underbrace{\left[
		\frac{1}{1-\frac{1}{2z}-1}
		\right]}_{|z|>\frac{1}{2}}
        \\ &= \frac{z}{z-\frac{1}{2}} -\frac{1}{2}\frac{\frac{1}{2z}}{1-\frac{1}{2z}}
        \\ &
        =\frac{z}{z-\frac{1}{2}} - \frac{1}{4}\frac{1}{z-\frac{1}{2}}\qquad |z|>\frac{1}{2}
	\end{align*}
	
    \item
	\begin{enumgreekpar}
	\item \textbf{Α' τρόπος}
	
	
	Επειδή οι αρχικές συνθήκες είναι μηδενικές, ισχύει ότι \( H(z) = \frac{Y(z)}{X(z)}\iff
	Y(z) = H(z)X(z) \iff y(n) = h(n)*x(n) \). Άρα εφαρμόζουμε τη συνέλιξη:
	
	\begin{align*}
		y(n) &= x(n) * h(n) = \sum_{k=-\infty}^{\infty}\left(\frac{1}{2}\right)^k\left[
		u(k) - \frac{1}{2}u(n-1)
		\right]\left(\frac{1}{3}\right)^{n-k}u(n-k)
		\\ &= \left(\frac{1}{3}\right)^n\left[
		\sum_{k=-\infty}^{\infty} \left(\frac{3}{2}\right)^k u(k)u(n-k) - \frac{1}{2}\sum_{k=-\infty}^{\infty}\left(\frac{3}{2}\right)^k u(k-1)u(n-k)
		\right]
		\\ &= \left(\frac{1}{3}\right)^n \left[\sum_{k=0}^{n}\left(\frac{3}{2}\right)^k u(n)
		-\frac{1}{2}\sum_{k=1}^{n}\left(\frac{3}{2}\right)^k u(n-1)\right]
		\\ &= \left(\frac{1}{3}\right)^n\left[
		\frac{1-\left(\frac{3}{2}\right)^{n+1}}{1-\frac{3}{2}}u(n)
		-\frac{1}{2}\sum_{k=0}^{n-1}\left(\frac{3}{2}\right)^k \frac{3}{2}u(n-1)
		\right]
		\\ &= \left(\frac{1}{3}\right)^n\left[
		\frac{1-\left(\frac{3}{2}\right)^{n+1}}{1-\frac{3}{2}}u(n)
		-\frac{1}{2}\frac{3}{2}\frac{1-\left(\frac{3}{2}\right)^k}{1-\frac{3}{2}}u(n-1)
		\right]
		\\ &= \left[3\left(\frac{1}{2}\right)^n - 2\left(\frac{1}{3}\right)^n\right]\mathrm{u}(n)
		+\left[\frac{3}{2}\left(\frac{1}{3}\right)^n-\frac{3}{2}\left(\frac{1}{2}\right)^n\right]u(n-1)
		\\ &= \left(\frac{1}{2}\right)\left[3u(n)-\frac{3}{2}u(n-1)\right]
		+ \left(\frac{1}{3}\right)^n \left[ -2u(n)-\frac{3}{2}u(n-1) \right]
	\end{align*}
	\item \textbf{Β' τρόπος}
	
	Γνωρίζουμε από το μετασχηματισμό \( \mathcal{Z} \) ότι:
	\[
	Y(z) = H(z)X(z)
	\]
	
	και η είσοδος είναι:
	\[
	x(n) = \left(\frac{1}{3}\right)^n u(n) \quad \implies \quad X(z) = \frac{z}{z-\frac{1}{3}}
	\qquad \text{ROC}_x:|z|>\frac{1}{3}
	\]
	
	Άρα η έξοδος θα είναι:
	\begin{align*}
		Y(z) &= \frac{z-\frac{1}{4}}{z-\frac{1}{2}}\frac{z}{z-\frac{1}{3}}\qquad \mathrm{ROC}_y:|z|>\frac{1}{2}\\
		y(n) &= \frac{1}{2πj} \ointctrclockwise_{C\in\text{ROC}} Y(z) z^{n-1}\dif z
		= \frac{1}{2πj} \ointctrclockwise_{C\in\text{ROC}} \frac{z^n\left(z-\frac{1}{3}\right)}{\left(z-\frac{1}{2}\right)\left(z-\frac{1}{3}\right)}\dif z
        \\ &= \res\left[ \cdots @\ z=\frac{1}{2} \right]		+ \res\left[ \cdots @\ z=\frac{1}{3} \right]
        \\ &= \left[
        \frac{\left(\frac{1}{2}\right)^n\left(\frac{1}{2}-\frac{1}{4}\right)}{\frac{1}{2}-\frac{1}{3}}
        +\frac{\left(\frac{1}{3}\right)^n \left(\frac{1}{3}-\frac{1}{4}\right)}{\frac{1}{3}-\frac{1}{2}}
        \right]u(n)
        \\ &= \left[
        \left(\frac{1}{2}\right)^n\frac{3}{2} - \left(\frac{1}{3}\right)^n \frac{1}{2}
        \right]u(n)
        \\ &= \left(\frac{1}{2}\right)^n\left[
        3u(n) - \frac{3}{2}u(n-1)
        \right] + \left(\frac{1}{3}\right)^n \left[
        -2u(n)+\frac{3}{2}u(n-1)
        \right]
	\end{align*}
	\end{enumgreekpar}


    \item Για \( y(-1) \neq 0 \) δεν μπορώ να εφαρμόσω το:
    \[
    y(n) = h(n)*x(n)
    \]
    γιατί δεν ισχύει και το \( Y(z) = H(z)X(z) \).
    
    Γράφουμε την αρχική εξίσωση:
    \begin{align*}
    	y(n)-\frac{1}{2}y(n-1) &= x(n)-\frac{1}{4}x(n-1) \qquad n \geq 0\\
    	\sum_{n=0}^\infty y(n)z^{-n}-\frac{1}{2}\sum_{n=0}^\infty y(n-1)z^{-n} &= \sum_{n=0}^{\infty}x(n)z^{-n} - \frac{1}{4}\sum_{n=0}^{\infty} x(n-1)z^{-n}
    	\\
    	Y(z) - \frac{1}{2}\sum_{k=-1}^{\infty} y(k)z^{-k-1}&= X(z)-\frac{1}{4}\sum_{k=-1}^{\infty}x(k)z^{-k-1}
    	\\ Y(z) - \frac{1}{2}z^{-1} \left(
    	\sum_{k=0}^{\infty} y(k)z^{-k} + zy(-1)
    	\right)
    	&= X(z)-\frac{1}{4}z^{-1}\left(
    	\sum_{k=0}^{\infty} x(k)z^{-k}+zx(-1)
    	\right) \\
    	\implies Y(z) \left[1-\frac{1}{2}z^{-1}\right] &= X(z)\left[
    	1-\frac{1}{4}z^{-1}
    	\right]+\frac{1}{2}\cancelto{1}{y(-1)}
    	\\
    	Y(z) &= X(z)\frac{1-\sfrac{1}{4}z^{-1} }{1-\sfrac{1}{2}z^{-1} } + \frac{\sfrac{1}{2}y(-1) }{1-\frac{1}{2}z^{-1}}
    	\\
    	Y(z) &= X(z)H(z) + \frac{1}{2}\frac{z}{z-\sfrac{1}{2} }
    	\\[2ex]
    	y(n) &=
    	\left[
    	\left(\frac{1}{2}\right)^n\frac{3}{2}-\left(\frac{1}{3}\right)^n\frac{1}{2}
    	\right]\mathrm{u}(n) + \underbrace{\frac{1}{2}\left(\frac{1}{2}\right)^n u(n)}_{\mathclap{\text{λόγω αρχικών συνθηκών}}}
    \end{align*}
    
    \item Επειδή απαντήσαμε στο προηγούμενο ερώτημα με τις ίδιες αρχικές συνθήκες, μπορούμε με ασφάλεια
    να απαντήσουμε ότι:
    \[
    y(n) = h(n) + \frac{1}{2}\left(\frac{1}{2}\right)^n \mathrm{u}(n)
    \]
	\end{enumpar}
\end{exercise}

\end{document}
