% !TeX program = xelatex
\documentclass[11pt,a4paper,notitlepage,fleqn,final]{article}

\input{preamble.tex}

\title{ΣΑΕ 2
	\\
	{ 
		\normalsize Συστήματα Αυτομάτου Ελέγχου II
		\\
		\normalsize Σημειώσεις από τις παραδόσεις\footnote{Όπως διδάσκονται στο τμήμα \textit{Ηλεκτρολόγων Μηχανικών και Μηχανικών Υπολογιστών} στο \textit{Αριστοτέλειο Πανεπιστήμιο Θεσσαλονίκης}.}
	}}
\date{Φεβρουάριος 2018
	\\
	{ 
		\small Τελευταία ενημέρωση: \today
	}
}
\author{
	Για τον κώδικα σε \LaTeX, ενημερώσεις και προτάσεις:
	\\
	\url{https://github.com/kongr45gpen/ece-notes}}

\setallmainfonts(Digits,Latin,Greek){Asana Math}
\setmainfont{Noto Serif}
\setsansfont{Ubuntu}
\usepackage{polyglossia}
\newfontfamily\greekfont[Script=Greek,Scale=1.00]{Liberation Serif}

\hypersetup{pdftitle = {ΣΑΕ 2}}


\begin{document}
\maketitle

\hrule
\vspace{50pt}

\begin{infobox}{Λάθη \& Διορθώσεις}
	Οι τελευταίες εκδόσεις των σημειώσεων βρίσκονται στο Github
	(\url{https://github.com/kongr45gpen/ece-notes/raw/master/sae2.pdf}) ή
	στη διεύθυνση \url{http://helit.org/ece-notes/sae2.pdf}.
	
	Περιέχουν διορθώσεις σε λάθη και τυχόν βελτιώσεις.
	
	\tcblower
	
	Μπορείτε να ενημερώνετε για οποιοδήποτε λάθος και πρόταση
	μέσω PM στο forum, issue στο Github, ή οποιουδήποτε άλλου τρόπου!
\end{infobox}
	
Το μάθημα περιλαμβάνει ένα μικρό προαιρετικό εργαστήριο. Η επιλογή γίνεται με βάση
προαιρετικής προόδου (μπαίνουν οι πρώτοι 18, εφ' όσον έχουν γράψει βαθμό \( \geq 6 \)).

Εφ' όσον δοθεί, η πρόοδος συμμετέχει κατά 25\% στον τελικό βαθμό
(και το υπόλοιπο 75\% στις εξετάσεις), για αυτούς που συμμετάσχουν
σε αυτήν. Διαφορετικά, μετράν οι εξετάσεις κατά 100\%. Το εργαστήριο μετράει προσθετικά
με μέγιστο βαθμό \( +3 \), εφ' όσον ο βαθμός της εξέτασης είναι από 4 και πάνω.

Αν δηλωθεί η πρόοδος, ο βαθμός της μετράει απαραίτητα όπως παραπάνω, και δεν υπάρχει δυνατότητα να
ακυρωθεί, ακόμα και αν ο φοιτητής δεν την παραδώσει.

\newpage

{
\hypersetup{linkcolor=black}
\listoflecture
\tableofcontents
}

\newpage
\lecture{1}{21/2/2018}
\subsection{Εισαγωγή}
Στα Συστήματα Αυτόματου Ελέγχου 2 οι αναλύσεις γίνονται στο πεδίο του \textbf{χρόνου}
και όχι της \textbf{συχνότητας}. Αυτό επιτρέπει να μελετηθούν συστήματα μη γραμμικά,
καθώς και συστήματα με περισσότερες από μία εισόδους και εξόδους.

Γενικότερα, τα ΣΑΕ έχουν εφαρμογές σε πολυάριθμους τομείς, όπως η αυτοκίνηση (φρένα
ABS, σύστημα πρόσφυσης, διατήρηση ευστάθειας σε πλαγιολίσθηση, \textellipsis), έλεγχος
κινητήρων, έλεγχος υπερμεγέθων τηλεσκοπίων, κατανομή πρόσβασης σε δίκτυα internet και
τηλεφωνικά, διαχείριση συστημάτων ενέργειας (για διανομή, ασφάλεια, αξιοπιστία, π.χ.
απόσβεση διαταραχών μετά από κεραυνό)\textellipsis

Θυμόμαστε ότι \textbf{\textit{σύστημα}} είναι οποιαδήποτε λειτουργική μονάδα που διεγείρεται
από κάποιες εισόδους, και επιστρέφει κάποιες εξόδους.

\begin{tikzpicture}
\draw (0,0) node[rectangle,draw,inner sep=15pt,minimum width=20pt] (r) {$S$};
\draw[<-] (r.west) -- ++(-2,0) node[above right] {είσοδος};
\draw[->] (r.east) -- ++(2,0) node[above left] {έξοδος};
\end{tikzpicture}

Ένα \textbf{ελεγχόμενο σύστημα} είναι τέτοιο ώστε να φροντίζουμε η έξοδος \( y \) να έχει μια
επιθυμητή τιμή \( r \), και το οποίο συχνά περιλαμβάνει και μια είσοδο διαταραχής
\( d \), που δεν μπορούμε να ελέγξουμε.

\begin{tikzpicture}
\draw (0,0) node[rectangle,draw,inner sep=15pt,minimum width=20pt] (r) {$S$};
\draw[<-] (r.west) ++ (0,-0.3) -- ++(-2,0) node[above right] {$u$};
\draw[<-] (r.west) ++ (0,0.3) -- ++(-2,0) node[above right] {$r$};
\draw[<-] (r.north) -- ++(0,1) node[midway,right] {$d(t)$};
\draw[->] (r.east) -- ++(2,0) node[above left] {$y$};
\end{tikzpicture}

Μια ακόμα χρήσιμη έννοια που μάθαμε είναι αυτή της ανάδρασης, στην οποία η έξοδος του συστήματος ανατροφοδοτείται στο σύστημα ως είσοδος, ίσως αφού περαστεί από έναν
ελεγκτή \( C \). Σε αυτά μπορούμε να προσθέσουμε μια μετρητική διάταξη \( M \) και έναν
ενεργοποιητή (actuator) που να μετατρέπει την έξοδο σε μορφή αποδεκτή από το σύστημα. Αυτά
είναι και τα \textbf{συστήματα κλειστού βρόχου}.

\begin{tikzpicture}
\draw (0,0) node[rectangle,draw,inner sep=15pt,minimum width=20pt] (r) {$S$};
\draw (-3,0) node[rectangle,draw,inner sep=10pt,minimum width=10pt] (c) {$C$};
\draw (-1.5,0) node[rectangle,draw,minimum height=30pt,minimum width=7pt] (e) {$E$};

\draw (-0.5,-1.5) node[rectangle,draw,minimum width=30pt,inner sep=8pt] (d) {$M$};

\draw[->] (e) -- (r) node[midway, above] {$u$};
\draw[->] (c) -- (e);
\draw[<-] (c.west) ++ (0,0.3) -- ++(-2,0) node[above right] {$r$};
\draw[<-] (r.north) -- ++(0,1) node[midway,right] {$d(t)$};
\draw[->] (r.east) -- ++(2,0) node[above left] {$y$} node[midway] (m) {};

\draw[->] (m.center) node[circ] {} |- (d) -- ++(-3.5,0) |- (c);
\end{tikzpicture}

Στόχος των μαθημάτων είναι ο σχεδιασμός του ελεγκτή \( C \) ώστε να ικανοποιούνται
συγκεκριμένες προδιαγραφές. Χρειάζεται βέβαια και μια διαισθητική κατανόηση των εννοιών.
Για παράδειγμα, αν έχουμε προδιαγραφή το σύστημα να έχει έξοδο \( 1 \) στη μόνιμη κατάσταση,
είναι προτιμότερο να φτάσει σε αυτήν με υπεραποσβεννύμενη απόκριση, παρά με ταλαντώσεις.

\begin{tikzpicture}[scale=.7]
\draw[->] (-0.5,0) -- (3,0) node[right] {$t$};
\draw[->] (0,-0.5) -- (0,3) node[left] {$y$};
\draw (0,0) node[below left,scale=.9] {$0$};

\def\h{2}

\draw[thick,timecolour]
plot [variable=\t,domain=0:3,samples=\lowsamples,smooth]
(\t,{\h*  (1-e^(-2*\t)  )});

\draw[thick,\timecolour!70!blue]
plot [variable=\t,domain=0:3,samples=\hisamples,smooth]
(\t,{\h*(1-1*exp(-3*\t)*cos(20*\t r))});

\draw[dashed] (3,\h) -- (0,\h) node[left] {$1$};
\end{tikzpicture}

Για τη \textbf{μοντελοποίηση} των συστημάτων μπορούμε είτε να υπολογίσουμε και να
αναλύσουμε τη φυσική λειτουργία του συστήματος, είτε να μελετήσουμε σύνολα εισόδων και
εξόδων ώστε να προβλέψουμε τη συμπεριφορά τους.

Στην πραγματικότητα βέβαια δεν θα μας δίνονται οι μαθηματικές προδιαγραφές, αλλά οι
φυσικές προδιαγραφές του συστήματος.

Υπάρχει μάλιστα η περίπτωση τα λειτουργικά κομμάτια των παραπάνω διατάξεων να μην
είναι συνδεδεμένα φυσικά μεταξύ τους, αλλά να βρίσκονται σε απόσταση, εισάγοντας
χρονικές καθυστερήσεις στη μεταφορά των σημάτων (π.χ. drones). Άλλα προβλήματα μπορεί
να είναι ο κβαντισμός των σημάτων (π.χ. για ασύρματη μεταφορά δεδομένων), περιορισμοί του
hardware ή του software.

\paragraph{Παράδειγμα}
Έστω ένα αυτοκίνητο μάζας \( m \) που κινείται σε δρόμο κλίσης \( \phi \) με ταχύτητα
\( y(t) \). Στο αυτοκίνητο ασκείται δύναμη οδήγησης \( u(t) \) και δύναμη του αέρα ανάλογη
με την ταχύτητα, με συντελεστή \( a \) (αεροδυναμικός συντελεστής).
Οι τριβές μεταξύ αυτοκινήτου και οδοστρώματος θεωρούνται αμελητέες.

Επιθυμούμε να σχεδιάσουμε έναν ελεγκτή \( u(t) \) που να ελέγχει τη δύναμη οδήγησης, ώστε
το αυτοκίνητο να κινείται με σταθερή ταχύτητα.

\subparagraph{Λύση}\hspace{0pt}

\begin{tikzpicture}
\def\ang{30}

\draw (0,0) -- (0:3) node [pos=.2] (a1) {};
\draw (0,0) -- (\ang:3.3) node[pos=.2] (a2) {} node [pos=.6] (bb) {};

\draw (bb) node[rectangle,draw,minimum height=5mm,minimum width=10mm,anchor=south,rotate=\ang] (b) {};

\draw[yellow!80!brown!50!black,thick,->] (b.center) -- ++(0,-0.7) node[below right] {$mg$};
\draw[yellow!80!brown!50!black,thick,->] (b.center) -- ++(\ang:1) node[above right] {$u(t)$};
\draw[yellow!10!brown!70!black,thick,->] (b.center) -- ++(180+\ang:1) node[left,scale=.8] {$ay(t)$};
\draw (b.center) node[circle,fill,inner sep=.6pt] {};

\draw[blue!50!green,->] (b.north east) ++ (\ang+90:0.4) --++(\ang:1) node[above,near end] {$y$};

\draw (a1.center) to[bend right] node[midway,yshift=1pt,right,scale=.9] {$\phi$} (a2.center);
\end{tikzpicture}

Από το νόμο του Νεύτωνα \( \sum F = m\dot y \) έχουμε:
\[
m\dot y = u - ay -mg\sin\phi
\]
δηλαδή φτάσαμε σε μία διαφορική εξίσωση που μοντελοποιεί το πρόβλημα.

Παρατηρούμε μάλιστα τον όρο \( \left[-mg\sin\phi\right] \), ο οποίος δεν εξαρτάται από μεταβλητές που
μπορούμε να επηρεάσουμε, αλλά μόνο από την κλίση του δρόμου, που πιθανώς αλλάζει. Δηλαδή
αποτελεί την \textbf{είσοδο διαταραχών}.

Η επιθυμητή έξοδος του συστήματος που δίνεται ως είσοδο είναι \( y(t) = r \), και εδώ
θεωρούμε για παράδειγμα ότι \( r = \SI{25}{\meter/\second} \).

\begin{itemize}
	\item Ισχυρίζομαι ότι μπορώ να λύσω το πρόβλημα \textbf{χωρίς κλειστό βρόχο}, δηλαδή
	χωρίς να φτάνει στον ελεγκτή \( C \) η έξοδος \( y \):
	\[
	u(t) = kr(t)
	\]
	
	Και για απλότητα στους υπολογισμούς θεωρώ \( \phi = 0 \).
	
	Τότε, από το παραπάνω μοντέλο του συστήματος, προκύπτει η διαφορική εξίσωση:
	\[
	m\dot y = -ay + k\cdot25
	\]
	με λύση:
	\[
	y(t) = 25\frac{k}{a}\left(
	1-e^{-\frac{a}{m} t}
	\right),\quad t\geq 0
	\]
	ή, αν επιλέξουμε το κέρδος του ελεγκτή να είναι \( k = a \), η ταχύτητα θα γίνει
	όντως \( \SI{25}{\meter/\second} \). Όμως ο χρόνος αποκατάστασης εξαρτάται από τα
	\( a \) και \( m \), που είναι παράμετροι του ελεγχόμενου συστήματος, και δεν μπορούν
	να επηρεαστούν. Δηλαδή ο ρυθμός με τον οποίο συγκλίνουμε στο 25 εξαρτάται μόνο από τις
	παραμέτρους του ελεγχόμενου συστήματος. Συνήθως έχουμε μεγάλη μάζα \( m \) για το
	αυτοκίνητο και μικρό αεροδυναμικό συντελεστή. Επομένως το πηλίκο \( \frac{a}{m} \) είναι
	μικρό και η απόκριση λογικά αργή.
	
	Ακόμα δεν είναι γνωστή τις περισσότερες φορές η τιμή του συντελεστή \( a \). Αν για
	παράδειγμα ανοίξουμε ένα παράθυρο, μεταβάλλεται ανάλογα με το πόσο το έχουμε ανοίξει.
	Γενικότερα στη διαδικασία της σχεδίασης \textbf{δεν μπορούμε να χρησιμοποιήσουμε
		μεγέθη που δεν είναι γνωστά}.
	
	Επίσης, στην περίπτωση που θεωρήσουμε ότι \( \phi \neq 0 \), η λύση θα προκύψει μετά
	από πράξεις:
	\[
	y(t) = \underbrace{\left(\frac{25k}{a} - \frac{mg\sin\phi}{a}\right)}_{\text{θέλουμε } = 25}
	\left(  1-e^{-\frac{a}{m} t} \right)
	\]
	επομένως:
	\[
	k = \frac{25a + mg\sin\phi}{25}
	\]
	το οποίο πάλι δεν μπορεί να υπολογιστεί εύκολα, αφού η κλίση του δρόμου \( \phi \) κάθε
	φορά δεν είναι γνωστή.
	\item Χρησιμοποιούμε \textbf{αναλογικό ελεγκτή κλειστού βρόχου}:
	\[
	u(t) = k \cdot \Big( r(t) - y(t) \Big), \qquad k > 0 
	\]
	
	Τότε η λύση της διαφορικής εξίσωσης θα προκύψει, μετά από πράξεις:
	\[
	y(t) = \left(
	\frac{25k - mg\sin\phi}{a+k}
	\right)\left( 1-e^{-\left(\frac{a+k}{m}\right)t} \right)
	\]
	
	Όσο μεγαλώνουμε το \( k \), ο παράγοντας στον εκθέτη αυξάνεται, άρα μεγαλώνει η ταχύτητα
	σύγκλισης στη μόνιμη τιμή. Όσον αφορά τον πρώτο όρο, για \( k \) που φτάνει στο
	\( \infty \), έχουμε:
	\[
	\lim_{k \to \infty} \left( \frac{mg\sin\phi}{a+k} \right) = 0
	\]
	και ο πρώτος όρος γίνεται 25.
	
	Η μικρή διαφορά που υπάρχει για πεπερασμένες τιμές του \( k \) είναι ουσιαστικά το
	σφάλμα θέσης, που μπορούμε να εξαλείψουμε με έναν ολοκληρωτή.
\end{itemize}

\lecture{2}{28/2/2018}

\subsection{Μοντελοποίηση Συστημάτων}
Η μοντελοποίηση συστημάτων, όπως αναφέραμε σε μια παράγραφο παραπάνω, γίνεται είτε με
φυσική μελέτη του συστήματος, είτε μελετώντας μερικές σχέσεις εισόδου-εξόδου, και εξάγοντας
συμπεράσματα από αυτές. Το αντικείμενο της μοντελοποίησης μελετάται εκτενώς σε μάθημα
επόμενου εξαμήνου, και εδώ θα κάνουμε μια εισαγωγή.

Τα πραγματικά συστήματα είναι από τη φύση τους πολύπλοκα, και επομένως ένα μοντέλο θα εισάγει
σχεδόν πάντα ένα \textbf{σφάλμα}. Το \textbf{σφάλμα μοντελοποίησης} \( e \) εκφράζει τη
διαφορά της τιμής \( \hat y \) που εξάγει το μοντέλο, από την τιμή \( y \) που εξάγει το
πραγματικό σύστημα.

\begin{circuitikz}
	\tikzstyle{system}=[rectangle,draw,minimum height=9mm,align=center,minimum width=32mm]
	\draw (0,0) node[system] (rs) {Πραγματικό\\Σύστημα};
	\draw (rs.north) node[system,anchor=south,yshift=10pt] (ms) {Μοντέλο};
	
	\draw[<-] (rs.west) -- ++(-1.5,0) node (sp) {} node[midway] (spm) {};
	\draw[->] (spm.center) |- (ms);
	
	\draw[->] (ms.east) node[above right] {$\hat y$} -- ++(2,0) node[midway] (ap1) {};
	\draw[->] (rs.east) node[below right] {$y$} -- ++(2,0) node[midway] (ap2) {};
	\path (ap1) -- (ap2) node[midway,circle,draw,inner sep=5pt] (sum) {};
	\draw[->] (ap1.center) -- (sum.north) node[above right,yshift=-2pt] {$+$};
	\draw[->] (ap2.center) -- (sum.south) node[below right,yshift=2pt] {$-$};
	\draw[->] (sum) -- ++ (1,0) node[midway,above] {$e$};
\end{circuitikz}

Στόχος της μοντελοποίησης είναι η ελαχιστοποίηση αυτού του σφάλματος, το οποίο εκφράζεται
μέσα από την προδιαγραφή της ακρίβειας.

Για παράδειγμα, μπορεί να θέλουμε να προσεγγίσουμε την έξοδο ενός πραγματικού συστήματος
σε μια "επικίνδυνη" είσοδο, την οποία είναι δύσκολο να εφαρμόσουμε στην πραγματικότητα,
αλλά εύκολο να θεωρήσουμε ως είσοδο στο μοντέλο.

Για τη μελέτη των συστημάτων χρησιμοποιούμε τις \textbf{μεταβλητές κατάστασης}, δηλαδή
τις μεταβλητές που είναι απαραίτητο να γνωρίζουμε για να περιγράψουμε πλήρως τη λειτουργία
του συστήματος. Ο ορισμός αυτός προέκυψε από τη μελέτη της κίνησης των πλανητών, η οποία
μπορεί να περιγραφεί από τη θέση και την ταχύτητα του καθενός.

Το σύνολο των τιμών των μεταβλητών κατάστασης ονομάζεται \textbf{σύνολο καταστάσεων}, και
κάθε τιμή (ή διάνυσμα καταστάσεων) ονομάζεται \textbf{κατάσταση}.

\paragraph{Παράδειγμα}
\phantomsection
Θεωρούμε ένα φυσικό σύστημα με ένα ελατήριο \( k \) και έναν αποσβεστήρα \( c \). Ασκούμε και
μία δύναμη \( u \). Σε αυτό θεωρούμε ότι η μεταβλητή \( q \) εκφράζει τη θέση του
σώματος. Τότε η χρονική παράγωγός της, \( \dot q \), εκφράζει την ταχύτητα του σώματος.
\label{sec:physical_ex0}


\begin{circuitikz}
	\fill[postaction={decorate},pattern=north east lines] (0,3) rectangle (-0.5,-0.5) rectangle (5,0);
	
	\draw (2,0) rectangle ++(2,2) node[midway] {$m$} node[midway] (m) {};
	
	\draw (2,1.6) to[damper,l_=$c(\dot q)$,invert] ++(-2,0);
	\draw (2,0.4) to[spring,invert,l_=\raisebox{-1.5ex}{$k$}] ++(-2,0);
	
	\draw[thick] (0,3) |- (5,0);
	
	\draw[->] (m) ++ (0,1.4) |- ++(2,0.7) node[above,pos=.75,gray] {$q$};
\end{circuitikz}

Από το θεμελιώδη νόμο της μηχανικής (2\textsuperscript{ος} Νόμος Νεύτωνα):
\[
m\ddot q = -c(\dot q) - kq + u
\]
δηλαδή το \textbf{μοντέλο} του συστήματος είναι το:
\[
m\ddot q + c(\dot q) + kq = u
\]
Το σύστημα αυτό είναι αυτόνομο. Αν είχαμε κάποια εξωτερική δύναμη, θα ήταν μη αυτόνομο.
\begin{defn}{Αυτόνομα συστήματα}{}
	Συστήματα στα οποία \textbf{δεν} ενεργούν \textbf{εξωτερικές δυνάμεις} ονομάζονται
	\textbf{αυτόνομα}.
	
	Συστήματα στα οποία ενεργούν \textbf{εξωτερικές δυνάμεις}, οι οποίες λειτουργούν ως
	είσοδοι και μπορούμε να τις μεταβάλλουμε ώστε να αλλάξει η δυναμική συμπεριφορά του
	συστήματος, ονομάζονται \textbf{μη αυτόνομα}.
\end{defn}

\begin{defn}{Εξισώσεις κατάστασης}{}
	Γενικότερα, για τα συστήματά μας θα προκύπτει μία εξίσωση:
	\[
	F\left(
	q^{(n)},\ q^{(n-1)},\ \dots,\ \dot q,\ q,\ u
	\right) = 0
	\]
	
	Αυτή είναι διαφορική εξίσωση \textbf{τάξης \( n \)}, και μπορεί να αναλυθεί σε
	επιμέρους απλούστερες διαφορικές εξισώσεις της μορφής:
	\[
	\boxed{\begin{aligned}
		\dot x &= f(x,u) \\
		y &= h(x,u)
		\end{aligned}}
	\text{ όπου }\begin{aligned}
		x \in \mathbb R^n\ &\text{το \textbf{διάνυσμα μεταβλητών κατάστασης}},\\
		u \quad&\text{η \textbf{είσοδος του συστήματος}},\\
		y \quad&\text{η \textbf{έξοδος του συστήματος}},\\
		q \quad&\text{μία \textbf{μεταβλητή κατάστασης} ή άλλη παράμετρος του συστήματος}
		\end{aligned}
	\]
	
	Οι παραπάνω εξισώσεις εκφράζουν για κάθε στιγμή τη σχέση των μεταβλητών κατάστασης,
	και ονομάζονται \textbf{εξισώσεις κατάστασης}.
\end{defn}

Η λύση του προβλήματος μπορεί να προκύψει από οποιαδήποτε επιλογή μεταβλητών κατάστασης. Οι
δυνατές επιλογές όμως είναι άπειρες. Στα παρακάτω παραδείγματα προτείνουμε επιλογές που
θα επιστρέφουν σίγουρα αποτέλεσμα, αν και ίσως θα οδηγούμαστε εκεί με πιο αργό τρόπο.


\paragraph{Παράδειγμα}
\label{sec:nontd_system}
Έστω ένα σύστημα του οποίου η περιγραφή εκφράζεται από τον τύπο:
\begin{equation}
y^{(n)} + a_1y^{(n-1)} + a_2y^{(n-2)} + \dots + a_{n-1}\dot y + a_n y = u
\label{eq:nontd_system}
\end{equation}
όπου \( u\in\mathbb R  \) η είσοδος και \( y\in\mathbb R  \) η έξοδος του συστήματος.

Εδώ παρατηρούμε ότι οι σταθερές \( a_i \) \textbf{δεν εξαρτώνται} από το \textbf{χρόνο}.

\textbf{Επιλέγουμε} να ορίσουμε τις μεταβλητές κατάστασης
\( (x_1,\ x_2,\dots,\ x_n) \) ως τις παραγώγους της εξόδου.
Η συγκεκριμένη επιλογή δουλεύει καλά:
\begin{align*}
	x_1 &= y \\
	x_2 &= \dot y \\
	&\vdots \\
	x_n &= y^{(n-1)}
\end{align*}

Η δυσκολία αλλά και ο στόχος που θέλουμε να πετύχουμε είναι η \textbf{εύρεση των \( n \) εξισώσεων κατάστασης} με βάση τις παραπάνω μεταβλητές. Εδώ παρατηρούμε ότι:
\begin{align*}
	\dot x_1 &= \dot y = x_2\\
	\dot x_2 &= \ddot y = x_3 \\
	&\vdots \\
	\dot x_{n-1} &= x_n
\end{align*}
και από την αρχική Διαφορική Εξίσωση \eqref{eq:nontd_system} έχουμε:
\[
\dot x_n = -a_1x_n -a_2x_{n-1} - \dots - a_{n-1}x_2 -a_nx_1 + u
\]
δηλαδή το σύνολο των εξισώσεων κατάστασης είναι:
\begin{align*}
\dot x_1 &= x_2\\
\dot x_2 &= x_3 \\
&\vdots \\
\dot x_{n-1} &= x_n\\
\dot x_n &= -a_1x_n -a_2x_{n-1} - \dots - a_{n-1}x_2 -a_nx_1 + u
\end{align*}

Σε \textbf{μορφή πίνακα}, οι \textbf{μεταβλητές κατάστασης} είναι:
\[
\dot X = \left[\begin{matrix}
\dot x_1 \\ \dot x_2 \\ \vdots \\ \dot x_n
\end{matrix}\right] = \left[
\begin{matrix}
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & 0\\
0 & 0 & 0 & \cdots & 1 \\
-a_n & - a_{n-1} & - a_{n-2} & \cdots & -a_1
\end{matrix}
\right] \left[\begin{matrix}
x_1 \\  x_2 \\ \vdots \\ x_{n-1} \\ x_n
\end{matrix}\right]
+ \left[\begin{matrix}
0\\0\\\vdots\\0\\1
\end{matrix}\right]u
\]
και η \textbf{έξοδος} του συστήματος προκύπτει από:
\[
y= \left[\begin{matrix}
1 & 0 & 0 & \cdots & 0
\end{matrix}\right]\left[\begin{matrix}
x_1\\x_2\\\vdots\\x_n
\end{matrix}\right]
\]

\paragraph{Παράδειγμα με μεγαλύτερη τάξη εξόδου}
\phantomsection
\label{sec:nontd_highorder_system}
Έστω το σύστημα:
\[
y^{(n)} + a_1y^{(n-1)} + a_2y^{(n-2)} + \dots + a_{n-1}\dot y + a_n y =
b_0 u^{(n)} + b_1u^{(n-1)} + \dots + b_{n-1}\dot u + b_n u
\label{eq:nontd_highorder_system}
\]

Υπενθυμίζουμε ότι σκοπός είναι να βρούμε ένα σύνολο μεταβλητών κατάστασης που μπορούν
να παράγουν διαφορικές εξισώσεις που μπορούν να λυθούν, ώστε να περιγραφεί η λειτουργία του
συστήματος.

\begin{itemize}
	\item Έστω ότι ακολουθούμε την προσέγγιση του προηγούμενου παραδείγματος, δηλαδή οι
	μεταβλητές κατάστασης είναι:
	\begin{align*}
	x_1 &= y \\
	x_2 &= \dot y \\
	&\vdots \\
	x_n &= y^{(n-1)}
	\end{align*}
	
	Με λύση:
	\begin{align*}
	\dot x_1 &= \dot y = x_2\\
	\dot x_2 &= \ddot y = x_3 \\
	&\vdots \\
	\dot x_{n-1} &= x_n\\
	\dot x_n &= -a_1x_n -a_2x_{n-1} - \dots - a_{n-1}x_2 -a_nx_1 + b_0 u^{(n)} + b_1u^{(n-1)} + \dots + b_{n-1}\dot u + b_n u
	\end{align*}

     Η παραπάνω λύση είναι σωστή, όμως απαιτεί τη γνώση \textbf{παραγώγων υψηλής τάξης} της
     εισόδου \( u \), κάτι το οποίο ιδιαίτερα στα πραγματικά ΣΑΕ δεν μπορεί να υπολογιστεί,
     επειδή απαιτούνται οι μελλοντικές τιμές του συστήματος.
     \item Μία άλλη λύση που προτείνουμε είναι να \textbf{επιλέξουμε}:
     \begin{alignat*}{2}
     	x_1 &= y - \beta_0 u && \\
     	x_2 &= \dot x_1 - \beta_1 u &&= \dot y - \beta_0\dot u - \beta_1u \\
     	&\vdots && \\
     	x_n &= \dot{x_{n-1}} - \beta_{n-1}u
     	&&= y^{(n-1)} - \beta_0u^{(n-1)} - \dots - \beta_{n-2}\dot u - \beta_{n-1}u
     \end{alignat*}
     
     Οι όροι \( \beta_i \) δεν είναι ίδιοι με τους \( b_i \), αλλά ορίζονται ως εξής:
     \begin{align*}
     	\beta_0 &= b_0 \\
     	\beta_1 &= b_1 - a_1\beta_0\\
     	\beta_2 &= b_2 - a_1\beta_1 - a_2\beta_0\\
     	&\vdots\\
     	\beta_n &= b_n - a_1\beta_{n-1}-\dots - a_{n-1}\beta_1 - a_n\beta_0
     \end{align*}
     
     Το παραπάνω σύστημα μπορεί να λυθεί, και αποδεικνύεται ότι η κάθε εξίσωση περιέχει
     την είσοδο \( u \) χωρίς να είναι σε παράγωγο.
\end{itemize}

\begin{exercise}[Παράδειγμα]
	Στο παράδειγμα με το φυσικό σύστημα της προηγούμενης παραγράφου (\autoref{sec:physical_ex0}):
	\[
	m\ddot q + c\dot q + kq = u
	\]
	\tcblower
	Η παραπάνω εξίσωση είναι η \textbf{διαφορική εξίσωση του συστήματος}.
	
	Δεν εμφανίζονται ανώτερες παράγωγοι της εισόδου άρα χρησιμοποιούμε την απλή έκφραση
	από επάνω (\autoref{sec:nontd_system}).
	
	Η τάξη της εξίσωσης είναι \textbf{2}, άρα έχουμε \textbf{μόνο 2} μεταβλητές κατάστασης.
	Σύμφωνα με την παράγραφο \autoref{sec:nontd_system}, επιλέγουμε:
	\begin{alignat*}{4}
		x_1 &=q \qquad && \dot x_1&&=x_2 \\
		x_2&=\dot q \qquad && \dot x_2 &&= -\frac{c}{m}x_2 - \frac{k}{m}x_1
		+ \frac{1}{m}u
	\end{alignat*}
	ή, σε μορφή πίνακα:
	\begin{align*}
		\dot x &= \left[\begin{matrix}
		0 & 1 \\ -\frac{k}{m} & -\frac{c}{m}
		\end{matrix}\right]\left[\begin{matrix}
		x_1\\x_2
		\end{matrix}
		\right]+\left[\begin{matrix}
		0\\ \frac{1}{m}
		\end{matrix}\right]u\\
		y &= \left[\begin{matrix}
		1 & 0
		\end{matrix}\right]\left[\begin{matrix}
		x_1 \\ x_2
		\end{matrix}\right]
	\end{align*}
\end{exercise}
\begin{exercise}[Παράδειγμα]
	Να γραφούν οι εξισώσεις κατάστασης του κυκλώματος:
	
	\begin{circuitikz}[american]
		\draw (0,0) to[V=$v_s(t)$] (0,2)
		to[R=$R$,i>^=$i$] (2,2)
		to[cute inductor=$L$] (4,2)
		to[C=$C$] (4,0)
		-- (0,0)
		;
	\end{circuitikz}
	
	\tcblower
	Λύνουμε το σύστημα με βάση τη φυσική του (νόμοι Kirchoff)
	\begin{align*}
		u_s(t) &=
		iR + L\od{i}{t} + \frac{1}{C} \int_{0}^{t} i \dif\tau
		\numberthis
		\label{eq:ex0ceq}
		\\
		L\od[2]{i}{t} + R\od{i}{t} + \frac{1}{C} i &= \od{u_s(t)}{t}
	\end{align*}
	
	Η είσοδος του συστήματος είναι η ανεξάρτητη τροφοδοσία \( u_s(t) \), και η έξοδος
	το ρεύμα \( i \), δηλαδή:
	\begin{align*}
		u &= u_s(t) \\
		y &= i
	\end{align*}
	άρα η τελευταία διαφορική εξίσωση γράφεται απλούστερα:
	\[
	\ddot y + \frac{R}{L}\dot y + \frac{1}{CL} y = \frac{1}{L} \dot u
	= 0\ddot u + \frac{1}{L}\dot u + 0u
	\]
	
	Αφού η είσοδος \( u \) είναι ανώτερης τάξης στη διαφορική αυτή, επιλέγουμε τις μεταβλητές
	κατάστασης με βάση την παράγραφο \autoref{sec:nontd_highorder_system}:
	\begin{alignat*}{2}
		x_1 &= y-\beta_0u,\qquad && \beta_0 = 0\\
		x_2 &= \dot y-\beta_0 \dot u -\beta_1 u,\qquad && \beta_1 = \frac{1}{L}
	\end{alignat*}
	και εκτελώντας πράξεις:
	\begin{align*}
		x_1 = y &\implies \boxed{\dot x_1 = x_2 + \frac{1}{L}u} \\
		x_2 = \dot x_1 - \beta_1 u \implies \dot x_2 = \ddot y - \frac{1}{L}\dot u
		&\implies \dot x_2 = -\frac{R}{L}\dot y-\frac{1}{LC}y + \frac{1}{L}\dot u
			- \frac{1}{L} \dot u  \implies \\
		&\implies\boxed{\dot x_2 = -\frac{R}{L}x_2 - \frac{R}{L^2}u-\frac{1}{LC}x}\\
		\boxed{y=x_1}&
	\end{align*}
	
	\lecture{3}{2/3/2018}
	\paragraph{Με διαφορετική επιλογή μεταβλητών κατάστασης}
	Στην παραπάνω λύση διαλέξαμε τις μεταβλητές κατάστασης όπως γνωρίζαμε από τη θεωρία
	των ΣΑΕ, οι οποίες οδήγησαν σε ένα αποτέλεσμα, αλλά με αρκετές πράξεις.
	
	Εναλλακτικά, μπορούμε να διαλέξουμε διαφορετικές μεταβλητές κατάστασης. Στο συγκεκριμένο
	πρόβλημα, επειδή ασχολούμαστε με ένα ηλεκτρικό κύκλωμα, επιλέγουμε τις \textbf{τυπικές
		μεταβλητές} που αντιστοιχούν στην \textbf{τάση του πυκνωτή} \( x_1 \) και στο
	\textbf{ρεύμα του πηνίου} \( x_2 \):
	\begin{align*}
		x_1 &= \frac{1}{C} \int_{0}^{t} i\dif t\\
		x_2 &= i \implies \dot x_2 = \od{i}{t}
	\end{align*}
	και από αυτά προκύπτει ότι:
	\begin{align*}
		\dot x_1 &= \frac{1}{C} x_2\\
		\dot x_2 &= \frac{x_1-x_2 R}{L} \qquad \text{λόγω της \eqref{eq:ex0ceq}}
	\end{align*}
\end{exercise}

\begin{exercise}
	Έστω το μηχανικό σύστημα:
	
	\begin{circuitikz}
		\fill[postaction={decorate},pattern=north east lines] (0,3) rectangle (-0.5,-0.5) rectangle (10,0);
		
		\draw (2,0) rectangle ++(2,2) node[midway] {$M_2$} node[midway] (m2) {};
		\draw (6,0) rectangle ++(2,2) node[midway] {$M_1$} node[midway] (m1) {};
		
		\draw (2,0.4) to[damper,l_=$c_2$,invert] ++(-2,0);
		\draw (2,1.6) to[spring,invert,l_=\raisebox{-1.5ex}{$k_2$}] ++(-2,0);
		\draw (6,0.4) to[damper,l_=$c_1$,invert] ++(-2,0);
		\draw (6,1.6) to[spring,invert,l_=\raisebox{-1.5ex}{$k_1$}] ++(-2,0);
		
		\draw[thick,->] (8,1) -- ++(1.5,0) node[right] {$u$};
		
		\draw[thick] (0,3) |- (10,0);
		
		\draw[->] (m2) ++ (0,1.4) |- ++(2,0.7) node[above,pos=.75,gray] {$q_2$};
		\draw[->] (m1) ++ (0,1.4) |- ++(2,0.7) node[above,pos=.75,gray] {$q_1$};
	\end{circuitikz}
	
	Να βρεθούν οι εξισώσεις κατάστασης, θεωρώντας ότι η έξοδος είναι η μετατόπιση του δεξιού
	σώματος, δηλαδή:
	\[
	y= q_1
	\]
	
	\tcblower
	
	Εφαρμόζοντας το νόμο του Νεύτωνα για κάθε σώμα, και αθροίζοντας τις δυνάμεις που
	ασκούνται στο καθένα, έχουμε:
	\begin{align}
		M_1\ddot q_1 &= u - k_1(q_1-q_2) - c_1(\dot q_1 - \dot q_2) 
		\label{eq:ex0eq1}
		\\
		M_2\ddot q_2 &= -k_1(q_2-q_1) - c_1(\dot q_2 - \dot q_1)-k_2q_2-c_2\dot q_2
		\label{eq:ex0eq2}
	\end{align}
	
	Το σύστημα αυτό είναι \textbf{4\textsuperscript{ης}} τάξης και 1\textsuperscript{ου}
	βαθμού, αφού έχουμε 2 εξισώσεις 2\textsuperscript{ης} τάξης. Επομένως πρέπει να βρούμε
	4 μεταβλητές και εξισώσεις κατάστασης.
	
	Λαμβάνουμε τις μεταβλητές κατάστασης με βάση τη θεωρία:
	\[
	x_1 = q_1, \hfill x_2=\dot q_1, \hfill x_3=q_2,\hfill x_4=\dot q_2
	\]
	οπότε, πιο καθαρά:
	\begin{align*}
		\dot x_1 &= x_2 \\
		\dot x_2 &= \frac{1}{M_1}u - \frac{k_1}{M_1}x_3
		+ \frac{k_1}{M_1}x_2 + \frac{C_1}{M_1}x_4
		\quad \text{(όπως προκύπτει από την \eqref{eq:ex0eq1})} \\
		\dot x_3 &= x_4\\
		\dot x_4 &= -\frac{k_1}{M_2}x_3 + \frac{k_1}{M_2}x_1 - \frac{c_1}{M_2}x_4
	    + \frac{c_1}{M_2}x_2 - \frac{k_2}{M_2}x_3 - \frac{c_2}{M_2}x_4
	    \quad \text{(όπως προκύπτει από την \eqref{eq:ex0eq2})}
	\end{align*}
	
	Σε μορφή πίνακα:
	\[
	\dot x = \left[\begin{matrix}
	0 & 1 & 0 & 0\\
	-\frac{k_1}{M_1} & -\frac{c_1}{M_1} & \frac{k_1}{M_1} & \frac{c_1}{M_1}\\
	0 & 0 & 0 & 1\\
	\frac{k_1}{M_2} & \frac{c_1}{M_2} & -\left(\frac{k_1+k_2}{M_2}\right)
	& -\left(\frac{c_1+c_2}{M_2}\right)
	\end{matrix}\right]\left[\begin{matrix}
	x_1 \\ x_2 \\ x_3 \\ x_4
	\end{matrix}\right] + \left[
	\begin{matrix}
	0 \\ \sfrac{1}{M_1} \\ 0 \\ 0
	\end{matrix}
	\right]u
	\]
\end{exercise}

\subsubsection{Μετασχηματισμός Laplace}
Θυμόμαστε μια υτυπική έκφραση ενός συστήματος συστήματος:
\[
y^{(n)} + a_1y^{(n-1)} + a_2y^{(n-2)} + \dots + a_{n-1}\dot y + a_n y =
b_0 u^{(n)} + b_1u^{(n-1)} + \dots + b_{n-1}\dot u + b_n u
\]

Αυτή μπορεί να μετασχηματιστεί κατά Laplace, όπως γνωρίζουμε:
\[
\left(
s^n + a_1s^{n-1} + \dots + a_{n-1}s + a_n
\right)Y(s) = \left(
b_0s^m = b_1s^{m-1} + \dots + b_{m-1}s+b_m
\right)U(s)
\]
και η \textbf{συνάρτηση μεταφοράς} προκύπτει κατά τα γνωστά:
\[
\frac{Y(s)}{U(s)} = \frac{
	b_0s^m = b_1s^{m-1} + \dots + b_{m-1}s+b_m
	}{
	s^n + a_1s^{n-1} + \dots + a_{n-1}s + a_n
	}
\] όπου συνήθως \( n \geq m \).

Προκύπτει το ερώτημα του πώς μπορεί να προκύψει η συνάρτηση μεταφοράς από τις εξισώσεις
κατάστασης, δηλαδή από την περιγραφή (σε μορφή πινάκων):
\begin{align*}
\dot x &= Ax	+ By\\
y &= Cx + Du
\end{align*}
όπου οι συντελεστές \( A,B,C,D \) είναι γνωστοί.

Μετασχηματίζοντας τις παραπάνω σχέσεις κατά Laplace, έχουμε:
\begin{align*}
	sX(s) &= AX(s) + BU(s) \\
	Y(s) &= CX(s) + DU(s)
\end{align*}

Εκτελούμε πράξεις:
\begin{align*}
	(sI-A)X(s) &= BU(s) \implies \\
	X(s) &= (sI-A)^{-1} B U(s) \implies \\
	Y(s) &= \left[ C(sI-A)^{-1}B+D \right]U(s)
\end{align*}
δηλαδή η συνάρτηση μεταφοράς προκύπτει από τον τύπο:
\[
\boxed{
	G(s) = \frac{Y(s)}{U(s)} = C(sI-A)^{-1}B+D
	}
\]

Ο υπολογισμός της συνάρτησης μεταφοράς μπορεί να φανεί χρήσιμος ανάλογα με τον τρόπο με
τον οποίο θέλουμε να λύσουμε ένα πρόβλημα. Για παράδειγμα, μπορεί να εφαρμοστεί αν θέλουμε
να εκμεταλλευτούμε τεχνικές του προηγούμενου εξαμήνου (π.χ. γεωμετρικός τόπος ριζών).

Υπενθυμίζουμε ότι σε ένα σύστημα αντιστοιχεί μία μοναδική διαφορική εξίσωση και μία μοναδική
συνάρτηση μεταφοράς, αλλά άπειρες διαφορετικές επιλογές μεταβλητών και εξισώσεων κατάστασης.

\subsubsection{Αριθμητική επίλυση διαφορικών εξισώσεων}
Για την αριθμητική επίλυση των διαφορικών εξισώσεων μπορούμε να χρησιμοποιήσουμε μια μέθοδο
όπως η \textbf{μέθοδος Euler}, προσομοιώνοντας ουσιαστικά το μοντέλο του συστήματος.
Εκμεταλλευόμαστε τον ορισμό της παραγώγου:
\[
\dot x = \frac{x(t+\Delta t) - x(t)}{\Delta(t)}
\]

Ορίζουμε μια συνάρτηση που εκφράζει την παράγωγο:
\[
\dot x = f(x)
\]
επομένως:
\[
x(t+\Delta t) = f\left( x(t) \right) \cdot \Delta t + x(t)
\]
όπως προκύπτει από τον ορισμό της παραγώγου.

Για μικρό \( \Delta t \) η μέθοδος αυτή οδηγεί στο επιθυμητό αποτέλεσμα.

\subsubsection{Μελέτη Ευστάθειας Συστήματος}
Θα μελετήσουμε \textbf{τρόπους εύρεσης της ευστάθειας} ενός συστήματος, οι οποίες όμως δεν απαιτούν
προσομοίωση ή αναλυτική επίλυση.

Ο λόγος που δεν μπορούμε να εφαρμόσουμε αναλυτική επίλυση, είναι ότι πολλές φορές είναι
δύσκολη η επίλυση των διαφορικών εξισώσεων που περιγράφουν τα συστήματα, ιδιαίτερα αν είναι
μη γραμμικές.

Από την άλλη μεριά, η προσομοίωση λειτουργεί μόνο για μία επιλογή αρχικών τιμών. Μπορεί να
δώσει ενδείξεις ευστάθειας, αλλά όχι να την αποδείξει για όλο το εύρος των άπειρων αρχικών
συνθηκών.

Πρέπει επομένως να βρούμε τρόπους να \textit{αποδείξουμε} την ευστάθεια ή μη ενός συστήματος,
η οποία να μην βασίζεται απλώς στην εμπειρία μας.

\paragraph{Παράδειγμα}
Έστω το σύστημα:
\[
\dot x = \left[\begin{matrix}
\dot x_1\\ \dot x_2
\end{matrix}\right] = \left[\begin{matrix}
x_2 \\ -\frac{c}{m}x_2 - \frac{k}{m}x_1
\end{matrix}\right] = f(x)
\]
το οποίο αναφέρεται σε ένα σώμα μάζας \( m \) που κινείται με την επίδραση ενός ελατηρίου
\( k \) και ενός αποσβεστήρα \( c \).

Η \textbf{ενέργεια} του συστήματος, όπως προκύπτει από τις γνώσεις μας στη φυσική, είναι:
\[
V(x_1,x_2) =
\underbrace{\frac{1}{2}kx_1^2}_{\mathclap{\text{Δυναμική Εν.}}}
\quad +\quad
\underbrace{\frac{1}{2}mx_2^2}_{\mathclap{\text{Κινητική Εν.}}}
\]

Αν την παραγωγίσουμε, έχουμε:
\begin{align*}
	\dot V &=
	kx_1\dot x_1 + mx_2\dot x_2 \\
	&= kx_1x_2 + mx_2 \left(
	-\frac{c}{m}x_2 - \frac{k}{m}x_1
	\right)
	\\ &= kx_1x_2 - cx_2^2 - kx_1x_2
	\\ &= -cx_2^2 \quad \leq 0
\end{align*}
δηλαδή παρατηρούμε ότι η \textbf{παράγωγος} της ενέργειας είναι \textbf{αρνητική}, άρα η ενέργεια του
συστήματος σχεδόν κάθε στιγμή μειώνεται (φθίνουσα)! Αυτό μπορούμε να το αντιληφθούμε αφού στο σύστημα δεν
ασκούνται εξωτερικές δυνάμεις, και εκτελεί κάποια ταλάντωση με μια απόσβαση που συνεχώς
αφαιρεί ενέργεια.

Δηλαδή κάθε στιγμή η ενέργεια είναι μικρότερη από την αρχική
\( V\left( x_1(0),\ x_2(0) \right) \):
\[
	V\left( x_1(0),\ x_2(0) \right) \geq \frac{1}{2}k x_1^2
	+ \frac{1}{2}mx_2^2
\]

Αυθαίρετα κρατάμε μόνο τον έναν όρο της παραπάνω σχέσης:
\begin{align*}
	V\left( x_1(0),\ x_2(0) \right) &\geq \frac{1}{2}k x_1^2 \implies \\
	\frac{1}{2}kx_1^2(0) + \frac{1}{2}mx_2^2(0) &\geq \frac{1}{2}kx_1^2
	\implies \boxed{
		x_1(t) \leq \sqrt{x_1^2(0) + \frac{m}{k}x_2^2(0)}
		}\quad \forall t \geq 0
\end{align*}
ή, αν κρατήσουμε τον άλλον όρο:
\begin{align*}
V\left( x_1(0),\ x_2(0) \right) &\geq \frac{1}{2}m x_x^2 \implies \\
\frac{1}{2}kx_1^2(0) + \frac{1}{2}mx_2^2(0) &\geq \frac{1}{2}mx_2^2
\implies \boxed{
	x_2(t) \leq \sqrt{\frac{k}{m}x_1^2(0) + x_2^2(0)}
}\quad \forall t \geq 0
\end{align*}

Παρατηρούμε δηλαδή ότι οι μεταβλητές κατάστασης είναι \textbf{φραγμένες}, δηλαδή δεν ξεπερνούν κάποια τιμή, το οποίο δηλώνει ευστάθεια του συστήματος, αφού δεν φτάνουν μέχρι
το \( \infty \).

\paragraph{}
Παραπάνω είδαμε ένα πρόβλημα στο οποίο \( \dot V(x_1,x_2) \leq 0 \). Η δυνατότητα ισότητας
(\( \leq \)) με το 0 δηλώνει ότι η συνάρτηση είναι απλά \textit{φθίνουσα}, και όχι
\textit{γνησίως φθίνουσα}, που σημαίνει ότι υπάρχουν διαστήματα στα οποία η παράγωγος
της ενέργειας είναι 0, και η ενέργεια παραμένει σταθερή χωρίς να μειώνεται. Έστω ένα τέτοιο
διάστημα στο παραπάνω σύστημα:
\[
\dot V(x_1,x_2) = 0
\xRightarrow{\dot V = -cx_2^2 \leq 0}
x_2 = 0
\xRightarrow[\dot x_2 = -\frac{c}{m} x_2 - \frac{k}{m} x_1]{\text{εξ. κατάστασης}}
x_1 = 0
\]

\begin{exercise}
	Έστω ένα ποδήλατο σε κάτοψη (το κοιτάμε από πάνω):
	
	\begin{circuitikz}
		\def\rightsize{0.2}
		\def\rang{9}
		
		\draw (0,5) |- (5,0);
		
		\draw[gray,mark position=0.8(d1),mark position=0.3(d1m)] (2,2) ++ (-45:0.1) -- ++(-45:2);
		\draw[gray,mark position=0.78(dm)] (3,3) -- ++(-45:1);
		\draw[gray,mark position=0.8(d2)] (4,4) ++ (-\rang:0.1) -- ++(-45:2);
		\draw[gray,<->] (d1m) -- (dm) node[midway,sloped,fill=white] {$s$};
		\draw[gray,<->] (d1) -- (d2) node[midway,sloped,fill=white] {$L$};
		
		\draw (2,2) node[very thick,
		rectangle,draw,postaction={decorate},pattern=vertical lines,minimum height=1.2cm,rotate=-45
		] (w1) {};
		\draw (3,3) node (wm) {};
		\draw (4,4) node[very thick,
		rectangle,draw,postaction={decorate},pattern=north west lines,minimum height=1.2cm,rotate=-\rang
		] (w2) {};
		
		\draw[dashed] (0,0) -- (w1);
		\draw (0.5,0) to[bend right] node[right,midway,scale=.9] {$\theta$} (45:0.5);
		
		\path (w1) -- (w2) node[pos=1] (b) {} node[midway] (m) {};
		\draw[red!30!orange!70!black,thick,->] (wm.center) -- ++(90:1.2) node[left] {$u$} node[pos=.3] (u) {};
		\draw[red!30!orange!30!black] (wm) ++(45:0.3*1.2) to[bend right] node[pos=.3,above,scale=.8] {$\phi$} (u.center);
		\draw[very thick] (w1) -- (w2) {};
		
		\path (2,2) ++(90:0.15) node[inner sep=0,outer sep=0] (a) {};
		%	\path (a) ++(45+90:4) node (O) {};
		\begin{scope}[overlay]
			\path [name path=(wpa)] (a) -- ++(45+90:8);
			\path [name path=(wpb)] (b.center) -- ++(180-\rang:8);
			\path [name intersections={of=(wpa) and (wpb),by=O}];
		\end{scope}
		
		\draw[brown!50!gray,dashed] (O.center) -- (a.center) node[midway,above,sloped] {$r$};
		\draw[brown!50!gray] (a.center) ++(45:\rightsize) -- ++(45+90:\rightsize) node (ram) {} -- ++(45+180:\rightsize);
		\path (a) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};
		\draw[brown!50!gray,dashed] (O.center) -- (b.center);
		\draw[brown!50!gray] (b.center) ++(90-\rang:\rightsize) -- ++(180-\rang:\rightsize) node (ram) {} -- ++(-\rang-90:\rightsize);
		\path (b.center) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};
		\draw[brown!50!gray,dashed] (O.center) -- (wm.center);
		
		\draw[dashed] (w2) -- ++(90-\rang:1.5) node[midway] (w2m1) {};
		\draw[dashed] (w2.north) -- ++(45:1) node[pos=.4] (w2m2) {}
		(w2.north) edge[opacity=.1] ++(180+45:4);
		\draw[red!30!orange!30!black] (w2m1.center) to[bend left] (w2m2.center) node[above,xshift=0mm,yshift=1mm,scale=.9] {$\delta$};
		
		\filldraw[bottom color=magenta!80!black,top color=black] (O) circle(2.5pt)
		node[above,yshift=2pt] {$O$};
		\draw (wm.center) node[circle,fill,inner sep=1.5pt] {};
	\end{circuitikz}
	
	Το ποδήλατο έχει κέντρο μάζας και περιστρέφεται γύρω από ένα σημείο \( O \).
	\tcblower
	
	Κυνηγούμε γωνίες και τις προσθέτουμε στο σχήμα:
	
	\begin{circuitikz}
		\def\rightsize{0.2}
		\def\rang{9}
		
		\draw[<->] (0,6) node[left] {$y$} |- node[below left] {$O'$} (6,0) node[right] {$x$};
		
		\draw[gray,mark position=0.8(d1),mark position=0.3(d1m)] (2,2) ++ (-45:0.1) -- ++(-45:2);
		\draw[gray,mark position=0.78(dm)] (3,3) -- ++(-45:1);
		\draw[gray,mark position=0.8(d2)] (4,4) ++ (-\rang:0.1) -- ++(-45:2);
		\draw[gray,<->] (d1m) -- (dm) node[midway,sloped,fill=white] {$s$};
		\draw[gray,<->] (d1) -- (d2) node[midway,sloped,fill=white] {$L$};
		
		\draw (2,2) node[very thick,
		rectangle,draw,postaction={decorate},pattern=vertical lines,minimum height=1.2cm,rotate=-45
		] (w1) {};
		\draw (3,3) node (wm) {};
		\draw (4,4) node[very thick,
		rectangle,draw,postaction={decorate},pattern=north west lines,minimum height=1.2cm,rotate=-\rang
		] (w2) {};
		
		\draw[dashed] (0,0) -- (w1);
		\draw (0.5,0) to[bend right] node[right,midway,scale=.9] {$\theta$} (45:0.5);
		
		\path (w1) -- (w2) node[pos=1] (b) {} node[midway] (m) {};
		\draw[red!30!orange!70!black,thick,->] (wm.center) -- ++(90:1.2) node[left] {$u$} node[pos=.3] (u) {};
		\draw[red!30!orange!30!black] (wm) ++(45:0.3*1.2) to[bend right] node[pos=.3,above,scale=.8] {$\phi$} (u.center);
		\draw[very thick] (w1) -- (w2) {};
		
		\path (2,2) ++(90:0.15) node[inner sep=0,outer sep=0] (a) {};
		%	\path (a) ++(45+90:4) node (O) {};
		\begin{scope}[overlay]
			\path [name path=(wpa)] (a) -- ++(45+90:8);
			\path [name path=(wpb)] (b.center) -- ++(180-\rang:8);
			\path [name intersections={of=(wpa) and (wpb),by=O}];
		\end{scope}
		
		\draw[brown!50!gray,dashed,mark position=0.2(r1),mark position=0.4(r2)] (O.center) -- (a.center) node[near end,above,sloped] {$r$};
		\draw[brown!50!gray] (a.center) ++(45:\rightsize) -- ++(45+90:\rightsize) node (ram) {} -- ++(45+180:\rightsize);
		\path (a) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};
		\draw[brown!50!gray,dashed,mark position=0.35(r3)] (O.center) -- (b.center);
		\draw[brown!50!gray] (b.center) ++(90-\rang:\rightsize) -- ++(180-\rang:\rightsize) node (ram) {} -- ++(-\rang-90:\rightsize);
		\path (b.center) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};
		\draw[brown!50!gray,dashed, mark position=0.19(r4)] (O.center) -- (wm.center);
		
		\begin{scope}[thick,orange!50!red,opacity=.8]
			\draw (r1) to[bend right] node[midway,right,yshift=-4pt] {$\phi$}  (r4) ;
			\draw (r2) to[bend right] node[midway,below,xshift=2pt] {$\delta$} (r3) ;
		\end{scope}
		\draw[very thick,red!30!orange!70!black,->] ([yshift=1pt]w1.center) node[circle,fill,inner sep=1pt] {} -- ++(45:1) node[below right] {$u_0$};
		
		\draw[dashed] (w2) -- ++(90-\rang:1.5) node[midway] (w2m1) {};
		\draw[dashed] (w2.north) -- ++(45:1) node[pos=.4] (w2m2) {}
		(w2.north) edge[opacity=.1] ++(180+45:4);
		\draw[red!30!orange!30!black] (w2m1.center) to[bend left] (w2m2.center) node[above,xshift=0mm,yshift=1mm,scale=.9] {$\delta$};
		
		\filldraw[bottom color=magenta!80!black,top color=black] (O) circle(2.5pt)
		node[above,yshift=2pt] {$O$};
		\draw (wm.center) node[circle,fill,inner sep=1.5pt] {} node[right,yshift=0mm,xshift=1mm,scale=.7] {$(x,y)$};
	\end{circuitikz}
	
	Στα ορθογώνια τρίγωνα που προκύπτουν μεταξύ γωνιών και πλευρών, έχουμε:
	\[
	\left.
	\begin{aligned}
	\tan\phi &= \frac{s}{r}\\
	\tan\delta &= \frac{L}{r}
	\end{aligned}\right\rbrace
	\implies \tan\phi = \frac{S}{L}\tan\delta
	\]
	
	Θεωρώντας ότι ο κάτω τροχός κινείται με ταχύτητα \( u_0 \), έχουμε:
	\[
	u\cos\phi = u_0
	\]
	
	Τώρα πρέπει να βρούμε μια διαφορική εξίσωση που να περιγράαφει την κίνηση του
	κέντρου βάρους του ποδηλάτου. Έστω λοιπόν \( (x,y) \) οι συντεταγμένες του κέντρου. Τότε:
	\begin{align*}
		\Aboxed{\od{x}{t} &=
		u \cos (\phi+\theta) = \frac{u_0\cos(\phi+\theta)}{\cos\phi}} \\
		\Aboxed{\od{y}{t} &=
		u \sin(\phi+\theta) = \frac{u_0\sin(\phi+\theta)}{\cos\phi}}
	\end{align*}
	
	Επίσης πρέπει να βρούμε εξισώσεις κατάστασης για τον προσανατολισμό του ποδηλάτου.
	
	Η γωνιακή ταχύτητα δίνεται από τη σχέση:
	\[
	\omega = \frac{u_0}{r} \qquad \text{ή} \qquad \omega = \od{\phi}{t}
	\]
	και, επειδή \( \tan\delta = \frac{L}{r} \):
	\[
	\omega = \frac{u_0}{L}\tan\delta
	\]
	
	Για μία μικρή μεταβολή \( \Delta \phi \) του προσανατολισμού του ποδηλάτου:
	
	\begin{tikzpicture}
	\def\rightsize{0.15}
	
	\draw (0,0) node[circle,fill,inner sep=1pt] {} node[below right] {$O$};
	\draw (0,0) -- ++(90:2) node (a) {} node[pos=.2] (aa) {};
	\draw (0,0) -- ++(60:2) node (b) {} node[pos=.2] (ba) {};
	
	\draw[brown!50!gray] (a.center) ++(0:\rightsize) -- ++(-90:\rightsize) node (ram) {} -- ++(180:\rightsize);
	\path (a.center) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};
	\draw[brown!50!gray] (b.center) ++(180-30:\rightsize) -- ++(-30-90:\rightsize) node (ram) {} -- ++(-30:\rightsize);
	\path (b.center) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};
	
	\draw[green!50!black,dashed] (-0.7,2.07) -- ++(-2:2) node[pos=.4] (ca) {};
	\draw[green!50!black,dashed] (50:2.07) -- ++(150:2) node[pos=.7] (da) {};
	
	\draw[very thick,blue!60!black] (0,0) ++ (100:2) arc [start angle=100,end angle=50,radius=2cm];
	
	\draw[opacity=.8] (aa.center) to[bend left] node[midway,above,xshift=1.5pt,fill=white,fill opacity=.4,text opacity=1,scale=.7] {$\Delta\phi$} (ba.center);
	\draw[opacity=.8,green!20!black] (ca.center) to[bend left] node[midway,left,yshift=1pt,fill=white,fill opacity=.4,text opacity=1,scale=.6] {$\theta$} (da.center);
	\end{tikzpicture}
	
	Οι γωνίες \( \Delta \phi \) και \( \theta \) είναι μεταξύ τους κάθετες, άρα ίσες,
	επομένως:
	\[
	\boxed{\od{\theta}{t} = \frac{u_0}{L} \tan\delta}
	\]
\end{exercise}

\lecture{4}{7/3/2018}

\section{Δυναμικά συστήματα}
Με τον όρο \textit{δυναμικά συστήματα} εννοούμε τα συστήματα των οποίων η συμπεριφορά αλλάζει με το χρόνο, δηλαδή όλα τα συστήματα
τα οποία μελετάμε.

Αφού ολοκληρωθεί η διαδικασία της μοντελοποίησης, οδηγούμαστε σε ένα σύστημα της μορφής:
\begin{align*}
	x' &= f(x,u) \\
	y &= h(x,u)
\end{align*}
όπου στόχος μας είναι να έχουμε κατάλληλη είσοδο \( u \) ώστε να
πετύχουμε έξοδο \( y \), όπου \( x \) είναι οι μεταβλητές κατάστασης.
%TODO wrap right graph of closed loop system?


Αρχικά, επιλέγουμε η είσοδος να \textbf{εξαρτάται μόνο από την κατάσταση του συστήματος}. Αυτή είναι η πιο ??? μορφή ανάδρασης,
όπου δηλαδή η κατάσταση του συστήματος επηρεάζει την είσοδό του. Μαθηματικά:
\[
u = a(x)
\]
τότε:
\[
x' = f\left(x,\ a(x)\right)
\]
ή, θέτοντας κατάλληλα:
\[
x' = F(x)
\]
οπότε έχουμε να λύσουμε μια διαφορική εξίσωση:
\[
\od{x(t)}{t} = F\left( x(t) \right),\quad \forall \in [t_1,t_2]
\]

Οι ειδικές λύσεις της διαφορικής εξίσωσης, ως γνωστόν, είναι άπειρες. Για
να τις προσδιορίσουμε ακριβώς χρειάζεται να προσδιορίσουμε τις \textbf{αρχικές
	συνθήκες}:
\[
x(t_0) = x_0
\]

Επίσης θέλουμε η \( F(x) \) να είναι \textbf{ομαλή}, δηλαδή να έχει συνεχείς
παραγώγους όλων των τάξεων. Παρ' όλα αυτά, ακόμα και με την ομαλότητα δεν μπορούμε να εγγυηθούμε αν το σύστημα
έχει λύση, και αν αυτή η λύση είναι \textbf{μοναδική}. Όταν μία (μη γραμμική)
διαφορική εξίσωση έχει περισσότερες λύσεις, τότε δεν μπορούμε να γνωρίζουμε ποιά
από όλες τις αποκρίσεις είναι αυτή που θα επιστρέψει το σύστημα.

\begin{exercise}[Παράδειγμα]
	Έστω το σύστημα:
	\[
	\dot x = x^2
	\]
	για \( x\in\mathbb R,\quad x(0) = 1 \)
	\tcblower
	Το σύστημα αυτό έχει προφανή λύση:
	\[
	x(t) = \frac{1}{1-t}
	\]
	
	Όμως για \( t\to 1 \), το \( x(t) \) τείνει στο \( \infty \), δηλαδή το
	σύστημα ουσιαστικά \textit{δεν έχει λύση} στο \( t = 1 \).
	
	Διαπιστώνουμε δηλαδή ότι η παραπάνω συνθήκη της θεωρίας δεν αρκεί για να
	διαπιστώσουμε ότι υπάρχει εύλογη λύση του συστήματος.
\end{exercise}
\begin{exercise}[Παράδειγμα]
	Έστω το σύστημα:\[
	\dot x = 2\sqrt{x}
	\]
	για \( x \in \mathbb R,\quad x(0) = 0 \)
	\tcblower
	Μπορούμε να διαπιστώσουμε ότι η λύση της διαφορικής εξίσωσης είναι:
	\[
	x(t) = \begin{cases}
	0,\quad & \text{αν } t \in [0,a]\\
	(t-a)^2,\quad & \text{αν } t > a
	\end{cases}
	\] για \( a > 0 \).
	
	Εδώ παρατηρούμε πως εισάγεται στη λύση ένας συντελεστής \( a \), ο οποίος όμως δεν υπάρχει
	στην αρχική διαφορική εξίσωση, αλλά εμφανίζεται απλώς στη λύση του συστήματος. Αυτό συμβαίνει
	ακόμα και με την ύπαρξη της αρχικής συνθήκης \( x(0) = 0 \).
	
	Δηλαδή το σύστημα αυτό έχει άπειρες λύσεις, που εξαρτώνται από την τιμή του \( a \).
	Όμως δεν μπορούμε να γνωρίζουμε εκ των προτέρων πώς θα αποκριθεί αυτό.
\end{exercise}

Παρατηρούμε ότι δηλαδή η ομαλότητα του δεξιού μέλους των διαφορικών εξισώσεων δεν εξασφαλίζει
την ύπαρξη και τη μοναδικότητα των λύσεων.

\begin{theorem}{Συνέχεια κατά Lipschitz}{}
	Εισάγουμε την έννοια της τοπικής \textbf{συνέχειας κατά Lipschitz}, που ικανοποιείται ότανν:
	% Not a typo!
	\[
	\left|
	F(z_1) - F(z_2)
	\right|
	\leq \kappa |z_1-z_2|\qquad \forall z_1,z_2 \in \Omega \subset \mathbb R^n
	\]
	
	Αυτή είναι μια ιδιαίτερα αυστηρή συνθήκη για μη γραμμικές διαφορικές εξισώσεις.
	\tcblower
	
	Όταν η συνάρτηση \(  F \) είναι \textbf{συνεχής κατά Lipschitz}, τότε η λύση του συστήματος \textbf{υπάρχει} και
	είναι \textbf{μοναδική}.
\end{theorem}

Πρακτικά, για να ικανοποιείται η συνθήκη, πρέπει η συνάρτηση να βρίσκεται κάτω από μία ευθεία \( k|z| \), για κάποιο
πεπερασμένο \( k \):

\begin{tikzpicture}
\draw[->] (0,-0.5) -- (0,3);
\draw[->] (-0.5,0) -- (3,0);

\draw[red!50!orange!90!blue,very thick] (0,0) -- (45:4) node[midway,above left] {$k|z|$};
\draw[blue!50!cyan,thick]
plot [smooth,samples=8,variable=\x,domain=0:3] 
(\x,{\x/2*(rand+2)/2}) (2,0) node[above] {$F(x)$};
\end{tikzpicture}

Διαφορετικά, για κάποιες συναρτήσεις, όπως η εκθετική, δεν υπάρχει ευθεία η οποία να βρίσκεται
επάνω από τη συνάρτηση για οποιαδήποτε κλίση. Υπάρχουν μόνο τιμές του \( k \) που είναι
πιο πάνω από τη συνάρτηση μέχρι \textit{συγκεκριμένα σημεία}:

\begin{tikzpicture}
\draw[->] (0,-0.5) -- (0,4.5);
\draw[->] (-0.5,0) -- (4,0);

\draw[red!50!orange!90!blue,very thick] (0,0) -- (45:5) node[midway,sloped,above left] {$k_2|z|$};
\draw[red!30!orange!90!blue,very thick] (0,0) -- (25:5) node[pos=.85,sloped,above left] {$k_1|z|$};
\draw[blue!50!cyan,thick]
plot [smooth,samples=\vlowsamples,variable=\x,domain=0:3] 
(\x,{0.06*(exp(1.4*\x)-1)}) node[above] {$F(x)$};

\coordinate (m) at (2.01,0.91);
\coordinate (n) at (2.74,2.70);

\draw[dashed] (m) -- (m |- 0,0) (n) -- (n |- 0,0);
\end{tikzpicture}

\paragraph{}
\textbf{Ικανή συνθήκη} (αλλά όχι και \textit{αναγκαία}) για να ικανοποιείται η συνέχεια
κατά Lipschtz είναι η \textbf{ιακωβιανή ορίζουσα} \( \od{F}{x} \) να είναι φραγμένη σε κάποιον χώρο \( \Omega \).

\subsubsection{Σημείο ισορροπίας}
\begin{defn}{Σημείο Ισορροπίας}{}
	Για το σύστημα:\[
	\dot x = F(x)
	\]
	ονομάζουμε \textbf{σημείο ισορροπίας} την τιμή του \( x \) που μηδενίζει το δεξί μέλος,
	δηλαδή ένα \( x^* \) τέτοιο ώστε:
	\[
	F(x^*) = 0
	\]
	
	Ένα σύστημα μπορεί να έχει μηδέν, ένα, πολλαπλά ή άπειρα σημεία ισορροπίας.
\end{defn}

Τα σημεία ισορροπίας είναι σημαντικά, επειδή δηλώνουν ότι σε αυτά τα σημεία, το σύστημα
\( \dot x = F(x) \) που \textit{δεν εξαρτάται από το χρόνο και από εξωτερικές επιρροές},
τότε το σύστημα δεν πρόκειται να μεταβληθεί. Δηλαδή \textit{ισορροπεί} στο \( x^* \).

\begin{exercise}[Παράδειγμα]
	\begin{wrapfigure}{r}{0.2\textwidth}
		\begin{center}
		\begin{tikzpicture}[scale=1.2]
		\draw (-1,0) -- (1,0);
		\draw (0,0) node[circle,inner sep=2pt,fill] {};
		\draw[very thick] (0,0) -- ++(90:1.5) node[circle,inner sep=2pt,fill=white,draw] {} node[pos=.5] (a) {};
		\draw[very thick] (0,0) -- ++(70:1.5) node[circle,inner sep=2pt,fill=white,draw] {} node[pos=.5] (b) {};
		
		\draw[brown,->] (a.center) to[bend left] node[midway,above,xshift=1pt] {$\theta$} (b.center);
		
		\begin{scope}[opacity=.5,dashed]
		\draw[thick] (0,0) -- ++(-90:1.5cm-2/2pt) node[circle,inner sep=2pt,fill=white,draw,anchor=north] {} node[pos=.2] (c) {};
		\draw[brown,->] (0,0.3) arc [start angle=90,end angle=-90,radius=0.3];
		\end{scope}
		\end{tikzpicture}
		\end{center}
	\end{wrapfigure}
	
	
	Ένα απλοποιημένο μοντέλο του αναστρεφόμενου εκκρεμούς, για μικρή γωνία \( \theta \), είναι:
	\[
	\left[
	\begin{matrix}
	\dot x_1 \\ \dot x_2
	\end{matrix}
	\right] = \left[
	\begin{matrix}
	x_2 \\ \sin x_1 - cx_2 + u\cdot \cos x_1
	\end{matrix}
	\right]
	\]
	όπου το \( x_1 \) εκφράζει τη \textbf{γωνία} \( \theta \), το \( x_2 \) εκφράζει
	τη \textbf{γωνιακή ταχύτητα} του εκκρεμούς, και το \( u \) εκφράζει την εξωτερική ροπή
	που ασκείται σε αυτό.
	\tcblower
	Πρώτα θα ψάξουμε τα \textbf{σημεία ισορροπίας} του συστήματος. Για αυτό, θεωρούμε
	\textbf{μηδενική εξωτερική επιρροή}, δηλαδή \( \underline{u=0} \), οπότε λύνουμε
	την εξίσωση \( F(x^*) = 0 \):
	\[
	\left[
	\begin{matrix}
	\dot x_1 \\ \dot x_2
	\end{matrix}
	\right] = \left[\begin{matrix}
	x_2 \\ \sin x_1 - cx_2
	\end{matrix}
	\right] = 0
	\implies
	\begin{cases}
	x_2 &= 0 \\
	\sin x_1 &= 0 \implies x_1 = \kappa \pi \quad \kappa \in \mathbb Z
	\end{cases}
	\] 
	
	Μαθηματικά, η παραπάνω εξίσωση έχει άπειρες λύσεις, αφού \( \kappa \in\mathbb Z \).
	Όμως πρακτικά, αυτές οι τιμές αντιστοιχούν στις γωνίες \( \ang{0} \) και
	\( \ang{180} \), δηλαδή στις δύο απέναντι κατακόρυφες θέσεις του εκκρεμούς.
\end{exercise} 

\begin{defn}{Απομονωμένο Σημείο Ισορροπίας}{}
	Ένα σημείο ισορροπίας ονομάζεται \textbf{απομονωμένο} αν υπάρχει κύκλος
	με κέντρο το σημείο αυτό και ακτίνα μη μηδενική ο οποίος \textit{δεν} περιέχει άλλο
	σημείο ισορροπίας.
	
	Πρακτικά δηλαδή όταν δεν υπάρχει άλλο σημείο ισορροπίας δίπλα στο πρώτο.
\end{defn}

\begin{defn}{Οριακός Κύκλος}{}
	\textbf{Οριακός Κύκλος} ονομάζεται μια \textbf{κλειστή περιοδική} τροχιά των λύσεων του
	συστήματος.
	
	Ο οριακός κύκλος είναι χαρακτηριστικό των μη γραμμικών συστημάτων. Δεν έχει απαραίτητα
	κυκλικό σχήμα. Εκφράζει γραμμικές ταλαντώσεις.
\end{defn}

Με τον όρο \textit{κλειστή} τροχιά εννοούμε μια τροχιά η οποία καταλήγει
εκεί απ' όπου ξεκίνησε.

Σε ένα \textit{μη γραμμικό} σύστημα, δεν υπάρχει δεύτερη \textit{κλειστή περιοδική} τροχιά
\textit{γειτονικά} από μια πρώτη \textit{κλειστή περιοδική} τροχιά, κάτι που μπορεί να ισχύει
στα γραμμικά συστήματα. Μπορούν βέβαια να υπάρχουν ανοιχτές τροχιές που να συγκλίνουν ή να
αποκλίνουν από τον οριακό κύκλο.

\begin{center}
\begin{tikzpicture}[scale=.8]
\draw[->] (-3,0) -- (3,0) node[below] {$x_1$};
\draw[->] (0,-3) -- (0,3) node[right] {$x_2$};

\draw[gray,dashed] (0,0) -- (40:0.6);
\draw[gray,dashed] (0,0) -- (250:2.4);

\draw[very thick,green!70!blue]
(0,0) circle (0.6cm);
\draw[very thick,green!75!blue]
(0,0) circle (1.2cm);
\draw[very thick,green!80!blue]
(0,0) circle (2.4cm);

\draw (current bounding box.south) node[below] {γραμμικό σύστημα};

\begin{scope}[xshift=10cm,local bounding box=scope1]
\draw[->] (-3,0) -- (3,0) node[below] {$x_1$};
\draw[->] (0,-3) -- (0,3) node[right] {$x_2$};

\draw[very thick,green!70!blue]
(0,0) circle (0.9cm);
\draw[very thick,green!80!blue]
plot[smooth,samples=\midsamples,variable=\t,domain=0:2*pi]
({(0.9+\t/6.28)*sin(-\t r)},{(0.9+\t/6.28)*cos(\t r)})
;

\draw (scope1.south) node[below] {μη γραμμικό σύστημα};
\end{scope}
\end{tikzpicture}
\end{center}

\begin{exercise}[Παράδειγμα]
	\begin{align*}
		\dot x_1 &= x_2 + x_1(1-x_1^2-x_2^2) \\
		\dot x_2 &= -x_1+x_2(1-x_1^2-x_2^2)
	\end{align*}
	\tcblower
	Μπορούμε να διαπιστώσουμε ότι το σύστημα έχει λύση:
	\[
	\left(
	x_1(t),\ x_2(t)
	\right) = \left(
	\sin t,\ \cos t
	\right)
	\]
	
	Ο οριακός κύκλος εξαρτάται από το δεξί μέλος των εξισώσεων, και στο συγκεκριμένο
	παράδειγμα είναι όντως ένας κύκλος.
\end{exercise}

\subsubsection{Ευστάθεια}
\begin{defn}{Ευσταθές σημείο ισορροπίας}{}
	Έστω το σύστημα:
	\[
	\dot x = F(x)
	\]
	όπου η \( F \) τοπικά συνεχής κατά \( Lipschitz \),
	και έστω η μοναδική του λύση για κάθε στιγμή \( t \), με αρχική συνθήκη \( x_0 \):
	\[
	x(t;\ x_0)
	\]
	και ένα σημείο ισορροπίας του:
	\[
	x^*
	\]
	
	Το σημείο \( x^* \) ονομάζεται \textbf{ευσταθές σημείο ισορροπίας} ανν:
	\[
	\forall \epsilon > 0,\quad
	\exists \delta(\epsilon) > 0 :
	\left|x_0-x^*\right| < \delta
	\implies \left| x^*-x(t;\ x_0) \right| < \epsilon,\quad \forall t \geq 0
	\]
\end{defn}

Πρακτικά, ξεκινάμε \textit{κοντά} από το σημείο ισορροπίας ( \( \left|x_0-x^*\right| < \delta \) ), και παραμένουμε \textit{κοντά}
σε αυτό. Δηλαδή, για να ικανοποιείται ο ορισμός, θα
πρέπει και το σημείο που φτάνουμε \( x(t; x_0) \) να είναι αρκετά κοντά στο σημείο ισορροπίας
\( x^* \), \textit{όσο προχωράει ο χρόνος}.

\begin{center}
\begin{tikzpicture}[scale=1.1]
\draw[->] (-3,0) -- (3,0) node[below] {$x_1$};
\draw[->] (0,-3) -- (0,3) node[right] {$x_2$};

\def\xox{-0.5};
\def\xoy{-0.5};
\coordinate (x0) at (\xox,\xoy);

\def\r{  (sqrt(  (\xox*\xox + \xoy*\xoy) ))  * (1+0.2*\t)   }
\def\phi{atan2(\xoy,\xox)}
\draw[ultra thick,green!50!blue,->]
plot[smooth,samples=\midsamples,variable=\t,domain=0:3*pi]
({\r*cos(-\t r + \phi)},{\r*sin(-\t r + \phi)})
node[circle,fill opacity=.5,fill,draw,inner sep=1.5pt,thick,opacity=.1,anchor=north west] {}
;

\path (0,0) node[circle,fill opacity=.5,fill,draw,inner sep=2pt,thick,fill=red!50!black] (O) {};
\path (x0) node[circle,fill opacity=.5,fill,draw,inner sep=1.2pt] {};
\draw (O) node[above right] {$x^*$};
\draw (x0) node[below left] {$x_0$};

\draw[green,thick,dashed] (0,0) circle (1cm);
\draw[green,thick,dashed] (0,0) circle (2.4cm);
\draw[densely dashed,blue!20!green!50!black] (0,0) -- (-50:1) node[above,midway,sloped] {$\delta$};
\draw[densely dashed,blue!20!green!50!black] (0,0) -- (165:2.4) node[above,midway,sloped] {$\varepsilon$};
\end{tikzpicture}
\end{center}

Ο παραπάνω ορισμός εκφράζει την έννοια της ευστάθειας μόνο του \textbf{σημείου ισορροπίας}, όχι ολόκληρου του συστήματος.
Το \textbf{σύστημα} ονομάζεται \textbf{ευσταθές} αν όλα τα σημεία ισορροπίας του είναι \textit{ευσταθή}.

\begin{defn}{Ασυμπτωτικά ευσταθές σημείο ισορροπίας}{}
	Ένα σημείο ισορροπίας ονομάζεται \textbf{ασυμπτωτικά ευσταθές} ότανν:
	\begin{enumerate}
		\item Είναι ευσταθές
		\item Ισχύει:
		\[
		\lim_{t \to +\infty}x(t;x_0) = x^*
		\]
	\end{enumerate}
\end{defn}

\begin{tikzpicture}[scale=1.1]
\draw[->] (-3,0) -- (3,0) node[below] {$x_1$};
\draw[->] (0,-3) -- (0,3) node[right] {$x_2$};

\def\xox{-1.5};
\def\xoy{-1.5};
\coordinate (x0) at (\xox,\xoy);

\def\rate{0.08}
\def\r{  (sqrt(  (\xox*\xox + \xoy*\xoy) ))  * (1-\rate*\t)   }
\def\phi{atan2(\xoy,\xox)}
\draw[ultra thick,green!50!blue,
%mark position=0.2(c1),mark position=0.2001(c2),
%mark position=0.5(c3),mark position=0.501(c4),
%mark position=0.91009(c5),mark position=0.91015(c6)
]
plot[smooth,samples=\midsamples,variable=\t,domain=0:1/\rate]
({\r*cos(-\t r + \phi)},{\r*sin(-\t r + \phi)})
node[circle,fill opacity=.5,fill,draw,inner sep=1.5pt,thick,opacity=.1,anchor=north west] {}
;
%\draw[green!50!blue,very thick,->] %(c1) -- (c2)
% (c3) -- (c4); %(c5) -- (c6);

\path (0,0) node[circle,fill opacity=.5,fill,draw,inner sep=2pt,thick,fill=red!50!black] (O) {};
\path (x0) node[circle,fill opacity=.5,fill,draw,inner sep=1.2pt] {};
\draw (O) node[below left] {$x^*$};
\draw (x0) node[above right] {$x_0$};

%\draw[green,thick,dashed] (0,0) circle (1cm);
\draw[green,thick,dashed] (0,0) circle (2.4cm);
%\draw[densely dashed,blue!20!green!50!black] (-50:1) node[above] {$\delta$};
\draw[densely dashed,blue!20!green!50!black] (165:2.4) node[below left] {$\varepsilon$};
\end{tikzpicture}

Πρακτικά σημαίνει ότι το σύστημα προσεγγίζει το σημείο ισορροπίας, όσο το \( t\to \infty \).

\begin{defn}{Εκθετικά ευσταθές σημείο ισορροπίας}{}
	Ένα σημείο ισορροπίας ονομάζεται \textbf{εκθετικά ευσταθές} ότανν:
	\begin{enumerate}
		\item Είναι \textbf{ασυμπτωτικά ευσταθές}
		\item Η λύση είναι φραγμένη από μια εκθετικά αποσβεννύμενη καμπύλη, δηλαδή:
		\[
		\left|
		x(t;x_0) - x^*
		\right| \leq ae^{-\gamma t} \left|x_0\right|
		\] για \( a,\gamma >0 \)
	\end{enumerate}
\end{defn}
Πρακτικά, σημαίνει ότι το σημείο αυτό συγκλίνει εκθετικά γρήγορα στο σημείο ισορροπίας.

Όταν κάποια από τις παραπάνω ιδιότητες ισχύει για όλα τα σημεία του χώρου, δηλαδή:
\[
\forall x_0 \in \mathbb R^n
\]
τότε μιλάμε για \textbf{ολική} ευστάθεια ή ιδιότητες.

Όταν κάποια από τις παραπάνω ιδιότητες ισχύει μόνο για μερικά σημεία του χώρου, δηλαδή:
\[
\forall x_0 \in \Omega \subset \mathbb R^n
\]
τότε μιλάμε για \textbf{τοπική} ευστάθεια ή ιδιότητες.

\begin{defn}{Ομοιόμορφα τελικώς φραγμένη λύση}{}
	Μία λύση \( x(t;x_0) \) με αρχική συνθήκη \( x_0 \) για χρόνο \( t \) ονομάζεται
	\textbf{ομοιόμορφα τελικώς φραγμένη} ότανν:
	\[
	\forall \xi > 0 \quad
	\exists M,T(\xi) > 0
	\quad : \quad
	\left|x_0\right| < \xi \implies \left|
	x(t;x_0)\right| < M
	, \quad \forall t > T(\xi)
	\]
\end{defn}
Πρακτικά ο ορισμός αυτός σημαίνει ότι, από κάποιον χρόνο και μετά (που
εξαρτάται από την αρχική τιμή μέσω του \( \xi \)), η λύση είναι φραγμένη
από κάποια τιμή.

\begin{tikzpicture}[scale=1,xscale=1.4]
\draw[->] (-0.5,0) -- (4,0) node[right] {$t$};
\draw[->] (0,-0.5) -- (0,2.5);

\draw (0,0) node[below left] {$O$};

\draw[dashed] (0,2) node[left] {$\xi$} -- ++(4,0);
\draw[dashed] (0,0.5) node[left] {$M$} -- ++(4,0);

\draw[very thick,blue!50!cyan] plot [smooth] coordinates {(0,1.8) (0.7,1.7) (1,1.25) (1.5,1.1) (2,0.5) (3,0.2) (3.9,0.10)};

\path (0,1.8) node[circle,fill opacity=.5,fill,draw,inner sep=1.2pt] {} node[below left] {$x_0$};
\end{tikzpicture}

Η έννοια αυτή είναι σημαντική, επειδή μπορούμε να ελέγχουμε την τιμή του \( M \) ώστε να
πετύχουμε σύγκλιση στο 0.

\lecture{5}{9/3/2018}

\subsection{Για γραμμικά συστήματα}
\label{sec:linear_stability}
Ένα σύστημα του οποίου οι παράμετροι μπορούν να εκφραστούν με έναν γραμμικό
συντελεστή ονομάζεται \textbf{γραμμικό}:
\[
\dot x = F(x) = Ax
\] όπου ο \( A \) είναι ένας πίνακας \( A \in \mathbb R^{n\times n} \)

Ένα σύστημα έχει τυπικά \textbf{αρχική τιμή}:
\[
x(0) = x_0
\]

Τα \textbf{σημεία ισορροπίας} βρίσκονται από τη σχέση \( F(x) = 0 \), ή:
\[
Ax = 0
\]
και, αν ο \( A \) είναι \textit{αντιστρέψιμος} (ισοδύναμα \( \det(A)\neq 0 \)), τότε ισχύει:\[
x^* = 0
\]

Για να είναι το σύστημα ευσταθές,
πρέπει όλες οι ιδιοτιμές του (λύσεις της εξίσωσης \( \det(sI-A)=0 \)) να έχουν
αρνητικό πραγματικό μέρος. Τότε είναι \textbf{ασυμπτωτικά ευσταθές}.
\todo{Really asymptotically?}
Σε περίπτωση που έστω και μία έχει θετικό πραγματικό
μέρος, το σύστημα είναι \textit{ασταθές}. \footnote{Για πραγματικό μέρος
	\( =0 \) έχουμε την οριακή ευστάθεια.}
% TODO check

Συμπεραίνουμε ότι το σύστημα και η ευστάθειά του περιγράφονται ουσιαστικά πλήρως
από τον πίνακα \( A \).

\subsubsection{Ειδική περίπτωση: Πίνακας \( A \) διαγώνιος}
\begin{defn}{Διαγώνιος πίνακας}{}
	Ένας \textbf{διαγώνιος} πίνακας έχει τη μορφή:\[
	\dot x = \left[\begin{matrix}
	\lambda_1 & 0 & \cdots & 0 \\
	0 & \lambda_2 & \cdots & 0 \\
	\vdots & \vdots & \ddots & \vdots \\
	0 & 0 & \cdots & \lambda_\nu
	\end{matrix}
	\right] x
	\]
\end{defn}

Ένα σύστημα με διαγώνιο πίνακα \( A \) έχει προφανή λύση:
\[
x(t) = e^{\lambda_i t} \cdot x_i(0)
\]
%TODO check above equation

Φαίνεται ότι για να έχουμε \textit{ευστάθεια}, πρέπει να ισχύει για όλους τους
συντελεστές \( \lambda \):
\[
\lambda_i < 0
\]

Επομένως είναι εύκολη η ανάλυση ενός συστήματος που μπορεί να περιγραφεί από
έναν διαγώνιο πίνακα, ή να \textit{μετασχηματιστεί} σε διαγώνιο πίνακα
με \textbf{κατάλληλη επιλογή μεταβλητών κατάστασης}.

\subsubsection{Ειδική περίπτωση: Πίνακας \( A \) μπλοκ-διαγώνιος}
\[
\dot x = \left[
\begin{matrix}
\begin{matrix}
\sigma_1 & \omega_1 \\ \omega_1 & \sigma_1
\end{matrix} & 0 & \cdots & 0 \\
0 & \begin{matrix}
\sigma_2 & \omega_2 \\ \omega_2 & \sigma_2
\end{matrix} & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots\\
0 & 0 & \cdots & \begin{matrix}
\sigma_\nu & \omega_\nu \\ \omega_\nu & \sigma_\nu
\end{matrix}
\end{matrix}
\right]x
\]
%TODO Move to definition
%TODO write equivalent in precise format

Τότε λειτουργούμε αντίστοιχα με παραπάνω, με τους συντελεστές \( \lambda \)
να είναι:
\[
\lambda_i = \sigma_i \pm j\omega_i
\]

\begin{exercise}[Παράδειγμα]
	Δίνεται το σύστημα:
	\begin{align*}
	\dot x &= \left[
	\begin{matrix}
	-k_0-k_1 & k_1 \\
	k_2 & -k_2
	\end{matrix}
	\right]\left[\begin{matrix}
	x_1 \\ x_2
	\end{matrix}\right] + \left[
	\begin{matrix}
	b_0 \\ 0
	\end{matrix}
	\right]u \\
	y &= \left[
	\begin{matrix}
	0 & 1
	\end{matrix}
	\right]\left[\begin{matrix}
	x_1 \\ x_2
	\end{matrix}\right]
	\end{align*}
	όπου \( k_0,k_1,k_2,b_0 > 0 \).
	
	Να επιλεγεί είσοδος ώστε να έχουμε ευστάθεια, και \( y \to 0 \).
	
	\tcblower
	
	Επιλέγουμε αυθαίρετα τον παρακάτω ελεγκτή:
	\[
	u = -kx_2\qquad k>0
	\]
	
	Πρακτικά δηλαδή μετατρέπουμε το σύστημα ανοιχτού βρόχου σε σύστημα κλειστού
	βρόχου, αφού μεταφέρουμε μία παράμετρό του στην είσοδο. Μαθηματικά,
	αντικαθιστούμε στον δοθέντα τύπο του \( \dot x \):
	\begin{align*}
		\dot x &= \left[\begin{matrix}
		-k_0-k_1 & k_1 \\ k_2 & -k_2
		\end{matrix}\right]\left[\begin{matrix}
		x_1 \\ x_2
		\end{matrix}\right] + \left[\begin{matrix}
		-b_0kx_2 \\ 0
		\end{matrix}\right]
		\\ &=
		\left[\begin{matrix}
		-k_0 - k_1 & k_1-b_0k \\
		k_2 & -k_2
		\end{matrix}\right]\left[\begin{matrix}
		x_1 \\ x_2
		\end{matrix}\right]
	\end{align*}
	
	Ο πίνακας \( A=\left[\begin{matrix}
	-k_0 - k_1 & k_1-b_0k \\
	k_2 & -k_2
	\end{matrix}\right] \) δεν ανήκει σε κάποια από τις ειδικές περιπτώσεις
	που αναφέραμε, επομένως πρέπει να βρούμε τις \textbf{ιδιοτιμές} του:
	\begin{align*}
	\det(sI-A) = 0 \implies \det\left(\left[\begin{matrix}
	s+k_0+k_1 & b_0k-k_1 \\ -k_2 & s+k_2 \end{matrix}
	\right]\right) &= 0 \implies \\
	s^2 + (k_0+k_1+k_2)s + k_2(b_0k + k_0) &= 0
	\end{align*}
	
	Αντί να βρούμε αναλυτικά την τιμή των ιδιοτιμών, μπορούμε απλά να
	απαιτήσουμε να έχουν αρνητικό πραγματικό μέρος. Αυτό μπορούμε να το
	πετύχουμε με το \textbf{κριτήριο Routh - Hurwitz}, ή, εναλλακτικά, επειδή
	εδώ έχουμε 2\textsuperscript{o}βάθμια εξίσωση, να φροντίσουμε ώστε όλοι
	οι συντελεστές να είναι ομόσημοι\footnote{Το συμπέρασμα αυτό προκύπτει από εφαρμογή του κριτηρίου Routh}, δηλαδή:
	\begin{align*}
		k_0+k_1+k_2 &> 0\\
		k_2(b_0k+k_0) &> 0
	\end{align*}
	
	Επομένως η συνθήκη που πρέπει να ικανοποιεί το \( k \) είναι:
	\[
	k > -\frac{k_0}{b_0} \implies k>0 \text{ που ήδη ισχύει}
	\]
	
	Επίσης, ισχύει \( \det(A) = k_2(k_0+k_1)-k_2(k_1-b_0k) = k_2k_0(1+b_0) \neq 0 \), άρα το σημείο ισορροπίας βρίσκεται στη θέση \( x^* = 0 \).
	
	Επειδή το σύστημα είναι \textit{ασυμπτωτικά ευσταθές} \todo{why?}, το
	\( x \) τείνει στο \( x^* = 0 \). Όμως η έξοδος \( y \) είναι \( y=0x_1 + 1x_2 \), όπως δίνεται από την εκφώνηση.
	Άρα και \( y\to 0 \).
	
	Τελικά ικανοποιούνται τα ζητούμενα χρησιμοποιώντας τον ελεγκτή \( u=-kx_2 \).
\end{exercise}

\subsection{Μελέτη ευστάθειας σε μη γραμμικά συστήματα}
Έστω το σύστημα \( \dot x = F(x) \) με σημείο ισορροπίας.

\subsubsection{Με γραμμικοποίηση}

Ένας τρόπος να μελετήσουμε την ευστάθεια ενός σημείου ισορροπίας, είναι να
μελετήσουμε την \textbf{ευστάθεια στη γειτονιά του} (για παράδειγμα, στο
αναστρεφόμενο εκκρεμές, εκτρέπουμε κατά μικρή γωνία \( \theta \), αφήνουμε
το εκκρεμές, και παρατηρούμε τη συμπεριφορά του).

Για αυτήν τη μελέτη, \textbf{"γραμμικοποιούμε"} το σύστημα που μελετάμε,
χρησιμοποιώντας ανάπτυγμα Taylor 1\textsuperscript{ης} τάξης:
\[
\dot x = F(x^*)
+ \underbrace{\left. \pd{F}{x} \right|_{x=x^*} (x-x^*)}_{\mathclap{\text{1\textsuperscript{ος} όρος}}}
+ \underbrace{\cancelto{0}{R\left(\left|x-x^*\right|\right)}}_{\mathclap{\text{υπόλοιποι όροι}}}
\]

Το ανάπτυγμα Taylor επιστρέφει ορθά αποτελέσματα για τιμές κοντά στο \( x^* \),
δηλαδή για μικρά \( \left|x-x^*\right| \), οπότε και μπορούμε να αγνοήσουμε
τους όρους μεγαλύτερους από την πρώτη τάξη, οι οποίοι είναι αμελητέοι:
\begin{align*}
\dot x &= F(x^*) + \left. \pd{F}{x} \right|_{x=x^*}(x-x^*)
\xRightarrow[F(x^*) = 0]{x^* \text{ σημ. ισορροπίας }} \\
\dot x &= \left. \pd{F}{x} \right|_{x=x^*} (x-x^*)
\end{align*}

Εδώ έχουμε φτάσει στο σημείο να μπορούμε να θέσουμε έναν \textbf{σταθερό} πίνακα \( A \):
\[
A = \left. \pd{F}{x} \right|_{x=x^*}
\]
οπότε το \textit{γραμμικοποιημένο} σύστημα έχει τη μορφή:
\[
\dot x = A(x-x^*)
\]
και, θέτοντας \( z=x-x^* \), έχουμε:
\[
\boxed{\dot z = Az}
\]

Το παραπάνω σύστημα μπορεί να μελετηθεί όπως τα υπόλοιπα γραμμικά συστήματα
(\autoref{sec:linear_stability}).

\textbf{Προσοχή!} Η παραπάνω μέθοδος μπορεί να εφαρμοστεί \textbf{μόνο για τοπική} ευστάθεια, και δεν εξάγει βέβαια συμπεράσματα για ολική ευστάθεια. Ένα
σύστημα που είναι \textit{ευσταθές} για \textit{μικρές εκτροπές}, δεν είναι απαραίτητα
ευσταθές για μεγαλύτερες. Αντίθετα, αν είναι \textit{ασταθές} για \textit{μικρές}
εκτροπές, τότε στις περισσότερες περιπτώσεις είναι \textit{ασταθές} και για
μεγαλύτερες.

\begin{exercise}[Παράδειγμα]
	Ένα απλοποιημένο μοντέλο του αναστρεφόμενου εκκρεμούς είναι το εξής:
	\[
	\dot x = \left[\begin{matrix}
	x_2 \\ \sin x_1 - γ x_2 \end{matrix}
	\right], \qquad γ > 0
	\]
	
	Τα σημεία ισορροπίας του συστήματος είναι τα \( (0,0) \) και
	\( (π,0) \). Να μελετηθεί
	η τοπική ευστάθεια γύρω από αυτά
	
	\tcbsubtitle{Λύση για \( (0,0) \)}
	Το σύστημα είναι μη γραμμικό, λόγω της ύπαρξης του \textit{ημιτόνου}.
	
	Για \( x_1 \) \textit{κοντά} στο 0, ισχύει κατά τα γνωστά:
	\[
	\sin x_1 \equiv x_1
	\]
	
	Αφού θέλουμε να γραμμικοποιήσουμε στη γειτονιά του \( (0,0) \), αρκεί
	να αντικαταστήσουμε το ημίτονο με το προσεγγιστικά ισοδύναμό του,
	και έχουμε:
	\[
	\dot x = \left[
	x_2 \\ x_1-γx_2
	\right] = \underbrace{\left[\begin{matrix}
	0 & 1 \\ 1 & -\gamma
	\end{matrix}\right]}_A \left[\begin{matrix}
	x_1 \\ x_2
	\end{matrix}\right]
	\]
	
	Μελετάμε τις ιδιοτιμές του \( A \):
	\[
	\det(sI-A) = 0 \implies \dots \implies s^ + \gamma s - 1 = 0
	\]
	το οποίο έχει μία λύση με αρνητικό πραγματικό μέρος, και μία με θετικό.
	Συνεπώς, το σύστημα σε εκείνο το σημείο είναι
	\textbf{τοπικά ασταθές}. Άλλωστε, αν μετακινήσουμε το εκκρεμές ελαφρά,
	αυτό θα αρχίσει να κινείται χωρίς να σταματήσει.
	
	\tcbsubtitle{Λύση για \( (π,0) \)}
	Ακολουθούμε τη θεωρία. Από τη σχέση \( z = x-x* \) υπολογίζουμε:
	\begin{align*}
		z_1 &= x_1 - π \\
		x_2 &= x_2 - 0
	\end{align*}
	άρα: \[
	(z_1,z_2) = \left(x_1-π, \ x_2\right)
	\]
	και το σύστημα είναι:
	\[
	\dot z = \left[\begin{matrix}
	z_2 \\ \sin(z_1 + π) - \gamma z_2
	\end{matrix}\right]
	\]

    Θεωρούμε την προσέγγιση:
    \[
    \sin(z_1 + π) = -\sin z_1 \overset{z_1 \equiv 0}{\simeq} -z_1
    \]
    άρα η γραμμικοποίηση είναι:
    \[
    \dot z = \left[
    z_2 \\ -z_1-\gamma z_2
    \right] = \left[\begin{matrix}
    0 & 1 \\ -1 -\gamma
    \end{matrix}
    \right]\left[\begin{matrix}
    z_1 \\ z_2
    \end{matrix}\right]
    \]
    με ιδιοτιμές:
    \[
    \det(sI-A) = 0 \implies s^2 + \gamma s + 1 =0
    \]
\end{exercise}

\subsubsection{Με το 2\textsuperscript{ο} θεώρημα Lyapunov}
Έστω το σύστημα \( \dot x = F(x) \) με σημείο ισορροπίας \( x^* \).

Η ιδέα της μεθόδου του Lyapunov είναι να βρούμε μια συνάρτηση που συγκλίνει
στο σημείο ισορροπίας, και φθίνει συνεχώς κατά μήκος της διαδρομής του \( x \).

\begin{defn}{Θετικά ορισμένη συνάρτηση}{}
	Μία συνάρτηση \( V(x) \) όπου \( V: \mathbb R^n \to \mathbb R \) ονομάζεται \textbf{θετικά
		ορισμένη} όταν:
	\begin{enumerate}
		\item Είναι συνεχώς παραγωγίσιμη
		\item Είναι θετική για \( x\neq 0 \):
		\[
		V(x) > 0 \quad \forall x\neq 0
		\]
		\item Είναι μηδενική μόνο για \( x=0 \):
		\[
		V(x) = 0 \iff x=0
		\]
	\end{enumerate}
\end{defn}

\begin{defn}{Αρνητικά ορισμένη συνάρτηση}{}
	Μία συνάρτηση \( V(x) \) όπου \( V: \mathbb R^n \to \mathbb R \) ονομάζεται \textbf{αρνητικά
		ορισμένη} όταν:
	\begin{enumerate}
		\item Είναι συνεχώς παραγωγίσιμη
		\item Είναι {\color{red!70!black}αρνητική} για \( x\neq 0 \):
		\[
		V(x) ~ {\color{red!70!black}< 0} \quad \forall x\neq 0
		\]
		\item Είναι μηδενική μόνο για \( x=0 \):
		\[
		V(x) = 0 \iff x=0
		\]
	\end{enumerate}
\end{defn}

\begin{defn}{Θετικά ημιορισμένη συνάρτηση}{}
	Μία συνάρτηση \( V(x) \) όπου \( V: \mathbb R^n \to \mathbb R \) ονομάζεται \textbf{θετικά
		ημιορισμένη} όταν:
	\begin{enumerate}
		\item Είναι συνεχώς παραγωγίσιμη
		\item Είναι {\color{orange!70!black}\textit{μη} αρνητική} για \( x\neq 0 \):
		\[
		V(x) ~ {\color{orange!70!black}\geq 0} \quad \forall x\neq 0
		\]
		%\item Είναι μηδενική για \( x=0 \):
		%\[
		%V(0) = 0
		%\]
		\todo{Check if the 3rd condition is present}
	\end{enumerate}
\end{defn}
Αντίστοιχα ορίζεται η \textit{αρνητικά ημιορισμένη} συνάρτηση.

\begin{exercise}[Παράδειγμα]
	Έστω το διάνυσμα:
	\[
	x = \left[\begin{matrix}
	x_1 & x_2
	\end{matrix}\right]^T
	\]
	
	Να εξεταστούν οι συναρτήσεις ως προς τα παραπάνω:
	\begin{align*}
		V_1(x) &= x_1^2 + x_2^2 \\
		V_2(x) &= x_1^2
	\end{align*}
	\tcblower
	\begin{enumparen}
		\item Η \( V_1 \) είναι μηδενική \textit{μόνο} για \( (x_1,x_2) = 0 \),
		και στα υπόλοιπα σημεία είναι θετική. Επομένως είναι \textbf{θετικά ορισμένη}:
		\[
		V_1(x) \succ 0
		\]
		\item Η \( V_2 \) είναι μηδενική για \( (x_1,x_2) = 0\), όμως είναι μηδενική επιπλέον και για όλα
		τα \( x= (0,a), \quad a\neq 0 \). Επομένως \textit{δεν} είναι θετικά ορισμένη.
		
		Είναι όμως θετικά ημιορισμένη, αφού δεν λαμβάνει
		αρνητικές τιμές. Άρα:
		\[
		V_2(x) \succeq 0
		\]
	\end{enumparen}
\end{exercise}

\begin{theorem}{Θεώρημα Lyapunov}{}
	Έστω ένα σύστημα: \[
	\dot x = F(x)
	\]
	και μία μια αρνητική συνάρτηση \( V \) που ορίζεται ως
	εξής:
	\[
	\dot V = \pd{V^T}{x} \dot x = \pd{V^T}{x} F(x)
	\]
	
	Έστω επίσης μία σφαίρα πεπερασμένης ακτίνας \( r \) με
	κέντρο το \(0\):
	\[
	B_r(0) = \left\lbrace x\in \mathbb R^n :\ |x|<r \right\rbrace
	\]
	
	\todo{...}
	
	Αν \( V < 0 \), τότε το σημείο είναι ασυμπτωτικά ευσταθές.
	
	Η συνάρτηση \( V \) ονομάζεται \textbf{συνάρτηση Lyapunov}.
\end{theorem}

Γεωμετρικά, σχεδιάζουμε \textit{ισοβαρείς καμπύλες}, δηλαδή καμπύλες όπου
οι τιμές της συνάρτησης Lyapunov είναι ίσες:
\todo{Graph 18}

\paragraph{Παρατηρήσεις}
\begin{itemize}
	\item Για κάθε ευσταθές σημείο ισορροπίας σε κάθε σύστημα, \textbf{υπάρχει
		συνάρτηση Lyapunov}. Επομένως η ύπαρξη τέτοιας συνάρτησης είναι
	\textbf{ικανή και αναγκαία} συνθήκη για τη μελέτη της ευστάθειας.
	\item Αν και δεν απαιτείται η εύρεση του συστήματος, η συνάρτηση
	Lyapunov δεν δίνεται, και πρέπει να \textbf{επιλεγεί} από εμάς. Δεν υπάρχει
	αλγοριθμική διαδικασία που να προβλέπει τέτοια συνάρτηση, αλλά πρέπει να
	σκεφτούμε εμείς, χρησιμοποιώντας την εμπειρία του σχεδιαστή.
\end{itemize}

\end{document}
