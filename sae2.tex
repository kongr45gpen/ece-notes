% !TeX program = xelatex
\documentclass[11pt,a4paper,notitlepage,fleqn]{article}

\input{preambles/preamble2018.tex}

\title{ΣΑΕ 2
	\\
	{
		\normalsize Συστήματα Αυτομάτου Ελέγχου II
		\\
		\normalsize Σημειώσεις από τις παραδόσεις\footnote{Όπως διδάσκονται στο τμήμα \textit{Ηλεκτρολόγων Μηχανικών και Μηχανικών Υπολογιστών} στο \textit{Αριστοτέλειο Πανεπιστήμιο Θεσσαλονίκης}.}
	}}
\date{Φεβρουάριος 2018
	\\
	{
		\small Τελευταία ενημέρωση: \today
	}
}
\author{
	Για τον κώδικα σε \LaTeX, ενημερώσεις και προτάσεις:
	\\
	\url{https://github.com/kongr45gpen/ece-notes}}

\setallmainfonts(Digits,Latin,Greek){Asana Math}
\setmainfont{Noto Serif}
\setsansfont{Ubuntu}
\usepackage{polyglossia}
\newfontfamily\greekfont[Script=Greek,Scale=1.00]{Liberation Serif}

\hypersetup{pdftitle = {ΣΑΕ 2}}

\let\mytodo\todo
\renewcommand{\todo}[1]{\par\mytodo[inline,noline]{#1}}


\begin{document}
\maketitle

\hrule
\vspace{50pt}

\begin{infobox}{Λάθη \& Διορθώσεις}
	Οι τελευταίες εκδόσεις των σημειώσεων βρίσκονται στο Github
	(\url{https://github.com/kongr45gpen/ece-notes/raw/master/sae2.pdf}) ή
	στη διεύθυνση \url{http://helit.org/ece-notes/sae2.pdf}.

	Περιέχουν διορθώσεις σε λάθη και τυχόν βελτιώσεις.

	\tcblower

	Μπορείτε να ενημερώνετε για οποιοδήποτε λάθος και πρόταση
	μέσω PM στο forum, issue στο Github, ή οποιουδήποτε άλλου τρόπου!
\end{infobox}

Το μάθημα περιλαμβάνει ένα μικρό προαιρετικό εργαστήριο. Η επιλογή γίνεται με βάση
προαιρετικής προόδου (μπαίνουν οι πρώτοι 18, εφ' όσον έχουν γράψει βαθμό \( \geq 6 \)).

Εφ' όσον δοθεί, η πρόοδος συμμετέχει κατά 25\% στον τελικό βαθμό
(και το υπόλοιπο 75\% στις εξετάσεις), για αυτούς που συμμετάσχουν
σε αυτήν. Διαφορετικά, μετράν οι εξετάσεις κατά 100\%. Το εργαστήριο μετράει προσθετικά
με μέγιστο βαθμό \( +3 \), εφ' όσον ο βαθμός της εξέτασης είναι από 4 και πάνω.

Αν δηλωθεί η πρόοδος, ο βαθμός της μετράει απαραίτητα όπως παραπάνω, και δεν υπάρχει δυνατότητα να
ακυρωθεί, ακόμα και αν ο φοιτητής δεν την παραδώσει.

\newpage

{
\hypersetup{linkcolor=black}
\listoflecture
\tableofcontents
}

\newpage
\lecture{1}{21/2/2018}
\section{Εισαγωγή}
Στα Συστήματα Αυτόματου Ελέγχου 2 οι αναλύσεις γίνονται στο πεδίο του \textbf{χρόνου}
και όχι της \textbf{συχνότητας}. Αυτό επιτρέπει να μελετηθούν συστήματα μη γραμμικά,
καθώς και συστήματα με περισσότερες από μία εισόδους και εξόδους.

Γενικότερα, τα ΣΑΕ έχουν εφαρμογές σε πολυάριθμους τομείς, όπως η αυτοκίνηση (φρένα
ABS, σύστημα πρόσφυσης, διατήρηση ευστάθειας σε πλαγιολίσθηση, \textellipsis), έλεγχος
κινητήρων, έλεγχος υπερμεγέθων τηλεσκοπίων, κατανομή πρόσβασης σε δίκτυα internet και
τηλεφωνικά, διαχείριση συστημάτων ενέργειας (για διανομή, ασφάλεια, αξιοπιστία, π.χ.
απόσβεση διαταραχών μετά από κεραυνό)\textellipsis

Θυμόμαστε ότι \textbf{\textit{σύστημα}} είναι οποιαδήποτε λειτουργική μονάδα που διεγείρεται
από κάποιες εισόδους, και επιστρέφει κάποιες εξόδους.

\begin{tikzpicture}
\draw (0,0) node[rectangle,draw,inner sep=15pt,minimum width=20pt] (r) {$S$};
\draw[<-] (r.west) -- ++(-2,0) node[above right] {είσοδος};
\draw[->] (r.east) -- ++(2,0) node[above left] {έξοδος};
\end{tikzpicture}

Ένα \textbf{ελεγχόμενο σύστημα} είναι τέτοιο ώστε να φροντίζουμε η έξοδος \( y \) να έχει μια
επιθυμητή τιμή \( r \), και το οποίο συχνά περιλαμβάνει και μια είσοδο διαταραχής
\( d \), που δεν μπορούμε να ελέγξουμε.

\begin{tikzpicture}
\draw (0,0) node[rectangle,draw,inner sep=15pt,minimum width=20pt] (r) {$S$};
\draw[<-] (r.west) ++ (0,-0.3) -- ++(-2,0) node[above right] {$u$};
\draw[<-] (r.west) ++ (0,0.3) -- ++(-2,0) node[above right] {$r$};
\draw[<-] (r.north) -- ++(0,1) node[midway,right] {$d(t)$};
\draw[->] (r.east) -- ++(2,0) node[above left] {$y$};
\end{tikzpicture}

Μια ακόμα χρήσιμη έννοια που μάθαμε είναι αυτή της ανάδρασης, στην οποία η έξοδος του συστήματος ανατροφοδοτείται στο σύστημα ως είσοδος, ίσως αφού περαστεί από έναν
ελεγκτή \( C \). Σε αυτά μπορούμε να προσθέσουμε μια μετρητική διάταξη \( M \) και έναν
ενεργοποιητή (actuator) \( E \) που να μετατρέπει την έξοδο σε μορφή αποδεκτή από το σύστημα. Αυτά
είναι και τα \textbf{συστήματα κλειστού βρόχου}.

\begin{tikzpicture}
\draw (0,0) node[rectangle,draw,inner sep=15pt,minimum width=20pt] (r) {$S$};
\draw (-3,0) node[rectangle,draw,inner sep=10pt,minimum width=10pt] (c) {$C$};
\draw (-1.5,0) node[rectangle,draw,minimum height=30pt,minimum width=7pt] (e) {$E$};

\draw (-0.5,-1.5) node[rectangle,draw,minimum width=30pt,inner sep=8pt] (d) {$M$};

\draw[->] (e) -- (r) node[midway, above] {$u$};
\draw[->] (c) -- (e);
\draw[<-] (c.west) ++ (0,0.3) -- ++(-2,0) node[above right] {$r$};
\draw[<-] (r.north) -- ++(0,1) node[midway,right] {$d(t)$};
\draw[->] (r.east) -- ++(2,0) node[above left] {$y$} node[midway] (m) {};

\draw[->] (m.center) node[circ] {} |- (d) -- ++(-3.5,0) |- (c);
\end{tikzpicture}

Στόχος των μαθημάτων είναι ο σχεδιασμός του ελεγκτή \( C \) ώστε να ικανοποιούνται
συγκεκριμένες προδιαγραφές. Χρειάζεται βέβαια και μια διαισθητική κατανόηση των εννοιών.
Για παράδειγμα, αν έχουμε προδιαγραφή το σύστημα να έχει έξοδο \( 1 \) στη μόνιμη κατάσταση,
είναι προτιμότερο να φτάσει σε αυτήν με υπεραποσβεννύμενη απόκριση, παρά με ταλαντώσεις.

\begin{tikzpicture}[scale=.7]
\draw[->] (-0.5,0) -- (3,0) node[right] {$t$};
\draw[->] (0,-0.5) -- (0,3) node[left] {$y$};
\draw (0,0) node[below left,scale=.9] {$0$};

\def\h{2}

\draw[thick,timecolour]
plot [variable=\t,domain=0:3,samples=\lowsamples,smooth]
(\t,{\h*  (1-e^(-2*\t)  )});

\draw[thick,\timecolour!70!blue]
plot [variable=\t,domain=0:3,samples=\hisamples,smooth]
(\t,{\h*(1-1*exp(-3*\t)*cos(20*\t r))});

\draw[dashed] (3,\h) -- (0,\h) node[left] {$1$};
\end{tikzpicture}

Για τη \textbf{μοντελοποίηση} των συστημάτων μπορούμε είτε να υπολογίσουμε και να
αναλύσουμε τη φυσική λειτουργία του συστήματος, είτε να μελετήσουμε σύνολα εισόδων και
εξόδων ώστε να προβλέψουμε τη συμπεριφορά τους.

Στην πραγματικότητα βέβαια δεν θα μας δίνονται οι μαθηματικές προδιαγραφές, αλλά οι
φυσικές προδιαγραφές του συστήματος.

Υπάρχει μάλιστα η περίπτωση τα λειτουργικά κομμάτια των παραπάνω διατάξεων να μην
είναι συνδεδεμένα φυσικά μεταξύ τους, αλλά να βρίσκονται σε απόσταση, εισάγοντας
χρονικές καθυστερήσεις στη μεταφορά των σημάτων (π.χ. drones). Άλλα προβλήματα μπορεί
να είναι ο κβαντισμός των σημάτων (π.χ. για ασύρματη μεταφορά δεδομένων), περιορισμοί του
hardware ή του software.

\paragraph{Παράδειγμα}
Έστω ένα αυτοκίνητο μάζας \( m \) που κινείται σε δρόμο κλίσης \( \phi \) με ταχύτητα
\( y(t) \). Στο αυτοκίνητο ασκείται δύναμη οδήγησης \( u(t) \) και δύναμη του αέρα ανάλογη
με την ταχύτητα, με συντελεστή \( a \) (αεροδυναμικός συντελεστής).
Οι τριβές μεταξύ αυτοκινήτου και οδοστρώματος θεωρούνται αμελητέες.

Επιθυμούμε να σχεδιάσουμε έναν ελεγκτή \( u(t) \) που να ελέγχει τη δύναμη οδήγησης, ώστε
το αυτοκίνητο να κινείται με σταθερή ταχύτητα.

\subparagraph{Λύση}\hspace{0pt}

\begin{tikzpicture}
\def\ang{30}

\draw (0,0) -- (0:3) node [pos=.2] (a1) {};
\draw (0,0) -- (\ang:3.3) node[pos=.2] (a2) {} node [pos=.6] (bb) {};

\draw (bb) node[rectangle,draw,minimum height=5mm,minimum width=10mm,anchor=south,rotate=\ang] (b) {};

\draw[yellow!80!brown!50!black,thick,->] (b.center) -- ++(0,-0.7) node[below right] {$mg$};
\draw[yellow!80!brown!50!black,thick,->] (b.center) -- ++(\ang:1) node[above right] {$u(t)$};
\draw[yellow!10!brown!70!black,thick,->] (b.center) -- ++(180+\ang:1) node[left,scale=.8] {$ay(t)$};
\draw (b.center) node[circle,fill,inner sep=.6pt] {};

\draw[blue!50!green,->] (b.north east) ++ (\ang+90:0.4) --++(\ang:1) node[above,near end] {$y$};

\draw (a1.center) to[bend right] node[midway,yshift=1pt,right,scale=.9] {$\phi$} (a2.center);
\end{tikzpicture}

Από το νόμο του Νεύτωνα \( \sum F = m\dot y \) έχουμε:
\[
m\dot y = u - ay -mg\sin\phi
\]
δηλαδή φτάσαμε σε μία διαφορική εξίσωση που μοντελοποιεί το πρόβλημα.

Παρατηρούμε μάλιστα τον όρο \( \left[-mg\sin\phi\right] \), ο οποίος δεν εξαρτάται από μεταβλητές που
μπορούμε να επηρεάσουμε, αλλά μόνο από την κλίση του δρόμου, που πιθανώς αλλάζει. Δηλαδή
αποτελεί την \textbf{είσοδο διαταραχών}.

Η επιθυμητή έξοδος του συστήματος που δίνεται ως είσοδο είναι \( y(t) = r \), και εδώ
θεωρούμε για παράδειγμα ότι \( r = \SI{25}{\meter/\second} \).

\begin{itemize}
	\item Ισχυρίζομαι ότι μπορώ να λύσω το πρόβλημα \textbf{χωρίς κλειστό βρόχο}, δηλαδή
	χωρίς να φτάνει στον ελεγκτή \( C \) η έξοδος \( y \):
	\[
	u(t) = kr(t)
	\]

	Και για απλότητα στους υπολογισμούς θεωρώ \( \phi = 0 \).

	Τότε, από το παραπάνω μοντέλο του συστήματος, προκύπτει η διαφορική εξίσωση:
	\[
	m\dot y = -ay + k\cdot25
	\]
	με λύση:
	\[
	y(t) = 25\frac{k}{a}\left(
	1-e^{-\frac{a}{m} t}
	\right),\quad t\geq 0
	\]
	ή, αν επιλέξουμε το κέρδος του ελεγκτή να είναι \( k = a \), η ταχύτητα θα γίνει
	όντως \( \SI{25}{\meter/\second} \). Όμως ο χρόνος αποκατάστασης εξαρτάται από τα
	\( a \) και \( m \), που είναι παράμετροι του ελεγχόμενου συστήματος, και δεν μπορούν
	να επηρεαστούν. Δηλαδή ο ρυθμός με τον οποίο συγκλίνουμε στο 25 εξαρτάται μόνο από τις
	παραμέτρους του ελεγχόμενου συστήματος. Συνήθως έχουμε μεγάλη μάζα \( m \) για το
	αυτοκίνητο και μικρό αεροδυναμικό συντελεστή. Επομένως το πηλίκο \( \frac{a}{m} \) είναι
	μικρό και η απόκριση λογικά αργή.

	Ακόμα δεν είναι γνωστή τις περισσότερες φορές η τιμή του συντελεστή \( a \). Αν για
	παράδειγμα ανοίξουμε ένα παράθυρο, μεταβάλλεται ανάλογα με το πόσο το έχουμε ανοίξει.
	Γενικότερα στη διαδικασία της σχεδίασης \textbf{δεν μπορούμε να χρησιμοποιήσουμε
		μεγέθη που δεν είναι γνωστά}.

	Επίσης, στην περίπτωση που θεωρήσουμε ότι \( \phi \neq 0 \), η λύση θα προκύψει μετά
	από πράξεις:
	\[
	y(t) = \underbrace{\left(\frac{25k}{a} - \frac{mg\sin\phi}{a}\right)}_{\text{θέλουμε } = 25}
	\left(  1-e^{-\frac{a}{m} t} \right)
	\]
	επομένως:
	\[
	k = \frac{25a + mg\sin\phi}{25}
	\]
	το οποίο πάλι δεν μπορεί να υπολογιστεί εύκολα, αφού η κλίση του δρόμου \( \phi \) κάθε
	φορά δεν είναι γνωστή.
	\item Χρησιμοποιούμε \textbf{αναλογικό ελεγκτή κλειστού βρόχου}:
	\[
	u(t) = k \cdot \Big( r(t) - y(t) \Big), \qquad k > 0
	\]

	Τότε η λύση της διαφορικής εξίσωσης θα προκύψει, μετά από πράξεις:
	\[
	y(t) = \left(
	\frac{25k - mg\sin\phi}{a+k}
	\right)\left( 1-e^{-\left(\frac{a+k}{m}\right)t} \right)
	\]

	Όσο μεγαλώνουμε το \( k \), ο παράγοντας στον εκθέτη αυξάνεται, άρα μεγαλώνει η ταχύτητα
	σύγκλισης στη μόνιμη τιμή. Όσον αφορά τον πρώτο όρο, για \( k \) που φτάνει στο
	\( \infty \), έχουμε:
	\[
	\lim_{k \to \infty} \left( \frac{mg\sin\phi}{a+k} \right) = 0
	\]
	και ο πρώτος όρος γίνεται 25.

	Η μικρή διαφορά που υπάρχει για πεπερασμένες τιμές του \( k \) είναι ουσιαστικά το
	σφάλμα θέσης, που μπορούμε να εξαλείψουμε με έναν ολοκληρωτή.
\end{itemize}

\lecture{2}{28/2/2018}

\section{Μοντελοποίηση Συστημάτων}
Η μοντελοποίηση συστημάτων, όπως αναφέραμε σε μια παράγραφο παραπάνω, γίνεται είτε με
φυσική μελέτη του συστήματος, είτε μελετώντας μερικές σχέσεις εισόδου-εξόδου, και εξάγοντας
συμπεράσματα από αυτές. Το αντικείμενο της μοντελοποίησης μελετάται εκτενώς σε μάθημα
επόμενου εξαμήνου, και εδώ θα κάνουμε μια εισαγωγή.

Τα πραγματικά συστήματα είναι από τη φύση τους πολύπλοκα, και επομένως ένα μοντέλο θα εισάγει
σχεδόν πάντα ένα \textbf{σφάλμα}. Το \textbf{σφάλμα μοντελοποίησης} \( e \) εκφράζει τη
διαφορά της τιμής \( \hat y \) που εξάγει το μοντέλο, από την τιμή \( y \) που εξάγει το
πραγματικό σύστημα.

\begin{circuitikz}
	\tikzstyle{system}=[rectangle,draw,minimum height=9mm,align=center,minimum width=32mm]
	\draw (0,0) node[system] (rs) {Πραγματικό\\Σύστημα};
	\draw (rs.north) node[system,anchor=south,yshift=10pt] (ms) {Μοντέλο};

	\draw[<-] (rs.west) -- ++(-1.5,0) node (sp) {} node[midway] (spm) {};
	\draw[->] (spm.center) |- (ms);

	\draw[->] (ms.east) node[above right] {$\hat y$} -- ++(2,0) node[midway] (ap1) {};
	\draw[->] (rs.east) node[below right] {$y$} -- ++(2,0) node[midway] (ap2) {};
	\path (ap1) -- (ap2) node[midway,circle,draw,inner sep=5pt] (sum) {};
	\draw[->] (ap1.center) -- (sum.north) node[above right,yshift=-2pt] {$+$};
	\draw[->] (ap2.center) -- (sum.south) node[below right,yshift=2pt] {$-$};
	\draw[->] (sum) -- ++ (1,0) node[midway,above] {$e$};
\end{circuitikz}

Στόχος της μοντελοποίησης είναι η ελαχιστοποίηση \textit{αυτού} του σφάλματος, το οποίο εκφράζεται
μέσα από την προδιαγραφή της ακρίβειας.

Για παράδειγμα, μπορεί να θέλουμε να προσεγγίσουμε την έξοδο ενός πραγματικού συστήματος
σε μια "επικίνδυνη" είσοδο, την οποία είναι δύσκολο να εφαρμόσουμε στην πραγματικότητα,
αλλά εύκολο να θεωρήσουμε ως είσοδο στο μοντέλο.

Για τη μελέτη των συστημάτων χρησιμοποιούμε τις \textbf{μεταβλητές κατάστασης}, δηλαδή
τις μεταβλητές που είναι απαραίτητο να γνωρίζουμε για να περιγράψουμε πλήρως τη λειτουργία
του συστήματος. Ο ορισμός αυτός προέκυψε από τη μελέτη της κίνησης των πλανητών, η οποία
μπορεί να περιγραφεί από τη θέση και την ταχύτητα του καθενός. Οι μεταβλητές αυτές μεταβάλλονται
με το χρόνο.

Το σύνολο των τιμών των μεταβλητών κατάστασης ονομάζεται \textbf{σύνολο καταστάσεων}, και
κάθε τιμή (ή διάνυσμα καταστάσεων) ονομάζεται \textbf{κατάσταση}.

\paragraph{Παράδειγμα}
\phantomsection
Θεωρούμε ένα φυσικό σύστημα με ένα ελατήριο \( k \) και έναν αποσβεστήρα \( c \). Ασκούμε και
μία δύναμη \( u \). Σε αυτό θεωρούμε ότι η μεταβλητή \( q \) εκφράζει τη θέση του
σώματος. Τότε η χρονική παράγωγός της, \( \dot q \), εκφράζει την ταχύτητα του σώματος.
\label{sec:physical_ex0}


\begin{circuitikz}
	\fill[postaction={decorate},pattern=north east lines] (0,3) rectangle (-0.5,-0.5) rectangle (5,0);

	\draw (2,0) rectangle ++(2,2) node[midway] {$m$} node[midway] (m) {};

	\draw (2,1.6) to[damper,l_=$c(\dot q)$,invert] ++(-2,0);
	\draw (2,0.4) to[spring,invert,l_=\raisebox{-1.5ex}{$k$}] ++(-2,0);

	\draw[thick] (0,3) |- (5,0);

	\draw[->] (m) ++ (0,1.4) |- ++(2,0.7) node[above,pos=.75,gray] {$q$};
\end{circuitikz}

Από το θεμελιώδη νόμο της μηχανικής (2\textsuperscript{ος} Νόμος Νεύτωνα):
\[
m\ddot q = -c(\dot q) - kq + u
\]
δηλαδή το \textbf{μοντέλο} του συστήματος είναι το:
\[
m\ddot q + c(\dot q) + kq = u
\]
Στην περίπτωση που \( u=0 \), το σύστημα αυτό είναι αυτόνομο. Αν είχαμε κάποια εξωτερική δύναμη, θα ήταν μη αυτόνομο.
\begin{defn}{Αυτόνομα συστήματα}{}
	Συστήματα στα οποία \textbf{δεν} ενεργούν \textbf{εξωτερικές δυνάμεις} ονομάζονται
	\textbf{αυτόνομα}.

	Συστήματα στα οποία ενεργούν \textbf{εξωτερικές δυνάμεις}, οι οποίες λειτουργούν ως
	είσοδοι και μπορούμε να τις μεταβάλλουμε ώστε να αλλάξει η δυναμική συμπεριφορά του
	συστήματος, ονομάζονται \textbf{μη αυτόνομα}.
\end{defn}

\begin{defn}{Εξισώσεις κατάστασης}{}
	Γενικότερα, για τα συστήματά μας θα προκύπτει μία εξίσωση:
	\[
	F\left(
	q^{(n)},\ q^{(n-1)},\ \dots,\ \dot q,\ q,\ u
	\right) = 0
	\]

	Αυτή είναι διαφορική εξίσωση \textbf{τάξης \( n \)}, και μπορεί να αναλυθεί σε
	επιμέρους απλούστερες διαφορικές εξισώσεις της μορφής:
	\[
	\boxed{\begin{aligned}
		\dot x &= f(x,u) \\
		y &= h(x,u)
		\end{aligned}}
	\text{ όπου }\begin{aligned}
		x \in \mathbb R^n\ &\text{το \textbf{διάνυσμα μεταβλητών κατάστασης}},\\
		u \quad&\text{η \textbf{είσοδος του συστήματος}},\\
		y \quad&\text{η \textbf{έξοδος του συστήματος}},\\
		q \quad&\text{μία \textbf{μεταβλητή κατάστασης} ή άλλη παράμετρος του συστήματος}
		\end{aligned}
	\]

	Οι παραπάνω εξισώσεις εκφράζουν για κάθε στιγμή τη σχέση των μεταβλητών κατάστασης,
	και ονομάζονται \textbf{εξισώσεις κατάστασης}.
\end{defn}

Η λύση του προβλήματος μπορεί να προκύψει από οποιαδήποτε επιλογή μεταβλητών κατάστασης. Οι
δυνατές επιλογές όμως είναι άπειρες. Στα παρακάτω παραδείγματα προτείνουμε επιλογές που
θα επιστρέφουν σίγουρα αποτέλεσμα, αν και ίσως θα οδηγούμαστε εκεί με πιο αργό τρόπο.


\paragraph{Παράδειγμα}
\label{sec:nontd_system}
Έστω ένα σύστημα του οποίου η περιγραφή εκφράζεται από τον τύπο:
\begin{equation}
y^{(n)} + a_1y^{(n-1)} + a_2y^{(n-2)} + \dots + a_{n-1}\dot y + a_n y = u
\label{eq:nontd_system}
\end{equation}
όπου \( u\in\mathbb R  \) η είσοδος και \( y\in\mathbb R  \) η έξοδος του συστήματος.

Εδώ παρατηρούμε ότι οι σταθερές \( a_i \) \textbf{δεν εξαρτώνται} από το \textbf{χρόνο}.

\textbf{Επιλέγουμε} να ορίσουμε τις μεταβλητές κατάστασης
\( (x_1,\ x_2,\dots,\ x_n) \) ως τις παραγώγους της εξόδου.
Η συγκεκριμένη επιλογή δουλεύει καλά:
\begin{align*}
	x_1 &= y \\
	x_2 &= \dot y \\
	&\vdots \\
	x_n &= y^{(n-1)}
\end{align*}

Η δυσκολία αλλά και ο στόχος που θέλουμε να πετύχουμε είναι η \textbf{εύρεση των \( n \) εξισώσεων κατάστασης} με βάση τις παραπάνω μεταβλητές. Εδώ παρατηρούμε ότι:
\begin{align*}
	\dot x_1 &= \dot y = x_2\\
	\dot x_2 &= \ddot y = x_3 \\
	&\vdots \\
	\dot x_{n-1} &= x_n
\end{align*}
και από την αρχική Διαφορική Εξίσωση \eqref{eq:nontd_system} έχουμε:
\[
\dot x_n = -a_1x_n -a_2x_{n-1} - \dots - a_{n-1}x_2 -a_nx_1 + u
\]
δηλαδή το σύνολο των εξισώσεων κατάστασης είναι:
\begin{align*}
\dot x_1 &= x_2\\
\dot x_2 &= x_3 \\
&\vdots \\
\dot x_{n-1} &= x_n\\
\dot x_n &= -a_1x_n -a_2x_{n-1} - \dots - a_{n-1}x_2 -a_nx_1 + u
\end{align*}

Σε \textbf{μορφή πίνακα}, οι \textbf{μεταβλητές κατάστασης} είναι:
\[
\dot X = \left[\begin{matrix}
\dot x_1 \\ \dot x_2 \\ \vdots \\ \dot x_n
\end{matrix}\right] = \left[
\begin{matrix}
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & 0\\
0 & 0 & 0 & \cdots & 1 \\
-a_n & - a_{n-1} & - a_{n-2} & \cdots & -a_1
\end{matrix}
\right] \left[\begin{matrix}
x_1 \\  x_2 \\ \vdots \\ x_{n-1} \\ x_n
\end{matrix}\right]
+ \left[\begin{matrix}
0\\0\\\vdots\\0\\1
\end{matrix}\right]u
\]
και η \textbf{έξοδος} του συστήματος προκύπτει από:
\[
y= \left[\begin{matrix}
1 & 0 & 0 & \cdots & 0
\end{matrix}\right]\left[\begin{matrix}
x_1\\x_2\\\vdots\\x_n
\end{matrix}\right]
\]

\paragraph{Παράδειγμα με μεγαλύτερη τάξη εισόδου-εξόδου}
\phantomsection
\label{sec:nontd_highorder_system}
Έστω το σύστημα:
\[
y^{(n)} + a_1y^{(n-1)} + a_2y^{(n-2)} + \dots + a_{n-1}\dot y + a_n y =
b_0 u^{(n)} + b_1u^{(n-1)} + \dots + b_{n-1}\dot u + b_n u
\label{eq:nontd_highorder_system}
\]

Υπενθυμίζουμε ότι σκοπός είναι να βρούμε ένα σύνολο μεταβλητών κατάστασης που μπορούν
να παράγουν διαφορικές εξισώσεις που μπορούν να λυθούν, ώστε να περιγραφεί η λειτουργία του
συστήματος.

\begin{itemize}
	\item Έστω ότι ακολουθούμε την προσέγγιση του προηγούμενου παραδείγματος, δηλαδή οι
	μεταβλητές κατάστασης είναι:
	\begin{align*}
	x_1 &= y \\
	x_2 &= \dot y \\
	&\vdots \\
	x_n &= y^{(n-1)}
	\end{align*}

	Με λύση:
	\begin{align*}
	\dot x_1 &= \dot y = x_2\\
	\dot x_2 &= \ddot y = x_3 \\
	&\vdots \\
	\dot x_{n-1} &= x_n\\
	\dot x_n &= -a_1x_n -a_2x_{n-1} - \dots - a_{n-1}x_2 -a_nx_1 + b_0 u^{(n)} + b_1u^{(n-1)} + \dots + b_{n-1}\dot u + b_n u
	\end{align*}

     Η παραπάνω λύση είναι σωστή, όμως απαιτεί τη γνώση \textbf{παραγώγων υψηλής τάξης} της
     εισόδου \( u \), κάτι το οποίο ιδιαίτερα στα πραγματικά ΣΑΕ δεν μπορεί να υπολογιστεί,
     επειδή απαιτούνται οι μελλοντικές τιμές του συστήματος.
     \item Μία άλλη λύση που προτείνουμε είναι να \textbf{επιλέξουμε}:
     \begin{alignat*}{2}
     	x_1 &= y - \beta_0 u && \\
     	x_2 &= \dot x_1 - \beta_1 u &&= \dot y - \beta_0\dot u - \beta_1u \\
     	&\vdots && \\
     	x_n &= \dot{x_{n-1}} - \beta_{n-1}u
     	&&= y^{(n-1)} - \beta_0u^{(n-1)} - \dots - \beta_{n-2}\dot u - \beta_{n-1}u
     \end{alignat*}

     Οι όροι \( \beta_i \) δεν είναι ίδιοι με τους \( b_i \), αλλά ορίζονται ως εξής:
     \begin{align*}
     	\beta_0 &= b_0 \\
     	\beta_1 &= b_1 - a_1\beta_0\\
     	\beta_2 &= b_2 - a_1\beta_1 - a_2\beta_0\\
     	&\vdots\\
     	\beta_n &= b_n - a_1\beta_{n-1}-\dots - a_{n-1}\beta_1 - a_n\beta_0
     \end{align*}

     Το παραπάνω σύστημα μπορεί να λυθεί, και αποδεικνύεται ότι η κάθε εξίσωση περιέχει
     την είσοδο \( u \) χωρίς να είναι σε παράγωγο.
\end{itemize}

\begin{exercise}[Παράδειγμα]
	Στο παράδειγμα με το φυσικό σύστημα της προηγούμενης παραγράφου (\autoref{sec:physical_ex0}):
	\[
	m\ddot q + c\dot q + kq = u
	\]
	να γραφούν οι εξισώσεις κατάστασης του συστήματος σε μορφή πίνακα.
	\tcblower
	Η παραπάνω εξίσωση είναι η \textbf{διαφορική εξίσωση του συστήματος}.

	Δεν εμφανίζονται ανώτερες παράγωγοι της εισόδου άρα χρησιμοποιούμε την απλή έκφραση
	από επάνω (\autoref{sec:nontd_system}).

	Η τάξη της εξίσωσης είναι \textbf{2}, άρα έχουμε \textbf{μόνο 2} μεταβλητές κατάστασης.
	Σύμφωνα με την παράγραφο \autoref{sec:nontd_system}, επιλέγουμε:
	\begin{alignat*}{4}
		x_1 &=q \qquad && \dot x_1&&=x_2 \\
		x_2&=\dot q \qquad && \dot x_2 &&= -\frac{c}{m}x_2 - \frac{k}{m}x_1
		+ \frac{1}{m}u
	\end{alignat*}
	ή, σε μορφή πίνακα:
	\begin{align*}
		\dot x &= \left[\begin{matrix}
		0 & 1 \\ -\frac{k}{m} & -\frac{c}{m}
		\end{matrix}\right]\left[\begin{matrix}
		x_1\\x_2
		\end{matrix}
		\right]+\left[\begin{matrix}
		0\\ \frac{1}{m}
		\end{matrix}\right]u\\
		y &= \left[\begin{matrix}
		1 & 0
		\end{matrix}\right]\left[\begin{matrix}
		x_1 \\ x_2
		\end{matrix}\right]
	\end{align*}
\end{exercise}
\begin{exercise}[Παράδειγμα]
	Να γραφούν οι εξισώσεις κατάστασης του κυκλώματος:

	\begin{circuitikz}[american]
		\draw (0,2) to[V=$v_s(t)$] (0,0);
		\draw (0,2) to[R=$R$,i>^=$i$] (2,2)
		to[cute inductor=$L$] (4,2)
		to[C=$C$] (4,0)
		-- (0,0)
		;
	\end{circuitikz}

	\tcblower
	Λύνουμε το σύστημα με βάση τη φυσική του (νόμοι Kirchoff)
	\begin{align*}
		u_s(t) &=
		iR + L\od{i}{t} + \frac{1}{C} \int_{0}^{t} i \dif\tau
		\numberthis
		\label{eq:ex0ceq}
		\\
		L\od[2]{i}{t} + R\od{i}{t} + \frac{1}{C} i &= \od{u_s(t)}{t}
	\end{align*}

	Η είσοδος του συστήματος είναι η ανεξάρτητη τροφοδοσία \( u_s(t) \), και η έξοδος
	το ρεύμα \( i \), δηλαδή:
	\begin{align*}
		u &= u_s(t) \\
		y &= i
	\end{align*}
	άρα η τελευταία διαφορική εξίσωση γράφεται απλούστερα:
	\[
	\ddot y + \frac{R}{L}\dot y + \frac{1}{CL} y = \frac{1}{L} \dot u
	= 0\ddot u + \frac{1}{L}\dot u + 0u
	\]

	Αφού η είσοδος \( u \) είναι ανώτερης τάξης στη διαφορική αυτή, επιλέγουμε τις μεταβλητές
	κατάστασης με βάση τη σελ. \pageref{sec:nontd_highorder_system}:
	\begin{alignat*}{2}
		x_1 &= y-\beta_0u,\qquad && \beta_0 = 0\\
		x_2 &= \dot y-\beta_0 \dot u -\beta_1 u,\qquad && \beta_1 = \frac{1}{L}
	\end{alignat*}
	και εκτελώντας πράξεις:
	\begin{align*}
		x_1 = y &\implies \boxed{\dot x_1 = x_2 + \frac{1}{L}u} \\
		x_2 = \dot x_1 - \beta_1 u \implies \dot x_2 = \ddot y - \frac{1}{L}\dot u
		&\implies \dot x_2 = -\frac{R}{L}\dot y-\frac{1}{LC}y + \frac{1}{L}\dot u
			- \frac{1}{L} \dot u  \implies \\
		&\implies\boxed{\dot x_2 = -\frac{R}{L}x_2 - \frac{R}{L^2}u-\frac{1}{LC}x_1}\\
		\boxed{y=x_1}&
	\end{align*}

	\lecture{3}{2/3/2018}
	\paragraph{Με διαφορετική επιλογή μεταβλητών κατάστασης}
	Στην παραπάνω λύση διαλέξαμε τις μεταβλητές κατάστασης όπως γνωρίζαμε από τη θεωρία
	των ΣΑΕ, οι οποίες οδήγησαν σε ένα αποτέλεσμα, αλλά με αρκετές πράξεις.

	Εναλλακτικά, μπορούμε να διαλέξουμε διαφορετικές μεταβλητές κατάστασης. Στο συγκεκριμένο
	πρόβλημα, επειδή ασχολούμαστε με ένα ηλεκτρικό κύκλωμα, επιλέγουμε τις \textbf{τυπικές
		μεταβλητές} που αντιστοιχούν στην \textbf{τάση του πυκνωτή} \( x_1 \) και στο
	\textbf{ρεύμα του πηνίου} \( x_2 \):
	\begin{align*}
		x_1 &= \frac{1}{C} \int_{0}^{t} i\dif t\\
		x_2 &= i \implies \dot x_2 = \od{i}{t}
	\end{align*}
	και από αυτά προκύπτει ότι:
	\begin{align*}
		\dot x_1 &= \frac{1}{C} x_2\\
		\dot x_2 &= \frac{x_1-x_2 R + u}{L} \qquad \text{λόγω της \eqref{eq:ex0ceq}}
	\end{align*}
\end{exercise}

\begin{exercise}
	Έστω το μηχανικό σύστημα:

	\begin{circuitikz}
		\fill[postaction={decorate},pattern=north east lines] (0,3) rectangle (-0.5,-0.5) rectangle (10,0);

		\draw (2,0) rectangle ++(2,2) node[midway] {$M_2$} node[midway] (m2) {};
		\draw (6,0) rectangle ++(2,2) node[midway] {$M_1$} node[midway] (m1) {};

		\draw (2,0.4) to[damper,l_=$c_2$,invert] ++(-2,0);
		\draw (2,1.6) to[spring,invert,l_=\raisebox{-1.5ex}{$k_2$}] ++(-2,0);
		\draw (6,0.4) to[damper,l_=$c_1$,invert] ++(-2,0);
		\draw (6,1.6) to[spring,invert,l_=\raisebox{-1.5ex}{$k_1$}] ++(-2,0);

		\draw[thick,->] (8,1) -- ++(1.5,0) node[right] {$u$};

		\draw[thick] (0,3) |- (10,0);

		\draw[->] (m2) ++ (0,1.4) |- ++(2,0.7) node[above,pos=.75,gray] {$q_2$};
		\draw[->] (m1) ++ (0,1.4) |- ++(2,0.7) node[above,pos=.75,gray] {$q_1$};
	\end{circuitikz}

	Να βρεθούν οι εξισώσεις κατάστασης, θεωρώντας ότι η έξοδος είναι η μετατόπιση του δεξιού
	σώματος, δηλαδή:
	\[
	y= q_1
	\]

	\tcblower

	Εφαρμόζοντας το νόμο του Νεύτωνα για κάθε σώμα, και αθροίζοντας τις δυνάμεις που
	ασκούνται στο καθένα, έχουμε:
	\begin{align}
		M_1\ddot q_1 &= u - k_1(q_1-q_2) - c_1(\dot q_1 - \dot q_2)
		\label{eq:ex0eq1}
		\\
		M_2\ddot q_2 &= -k_1(q_2-q_1) - c_1(\dot q_2 - \dot q_1)-k_2q_2-c_2\dot q_2
		\label{eq:ex0eq2}
	\end{align}

	Το σύστημα αυτό είναι \textbf{4\textsuperscript{ης}} τάξης και 1\textsuperscript{ου}
	βαθμού, αφού έχουμε 2 εξισώσεις 2\textsuperscript{ης} τάξης. Επομένως πρέπει να βρούμε
	4 μεταβλητές και εξισώσεις κατάστασης.

	Λαμβάνουμε τις μεταβλητές κατάστασης με βάση τη θεωρία:
	\[
	x_1 = q_1, \hfill x_2=\dot q_1, \hfill x_3=q_2,\hfill x_4=\dot q_2
	\]
	οπότε, πιο καθαρά:
	\begin{align*}
		\dot x_1 &= x_2 \\
		\dot x_2 &= \frac{1}{M_1}u - \frac{k_1}{M_1}x_1 + \frac{k_1}{M_1}x_3
		+ \frac{k_1}{M_1}x_2 + \frac{C_1}{M_1}x_4
		\quad \text{(όπως προκύπτει από την \eqref{eq:ex0eq1})} \\
		\dot x_3 &= x_4\\
		\dot x_4 &= -\frac{k_1}{M_2}x_3 + \frac{k_1}{M_2}x_1 - \frac{c_1}{M_2}x_4
	    + \frac{c_1}{M_2}x_2 - \frac{k_2}{M_2}x_3 - \frac{c_2}{M_2}x_4
	    \quad \text{(όπως προκύπτει από την \eqref{eq:ex0eq2})}
	\end{align*}

	Σε μορφή πίνακα:
	\[
	\dot x = \left[\begin{matrix}
	0 & 1 & 0 & 0\\
	-\frac{k_1}{M_1} & -\frac{c_1}{M_1} & \frac{k_1}{M_1} & \frac{c_1}{M_1}\\
	0 & 0 & 0 & 1\\
	\frac{k_1}{M_2} & \frac{c_1}{M_2} & -\left(\frac{k_1+k_2}{M_2}\right)
	& -\left(\frac{c_1+c_2}{M_2}\right)
	\end{matrix}\right]\left[\begin{matrix}
	x_1 \\ x_2 \\ x_3 \\ x_4
	\end{matrix}\right] + \left[
	\begin{matrix}
	0 \\ \sfrac{1}{M_1} \\ 0 \\ 0
	\end{matrix}
	\right]u
	\]
\end{exercise}

\subsection{Μετασχηματισμός Laplace}
Θυμόμαστε μια τυπική έκφραση ενός συστήματος συστήματος:
\[
y^{(n)} + a_1y^{(n-1)} + a_2y^{(n-2)} + \dots + a_{n-1}\dot y + a_n y =
b_0 u^{(m)} + b_1u^{(m-1)} + \dots + b_{m-1}\dot u + b_m u
\]

Αυτή μπορεί να μετασχηματιστεί κατά Laplace, όπως γνωρίζουμε:
\[
\left(
s^n + a_1s^{n-1} + \dots + a_{n-1}s + a_n
\right)Y(s) = \left(
b_0s^m + b_1s^{m-1} + \dots + b_{m-1}s+b_m
\right)U(s)
\]
και η \textbf{συνάρτηση μεταφοράς} προκύπτει κατά τα γνωστά:
\[
\frac{Y(s)}{U(s)} = \frac{
	b_0s^m + b_1s^{m-1} + \dots + b_{m-1}s+b_m
	}{
	s^n + a_1s^{n-1} + \dots + a_{n-1}s + a_n
	}
\] όπου συνήθως \( n \geq m \).

Προκύπτει το ερώτημα του πώς μπορεί να προκύψει η συνάρτηση μεταφοράς από τις εξισώσεις
κατάστασης, δηλαδή από την περιγραφή (σε μορφή πινάκων):
\begin{align*}
\dot x &= Ax	+ Bu\\
y &= Cx + Du
\end{align*}
όπου οι συντελεστές \( A,B,C,D \) είναι γνωστοί.

Μετασχηματίζοντας τις παραπάνω σχέσεις κατά Laplace, έχουμε:
\begin{align*}
	sX(s) &= AX(s) + BU(s) \\
	Y(s) &= CX(s) + DU(s)
\end{align*}

Εκτελούμε πράξεις:
\begin{align*}
	(sI-A)X(s) &= BU(s) \implies \\
	X(s) &= (sI-A)^{-1} B U(s) \implies \\
	Y(s) &= \left[ C(sI-A)^{-1}B+D \right]U(s)
\end{align*}
δηλαδή η συνάρτηση μεταφοράς προκύπτει από τον τύπο:
\[
\boxed{
	G(s) = \frac{Y(s)}{U(s)} = C(sI-A)^{-1}B+D
	}
\]

Ο υπολογισμός της συνάρτησης μεταφοράς μπορεί να φανεί χρήσιμος ανάλογα με τον τρόπο με
τον οποίο θέλουμε να λύσουμε ένα πρόβλημα. Για παράδειγμα, μπορεί να εφαρμοστεί αν θέλουμε
να εκμεταλλευτούμε τεχνικές του προηγούμενου εξαμήνου (π.χ. γεωμετρικός τόπος ριζών).

Υπενθυμίζουμε ότι σε ένα σύστημα αντιστοιχεί μία μοναδική διαφορική εξίσωση και μία μοναδική
συνάρτηση μεταφοράς, αλλά άπειρες διαφορετικές επιλογές μεταβλητών και εξισώσεων κατάστασης.

\subsection{Αριθμητική επίλυση διαφορικών εξισώσεων}
Για την αριθμητική επίλυση των διαφορικών εξισώσεων μπορούμε να χρησιμοποιήσουμε μια μέθοδο
όπως η \textbf{μέθοδος Euler}, προσομοιώνοντας ουσιαστικά το μοντέλο του συστήματος.
Εκμεταλλευόμαστε τον ορισμό της παραγώγου:
\[
\dot x = \frac{x(t+\Delta t) - x(t)}{\Delta t}
\]

Ορίζουμε μια συνάρτηση που εκφράζει την παράγωγο:
\[
\dot x = f(x)
\]
επομένως:
\[
x(t+\Delta t) = f\left( x(t) \right) \cdot \Delta t + x(t)
\]
όπως προκύπτει από τον ορισμό της παραγώγου.

Για μικρό \( \Delta t \) η μέθοδος αυτή οδηγεί στο επιθυμητό αποτέλεσμα.

\subsection{Μελέτη Ευστάθειας Συστήματος}
Θα μελετήσουμε \textbf{τρόπους εύρεσης της ευστάθειας} ενός συστήματος, οι οποίες όμως δεν απαιτούν
προσομοίωση ή αναλυτική επίλυση.

Ο λόγος που δεν μπορούμε να εφαρμόσουμε αναλυτική επίλυση, είναι ότι πολλές φορές είναι
δύσκολη η επίλυση των διαφορικών εξισώσεων που περιγράφουν τα συστήματα, ιδιαίτερα αν είναι
μη γραμμικές.

Από την άλλη μεριά, η προσομοίωση λειτουργεί μόνο για μία επιλογή αρχικών τιμών. Μπορεί να
δώσει ενδείξεις ευστάθειας, αλλά όχι να την αποδείξει για όλο το εύρος των άπειρων αρχικών
συνθηκών.

Πρέπει επομένως να βρούμε τρόπους να \textit{αποδείξουμε} την ευστάθεια ή μη ενός συστήματος,
η οποία να μην βασίζεται απλώς στην εμπειρία μας.

\paragraph{Παράδειγμα}
Έστω το σύστημα:
\[
\dot x = \left[\begin{matrix}
\dot x_1\\ \dot x_2
\end{matrix}\right] = \left[\begin{matrix}
x_2 \\ -\frac{c}{m}x_2 - \frac{k}{m}x_1
\end{matrix}\right] = f(x)
\]
το οποίο αναφέρεται σε ένα σώμα μάζας \( m \) που κινείται με την επίδραση ενός ελατηρίου
\( k \) και ενός αποσβεστήρα \( c \).

Η \textbf{ενέργεια} του συστήματος, όπως προκύπτει από τις γνώσεις μας στη φυσική, είναι:
\[
V(x_1,x_2) =
\underbrace{\frac{1}{2}kx_1^2}_{\mathclap{\text{Δυναμική Εν.}}}
\quad +\quad
\underbrace{\frac{1}{2}mx_2^2}_{\mathclap{\text{Κινητική Εν.}}}
\]

Αν την παραγωγίσουμε, έχουμε:
\begin{align*}
	\dot V &=
	kx_1\dot x_1 + mx_2\dot x_2 \\
	&= kx_1x_2 + mx_2 \left(
	-\frac{c}{m}x_2 - \frac{k}{m}x_1
	\right)
	\\ &= kx_1x_2 - cx_2^2 - kx_1x_2
	\\ &= -cx_2^2 \quad \leq 0
\end{align*}
δηλαδή παρατηρούμε ότι η \textbf{παράγωγος} της ενέργειας είναι \textbf{αρνητική}, άρα η ενέργεια του
συστήματος σχεδόν κάθε στιγμή μειώνεται (φθίνουσα)! Αυτό μπορούμε να το αντιληφθούμε αφού στο σύστημα δεν
ασκούνται εξωτερικές δυνάμεις, και εκτελεί κάποια ταλάντωση με μια απόσβαση που συνεχώς
αφαιρεί ενέργεια.

Δηλαδή κάθε στιγμή η ενέργεια είναι μικρότερη από την αρχική
\( V\left( x_1(0),\ x_2(0) \right) \):
\[
	V\left( x_1(0),\ x_2(0) \right) \geq \frac{1}{2}k x_1^2
	+ \frac{1}{2}mx_2^2
\]

Αυθαίρετα κρατάμε μόνο τον έναν όρο της παραπάνω σχέσης:
\begin{align*}
	V\left( x_1(0),\ x_2(0) \right) &\geq \frac{1}{2}k x_1^2 \implies \\
	\frac{1}{2}kx_1^2(0) + \frac{1}{2}mx_2^2(0) &\geq \frac{1}{2}kx_1^2
	\implies \boxed{
		x_1(t) \leq \sqrt{x_1^2(0) + \frac{m}{k}x_2^2(0)}
		}\quad \forall t \geq 0
\end{align*}
ή, αν κρατήσουμε τον άλλον όρο:
\begin{align*}
V\left( x_1(0),\ x_2(0) \right) &\geq \frac{1}{2}m x_x^2 \implies \\
\frac{1}{2}kx_1^2(0) + \frac{1}{2}mx_2^2(0) &\geq \frac{1}{2}mx_2^2
\implies \boxed{
	x_2(t) \leq \sqrt{\frac{k}{m}x_1^2(0) + x_2^2(0)}
}\quad \forall t \geq 0
\end{align*}

Παρατηρούμε δηλαδή ότι οι μεταβλητές κατάστασης είναι \textbf{φραγμένες}, δηλαδή δεν ξεπερνούν κάποια τιμή, το οποίο δηλώνει ευστάθεια του συστήματος, αφού δεν φτάνουν μέχρι
το \( \infty \).

\paragraph{}
Παραπάνω είδαμε ένα πρόβλημα στο οποίο \( \dot V(x_1,x_2) \leq 0 \). Η δυνατότητα ισότητας
(\( = \)) με το 0 δηλώνει ότι η συνάρτηση είναι απλά \textit{φθίνουσα}, και όχι
\textit{γνησίως φθίνουσα}, που σημαίνει ότι υπάρχουν διαστήματα στα οποία η παράγωγος
της ενέργειας είναι 0, και η ενέργεια παραμένει σταθερή χωρίς να μειώνεται. Έστω ένα τέτοιο
διάστημα στο παραπάνω σύστημα:
\[
\dot V(x_1,x_2) = 0
\xRightarrow{\dot V = -cx_2^2 \leq 0}
x_2 = 0
\xRightarrow[\dot x_2 = -\frac{c}{m} x_2 - \frac{k}{m} x_1]{\text{εξ. κατάστασης}}
x_1 = 0
\]

\begin{exercise}
	Έστω ένα ποδήλατο σε κάτοψη (το κοιτάμε από πάνω):

	\begin{circuitikz}
		\def\rightsize{0.2}
		\def\rang{9}

		\draw (0,5) |- (5,0);

		\draw[gray,mark position=0.8(d1),mark position=0.3(d1m)] (2,2) ++ (-45:0.1) -- ++(-45:2);
		\draw[gray,mark position=0.78(dm)] (3,3) -- ++(-45:1);
		\draw[gray,mark position=0.8(d2)] (4,4) ++ (-\rang:0.1) -- ++(-45:2);
		\draw[gray,<->] (d1m) -- (dm) node[midway,sloped,fill=white] {$s$};
		\draw[gray,<->] (d1) -- (d2) node[midway,sloped,fill=white] {$L$};

		\draw (2,2) node[very thick,
		rectangle,draw,postaction={decorate},pattern=vertical lines,minimum height=1.2cm,rotate=-45
		] (w1) {};
		\draw (3,3) node (wm) {};
		\draw (4,4) node[very thick,
		rectangle,draw,postaction={decorate},pattern=north west lines,minimum height=1.2cm,rotate=-\rang
		] (w2) {};

		\draw[dashed] (0,0) -- (w1);
		\draw (0.5,0) to[bend right] node[right,midway,scale=.9] {$\theta$} (45:0.5);

		\path (w1) -- (w2) node[pos=1] (b) {} node[midway] (m) {};
		\draw[red!30!orange!70!black,thick,->] (wm.center) -- ++(90:1.2) node[left] {$u$} node[pos=.3] (u) {};
		\draw[red!30!orange!30!black] (wm) ++(45:0.3*1.2) to[bend right] node[pos=.3,above,scale=.8] {$\phi$} (u.center);
		\draw[very thick] (w1) -- (w2) {};

		\path (2,2) ++(90:0.15) node[inner sep=0,outer sep=0] (a) {};
		%	\path (a) ++(45+90:4) node (O) {};
		\begin{scope}[overlay]
			\path [name path=(wpa)] (a) -- ++(45+90:8);
			\path [name path=(wpb)] (b.center) -- ++(180-\rang:8);
			\path [name intersections={of=(wpa) and (wpb),by=O}];
		\end{scope}

		\draw[brown!50!gray,dashed] (O.center) -- (a.center) node[midway,above,sloped] {$r$};
		\draw[brown!50!gray] (a.center) ++(45:\rightsize) -- ++(45+90:\rightsize) node (ram) {} -- ++(45+180:\rightsize);
		\path (a) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};
		\draw[brown!50!gray,dashed] (O.center) -- (b.center);
		\draw[brown!50!gray] (b.center) ++(90-\rang:\rightsize) -- ++(180-\rang:\rightsize) node (ram) {} -- ++(-\rang-90:\rightsize);
		\path (b.center) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};
		\draw[brown!50!gray,dashed] (O.center) -- (wm.center);

		\draw[dashed] (w2) -- ++(90-\rang:1.5) node[midway] (w2m1) {};
		\draw[dashed] (w2.north) -- ++(45:1) node[pos=.4] (w2m2) {}
		(w2.north) edge[opacity=.1] ++(180+45:4);
		\draw[red!30!orange!30!black] (w2m1.center) to[bend left] (w2m2.center) node[above,xshift=0mm,yshift=1mm,scale=.9] {$\delta$};

		\filldraw[bottom color=magenta!80!black,top color=black] (O) circle(2.5pt)
		node[above,yshift=2pt] {$O$};
		\draw (wm.center) node[circle,fill,inner sep=1.5pt] {};
	\end{circuitikz}

	Το ποδήλατο έχει κέντρο μάζας και περιστρέφεται γύρω από ένα σημείο \( O \).
	\tcblower

	Κυνηγούμε γωνίες και τις προσθέτουμε στο σχήμα:\todo{fix the graph}

	\begin{circuitikz}
		\def\rightsize{0.2}
		\def\rang{9}

		\draw[<->] (0,6) node[left] {$y$} |- node[below left] {$O'$} (6,0) node[right] {$x$};

		\draw[gray,mark position=0.8(d1),mark position=0.3(d1m)] (2,2) ++ (-45:0.1) -- ++(-45:2);
		\draw[gray,mark position=0.78(dm)] (3,3) -- ++(-45:1);
		\draw[gray,mark position=0.8(d2)] (4,4) ++ (-\rang:0.1) -- ++(-45:2);
		\draw[gray,<->] (d1m) -- (dm) node[midway,sloped,fill=white] {$s$};
		\draw[gray,<->] (d1) -- (d2) node[midway,sloped,fill=white] {$L$};

		\draw (2,2) node[very thick,
		rectangle,draw,postaction={decorate},pattern=vertical lines,minimum height=1.2cm,rotate=-45
		] (w1) {};
		\draw (3,3) node (wm) {};
		\draw (4,4) node[very thick,
		rectangle,draw,postaction={decorate},pattern=north west lines,minimum height=1.2cm,rotate=-\rang
		] (w2) {};

		\draw[dashed] (0,0) -- (w1);
		\draw (0.5,0) to[bend right] node[right,midway,scale=.9] {$\theta$} (45:0.5);

		\path (w1) -- (w2) node[pos=1] (b) {} node[midway] (m) {};
		\draw[red!30!orange!70!black,thick,->] (wm.center) -- ++(90:1.2) node[left] {$u$} node[pos=.3] (u) {};
		\draw[red!30!orange!30!black] (wm) ++(45:0.3*1.2) to[bend right] node[pos=.3,above,scale=.8] {$\phi$} (u.center);
		\draw[very thick] (w1) -- (w2) {};

		\path (2,2) ++(90:0.15) node[inner sep=0,outer sep=0] (a) {};
		%	\path (a) ++(45+90:4) node (O) {};
		\begin{scope}[overlay]
			\path [name path=(wpa)] (a) -- ++(45+90:8);
			\path [name path=(wpb)] (b.center) -- ++(180-\rang:8);
			\path [name intersections={of=(wpa) and (wpb),by=O}];
		\end{scope}

		\draw[brown!50!gray,dashed,mark position=0.2(r1),mark position=0.4(r2)] (O.center) -- (a.center) node[near end,above,sloped] {$r$};
		\draw[brown!50!gray] (a.center) ++(45:\rightsize) -- ++(45+90:\rightsize) node (ram) {} -- ++(45+180:\rightsize);
		\path (a) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};
		\draw[brown!50!gray,dashed,mark position=0.35(r3)] (O.center) -- (b.center);
		\draw[brown!50!gray] (b.center) ++(90-\rang:\rightsize) -- ++(180-\rang:\rightsize) node (ram) {} -- ++(-\rang-90:\rightsize);
		\path (b.center) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};
		\draw[brown!50!gray,dashed, mark position=0.19(r4)] (O.center) -- (wm.center);

		\begin{scope}[thick,orange!50!red,opacity=.8]
			\draw (r1) to[bend right] node[midway,right,yshift=-4pt] {$\phi$}  (r4) ;
			\draw (r2) to[bend right] node[midway,below,xshift=2pt] {$\delta$} (r3) ;
		\end{scope}
		\draw[very thick,red!30!orange!70!black,->] ([yshift=1pt]w1.center) node[circle,fill,inner sep=1pt] {} -- ++(45:1) node[below right] {$u_0$};

		\draw[dashed] (w2) -- ++(90-\rang:1.5) node[midway] (w2m1) {};
		\draw[dashed] (w2.north) -- ++(45:1) node[pos=.4] (w2m2) {}
		(w2.north) edge[opacity=.1] ++(180+45:4);
		\draw[red!30!orange!30!black] (w2m1.center) to[bend left] (w2m2.center) node[above,xshift=0mm,yshift=1mm,scale=.9] {$\delta$};

		\filldraw[bottom color=magenta!80!black,top color=black] (O) circle(2.5pt)
		node[above,yshift=2pt] {$O$};
		\draw (wm.center) node[circle,fill,inner sep=1.5pt] {} node[right,yshift=0mm,xshift=1mm,scale=.7] {$(x,y)$};
	\end{circuitikz}

	Στα ορθογώνια τρίγωνα που προκύπτουν μεταξύ γωνιών και πλευρών, έχουμε:
	\[
	\left.
	\begin{aligned}
	\tan\phi &= \frac{s}{r}\\
	\tan\delta &= \frac{L}{r}
	\end{aligned}\right\rbrace
	\implies \tan\phi = \frac{S}{L}\tan\delta
	\]

	Θεωρώντας ότι ο κάτω τροχός κινείται με ταχύτητα \( u_0 \), έχουμε:
	\[
	u\cos\phi = u_0
	\]

	Τώρα πρέπει να βρούμε μια διαφορική εξίσωση που να περιγράφει την κίνηση του
	κέντρου βάρους του ποδηλάτου. Έστω λοιπόν \( (x,y) \) οι συντεταγμένες του κέντρου. Τότε:
	\begin{align*}
		\Aboxed{\od{x}{t} &=
		u \cos (\phi+\theta) = \frac{u_0\cos(\phi+\theta)}{\cos\phi}} \\
		\Aboxed{\od{y}{t} &=
		u \sin(\phi+\theta) = \frac{u_0\sin(\phi+\theta)}{\cos\phi}}
	\end{align*}

	Επίσης πρέπει να βρούμε εξισώσεις κατάστασης για τον προσανατολισμό του ποδηλάτου.

	Η γωνιακή ταχύτητα δίνεται από τη σχέση:
	\[
	\omega = \frac{u_0}{r} \qquad \text{ή} \qquad \omega = \od{\phi}{t}
	\]
	και, επειδή \( \tan\delta = \frac{L}{r} \):
	\[
	\omega = \frac{u_0}{L}\tan\delta
	\]

	Για μία μικρή μεταβολή \( \Delta \phi \) του προσανατολισμού του ποδηλάτου:

	\begin{tikzpicture}
	\def\rightsize{0.15}

	\draw (0,0) node[circle,fill,inner sep=1pt] {} node[below right] {$O$};
	\draw (0,0) -- ++(90:2) node (a) {} node[pos=.2] (aa) {};
	\draw (0,0) -- ++(60:2) node (b) {} node[pos=.2] (ba) {};

	\draw[brown!50!gray] (a.center) ++(0:\rightsize) -- ++(-90:\rightsize) node (ram) {} -- ++(180:\rightsize);
	\path (a.center) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};
	\draw[brown!50!gray] (b.center) ++(180-30:\rightsize) -- ++(-30-90:\rightsize) node (ram) {} -- ++(-30:\rightsize);
	\path (b.center) -- (ram.center) node[midway,fill=brown!50!gray,circle,inner sep=0.2pt] {};

	\draw[green!50!black,dashed] (-0.7,2.07) -- ++(-2:2) node[pos=.4] (ca) {};
	\draw[green!50!black,dashed] (50:2.07) -- ++(150:2) node[pos=.7] (da) {};

	\draw[very thick,blue!60!black] (0,0) ++ (100:2) arc [start angle=100,end angle=50,radius=2cm];

	\draw[opacity=.8] (aa.center) to[bend left] node[midway,above,xshift=1.5pt,fill=white,fill opacity=.4,text opacity=1,scale=.7] {$\Delta\phi$} (ba.center);
	\draw[opacity=.8,green!20!black] (ca.center) to[bend left] node[midway,left,yshift=1pt,fill=white,fill opacity=.4,text opacity=1,scale=.6] {$\theta$} (da.center);
	\end{tikzpicture}

	Οι γωνίες \( \Delta \phi \) και \( \theta \) είναι μεταξύ τους κάθετες, άρα ίσες,
	επομένως:
	\[
	\boxed{\od{\theta}{t} = \frac{u_0}{L} \tan\delta}
	\]
\end{exercise}

\lecture{4}{7/3/2018}

\section{Δυναμικά συστήματα}
Με τον όρο \textit{δυναμικά συστήματα} εννοούμε τα συστήματα των οποίων η συμπεριφορά αλλάζει με το χρόνο, δηλαδή όλα τα συστήματα
τα οποία μελετάμε.

Αφού ολοκληρωθεί η διαδικασία της μοντελοποίησης, οδηγούμαστε σε ένα σύστημα της μορφής:
\begin{align*}
\dot x &= f(x,u) \\
	y &= h(x,u)
\end{align*}
όπου στόχος μας είναι να έχουμε κατάλληλη είσοδο \( u \) ώστε να
πετύχουμε έξοδο \( y \), όπου \( x \) είναι οι μεταβλητές κατάστασης.
\todo{wrap right graph of closed loop system?}


Αρχικά, επιλέγουμε η είσοδος να \textbf{εξαρτάται μόνο από την κατάσταση του συστήματος}. Αυτή είναι η πιο απλή μορφή ανάδρασης,
όπου δηλαδή η κατάσταση του συστήματος επηρεάζει την είσοδό του. Μαθηματικά:
\[
u = a(x)
\]
τότε:
\[
\dot x = f\left(x,\ a(x)\right)
\]
ή, θέτοντας κατάλληλα:
\[
\dot x = F(x)
\]
οπότε έχουμε να λύσουμε μια διαφορική εξίσωση:
\[
\od{x(t)}{t} = F\left( x(t) \right),\quad \forall \in [t_1,t_2]
\]

Οι ειδικές λύσεις της διαφορικής εξίσωσης, ως γνωστόν, είναι άπειρες. Για
να τις προσδιορίσουμε ακριβώς χρειάζεται να προσδιορίσουμε τις \textbf{αρχικές
	συνθήκες}:
\[
x(t_0) = x_0
\]

Επίσης θέλουμε η \( F(x) \) να είναι \textbf{ομαλή}, δηλαδή να έχει συνεχείς
παραγώγους όλων των τάξεων. Παρ' όλα αυτά, ακόμα και με την ομαλότητα δεν μπορούμε να εγγυηθούμε αν το σύστημα
έχει λύση, και αν αυτή η λύση είναι \textbf{μοναδική}. Όταν μία (μη γραμμική)
διαφορική εξίσωση έχει περισσότερες λύσεις, τότε δεν μπορούμε να γνωρίζουμε ποιά
από όλες τις αποκρίσεις είναι αυτή που θα επιστρέψει το σύστημα.

\begin{exercise}[Παράδειγμα]
	Έστω το σύστημα:
	\[
	\dot x = x^2
	\]
	για \( x\in\mathbb R,\quad x(0) = 1 \)
	\tcblower
	Το σύστημα αυτό έχει προφανή λύση:
	\[
	x(t) = \frac{1}{1-t}
	\]

	Όμως για \( t\to 1 \), το \( x(t) \) τείνει στο \( \infty \), δηλαδή το
	σύστημα ουσιαστικά \textit{δεν έχει λύση} στο \( t = 1 \).

	Διαπιστώνουμε δηλαδή ότι η παραπάνω συνθήκη της θεωρίας δεν αρκεί για να
	διαπιστώσουμε ότι υπάρχει εύλογη λύση του συστήματος.
\end{exercise}
\begin{exercise}[Παράδειγμα]
	Έστω το σύστημα:\[
	\dot x = 2\sqrt{x}
	\]
	για \( x \in \mathbb R,\quad x(0) = 0 \)
	\tcblower
	Μπορούμε να διαπιστώσουμε ότι η λύση της διαφορικής εξίσωσης είναι:
	\[
	x(t) = \begin{cases}
	0,\quad & \text{αν } t \in [0,a]\\
	(t-a)^2,\quad & \text{αν } t > a
	\end{cases}
	\] για \( a > 0 \).

	Εδώ παρατηρούμε πως εισάγεται στη λύση ένας συντελεστής \( a \), ο οποίος όμως δεν υπάρχει
	στην αρχική διαφορική εξίσωση, αλλά εμφανίζεται απλώς στη λύση του συστήματος. Αυτό συμβαίνει
	ακόμα και με την ύπαρξη της αρχικής συνθήκης \( x(0) = 0 \).

	Δηλαδή το σύστημα αυτό έχει άπειρες λύσεις, που εξαρτώνται από την τιμή του \( a \).
	Όμως δεν μπορούμε να γνωρίζουμε εκ των προτέρων πώς θα αποκριθεί αυτό.
\end{exercise}

Παρατηρούμε ότι δηλαδή η ομαλότητα του δεξιού μέλους των διαφορικών εξισώσεων δεν εξασφαλίζει
την ύπαρξη και τη μοναδικότητα των λύσεων.

\begin{theorem}{Συνέχεια κατά Lipschitz}{}
	Εισάγουμε την έννοια της τοπικής \textbf{συνέχειας κατά Lipschitz}, που ικανοποιείται ότανν\footnote{όταν και μόνο όταν}:
	% Not a typo!
	\[
	\left|
	F(z_1) - F(z_2)
	\right|
	\leq \kappa |z_1-z_2|\qquad \forall z_1,z_2 \in \Omega \subset \mathbb R^n
	\]

	Αυτή είναι μια ιδιαίτερα αυστηρή συνθήκη για μη γραμμικές διαφορικές εξισώσεις.
	\tcblower

	Όταν η συνάρτηση \(  F \) είναι \textbf{συνεχής κατά Lipschitz}, τότε η λύση του συστήματος \textbf{υπάρχει} και
	είναι \textbf{μοναδική}.
\end{theorem}

Πρακτικά, για να ικανοποιείται η συνθήκη, πρέπει η συνάρτηση να βρίσκεται κάτω από μία ευθεία \( k|z| \), για κάποιο
πεπερασμένο \( k \):

\begin{tikzpicture}
\draw[->] (0,-0.5) -- (0,3);
\draw[->] (-0.5,0) -- (3,0);

\draw[red!50!orange!90!blue,very thick] (0,0) -- (45:4) node[midway,above left] {$k|z|$};
\draw[blue!50!cyan,thick]
plot [smooth,samples=8,variable=\x,domain=0:3]
(\x,{\x/2*(rand+2)/2}) (2,0) node[above] {$F(x)$};
\end{tikzpicture}

Διαφορετικά, για κάποιες συναρτήσεις, όπως η εκθετική, δεν υπάρχει ευθεία η οποία να βρίσκεται
επάνω από τη συνάρτηση για οποιαδήποτε κλίση. Υπάρχουν μόνο τιμές του \( k \) που είναι
πιο πάνω από τη συνάρτηση μέχρι \textit{συγκεκριμένα σημεία}:

\begin{tikzpicture}
\draw[->] (0,-0.5) -- (0,4.5);
\draw[->] (-0.5,0) -- (4,0);

\draw[red!50!orange!90!blue,very thick] (0,0) -- (45:5) node[midway,sloped,above left] {$k_2|z|$};
\draw[red!30!orange!90!blue,very thick] (0,0) -- (25:5) node[pos=.85,sloped,above left] {$k_1|z|$};
\draw[blue!50!cyan,thick]
plot [smooth,samples=\vlowsamples,variable=\x,domain=0:3]
(\x,{0.06*(exp(1.4*\x)-1)}) node[above] {$F(x)$};

\coordinate (m) at (2.01,0.91);
\coordinate (n) at (2.74,2.70);

\draw[dashed] (m) -- (m |- 0,0) (n) -- (n |- 0,0);
\end{tikzpicture}

\paragraph{}
\textbf{Ικανή συνθήκη} (αλλά όχι και \textit{αναγκαία}) για να ικανοποιείται η συνέχεια
κατά Lipschtz σε κάποιον χώρο \( \Omega \) είναι η \textbf{ιακωβιανή ορίζουσα} \( \od{F}{x} \) να είναι φραγμένη εκεί.

\subsubsection{Σημείο ισορροπίας}
\begin{defn}{Σημείο Ισορροπίας}{}
	Για το σύστημα:\[
	\dot x = F(x)
	\]
	ονομάζουμε \textbf{σημείο ισορροπίας} την τιμή του \( x \) που μηδενίζει το δεξί μέλος,
	δηλαδή ένα \( x^* \) τέτοιο ώστε:
	\[
	F(x^*) = 0
	\]

	Ένα σύστημα μπορεί να έχει μηδέν, ένα, πολλαπλά ή άπειρα σημεία ισορροπίας.
\end{defn}

Τα σημεία ισορροπίας είναι σημαντικά, επειδή δηλώνουν πώς όταν φτάσει σε αυτά τα σημεία, το σύστημα
\( \dot x = F(x) \) που \textit{δεν εξαρτάται από το χρόνο και από εξωτερικές επιρροές},
τότε το σύστημα δεν πρόκειται να μεταβληθεί. Δηλαδή \textit{ισορροπεί} στο \( x^* \).

\begin{exercise}[Παράδειγμα]
	\begin{wrapfigure}{r}{0.2\textwidth}
		\begin{center}
		\begin{tikzpicture}[scale=1.2]
		\draw (-1,0) -- (1,0);
		\draw (0,0) node[circle,inner sep=2pt,fill] {};
		\draw[very thick] (0,0) -- ++(90:1.5) node[circle,inner sep=2pt,fill=white,draw] {} node[pos=.5] (a) {};
		\draw[very thick] (0,0) -- ++(70:1.5) node[circle,inner sep=2pt,fill=white,draw] {} node[pos=.5] (b) {};

		\draw[brown,->] (a.center) to[bend left] node[midway,above,xshift=1pt] {$\theta$} (b.center);

		\begin{scope}[opacity=.5,dashed]
		\draw[thick] (0,0) -- ++(-90:1.5cm-2/2pt) node[circle,inner sep=2pt,fill=white,draw,anchor=north] {} node[pos=.2] (c) {};
		\draw[brown,->] (0,0.3) arc [start angle=90,end angle=-90,radius=0.3];
		\end{scope}
		\end{tikzpicture}
		\end{center}
	\end{wrapfigure}


	Ένα απλοποιημένο μοντέλο του αναστρεφόμενου εκκρεμούς, για μικρή γωνία \( \theta \), είναι:
	\[
	\left[
	\begin{matrix}
	\dot x_1 \\ \dot x_2
	\end{matrix}
	\right] = \left[
	\begin{matrix}
	x_2 \\ \sin x_1 - cx_2 + u\cdot \cos x_1
	\end{matrix}
	\right]
	\]
	όπου το \( x_1 \) εκφράζει τη \textbf{γωνία} \( \theta \), το \( x_2 \) εκφράζει
	τη \textbf{γωνιακή ταχύτητα} του εκκρεμούς, και το \( u \) εκφράζει την εξωτερική ροπή
	που ασκείται σε αυτό.

	Να βρεθούν τα σημεία ισορροπίας του.
	\tcblower
	Για την εύρεση των σημείων ισορροπίας, θεωρούμε
	\textbf{μηδενική εξωτερική επιρροή}, δηλαδή \( \underline{u=0} \), οπότε λύνουμε
	την εξίσωση \( F(x^*) = 0 \):
	\[
	\left[
	\begin{matrix}
	\dot x_1 \\ \dot x_2
	\end{matrix}
	\right] = \left[\begin{matrix}
	x_2 \\ \sin x_1 - cx_2
	\end{matrix}
	\right] = 0
	\implies
	\begin{cases}
	x_2 &= 0 \\
	\sin x_1 &= 0 \implies x_1 = \kappa \pi \quad \kappa \in \mathbb Z
	\end{cases}
	\]

	Μαθηματικά, η παραπάνω εξίσωση έχει άπειρες λύσεις, αφού \( \kappa \in\mathbb Z \).
	Όμως πρακτικά, αυτές οι τιμές αντιστοιχούν στις γωνίες \( \ang{0} \) και
	\( \ang{180} \), δηλαδή στις δύο απέναντι κατακόρυφες θέσεις του εκκρεμούς.
\end{exercise}

\begin{defn}{Απομονωμένο Σημείο Ισορροπίας}{}
	Ένα σημείο ισορροπίας ονομάζεται \textbf{απομονωμένο} αν υπάρχει κύκλος
	με κέντρο το σημείο αυτό και ακτίνα μη μηδενική ο οποίος \textit{δεν} περιέχει άλλο
	σημείο ισορροπίας.

	Πρακτικά δηλαδή όταν δεν υπάρχει άλλο σημείο ισορροπίας δίπλα στο πρώτο.
\end{defn}

\begin{defn}{Οριακός Κύκλος}{}
	\textbf{Οριακός Κύκλος} ονομάζεται μια \textbf{κλειστή περιοδική} τροχιά των λύσεων του
	συστήματος.

	Ο οριακός κύκλος είναι χαρακτηριστικό των μη γραμμικών συστημάτων. Δεν έχει απαραίτητα
	κυκλικό σχήμα. Εκφράζει γραμμικές ταλαντώσεις.
\end{defn}

Με τον όρο \textit{κλειστή} τροχιά εννοούμε μια τροχιά η οποία καταλήγει
εκεί απ' όπου ξεκίνησε.

Σε ένα \textit{μη γραμμικό} σύστημα, δεν υπάρχει δεύτερη \textit{κλειστή περιοδική} τροχιά
\textit{γειτονικά} από μια πρώτη \textit{κλειστή περιοδική} τροχιά, κάτι που μπορεί να ισχύει
στα γραμμικά συστήματα. Μπορούν βέβαια να υπάρχουν ανοιχτές τροχιές που να συγκλίνουν ή να
αποκλίνουν από τον οριακό κύκλο.

\begin{center}
\begin{tikzpicture}[scale=.8]
\draw[->] (-3,0) -- (3,0) node[below] {$x_1$};
\draw[->] (0,-3) -- (0,3) node[right] {$x_2$};

\draw[gray,dashed] (0,0) -- (40:0.6);
\draw[gray,dashed] (0,0) -- (250:2.4);

\draw[very thick,green!70!blue]
(0,0) circle (0.6cm);
\draw[very thick,green!75!blue]
(0,0) circle (1.2cm);
\draw[very thick,green!80!blue]
(0,0) circle (2.4cm);

\draw (current bounding box.south) node[below] {γραμμικό σύστημα};

\begin{scope}[xshift=10cm,local bounding box=scope1]
\draw[->] (-3,0) -- (3,0) node[below] {$x_1$};
\draw[->] (0,-3) -- (0,3) node[right] {$x_2$};

\draw[very thick,green!70!blue]
(0,0) circle (0.9cm);
\draw[very thick,green!80!blue]
plot[smooth,samples=\midsamples,variable=\t,domain=0:2*pi]
({(0.9+\t/6.28)*sin(-\t r)},{(0.9+\t/6.28)*cos(\t r)})
;

\draw (scope1.south) node[below] {μη γραμμικό σύστημα};
\end{scope}
\end{tikzpicture}
\end{center}

\begin{exercise}[Παράδειγμα]
	\begin{align*}
		\dot x_1 &= x_2 + x_1(1-x_1^2-x_2^2) \\
		\dot x_2 &= -x_1+x_2(1-x_1^2-x_2^2)
	\end{align*}
	\tcblower
	Μπορούμε να διαπιστώσουμε ότι το σύστημα έχει λύση:
	\[
	\left(
	x_1(t),\ x_2(t)
	\right) = \left(
	\sin t,\ \cos t
	\right)
	\]

	Ο οριακός κύκλος εξαρτάται από το δεξί μέλος των εξισώσεων, και στο συγκεκριμένο
	παράδειγμα είναι όντως ένας κύκλος.
\end{exercise}

\subsubsection{Ευστάθεια}
\begin{defn}{Ευσταθές σημείο ισορροπίας}{}
	Έστω το σύστημα:
	\[
	\dot x = F(x)
	\]
	όπου η \( F \) τοπικά συνεχής κατά \( Lipschitz \),
	και έστω η μοναδική του λύση για κάθε στιγμή \( t \), με αρχική συνθήκη \( x_0 \):
	\[
	x(t;\ x_0)
	\]
	και ένα σημείο ισορροπίας του:
	\[
	x^*
	\]

	Το σημείο \( x^* \) ονομάζεται \textbf{ευσταθές σημείο ισορροπίας} ανν:
	\[
	\forall \epsilon > 0,\quad
	\exists \delta(\epsilon) > 0 :
	\left|x_0-x^*\right| < \delta
	\implies \left| x^*-x(t;\ x_0) \right| < \epsilon,\quad \forall t \geq 0
	\]
\end{defn}

Πρακτικά, ξεκινάμε \textit{κοντά} από το σημείο ισορροπίας ( \( \left|x_0-x^*\right| < \delta \) ), και παραμένουμε \textit{κοντά}
σε αυτό. Δηλαδή, για να ικανοποιείται ο ορισμός, θα
πρέπει και το σημείο που φτάνουμε \( x(t; x_0) \) να είναι αρκετά κοντά στο σημείο ισορροπίας
\( x^* \), \textit{όσο προχωράει ο χρόνος}.

\begin{center}
\begin{tikzpicture}[scale=1.1]
\draw[->] (-3,0) -- (3,0) node[below] {$x_1$};
\draw[->] (0,-3) -- (0,3) node[right] {$x_2$};

\def\xox{-0.5};
\def\xoy{-0.5};
\coordinate (x0) at (\xox,\xoy);

\def\r{  (sqrt(  (\xox*\xox + \xoy*\xoy) ))  * (1+0.2*\t)   }
\def\phi{atan2(\xoy,\xox)}
\draw[ultra thick,green!50!blue,->]
plot[smooth,samples=\midsamples,variable=\t,domain=0:3*pi]
({\r*cos(-\t r + \phi)},{\r*sin(-\t r + \phi)})
node[circle,fill opacity=.5,fill,draw,inner sep=1.5pt,thick,opacity=.1,anchor=north west] {}
;

\path (0,0) node[circle,fill opacity=.5,fill,draw,inner sep=2pt,thick,fill=red!50!black] (O) {};
\path (x0) node[circle,fill opacity=.5,fill,draw,inner sep=1.2pt] {};
\draw (O) node[above right] {$x^*$};
\draw (x0) node[below left] {$x_0$};

\draw[green,thick,dashed] (0,0) circle (1cm);
\draw[green,thick,dashed] (0,0) circle (2.4cm);
\draw[densely dashed,blue!20!green!50!black] (0,0) -- (-50:1) node[above,midway,sloped] {$\delta$};
\draw[densely dashed,blue!20!green!50!black] (0,0) -- (165:2.4) node[above,midway,sloped] {$\varepsilon$};
\end{tikzpicture}
\end{center}

Ο παραπάνω ορισμός εκφράζει την έννοια της ευστάθειας μόνο του \textbf{σημείου ισορροπίας}, όχι ολόκληρου του συστήματος.
Το \textbf{σύστημα} ονομάζεται \textbf{ευσταθές} αν όλα τα σημεία ισορροπίας του είναι \textit{ευσταθή}.

\begin{defn}{Ασυμπτωτικά ευσταθές σημείο ισορροπίας}{}
	Ένα σημείο ισορροπίας ονομάζεται \textbf{ασυμπτωτικά ευσταθές} ότανν:
	\begin{enumerate}
		\item Είναι ευσταθές
		\item Ισχύει:
		\[
		\lim_{t \to +\infty}x(t;x_0) = x^*
		\]
		για \( x_0 \) κοντά στο \(  x^* \).
	\end{enumerate}
\end{defn}

\begin{tikzpicture}[scale=1.1]
\draw[->] (-3,0) -- (3,0) node[below] {$x_1$};
\draw[->] (0,-3) -- (0,3) node[right] {$x_2$};

\def\xox{-1.5};
\def\xoy{-1.5};
\coordinate (x0) at (\xox,\xoy);

\def\rate{0.08}
\def\r{  (sqrt(  (\xox*\xox + \xoy*\xoy) ))  * (1-\rate*\t)   }
\def\phi{atan2(\xoy,\xox)}
\draw[ultra thick,green!50!blue,
%mark position=0.2(c1),mark position=0.2001(c2),
%mark position=0.5(c3),mark position=0.501(c4),
%mark position=0.91009(c5),mark position=0.91015(c6)
]
plot[smooth,samples=\midsamples,variable=\t,domain=0:1/\rate]
({\r*cos(-\t r + \phi)},{\r*sin(-\t r + \phi)})
node[circle,fill opacity=.5,fill,draw,inner sep=1.5pt,thick,opacity=.1,anchor=north west] {}
;
%\draw[green!50!blue,very thick,->] %(c1) -- (c2)
% (c3) -- (c4); %(c5) -- (c6);

\path (0,0) node[circle,fill opacity=.5,fill,draw,inner sep=2pt,thick,fill=red!50!black] (O) {};
\path (x0) node[circle,fill opacity=.5,fill,draw,inner sep=1.2pt] {};
\draw (O) node[below left] {$x^*$};
\draw (x0) node[above right] {$x_0$};

%\draw[green,thick,dashed] (0,0) circle (1cm);
\draw[green,thick,dashed] (0,0) circle (2.4cm);
%\draw[densely dashed,blue!20!green!50!black] (-50:1) node[above] {$\delta$};
\draw[densely dashed,blue!20!green!50!black] (165:2.4) node[below left] {$\varepsilon$};
\end{tikzpicture}

Πρακτικά σημαίνει ότι το σύστημα προσεγγίζει το σημείο ισορροπίας, όσο το \( t\to \infty \).

\begin{defn}{Εκθετικά ευσταθές σημείο ισορροπίας}{}
	Ένα σημείο ισορροπίας ονομάζεται \textbf{εκθετικά ευσταθές} ότανν:
	\begin{enumerate}
		\item Είναι \textbf{ασυμπτωτικά ευσταθές}
		\item Η λύση είναι φραγμένη από μια εκθετικά αποσβεννύμενη καμπύλη, δηλαδή:
		\[
		\left|
		x(t;x_0) - x^*
		\right| \leq ae^{-\gamma t} \left|x_0\right|
		\] για \( a,\gamma >0 \)
	\end{enumerate}
\end{defn}
Πρακτικά, σημαίνει ότι το σημείο αυτό συγκλίνει εκθετικά γρήγορα στο σημείο ισορροπίας.

Όταν κάποια από τις παραπάνω ιδιότητες ισχύει για όλα τα σημεία του χώρου, δηλαδή:
\[
\forall x_0 \in \mathbb R^n
\]
τότε μιλάμε για \textbf{ολική} ευστάθεια ή ιδιότητες.

Όταν κάποια από τις παραπάνω ιδιότητες ισχύει μόνο για μερικά σημεία του χώρου, δηλαδή:
\[
\forall x_0 \in \Omega \subset \mathbb R^n
\]
τότε μιλάμε για \textbf{τοπική} ευστάθεια ή ιδιότητες.

\begin{defn}{Ομοιόμορφα τελικώς φραγμένη λύση}{}
	Μία λύση \( x(t;x_0) \) με αρχική συνθήκη \( x_0 \) για χρόνο \( t \) ονομάζεται
	\textbf{ομοιόμορφα τελικώς φραγμένη} ότανν:
	\[
	\forall \xi > 0 \quad
	\exists M,T(\xi) > 0
	\quad : \quad
	\left|x_0\right| < \xi \implies \left|
	x(t;x_0)\right| < M
	, \quad \forall t > T(\xi)
	\]
\end{defn}
Πρακτικά ο ορισμός αυτός σημαίνει ότι, από κάποιον χρόνο και μετά (που
εξαρτάται από την αρχική τιμή μέσω του \( \xi \)), η λύση είναι φραγμένη
από κάποια τιμή.

\begin{tikzpicture}[scale=1,xscale=1.4]
\fill[blue!70!green,opacity=.18] (2,0) rectangle (6.09,0.5);

\draw[->] (-0.5,0) -- (6,0) node[right] {$t$};
\draw[->] (0,-0.5) -- (0,2.5);

\draw (0,0) node[below left] {$O$};

\draw[dashed] (0,2) node[left] {$\xi$} -- ++(6,0);
\draw[dashed] (0,0.5) node[left] {$M$} -- ++(6.1,0);

\draw[very thick,blue!50!cyan] plot [smooth] coordinates {(0,1.8) (0.7,1.7) (1,1.25) (1.5,1.1) (2,0.5) (3,0.2) (3.9,0.10) (4.2, 0.2) (4.5, 0.4) (5,0.2) (5.5,0.3) (6,0.32)};

\path (0,1.8) node[circle,fill opacity=.5,fill,draw,inner sep=1.2pt] {} node[below left] {$x_0$};
\end{tikzpicture}

Η έννοια αυτή είναι σημαντική, επειδή μπορούμε να ελέγχουμε την τιμή του \( M \) ώστε να
πετύχουμε αρκετά καλή σύγκλιση στο 0.

\lecture{5}{9/3/2018}

\subsection{Για γραμμικά συστήματα}
\label{sec:linear_stability}
Ένα σύστημα του οποίου οι παράμετροι μπορούν να εκφραστούν με έναν γραμμικό
συντελεστή ονομάζεται \textbf{γραμμικό}:
\[
\dot x = F(x) = Ax
\] όπου ο \( A \) είναι ένας πίνακας \( A \in \mathbb R^{n\times n} \)

Ένα σύστημα έχει τυπικά \textbf{αρχική τιμή}:
\[
x(0) = x_0
\]

Τα \textbf{σημεία ισορροπίας} βρίσκονται από τη σχέση \( F(x) = 0 \), ή:
\[
Ax = 0
\]
και, αν ο \( A \) είναι \textit{αντιστρέψιμος} (ισοδύναμα \( \det(A)\neq 0 \)), τότε ισχύει:\[
x^* = 0
\]

\begin{theorem}{Ευστάθεια Γραμμικού Συστήματος}{linear_stability}
	Για να είναι το σύστημα ευσταθές,
	πρέπει όλες οι ιδιοτιμές του (λύσεις της εξίσωσης \( \det(sI-A)=0 \)) να έχουν
	\textbf{αρνητικό πραγματικό μέρος}. Τότε είναι πάντα \textbf{ασυμπτωτικά ευσταθές}.

	Σε περίπτωση που έστω και μία έχει \textbf{θετικό} πραγματικό
	μέρος, το σύστημα είναι \textit{ασταθές}. \footnote{Για πραγματικό μέρος
		\( =0 \) έχουμε την οριακή ευστάθεια.}

	% TODO check
\end{theorem}

Συμπεραίνουμε ότι το σύστημα και η ευστάθειά του περιγράφονται ουσιαστικά πλήρως
από τον πίνακα \( A \).

\subsubsection{Ειδική περίπτωση: Πίνακας \( A \) διαγώνιος}
\begin{defn}{Διαγώνιος πίνακας}{}
	Ένας \textbf{διαγώνιος} πίνακας έχει τη μορφή:\[
	\dot x = \left[\begin{matrix}
	\lambda_1 & 0 & \cdots & 0 \\
	0 & \lambda_2 & \cdots & 0 \\
	\vdots & \vdots & \ddots & \vdots \\
	0 & 0 & \cdots & \lambda_\nu
	\end{matrix}
	\right] x
	\]
\end{defn}

Ένα σύστημα με διαγώνιο πίνακα \( A \) έχει προφανή λύση:
\[
x(t) = e^{\lambda_i t} \cdot x_i(0)
\]

Φαίνεται ότι για να έχουμε \textit{ευστάθεια}, πρέπει να ισχύει για όλους τους
συντελεστές \( \lambda \):
\[
\lambda_i < 0
\]

Επομένως είναι εύκολη η ανάλυση ενός συστήματος που μπορεί να περιγραφεί από
έναν διαγώνιο πίνακα, ή να \textit{μετασχηματιστεί} σε διαγώνιο πίνακα
με \textbf{κατάλληλη επιλογή μεταβλητών κατάστασης}.

\subsubsection{Ειδική περίπτωση: Πίνακας \( A \) μπλοκ-διαγώνιος}
\begin{defn}{Μπλοκ-διαγώνιος πίνακας}{}
Ένας \textbf{μπλοκ διαγώνιος} πίνακας έχει ουσιαστικά
επιμέρους διδιάστατους πίνακες στις
διαγωνίους του:
\[
\dot x = \left[
\begin{matrix}
\begin{matrix}
\sigma_1 & \omega_1 \\ -\omega_1 & \sigma_1
\end{matrix} & \mathlarger{\mathlarger{0}} & \cdots & \mathlarger{\mathlarger{0}} \\
\mathlarger{\mathlarger{0}} & \begin{matrix}
\sigma_2 & \omega_2 \\ -\omega_2 & \sigma_2
\end{matrix} & \cdots & \mathlarger{\mathlarger{0}} \\
\vdots & \vdots & \ddots & \vdots\\
\mathlarger{\mathlarger{0}} & \mathlarger{\mathlarger{0}} & \cdots & \begin{matrix}
\sigma_\nu & \omega_\nu \\ -\omega_\nu & \sigma_\nu
\end{matrix}
\end{matrix}
\right]x
= \left[\begin{matrix}
\sigma_1 & \omega_1 & \cdots & 0 & 0\\
-\omega_1 & \sigma_1 & \cdots & 0 & 0\\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \cdots & \sigma_\nu & \omega_\nu \\
0 & 0 & \cdots & -\omega_\nu & \sigma_\nu
\end{matrix}\right]x
\]
\end{defn}

Τότε λειτουργούμε αντίστοιχα με παραπάνω, με τους συντελεστές \( \lambda \)
να είναι:
\[
\lambda_i = \sigma_i \pm j\omega_i
\]

\begin{exercise}[Παράδειγμα]
	Δίνεται το σύστημα:
	\begin{align*}
	\dot x &= \left[
	\begin{matrix}
	-k_0-k_1 & k_1 \\
	k_2 & -k_2
	\end{matrix}
	\right]\left[\begin{matrix}
	x_1 \\ x_2
	\end{matrix}\right] + \left[
	\begin{matrix}
	b_0 \\ 0
	\end{matrix}
	\right]u \\
	y &= \left[
	\begin{matrix}
	0 & 1
	\end{matrix}
	\right]\left[\begin{matrix}
	x_1 \\ x_2
	\end{matrix}\right]
	\end{align*}
	όπου \( k_0,k_1,k_2,b_0 > 0 \).

	Να επιλεγεί είσοδος ώστε να έχουμε ευστάθεια, και \( y \to 0 \).

	\tcblower

	Επιλέγουμε αυθαίρετα τον παρακάτω ελεγκτή:
	\[
	u = -kx_2\qquad k>0
	\]

	Πρακτικά δηλαδή μετατρέπουμε το σύστημα ανοιχτού βρόχου σε σύστημα κλειστού
	βρόχου, αφού μεταφέρουμε μία παράμετρό του στην είσοδο. Μαθηματικά,
	αντικαθιστούμε στον δοθέντα τύπο του \( \dot x \):
	\begin{align*}
		\dot x &= \left[\begin{matrix}
		-k_0-k_1 & k_1 \\ k_2 & -k_2
		\end{matrix}\right]\left[\begin{matrix}
		x_1 \\ x_2
		\end{matrix}\right] + \left[\begin{matrix}
		-b_0kx_2 \\ 0
		\end{matrix}\right]
		\\ &=
		\left[\begin{matrix}
		-k_0 - k_1 & k_1-b_0k \\
		k_2 & -k_2
		\end{matrix}\right]\left[\begin{matrix}
		x_1 \\ x_2
		\end{matrix}\right]
	\end{align*}

	Ο πίνακας \( A=\left[\begin{matrix}
	-k_0 - k_1 & k_1-b_0k \\
	k_2 & -k_2
	\end{matrix}\right] \) δεν ανήκει σε κάποια από τις ειδικές περιπτώσεις
	που αναφέραμε, επομένως πρέπει να βρούμε τις \textbf{ιδιοτιμές} του:
	\begin{align*}
	\det(sI-A) = 0 \implies \det\left(\left[\begin{matrix}
	s+k_0+k_1 & b_0k-k_1 \\ -k_2 & s+k_2 \end{matrix}
	\right]\right) &= 0 \implies \\
	s^2 + (k_0+k_1+k_2)s + k_2(b_0k + k_0) &= 0
	\end{align*}

	Αντί να βρούμε αναλυτικά την τιμή των ιδιοτιμών, μπορούμε απλά να
	απαιτήσουμε να έχουν αρνητικό πραγματικό μέρος. Αυτό μπορούμε να το
	πετύχουμε με το \textbf{κριτήριο Routh - Hurwitz}, ή, εναλλακτικά, επειδή
	εδώ έχουμε 2\textsuperscript{o}βάθμια εξίσωση, να φροντίσουμε ώστε όλοι
	οι συντελεστές να είναι ομόσημοι\footnote{Το συμπέρασμα αυτό προκύπτει από εφαρμογή του κριτηρίου Routh}, δηλαδή:
	\begin{align*}
		k_0+k_1+k_2 &> 0\\
		k_2(b_0k+k_0) &> 0
	\end{align*}

	Επομένως η συνθήκη που πρέπει να ικανοποιεί το \( k \) είναι:
	\[
	k > -\frac{k_0}{b_0} \impliedby k>0 \text{ που ήδη ισχύει}
	\]

	Επίσης, ισχύει \( \det(A) = k_2(k_0+k_1)-k_2(k_1-b_0k) = k_2k_0(1+b_0) \neq 0 \), άρα το σημείο ισορροπίας βρίσκεται στη θέση \( x^* = 0 \).

	Επειδή το σύστημα είναι \textit{ασυμπτωτικά ευσταθές}, σύμφωνα
	με το \autoref{th:linear_stability}, το
	\( x \) τείνει στο \( x^* = 0 \). Όμως η έξοδος \( y \) είναι \( y=0x_1 + 1x_2 \), όπως δίνεται από την εκφώνηση.
	Άρα και \( y\to 0 \).

	Τελικά ικανοποιούνται τα ζητούμενα χρησιμοποιώντας τον ελεγκτή \( u=-kx_2 \).
\end{exercise}

\subsection{Μελέτη ευστάθειας σε μη γραμμικά συστήματα}
Έστω το σύστημα \( \dot x = F(x) \) με σημείο ισορροπίας \( x^* \).

\subsubsection{Με γραμμικοποίηση}

Ένας τρόπος να μελετήσουμε την ευστάθεια ενός σημείου ισορροπίας, είναι να
μελετήσουμε την \textbf{ευστάθεια στη γειτονιά του} (για παράδειγμα, στο
αναστρεφόμενο εκκρεμές, εκτρέπουμε κατά μικρή γωνία \( \theta \), αφήνουμε
το εκκρεμές, και παρατηρούμε τη συμπεριφορά του).

Για αυτήν τη μελέτη, \textbf{"γραμμικοποιούμε"} το σύστημα που μελετάμε,
χρησιμοποιώντας ανάπτυγμα Taylor 1\textsuperscript{ης} τάξης:
\[
\dot x = F(x^*)
+ \underbrace{\left. \pd{F}{x} \right|_{x=x^*} (x-x^*)}_{\mathclap{\text{1\textsuperscript{ος} όρος}}}
+ \underbrace{\cancelto{0}{R\left(\left|x-x^*\right|\right)}}_{\mathclap{\text{υπόλοιποι όροι}}}
\]

Το ανάπτυγμα Taylor επιστρέφει ορθά αποτελέσματα για τιμές κοντά στο \( x^* \),
δηλαδή για μικρά \( \left|x-x^*\right| \), οπότε και μπορούμε να αγνοήσουμε
τους όρους μεγαλύτερους από την πρώτη τάξη, οι οποίοι είναι αμελητέοι:
\begin{align*}
\dot x &= F(x^*) + \left. \pd{F}{x} \right|_{x=x^*}(x-x^*)
\xRightarrow[F(x^*) = 0]{x^* \text{ σημ. ισορροπίας }} \\
\dot x &= \left. \pd{F}{x} \right|_{x=x^*} (x-x^*)
\end{align*}

Εδώ έχουμε φτάσει στο σημείο να μπορούμε να θέσουμε έναν \textbf{σταθερό} πίνακα \( A \):
\[
A = \left. \pd{F}{x} \right|_{x=x^*}
\]
οπότε το \textit{γραμμικοποιημένο} σύστημα έχει τη μορφή:
\[
\dot x = A(x-x^*)
\]
και, θέτοντας \( z=x-x^* \), έχουμε:
\[
\boxed{\dot z = Az}
\]

Το παραπάνω σύστημα μπορεί να μελετηθεί όπως τα υπόλοιπα γραμμικά συστήματα
(\autoref{sec:linear_stability}).

\textbf{Προσοχή!} Η παραπάνω μέθοδος μπορεί να εφαρμοστεί \textbf{μόνο για τοπική} ευστάθεια, και δεν εξάγει βέβαια συμπεράσματα για ολική ευστάθεια. Ένα
σύστημα που είναι \textit{ευσταθές} για \textit{μικρές εκτροπές}, δεν είναι απαραίτητα
ευσταθές για μεγαλύτερες. Αντίθετα, αν είναι \textit{ασταθές} για \textit{μικρές}
εκτροπές, τότε στις περισσότερες περιπτώσεις είναι \textit{ασταθές} και για
μεγαλύτερες.

\begin{exercise}[Παράδειγμα]
	Ένα απλοποιημένο μοντέλο του αναστρεφόμενου εκκρεμούς είναι το εξής:
	\[
	\dot x = \left[\begin{matrix}
	x_2 \\ \sin x_1 - γ x_2 \end{matrix}
	\right], \qquad γ > 0
	\]

	Τα σημεία ισορροπίας του συστήματος είναι τα \( (0,0) \) και
	\( (π,0) \). Να μελετηθεί
	η τοπική ευστάθεια γύρω από αυτά.

	\tcbsubtitle{Λύση για \( (0,0) \)}
	Το σύστημα είναι μη γραμμικό, λόγω της ύπαρξης του \textit{ημιτόνου}.

	Για \( x_1 \) \textit{κοντά} στο 0, ισχύει κατά τα γνωστά:
	\[
	\sin x_1 \equiv x_1
	\]

	Αφού θέλουμε να γραμμικοποιήσουμε στη γειτονιά του \( (0,0) \), αρκεί
	να αντικαταστήσουμε το ημίτονο με το προσεγγιστικά ισοδύναμό του,
	και έχουμε:
	\[
	\dot x = \left[\begin{matrix}
	x_2 \\ x_1-γx_2
	\end{matrix}\right] = \underbrace{\left[\begin{matrix}
	0 & 1 \\ 1 & -\gamma
	\end{matrix}\right]}_A \left[\begin{matrix}
	x_1 \\ x_2
	\end{matrix}\right]
	\]

	Μελετάμε τις ιδιοτιμές του \( A \):
	\[
	\det(sI-A) = 0 \implies \dots \implies s^2 + \gamma s - 1 = 0
	\]
	το οποίο έχει μία λύση με αρνητικό πραγματικό μέρος, και μία με θετικό.
	Συνεπώς, το σύστημα σε εκείνο το σημείο είναι
	\textbf{τοπικά ασταθές}. Άλλωστε, αν μετακινήσουμε το εκκρεμές ελαφρά,
	αυτό θα αρχίσει να κινείται χωρίς να σταματήσει.

	\tcbsubtitle{Λύση για \( (π,0) \)}
	Ακολουθούμε τη θεωρία. Από τη σχέση \( z = x-x* \) υπολογίζουμε:
	\begin{align*}
		z_1 &= x_1 - π \\
		x_2 &= x_2 - 0
	\end{align*}
	άρα: \[
	(z_1,z_2) = \left(x_1-π, \ x_2\right)
	\]
	και το σύστημα είναι:
	\[
	\dot z = \left[\begin{matrix}
	z_2 \\ \sin(z_1 + π) - \gamma z_2
	\end{matrix}\right]
	\]

    Θεωρούμε την προσέγγιση:
    \[
    \sin(z_1 + π) = -\sin z_1 \overset{z_1 \equiv 0}{\simeq} -z_1
    \]
    άρα η γραμμικοποίηση είναι:
    \[
    \dot z = \left[\begin{matrix}
    z_2 \\ -z_1-\gamma z_2
    \end{matrix}\right] = \left[\begin{matrix}
    0 & 1 \\ -1 &-\gamma
    \end{matrix}
    \right]\left[\begin{matrix}
    z_1 \\ z_2
    \end{matrix}\right]
    \]
    με ιδιοτιμές:
    \[
    \det(sI-A) = 0 \implies s^2 + \gamma s + 1 =0 \xRightarrow{\cdots} s_{1,2} = \frac{-\gamma \pm \sqrt{\gamma^2-4}}{2}
    \]

    Οι ιδιοτιμές αυτές είναι πάντα αρνητικές, επομένως το σύστημα είναι τοπικά ευσταθές στο \( (π,0) \).
\end{exercise}

\subsubsection{Με το 2\textsuperscript{ο} θεώρημα Lyapunov}
Έστω το σύστημα \( \dot x = F(x) \) με σημείο ισορροπίας \( x^* \).

Η ιδέα της μεθόδου του Lyapunov είναι να βρούμε μια συνάρτηση που συγκλίνει
στο σημείο ισορροπίας, και φθίνει συνεχώς κατά μήκος της διαδρομής του \( x \).

\paragraph{}
Πρώτα θα δώσουμε μερικούς βοηθητικούς ορισμούς.

\begin{defn}{Θετικά ορισμένη συνάρτηση}{}
	Μία συνάρτηση \( V(x) \) όπου \( V: \mathbb R^n \to \mathbb R \) ονομάζεται \textbf{θετικά
		ορισμένη} όταν:
	\begin{enumerate}
		\item Είναι συνεχώς παραγωγίσιμη
		\item Είναι θετική για \( x\neq 0 \):
		\[
		V(x) > 0 \quad \forall x\neq 0
		\]
		\item Είναι μηδενική μόνο για \( x=0 \):
		\[
		V(x) = 0 \iff x=0
		\]
	\end{enumerate}
\end{defn}

\begin{defn}{Αρνητικά ορισμένη συνάρτηση}{}
	Μία συνάρτηση \( V(x) \) όπου \( V: \mathbb R^n \to \mathbb R \) ονομάζεται \textbf{αρνητικά
		ορισμένη} όταν:
	\begin{enumerate}
		\item Είναι συνεχώς παραγωγίσιμη
		\item Είναι {\color{red!70!black}αρνητική} για \( x\neq 0 \):
		\[
		V(x) ~ {\color{red!70!black}< 0} \quad \forall x\neq 0
		\]
		\item Είναι μηδενική μόνο για \( x=0 \):
		\[
		V(x) = 0 \iff x=0
		\]
	\end{enumerate}
\end{defn}

\begin{defn}{Θετικά ημιορισμένη συνάρτηση}{}
	Μία συνάρτηση \( V(x) \) όπου \( V: \mathbb R^n \to \mathbb R \) ονομάζεται \textbf{θετικά
		ημιορισμένη} όταν:\footnote{Η απαίτηση \( V(0) = 0 \) για θετικά/αρνητικά \textbf{ημι}ορισμένες συναρτήσεις δεν αναφέρεται στις σημειώσεις του
		μαθήματος, αλλά υπάρχει γενικότερα στη βιβλιογραφία.}
	\begin{enumerate}
		\item Είναι συνεχώς παραγωγίσιμη
		\item Είναι {\color{orange!70!black}\textit{μη} αρνητική} για \( x\neq 0 \):
		\[
		V(x) ~ {\color{orange!70!black}\geq 0} \quad \forall x\neq 0
		\]
		%\item Είναι μηδενική για \( x=0 \):
		%\[
		%V(0) = 0
		%\]

		% Note: The required V(0) = 0 for a positive/negative SEMI-definite function
		% is not mentioned in the lecture notes, but it is specified on other
		% textbooks.
	\end{enumerate}
\end{defn}
Αντίστοιχα ορίζεται η \textit{αρνητικά ημιορισμένη} συνάρτηση.

\begin{exercise}[Παράδειγμα]
	Έστω το διάνυσμα:
	\[
	x = \left[\begin{matrix}
	x_1 & x_2
	\end{matrix}\right]^T
	\]

	Να εξεταστούν οι συναρτήσεις ως προς τα παραπάνω:
	\begin{align*}
		V_1(x) &= x_1^2 + x_2^2 \\
		V_2(x) &= x_1^2
	\end{align*}
	\tcblower
	\begin{enumparen}
		\item Η \( V_1 \) είναι μηδενική \textit{μόνο} για \( (x_1,x_2) = 0 \),
		και στα υπόλοιπα σημεία είναι θετική. Επομένως είναι \textbf{θετικά ορισμένη}.
		\item Η \( V_2 \) είναι μηδενική για \( (x_1,x_2) = 0\), όμως είναι μηδενική επιπλέον και για όλα
		τα \( x= (0,a), \) \quad \( a \neq 0 \). Επομένως \textit{δεν} είναι θετικά ορισμένη.

		Είναι όμως \textbf{θετικά ημιορισμένη}, αφού δεν λαμβάνει
		αρνητικές τιμές.
	\end{enumparen}
\end{exercise}

\begin{theorem}{Θεώρημα Lyapunov}{}
	Έστω ένα σύστημα: \[
	\dot x = F(x)
	\]
	και μία \textbf{μη}-αρνητική συνάρτηση \( V \) επάνω στην τροχιά του \( x \) που ορίζεται ως
	εξής:
	\[
	\dot V = \pd{V^T}{x} \dot x = \pd{V^T}{x} F(x)
	\]

	Έστω επίσης μία σφαίρα πεπερασμένης ακτίνας \( r \) με
	κέντρο το \(0\):
	\[
	B_r(0) = \left\lbrace x\in \mathbb R^n :\ |x|<r \right\rbrace
	\]

	Αν υπάρχει \( r > 0 \) τέτοιο ώστε \( V \) \textbf{θετικά ορισμένη}
	και \( \dot V \) \textbf{αρνητικά ημιορισμένη} στη σφαίρα, τότε το \( x = 0 \) είναι τοπικά
	ευσταθές σημείο ισορροπίας.

	Αν η \( \dot V \) είναι αρνητικά ορισμένη, τότε το σημείο είναι \textbf{ασυμπτωτικά} ευσταθές.

	Η συνάρτηση \( V \) ονομάζεται \textbf{συνάρτηση Lyapunov}.
\end{theorem}

Γεωμετρικά, σχεδιάζουμε \textit{ισοβαρείς καμπύλες}, δηλαδή καμπύλες όπου
οι τιμές της συνάρτησης Lyapunov είναι ίσες:
\todo{Graph 18}

\paragraph{Παρατηρήσεις}
\begin{itemize}
	\item Για κάθε ευσταθές σημείο ισορροπίας σε κάθε σύστημα, \textbf{υπάρχει
		συνάρτηση Lyapunov}. Επομένως η ύπαρξη τέτοιας συνάρτησης είναι
	\textbf{ικανή και αναγκαία} συνθήκη για τη μελέτη της ευστάθειας.
	\item Αν και δεν απαιτείται η εύρεση του συστήματος, η συνάρτηση
	Lyapunov δεν δίνεται, και πρέπει να \textbf{επιλεγεί} από εμάς. Δεν υπάρχει
	αλγοριθμική διαδικασία που να προβλέπει τέτοια συνάρτηση, αλλά πρέπει να
	σκεφτούμε εμείς, χρησιμοποιώντας την εμπειρία του σχεδιαστή.
	\item Το θεώρημα Lyapunov υπονοεί την απαίτηση να λύνεται
	το σύστημα, δηλαδή να είναι συνεχές κατά Lipschitz.
\end{itemize}

\lecture{6}{14/3/2018}

\begin{exercise}
	Να μελετηθεί η ευστάθεια των σημείων ισορροπίας του συστήματος:
	\[
	\dot x = \frac{2}{1+x}-x,\quad x\in\mathbb R
	\]
	\tcblower
	Πρώτα πρέπει να βρούμε τα σημεία ισορροπίας. Έχουμε:
	\[
	\frac{2}{1+x} - x = 0 \implies \frac{2-x(1+x)}{1+x} = 0
	\implies -x^2 -x +2 = 0 \implies x_{1,2} = -2,\ 1
	\]

	\begin{itemize}
		\item Για το \textbf{σημείο ισορροπίας} \( x^* = 1 \), έχουμε τις γνωστές
		σχέσεις:
		\begin{align*}
			z &= x-x^* \\ \implies
			z &= x-1
		\end{align*}
		άρα, παραγωγίζοντας:
		\[
		\dot z = \dot x \implies \dot z = \frac{2}{z+2} -z -1
		\]

		\textbf{Επιλέγουμε} ως \textbf{\textit{υποψήφια} συνάρτηση Lyapunov} την:
		\[
		V(z) = \frac{1}{2} z^2
		\]

		Πρέπει να επιβεβαιώσουμε ότι ικανοποιεί τις συνθήκες για να είναι όντως
		συνάρτηση Lyapunov. Παραγωγίζουμε:
		\begin{align*}
			\dot V(z) &= z\dot z \\
			 &= \frac{2z}{z+2} - z(z+1) \\
			&= \frac{2z-(z^2+z)(z+2)}{z+2} \numberthis \label{eq:sec1ex0l}
		\end{align*}

		Πρέπει να μελετήσουμε το πρόσημο της \( \dot V \) για έναν κύκλο
		μικρής ακτίνας \( r \) με κέντρο 0, που συμβολίζεται ως \( z \in B_r(0) \).

		Λόγω του όρου \( z+2 \) στον παρονομαστή, πρέπει \( z\neq -2 \). Για να υπάρχει
		συνέχεια κοντά στο 0, πρέπει \( z+2 > 0 \), άρα ο κύκλος πρέπει να έχει ακτίνα
		\( r < 2 \).

		Ελέγχουμε το \textit{πρόσημο} του \textbf{αριθμητή} του κλάσματος της \eqref{eq:sec1ex0l}. Ο αριθμητής είναι ίσος με \( -z^3-3z^2 \), άρα θέλουμε:
		\[
		-z^3 - 3z^2 < 0 \implies -z^2(z+3) < 0, \quad \text{ που ισχύει για $z$ < 2}.
		\]

		Επομένως, αφού ισχύουν οι ζητούμενες συνθήκες, το σημείο είναι
		\textbf{τοπικά ασυμπτωτικά ευσταθές}. Η \textit{τοπική} ευστάθεια εκφράζει πως το
		σύστημα είναι ευσταθές μόνο όσο η διαταραχή ανήκει στον κύκλο \( B_r(0) \). Αν
		ξεφύγει από αυτόν, τότε το σύστημα ίσως παρουσιάσει αστάθεια.

		\item Με αντίστοιχο τρόπο, βρίσκουμε ότι και το \( x_1 = -2 \) είναι σημείο
		τοπικά ασυμπτωτικής ευστάθειας. Η απόδειξη αφήνεται ως άσκηση για το σπίτι.
	\end{itemize}
\end{exercise}

\begin{exercise}
	Δίνεται ένα απλοποιημένο μοντέλο του εκκρεμούς:
	\begin{align*}
		\dot x_1 &= x_2 \\
		\dot x_2 &= -\sin x_1
	\end{align*}
	όπου \( x_1 \) η γωνία εκτροπής, και \( x_2 \) η γωνιακή ταχύτητα, με σημείο ισορροπίας το \( (0,0) \). Να μελετήσετε την ευστάθεια αυτού του σημείου
	ισορροπίας.
	\tcblower
	Οι πιο συνηθισμένες και απλές επιλογές συναρτήσεων Lyapunov είναι οι \textit{τετραγωνικές} μορφές. Επίσης, προσέχουμε στην επιλογή μας οι συναρτήσεις
	να είναι συναρτήσεις όλων των μεταβλητών του συστήματός μας.

	Επομένως, εδώ μπορούμε να \textbf{επιλέξουμε} ως υποψήφια συνάρτηση Lyapunov την εξής:
	\[
	V(x_1,x_2) = \frac{1}{2}x_1^2 + \frac{1}{2}x_2^2
	\]
	με χρονική παράγωγο:
	\begin{align*}
	\dot V &= x_1\dot x_1 + x_2\dot x_2
	\\ &= x_1x_2 - x_2\sin x_1
	\\ &= x_2(x_1 - \sin x_1)
	\end{align*}

	Στην περίπτωση που \( x_1 \simeq 0 \) ισχύει \( \sin x_1 \simeq x_1 \), άρα:
	\begin{align*}
		\dot V &= x_2(x_1-x_1) \\ &= 0
	\end{align*}

	Η συνάρτηση είναι \textbf{αρνητικά ημι-ορισμένη}. Επίσης, λόγω
	του περιορισμού ότι \( x_1 \) \textit{κοντά} στο 0, το σημείο
	είναι \textbf{\textit{τοπικά}} ευσταθές.

	\paragraph{}
	Όμως αυτή η προσέγγιση μας δίνει συμπεράσματα μόνο για την
	\textit{τοπική} και όχι την \textit{ολική} ευστάθεια του συστήματος.
	Για να μελετήσουμε την ολική, σκεφτόμαστε να χρησιμοποιήσουμε
	μια συνάρτηση Lyapunov που προέρχεται από τη φυσική
	σημασία του προβλήματος, και πιο συγκεκριμένα την
	\textbf{ενέργειά} του.

	\todo{Graph 19}

	Η ενέργεια είναι το άθροισμα της κινητικής και της δυναμικής
	ενέργειας του συστήματος (το οποίο είναι κανονικοποιημένο όσον
	αφορά τη μάζα και το μήκος του εκκρεμούς):
	\[
	V(x_1,x_2)
	= \underbrace{1-\cos x_1}_{\mathclap{\text{δυναμική }(mgh)}}
	+ \underbrace{\frac{1}{2}x_2^2}_{\mathclap{\text{κινητική}}}
	\]

	Παραγωγίζουμε:
	\begin{align*}
		\dot V &= \dot x_1\sin x_1 + x_2\dot x_2 \\
		&= x_2\sin x_1 - x_2\sin x_1 \\ &= 0
	\end{align*}
	και το αποτέλεσμα είναι μηδενικό, δηλαδή η \( \dot V \) είναι αρνητικά ημιορισμένη.

	Το αποτέλεσμα αυτό έχει και φυσική σημασία, αφού εκφράζει
	μηδενική χρονική παράγωγο ενέργειας, δηλαδή ότι η ενέργεια
	παραμένει σταθερή και διατηρείται, κάτι γνωστό. Το παραπάνω
	σύστημα, όπως γνωρίζουμε και από τη φυσική μας εμπειρία, επειδή
	δεν έχει απόσβεση, θα ταλαντώνεται συνέχεια χωρίς να σταματήσει.

	Πολλές φορές βέβαια δεν θα έχουμε την ευχέρεια να υπολογίσουμε
	ακριβώς το πρόσημο μιας συνάρτησης, όμως συχνά θα μπορούμε να
	το βρούμε \textit{κοντά} στο 0, χρησιμοποιώντας \textbf{ανάπτυγμα
		Taylor 2\textsuperscript{ης} τάξης}. Ενδεικτικά, για αυτήν
	την άσκηση:
	\begin{align*}
		\cos x_1 &= \cos(0) +
		\cancelto{0}{\left(-\sin x_1\middle|_{x_1\to 0}\right)}
		(x_1 - 0)
		+ \frac{1}{2}(x_1-0)^2
			\cancelto{0}{\left(-\cos x_1\middle|_{x_1\to 0}\right)}
		\\ &= 1 - \frac{1}{2}x_1^2
		\intertext{άρα:}
		1-\cos x_1 &= \frac{1}{2}x_1^2
	\end{align*}
\end{exercise}

\subsubsection{Αμετάβλητα Σημεία}
Έστω \( \dot x = F(x) \) ένα \textit{χρονικά αμετάβλητο} σύστημα με λύσεις \( x(t;x_0) \).

\begin{defn}{Αμετάβλητο σύνολο}{}
 	Έστω ένα σύνολο \( M \in \mathbb R^n \). Το \( M \) ονομάζεται
 	\textbf{αμετάβλητο σύνολο} ανν\footnote{αν και μόνο αν}:
 	\[
 	\forall a \in M \implies x(t;a) \in M
 	\]

 	Δηλαδή αν έχουμε αρχική τιμή \( a \), τότε το σύστημα παραμένει
 	στην ίδια περιοχή και δεν ξεφεύγει από αυτήν.
\end{defn}

Τα αμετάβλητα σύνολα χρησιμεύουν στο ότι αν στείλουμε μέσα σε αυτά
ένα σημείο, αυτό θα παραμείνει μέσα στον κύκλο \( M \), χωρίς να
ξεφεύγει από τις τιμές του.


\begin{theorem}{Θεώρημα LaSalle}{}
	Έστω \( V \) μια \textbf{τοπικά θετικά ορισμένη} συνάρτηση,
	τέτοια ώστε σε μία σφαίρα \( \Omega_r \) να ισχύει: \[ \dot V(x) \leq 0,
	\quad \forall x \in \Omega_r = \left\lbrace
	x\in\mathbb R^n : V(x) \leq r, r >0
	 \right\rbrace \]
	Επίσης, έστω το σύνολο των σημείων όπου η \( \dot V \) μηδενίζεται:
	\[
	S = \left\lbrace x \in \Omega_r : \dot V(x) = 0 \right\rbrace
	\]

	\todo{Graph 20 wrap right}

	Τότε, καθώς \( t\to \infty \), η λύση του συστήματος θα
	συγκλίνει στο μεγαλύτερο δυνατό αμετάβλητο υποσύνολο που
	περιέχεται στον \( S \).
\end{theorem}

\begin{exercise}[Εφαρμογή]
	Να μελετηθεί η ευστάθεια των σημείων ισορροπίας του συστήματος:
	\begin{align*}
		\dot x_1 &= -x_1+x_2 + x_1x_2^3 \\
		\dot x_2 &= -x_1 -x_1^2x_2^2
	\end{align*}

	\tcblower
	Πρώτα βρίσκουμε τα σημεία ισορροπίας. Έχουμε:
	\begin{align*}
		\dot x_1 = 0 &\implies
		-x_1 + x_2(1+x_1x_2^2) = 0
		\implies -x_1^2 + x_2(x_1+x_1^2x_2^2) = 0
		\xRightarrow{\dot x_2 = 0} -x_1^2 = 0
		\\
		&\implies x_1 = 0
		\xRightarrow{\dot x_1 = 0} x_2 = 0
	\end{align*}

	Και ως υποψήφια συνάρτηση Lyapunov επιλέγουμε:
	\[
	V(x) = \frac{1}{2}x_1^2 + \frac{1}{2}x_2^2
	\]
	με παράγωγο (που προκύπτει από πράξεις \& αντικαταστάσεις):
	\begin{align*}
		\dot V &= x_1\dot x_1 + x_2\dot x_2 \\ &= -x_1^2 \quad \text{αρνητικά ημιορισμένη}
	\end{align*}
	Επομένως το σημείο ισορροπίας \( (0,0) \) είναι \textbf{ολικά ευσταθές}.

	\paragraph{}
	Εναλλακτικά, μπορούμε να εφαρμόσουμε το \textbf{θεώρημα
		LaSalle.}

	Βρίσκουμε το σύνολο \( S \):
	\[
	S = \left\lbrace  x\in\mathbb R_n : \dot V(x) = 0 \right\rbrace
	= \left\lbrace x \in \mathbb R^n : x_1 = 0 \right\rbrace
	\]

	Εντός του \( S \), το \( x \) παίρνει τη μορφή:
	\begin{align*}
		\dot x_1 &= x_2 \\ \dot x_2 &= 0
	\end{align*}

	Δηλαδή τα \textit{αρχικά} σημεία είναι της μορφής \( (x_1,x_2) = (0,a) \). Αν
	υποθέσουμε \( a > 0 \implies x_2 > 0 \xRightarrow{\dot x_1 = x_2} \dot x_1 > 0 \implies
	x_1 > 0 \neq 0 \), \footnote{Αφού η παράγωγος $\dot x1$ είναι θετική, αυτό σημαίνει ότι όσο περνάει ο χρόνος, η τιμή του  $x_1$  αυξάνεται και γίνεται μεγαλύτερη του 0.} που σημαίνει ότι
	τα σημεία \( x \), όσο προχωράει ο χρόνος, αποκτούν
	\( x_1 \neq 0 \). Δηλαδή τα σημεία δεν ανήκουν στο \( S \), αφού
	\( x \notin S \). Άρα το μέγιστο αμετάβλητο σύνολο αποτελείται από
	το σημείο
	\( (0,0) \).

	Επομένως, σύμφωνα με το θεώρημα LaSalle, η λύση του συστήματος στο \( t \to \infty \) θα συγκλίνει στο \( (0,0) \)
\end{exercise}

\lecture{7}{16/3/2018}

\begin{exercise}
	\begin{wrapfigure}{r}{0.2\textwidth}
		\begin{center}
			\begin{tikzpicture}[scale=1.2]
			\draw (-1,0) -- (1,0);
			\draw (0,0) node[circle,inner sep=2pt,fill] {};
			\draw[very thick] (0,0) -- ++(90:1.5) node[circle,inner sep=2pt,fill=white,draw] {} node[pos=.5] (a) {};
			\draw[very thick] (0,0) -- ++(70:1.5) node[circle,inner sep=2pt,fill=white,draw] {} node[pos=.5] (b) {};

			\draw[brown,->] (a.center) to[bend left] node[midway,above,xshift=1pt] {$\theta$} (b.center);
			\end{tikzpicture}
		\end{center}
	\end{wrapfigure}

	Δίνεται το σύστημα που αποτελεί απλοποιημένο μοντέλο αναστρεφόμενου εκκρεμούς:
	\begin{align*}
		\dot x_1 &= x_2 \\
		\dot x_2 &= \sin x_1 + u\cos x_1
	\end{align*}
	όπου \( u \) η \textbf{ροπή που ασκεί ο κινητήρας} στη βάση του εκκρεμούς,
	\( x_1 \) η γωνία και \( x_2 \) η γωνιακή ταχύτητα.

	Να σχεδιαστεί ελεγκτής για την είσοδο \( u \) που να επιφέρει ισορροπία στην επάνω
	κατακόρυφη θέση του εκκρεμούς.

	\tcblower

	Έστω \( x = [\begin{matrix}
	x_1 & x_2
	\end{matrix}] \) το διάνυσμα μεταβλητών κατάστασης.

	\textit{Επιλέγουμε} ως υποψήφια συνάρτηση Lyapunov την:
	\begin{equation}
	V(x) = \left( \cos x_1 -1 \right) + a\left( 1-\cos^2 x_1 \right)
	+ \frac{1}{2}x_2^2
	\label{eq:sec3ex1lyapunov}
	\end{equation}
	Φυσικά δεν απαιτείται να γνωρίζουμε από μόνοι μας αυτή τη συνάρτηση, αλλά πρέπει να
	την έχουμε δει.

	Για τη μελέτη του προσήμου της παραγώγου, επειδή είναι σύνθετο να απαντήσουμε με
	ακρίβεια, θα χρησιμοποιήσουμε το ανάπτυγμα Taylor. Αρχικά:
	\begin{align*}
		\cos x&\simeq
		\cos (0) + \cancelto{0}{\left[ 2\cos(-\sin x) \middle|_{x=0} \right]}(x-0)
		+ \frac{1}{2} (x-0)(-\cos 0)(x-0)
		\\ &= 1 - \frac{1}{2}x^2 \\
		\cos^2 x &\simeq 1-x^2
	\end{align*}
	Επομένως η συνάρτηση Lyapunov μπορεί να γραφεί, για \textit{\( x_1,x_2 \) κοντά στο 0}:
	\[
	V(x) = \left(a-\frac{1}{2}\right)x_1^2 + \frac{1}{2}x_2^2
	\]
	με \( a > \sfrac{1}{2}  \).

	Παραγωγίζοντας την αρχική \( V(x) \) της σχέσης \eqref{eq:sec3ex1lyapunov}, μετά τις πράξεις, προκύπτει:
	\begin{align*}
	\dot V &= -\dot x_1 \sin x_1 + 2a \dot x_1 \cos x_1\sin x_1 + x_2\dot x_2
	\\ &= -x_2\sin x_1 + 2a x_2\cos x_1 \sin x_1 + x_2(\sin x_1 + u\cos x_1)
	\\ &= x_2(u+2a\sin x_1)\cos x_1
	\end{align*}

	Σκοπός μου είναι να επιλέξω το \( u \) ώστε η \( \dot V \) να είναι αρνητικά ημιορισμένη, ή, ακόμα καλύτερα, αρνητικά ορισμένη.

	Έτσι, \textit{επιλέγουμε} αυθαίρετα την:
	\[
	u = -2a\sin x_1 - x_2\cos x_1
	\]
	οπότε τότε:
	\[
	\dot V = -x_2^2\cos^2x_1
	\]

	Η παραπάνω \( \dot V \) μηδενίζεται και σε σημεία εκτός
	του \( (0,0) \) (π.χ. \( (1,0) \)). Επομένως είναι αρνητικά
	\textbf{ημι}ορισμένη. Άρα
	το \( (0,0) \) είναι \textbf{τοπικά} ευσταθές σημείο
	ισορροπίας (αφού θεωρήσαμε σημεία κοντά στο 0).

	\paragraph{}
	Προχωρώντας, θα ψάξουμε αν υπάρχει συνάρτηση \( u \) που να καθιστά το σημείο
	\textbf{ασυμπτωτικά} ευσταθές.

	Έχουμε το σύνολο των σημείων που μηδενίζουν τη συνάρτηση Lyapunov:
	\[
	S = \left\lbrace x \in \omega \subset \mathbb R^2 : \dot V = 0 \right\rbrace
	= \left\lbrace X \in \Omega \subset \mathbb R^2 : x_2 = 0 \right\rbrace
	\footnote{Αγνοούμε τα σημεία όπου \( \cos x_1 = 0 \) επειδή βρίσκονται μακριά από το $(0,0)$.}
	\]

    και, για \( x_2=0 \), το σύστημα γίνεται:
    \begin{align*}
    	\dot x_1 &= 0 \quad \text{μηδενίζεται για σημεία $(b,0)$ }\\
    	\dot x_2 &= \sin x_1 - 2a\sin x_1\cos x_1 \quad \text{μηδενίζεται για σημεία $(0,0)$}
    \end{align*}

    Το μεγαλύτερο δυνατό αμετάβλητο υποσύνολο του \( S \) είναι το \( (0,0) \), επειδή
    τα σημεία \( (b,0) \) προκαλούν \( \dot x_2 \neq 0 \implies x_2 \neq 0 \implies
    x \notin S \), άρα βγαίνουν εκτός του συνόλου.

    Επομένως, από το θεώρημα μεταβλητότητας LaSalle, η λύση του συστήματος μπορεί
    μόνο να συγκλίνει στο \( (0,0) \), άρα η συνάρτηση \( u \) που βρήκαμε παραπάνω
    οδηγεί σε σημείο ισορροπίας \textbf{τοπικής} και \textbf{ασυμπτωτικής} ευστάθειας.
\end{exercise}

\begin{exercise}
	Δίνεται το σύστημα:
	\[
	\dot x = -g(x) \qquad g(0) = 0,\quad \forall x \in \mathbb R
	\]
	όπου
	\[
	xg(x) > 0,\quad \forall x\neq 0,\quad x\in (-a,a)
	\]
	Να μελετηθεί η ευστάθεια στα σημεία ισορροπίας του.

	\tcblower

	Πρώτα πρέπει να βρούμε \textit{όλα τα σημεία ισορροπίας}, δηλαδή τα σημεία
	στα οποία \( g(x) = 0 \). Δίνεται ότι \( g(0) = 0 \), άρα ένα σημείο ισορροπίας
	είναι το \( (0,0) \). Επίσης δίνεται ότι \( xg(x) > 0 \), άρα \( \forall x \neq 0 \)
	θα ισχύει \( g(x) > 0 \) ή \( g(x) <0 \), επομένως \( g(x) \neq 0 \). Τελικά,
	το μοναδικό σημείο ισορροπίας είναι το \( (0,0) \).

	Ως υποψήφια συνάρτηση Lyapunov \textbf{επιλέγουμε} την παρακάτω:
	\[
	V(x) = \int_0^x g(y) \dif y
	\]

	Η συνάρτηση αυτή είναι \textit{θετικά ορισμένη}, επειδή: \begin{inparaenum}[(a)]
		\item Για \( x>0 \), \( xg(x) > 0 \implies g(x) > 0 \implies \int_{0}^{x} g(y)\dif y > 0\)
		\item Για \( x<0 \), \( xg(x) > 0 \implies g(x) < 0 \implies \int_{0}^{x} g(y)\dif y > 0 \)
		\item Για \( x=0 \), \( g(x) = 0 \implies \int_0^x g(y)\dif y = 0 \).
	\end{inparaenum}

	Για την παράγωγό της ισχύει:
	\[
	\dot V = g(x)\dot x = -g^2(x) \text{ αρνητικά ορισμένη}
	\]

	Επομένως, αφού είναι αρνητικά ορισμένη, το σημείο ισορροπίας είναι \textbf{ασυμπτωτικά ευσταθές}.
	%Δεν αναφέρουμε πως το σημείο είναι \textit{μόνον τοπικά} ευσταθές, αφού δεν εισάγαμε κάποιον περιορισμό στο πεδίο ορισμού.

	Ως παράδειγμα, θα μπορούσαμε να επιλέξουμε μια \( g(x) \) που να ικανοποιεί τα
	παραπάνω:
	\[
	\dot x = -x^2
	\]
\end{exercise}

\begin{exercise}
	Δίνεται το σύστημα:
	\begin{align}
		\dot x_1 &= x_2 \label{sec1ex2m1} \\
		\dot x_2 &= -a\sin  x_1 - bx_2 \label{sec1ex2m2}
	\end{align}
	όπου \( a,b > 0 \), όπου \( x_1 \in \left(-\frac{π}{2},\frac{π}{2}\right) \) με μοναδικό σημείο ισορροπίας το \( (0,0) \).

	Να χαρακτηριστεί η ευστάθεια του σημείου αυτού.

	\tcblower

	\textit{Επιλέγω} ως συνάρτηση Lyapunov (με βάση θεωρία που θα δούμε αργότερα \textemdash~\autoref{sec:linear_lyapunov}):
	\[
	V(x) = a\int_{0}^{x_1} \sin z \dif z + \frac{1}{2} x^{\mathrm T} Px
	\]
	όπου \( P \) ένας \textit{τετραγωνικός συμμετρικός} πίνακας, \textbf{θετικά
	ορισμένος}, τέτοιος ώστε:
	\[
	P^{\mathrm T} = P > 0
	\]
	\begin{infobox}{Θετικά Ορισμένος Πίνακας}
		Ένας πίνακας ονομάζεται \textbf{θετικά ορισμένος} όταν ισχύει οποιαδήποτε
		από τις παρακάτω ισοδύναμες ιδιότητες:
		\begin{enumerate}
			\item \( x^{\mathrm T} P x \) θετικά ορισμένη, δηλαδή: \begin{itemize}
				\item \( x^{\mathrm T} P x = 0 \) μόνο για \( x = 0 \)
				\item \( x^{\mathrm T} P x > 0 \) για \( x \neq 0 \)
			\end{itemize}
			\item Όλες οι \textbf{ιδιοτιμές} του είναι \( >0 \).
			\item Όλες οι \textbf{κύριες ελάσσονες} ορίζουσές του είναι \( >0 \).
%			\item %TODO A=BB^T
		\end{enumerate}
	\end{infobox}

	Πρέπει να επιλέξουμε τα στοιχεία του πίνακα \( P \) έτσι ώστε να είναι θετικά
	ορισμένος, αφού αυθαίρετα τον τοποθετήσαμε στη συνάρτηση Lyapunov:
	\[
	x^{\mathrm T} P x = \left[\begin{matrix}
	x_1 & x_2
	\end{matrix}\right]\left[
	\begin{matrix}
	P_{11} & P_{12} \\ P_{12} & P_{22}
	\end{matrix}
	\right] \left[
	\begin{matrix}
	x_1 \\ x_2
	\end{matrix}
	\right]= P_{11} x_1^2 + P_{22}x_2^2 + 2P_{12}x_1x_2
	\]
	όπου πρέπει, από τη συνθήκη των κύριων ελάσσονων οριζουσών (υπενθυμίζουμε ότι ο πίνακας είναι συμμετρικός):
	\begin{align*}
		P_{11} &> 0 \text{ και} \\ P_{11}P_{22} - P_{12}^2 &> 0
	\end{align*}

	Αντικαθιστώντας στη συνάρτηση Lyapunov, παραγωγίζοντας και εκτελώντας πράξεις, έχουμε:
	\begin{equation}
	\dot V =
	\underbrace{ax_2\sin x_1\left( 1-P_{22} \right)}_{???} + \underbrace{(P_{11} - bP_{12})x_1x_2}_{???}
	+ \underbrace{(P_{12}-bP_{22})x_2^2}_{<0} -\underbrace{aP_{12}x_1\sin x_1}_{>0}
	\label{sec1ex2vdot}
	\end{equation}

	Για να ικανοποιείται το θεώρημα Lyapunov, πρέπει να ελέγξουμε το πρόσημο της
	παραγώγου αυτής. Για αυτό, πρέπει να φροντίσουμε ώστε τα πρόσημα όλων των
	όρων στην έκφραση \eqref{sec1ex2vdot} να είναι \textit{αρνητικά}.

	Για να το πετύχουμε αυτό, \textit{επιλέγουμε} τις τιμές των σταθερών
	\( P_{11},P_{12},P_{22} \)! Φροντίζουμε ώστε οι όροι \( ax_2\sin x_1(1-P_{22}) \)
	και \( (P_{11}-bP_{12})x_1x_2 \) να \textit{μηδενιστούν}, επειδή το πρόσημό τους
	εναλλάσσεται ανάλογα με τις τιμές των \( x \). Αντίθετα, στους όρους
	\( (P_{12}-bP_{22})x_2^2 \) και \( aP_{12}x_1\sin x_1 \) το πρόσημο των όρων
	που περιλαμβάνουν το \( x \) παραμένει σταθερό.

	Για αυτό, \textbf{επιλέγουμε} για τους μηδενικούς όρους:
	\begin{itemize}
		\item \( \boxed{P_{22} = 1 }\)
		\item \( \boxed{P_{11} = bP_{12}} \)
	\end{itemize}
	και για τους μη μηδενικούς όρους:
	\begin{itemize}
		\item \( P_{12} - bP_{22} \xRightarrow{P_{12} > 0} P_{12} < b \)
		\item \( P_{12} > 0 \)
	\end{itemize}
	άρα μία ακόμα συνθήκη είναι:
	\[
	\boxed{0 < P_{12} < b}
	\]

	Ταυτόχρονα, πρέπει να ικανοποιούνται οι σχέσεις \eqref{sec1ex2m1} και \eqref{sec1ex2m2}, από τις οποίες προκύπτει η συνθήκη:
	\[
	\eqref{sec1ex2m2} \implies P_{11} > P_{12}^2
	\implies \boxed{bP_{12} > P_{12}^2}
	\]

	Ανάλογα με την τιμή του \( b \), μπορούμε να επιλέξουμε κατάλληλη τιμή των
	σταθερών \( P \) ώστε να ικανοποιούνται οι 4 παραπάνω συνθήκες.
\end{exercise}

\begin{exercise}
	Δίνεται το σύστημα:
	\begin{align}
		\dot x_1 &= x_2 + x_1\left( 1-x_1^2 - x_2^2 \right)
		\label{sec1ex3diff1} \\
		\dot x_2 &= -x_1+x_2 \left( 1-x_1^2 - x_2^2 \right)
		\label{sec1ex3diff2}
	\end{align}

	Να μελετηθεί η ευστάθεια των σημείων ισορροπίας.
	\tcblower
	Στο συγκεκριμένο παράδειγμα, χρειάζεται να λάβουμε περιπτώσεις για τα σημεία ισορροπίας:
	\begin{itemize}
		\item Για \( (a,b) \neq (0,0) \), τότε:
		\[
		\left.
		\begin{aligned}
		\eqref{sec1ex3diff1} \implies 1-x_1^2-x_2^2 = \frac{-x_2}{x_1} \\
		\eqref{sec1ex3diff2} \implies 1-x_1^2-x_2^2 = \frac{x_1}{x_2}
		\end{aligned} \right\rbrace \implies
		\frac{-x_2}{x_1} = \frac{x_1}{x_2}
		\implies -x_2^2=x_1^2 \implies x_1^2 + x_2^2 = 0
		\text{ άτοπο}
		\]
		\item Ομοίως για \( (0,b) \)
		\item Ομοίως για \( (a,0) \) \todo{Πράξεις}
		\item Για \( (0,0) \), οι συναρτήσεις στα δεξιά μέλη είναι προφανώς 0.
	\end{itemize}

	Άρα το \( (0,0) \) είναι το μοναδικό σημείο ισορροπίας.

	\textbf{Επιλέγουμε} ως συνάρτηση Lyapunov την:
	\[
	V = \frac{1}{2} x_1^2 + \frac{1}{2} x_2^2
	\]
	με παράγωγο:
	\[
	\dot V = x_1\dot x_1 + x_2\dot x_2
	= (x_1^2+x_2^2)\left(1-x_1^2-x_2^2\right)
	\]

	Εδώ επιλέγουμε το μοναδιαίο κυκλικό δίσκο ως πεδίο εφαρμογής του θεωρήματος Lyapunov, αφού
	παρατηρήσουμε τον όρο \( 1-x_1^2-x_2^2 \) που επηρεάζει το πρόσημο της συνάρτησης:
	\[
	B_1(0) = \left\lbrace x\in\mathbb R^2 : x_1^2+x_2^2 \leq 1 \right\rbrace
	\]

	\todo{Graph 19}

	Λαμβάνουμε περιπτώσεις για τις θέσεις των σημείων σε σχέση με τον κυκλικό δίσκο:
	\begin{itemize}
		\item \( x \notin B_1(0) \implies \dot V < 0 \)

		Αυτό σημαίνει ότι, ξεκινώντας εκτός του κύκλου, καταφτάνουμε στον μοναδιαίο
		κύκλο
		\item \( x \in B_1(0) - \left\lbrace x \in \mathbb R^2: x_1^2+x_2^2 = 1 \right\rbrace \implies \dot V > 0 \)

		Ξεκινώντας εντός του δίσκου, παραμένουμε μέσα σε αυτόν, φτάνοντας στον
		εξωτερικό
		\item \( x \in \left\lbrace x \in \mathbb R^2 : x_1^2+x_2^2 = 1 \right\rbrace
		\implies \dot V = 0
		\)

		Επάνω στον κύκλο, η συνάρτηση Lyapunov είναι μηδέν, άρα η κατάσταση του
		συστήματος δεν ξεφεύγει από αυτόν τον οριακό κύκλο.
	\end{itemize}

	Το σημείο ισορροπίας είναι \textbf{ασταθές}. Σύμφωνα με τον ορισμό της ευστάθειας,
	\( \forall \varepsilon > 0 \exists \delta(\epsilon) :
	|x_0-x^*| < \delta \implies |x(t;x_0)-x^*| < \epsilon \). Αν διαλέξουμε ένα
	\( \epsilon < 1 \), εντός δηλαδή του κυκλικού δίσκου, δεν μπορούμε να επιλέξουμε
	κάποιο
	\( \delta \) τέτοιο ώστε να \textbf{παραμείνουμε} εντός ακτίνας \( \epsilon \),
	επειδή πάντα τα σημεία εντός του κύκλου θα κατευθύνονται προς τον κύκλο ακτίνας 1.
\end{exercise}

\lecture{8}{23/3/2018}
\subsection{Ειδική περίπτωση: Γραμμικά συστήματα}
\label{sec:linear_lyapunov}
Έστω ότι έχουμε γραμμικά συστήματα, δηλαδή συστήματα της μορφής:
\[
\dot x = Ax
\]
αν θεωρήσουμε ότι για τις μεταβλητές κατάστασης του συστήματος ισχύει γενικότερα
\( \dot x = F(x) \).

Τότε θα χρησιμοποιούμε \textbf{συναρτήσεις Lyapunov} της μορφής:
\[
V(x) = x^{\mathrm T} P x > 0
\]
όπου \( P \) ένας \textbf{συμμετρικός} και \textbf{θετικά ορισμένος} πίνακας:
\[
P = P^{\mathrm{T}}
\]

Για την εφαρμογή του θεωρήματος χρειαζόμαστε την παράγωγο της \( V(x) \), η οποία
με πράξεις προκύπτει:
\begin{align*}
	\dot V(x) &= \dot x^{\mathrm T} P x + x^{\mathrm T} P \dot x \\
	&= x^{\mathrm T} A^{\mathrm T} P x + x^{\mathrm T} P A x \\
	&= x^{\mathrm T}(A^{\mathrm T}P + PA)x
	\numberthis
	\label{eq:linear_lyapunov_vd}
\end{align*}

Για ευκολία, ορίζουμε έναν επιπλέον πίνακα \( Q \), \textbf{θετικά ορισμένο} και
\textbf{συμμετρικό} \( Q = Q^{\mathrm T} \), ως εξής:
\[
-Q = A^{\mathrm T}P + PA
\]

Επομένως, από την \eqref{eq:linear_lyapunov_vd} προκύπτει:
\[
\dot V = -x^{\mathrm T} Q x \text{ αρνητικά ορισμένος}
\]

Για τη λύση του \textit{γραμμικού} συστήματος εφαρμόζουμε το
παρακάτω θεώρημα.

\begin{theorem}{Θεώρημα Ευστάθειας Lyapunov σε Γραμμικά Συστήματα}{lyapunov_linear}
	Το γραμμικό σύστημα \( \dot x = Ax \) είναι
	\textit{ασυμπτωτικά ευσταθές} ανν για κάποιον
	πίνακα \( Q \) συμμετρικό, και θετικά ορισμένο, η λύση \( P \)
	της εξίσωσης:
	\begin{equation}
	\boxed{-Q = A^{\mathrm T}P + PA}
	\label{eq:lyapunov_linear}
	\end{equation}
	είναι επίσης πραγματική, συμμετρική και θετικά ορισμένη.
\end{theorem}

\begin{exercise}[Παράδειγμα]
	Δίνεται ένα γραμμικό σύστημα \( \dot x = Ax \) όπου:
	\[
	A = \left[\begin{matrix}
	0 & 1 \\ -1 & -2
	\end{matrix}\right]
	\]

	Να μελετηθεί η ευστάθειά του.
	\tcblower
	Πρέπει να βρούμε τον πίνακα \( P = P^{\mathrm T}
	= \left[\begin{matrix}
	P_{11} & P_{12} \\ P_{12} & P_{22}
	\end{matrix}\right]
	\). Υποθέτουμε
	ότι ο \( Q \) είναι:
	\[
	Q = I_2
	\]
	δηλαδή ο μοναδιαίος πίνακας.

	Τοποθετούμε τις τιμές των πινάκων στην εξίσωση \eqref{eq:lyapunov_linear} του θεωρήματος \ref{th:lyapunov_linear}:
	\[
	\left[\begin{matrix}
	-2P_{12} & -P_{22} + P_{11} - 2P_{12} \\
	-P_{22} + P_{11} - 2P_{12} & 2P_{12} - 4P_{22}
	\end{matrix}\right] = \left[
	\begin{matrix}
	-1 & 0 \\ 0 & -1
	\end{matrix}
	\right]
	\]

	Λύνοντας αυτό το (σύστημα) εξισώσεων, μετά από μερικές πράξεις,
	προκύπτει:
	\[
	P = \left[
	\begin{matrix}
	\sfrac{3}{2}  & \sfrac{1}{2}  \\
	\sfrac{1}{2} & \sfrac{1}{2}
	\end{matrix}
	\right] \text{ θετικά ορισμένος}
	\]

	Αφού ο πίνακας \( P \) είναι \textbf{θετικά ορισμένος}, όπως προκύψει
	αν τον ελέγξουμε με οποιοδήποτε κριτήριο, το σύστημα είναι
	\textbf{ασυμπτωτικά ευσταθές}.
\end{exercise}

\begin{exercise}[Παράδειγμα]
	Να ελεγθεί η ευστάθεια του γραμμικού συστήματος:
	\[
	A = \left[
	\begin{matrix}
	-1 & 3 \\ 0 & -1
	\end{matrix}\right]
	\]
	\tcblower
	Το παραπάνω σύστημα είναι προφανώς ασυμπτωτικά ευσταθές,
	αφού εύκολα μπορούμε να βρούμε τις ιδιοτιμές του και να διαπιστώσουμε πως έχουν
	αρνητικό πραγματικό μέρος,
    αλλά θα το λύσουμε με τη μέθοδο κατά Lyapunov.

    \begin{itemize}
    \item	Θα δοκιμάσουμε να λειτουργήσουμε \textbf{ανάποδα} για ευκολία:
    	Δηλαδή θα θεωρήσουμε έναν \textit{δεδομένο} \( P=I_2 \), και
    	θα βρούμε τον \( Q \) από τη σχέση.

    	Έστω ότι \( P = I_2 \). Από την εξίσωση \eqref{eq:lyapunov_linear}
    	προκύπτει εύκολα \( Q = \left[\begin{matrix}
    	2 & -3 \\ -3 & 2
    	\end{matrix}\right] \).

    	Ο παραπάνω \( Q \) έχει μία θετική και μία \textit{αρνητική}
    	ιδιοτιμή, επομένως \textit{δεν} είναι θετικά ορισμένος! Άρα
    	δεν μπορούμε να εξάγουμε κανένα συμπέρασμα από την εφαρμογή
    	του Θεωρήματος \ref{th:lyapunov_linear}.

    	Αναγκαστικά πρέπει \textbf{πρώτα} να επιλέξουμε \textbf{οποιονδήποτε} συμμετρικό και θετικά ορισμένο πίνακα
    	\( Q \), και μετά, μέσω της \eqref{eq:lyapunov_linear}, να
    	ελέγξουμε αν το σύστημα είναι ασυμπτωτικά ευσταθές ή όχι.
    \end{itemize}
\end{exercise}

\begin{exercise}
	Δίνεται το σύστημα:
	\[
	\dot x = Ax + Bu
	\]

	Να επιλεγεί ένας ελεγτής \( u \) έτσι ώστε το σύστημα να είναι
	ασυμπτωτικά ευσταθές όταν κλείνει ο βρόχος. Να γίνει το ίδιο και
	όταν υπάρχουν διαταραχές.

	\tcblower
	\textbf{Επιλέγουμε} τον απλό ελεγκτή ανάδρασης:
	\[
	\underline{u = -kx}
	\]

	Τότε το σύστημα γίνεται, από τη δοθείσα σχέση:
	\[
	\dot x = Ax - Bkx \implies
	\dot x = \underbrace{(A-Bk)}_{\tilde A} x
	\]
	όπου ορίσαμε \( \tilde A = A-Bk \), έτσι ώστε να προκύψει η απλή
	σχέση:
	\[
	\dot x = \tilde A x
	\]

	Από το \autoref{th:lyapunov_linear}, ψάχνουμε έναν πίνακα \( Q \)
	για τον οποίο:
	\begin{align*}
		Q &= Q^{\mathrm T} \text{ θετικά ορισμένος} \\
		-Q &= A^{\mathrm T}P + PA
	\end{align*}

	\tcbsubtitle{\textbf{Λύση} με διαταραχές}
	Το σύστημά μας με διαταραχή \( d(t) \) θα γίνει:
	\[
	\dot x = Ax+Bu+d(t)
	\]
	όπου οι διαταραχές έχουν ένα μέγιστο πλάτος \( \left|d(t)\right|
	\leq \bar d
	\)

	Τότε η παράγωγος της συνάρτησης Lyapunov θα γίνει:
	\begin{align*}
		\dot V &=
		\od{}{t}\left( x^{\mathrm{T}} P x \right)
		\\ &=
		\dot x^{\mathrm T} P x + x^{\mathrm T} P\dot x
		\\ &=
		\left(
		Ax + d(t)
		\right)^{\mathrm T} P x
		+ x^{\mathrm{T}}P\left(Ax+d(t)\right)
		\\ &= \left(
		x^{\mathrm{T}}A^{\mathrm T} + d^{\mathrm T}(t)
		\right)Px + x^{\mathrm{T}} PAx
		+x^{\mathrm{T}}P d(t)
		\\ &= x^{\mathrm{T}}(A^{\mathrm{T}} P + PA)x
		+ d^{\mathrm{T}}(t) P x + x^{\mathrm{T}}P d(t)
		\\ &=
		\underbrace{-x^{\mathrm{T}} Q x}_{\leq\ -\lambda_{\min}(Q)|x|^2}
		+ \underbrace{d^{\mathrm T}(t)Px}_{\leq\
			\left\lvert d^{\mathrm{T}}(t) \right\rvert |x|\left\lVert P \right\rVert}
		+ \underbrace{x^{\mathrm{T}} P d(t)}_{\leq\  |x^{\mathrm{T}}|\left\lVert P \right\rVert \left\lvert d(t) \right\rvert}
		\\ &\leq
		-\lambda_{\min}(Q)|x|^2 +
		\left\lvert d^{\mathrm{T}}(t) \right\rvert |x|\left\lVert P \right\rVert + |x^{\mathrm{T}}|\left\lVert P \right\rVert \left\lvert d(t) \right\rvert
		\\ &\leq
		-\lambda_{\min}(Q)|x|^2 +
	    \bar d |x|\left\lVert P \right\rVert + |x|\left\lVert P \right\rVert \bar d
	    \\ &= -|x| \left(
	    λ_{\min}(Q)|x| - 2\bar d \left\lVert P \right\rVert
	    \right)
	\end{align*}
	όπου \( \lambda_{\min}(Q) \) η \textit{ελάχιστη ιδιοτιμή} του
	πίνακα \( Q \), και \( \left\lVert P \right\rVert \) η
	\textbf{νόρμα} του πίνακα \( P \).

	Θέλουμε \( \dot V \) να είναι αρνητικά ορισμένη για την εφαρμογή του θεωρήματος Lyapunov,
	δηλαδή:
	\[
	|x| > \frac{2\left\lVert P \right\rVert \bar d}{\lambda_{\min}(Q)}
	\]

	Με την πάροδο του χρόνου, η \( |x| \) θα αποκτά τη μορφή
	\todo{Graph 21}.\todo{explain better}

	Εδώ διαπιστώνουμε ότι το σύστημα με την πάροδο του χρόνου παραμένει στην ευστάθεια, αλλά δεν
	είναι απαραίτητα και \textit{ασυμπτωτικά} ευσταθές. Μόλις το
	\( |x| \) ξεπεράσει την τιμή \( \frac{\left\lVert P \right\rVert \bar d}{\lambda_{\min}(Q)} \), θα παραμείνει αναγκαστικά εντός του
	εύρους της. Για να ρυθμίσουμε ακριβώς το εύρος αυτό, πρέπει να
	επιλέξουμε τους όρους του κλάσματος \( 2\frac{\left\lVert P \right\rVert}{\lambda_{\min}(Q)} \), κάτι που είναι δύσκολο, λόγω
	της εξάρτησης του \( P \) από το \( Q \).

	\todo{add defn reference}
	Να σημειωθεί βέβαια πως η ευστάθεια που παρουσιάζει το σύστημα εδώ δεν συμφωνεί με τον ορισμό που έχουμε δώσει παραπάνω (κατά Lyapunov),
	αλλά εκφράζει πως θα έχουμε πεπερασμένη είσοδο με
	πεπερασμένη έξοδο, αφού η συνάρτηση είναι \textbf{ομοιόμορφα τελικώς φραγμένη}.
\end{exercise}

\section{Γραμμικά Συστήματα}
Αν και τα περισσότερα συστήματα στη φύση είναι \textit{μη} γραμμικά, σε αυτό το κεφάλαιο μελετάμε τα \textit{γραμμικά}, καθώς είναι χρήσιμα
για διδακτικούς σκοπούς, ενώ τα μη γραμμικά συστήματα και ελεγκτές είναι
δύσκολα, περίπλοκα, και δεν είναι εύκολο να επιδιορθωθούν.
Σε αυτό το κεφάλαιο θα μελετήσουμε μεταξύ άλλων γραμμικούς ελεγκτές, αλλά
και γραμμικοποίηση συστημάτων.

\subsection{Ιδιότητες \& Ορισμοί}
Έστω ένα σύστημα της μορφής:
\begin{align*}
	\dot x &= f(x,u) \\
	y &= h(x,u)
\end{align*}
με μοναδική λύση της μορφής:
\[
y(t;\ x_0,u)
\]

\begin{defn}{Γραμμικό σύστημα}{}
	Ένα σύστημα είναι \textbf{γραμμικό} ανν πληροί τις παρακάτω ιδιότητες:
	\begin{enumroman}
		\item \textbf{Ιδιότητα της επαλληλίας} ως προς τις αρχικές τιμές.
		%\begin{itemize}
		%\item
		\[
		y\left(t;\ ax_1(0)+bx_2(0),\ 0\right)
		=
		ay\left(t; x_1(0),\ 0\right)
		+ by\left(t; x_2(0),\ 0\right)
		\]
		%\end{itemize}

		\item \textbf{Ιδιότητα της ομογένειας}%
		\[
		y\left(τ;\ ax_0,\gamma u\right)
		= ay(t;\ x_0,\ 0) + \gamma y(t;\ 0,\ u)
		\]

		\item \textbf{Ιδιότητα της επαλληλίας} ως προς την είσοδο.
		\[
		y\left(t;\ 0,\ \zeta u_1+\xi u_2\right)
		= \zeta y(t;0,u_1) + \xi y(t; 0,u_2)
		\]
	\end{enumroman}
\end{defn}

Οι παραπάνω ιδιότητες μπορούν να επαληθευτούν και πειραματικά, έτσι ώστε
να διαπιστωθεί αν ένα φυσικό σύστημα είναι όντως γραμμικό.

Αν ικανοποιούνται οι παραπάνω ιδιότητες, το σύστημα μπορεί να γραφτεί
και στη μορφή:
\[
\dot x = Ax
\]

\begin{defn}{Χρονικά Αμετάβλητο}{}
	\todo{Add definition}
	Αν μετατοπίσουμε την είσοδο στο χρόνο, πρέπει και η έξοδος
	να μετατοπίζεται κατά την ίδια ποσότητα.
\end{defn}

\subsection{Λύση}
\label{sec:linear_solution}
Ένα γραμμικό σύστημα έχει γενικά τη μορφή:
\[
\dot x = Ax,\quad x(0) = x_0 \quad \text{(αρχική συνθήκη)}
\]

Έστω ότι το σύστημα είναι \textbf{μίας μεταβλητής}.

Τότε:
\[
\dot x = ax,\quad x(0) = x_0
\]
και η προφανής λύση είναι:
\[
x(t) = e^{at}x(0)
\]

Για απλοποίηση της εξόδου, θεωρούμε τις σειρές Taylor της εκθετικής συνάρτησης, για τις τιμές ενός πίνακα \( X \in \mathbb R^{n\times n} \):
\begin{align*}
	e^{X} &= I + X + \frac{1}{2} X^2 + \frac{1}{3!} X^3 + \dots
	\\ &= \sum_{k=0}^{\infty} \frac{1}{k!}x^k
	\\[3em]
	e^{At} &= I + At + \frac{1}{2}A^2t^2 + \frac{1}{3!}A^3t^3 + \dots
	\\ &= \sum_{k=0}^{\infty} \frac{1}{k!}A^k t^k\\[3em]
	\od{e^{At}}{t} &= A + A^2t + \frac{1}{2}A^3t^2 + \dots
	\\ &= A\sum_{k=0}^{\infty} \frac{1}{k!}A^kt^k
	\\ &= Ae^{At}
\end{align*}

Ορίζουμε τον πίνακα \( e^{At} \in \mathbb R^{n\times n} \) ως
\textbf{πίνακα μετάβασης}, αφού είναι αυτός που μας μεταφέρει από
το \( x(0) \) στο \( x(t) \):
\[
x(t) = e^{At} x(0)
\]

\begin{exercise}[Παράδειγμα]
	Έστω το σύστημα \( \ddot q = u, y=q \) με μεταβλητές κατάστασης
	\( x_1=q \), \( x_2 = \dot q \). Να βρεθεί η έξοδός του.
	\tcblower

	Όπως έχει οριστεί το σύστημα, φαίνεται ότι:
	\begin{align*}
		\dot x_1 &= x_2\\
		\dot x_2 &= u\\
		y &= x_1
	\end{align*}
	ή, σε μορφή πίνακα:
	\begin{align*}
		\dot x &= \left[\begin{matrix}
		0 & 1 \\ 0 & 0
		\end{matrix}\right]x + \left[\begin{matrix}
		0 \\ 1
		\end{matrix}\right]u\\
		y &= \left[\begin{matrix}
		1 & 0
		\end{matrix}\right] x
	\end{align*}

	Για να υπολογίσουμε την έξοδο του συστήματος, θα εκμεταλλευτούμε το γεγονός ότι
	\( x(t) = e^{At} x(0) \). Πρώτα επομένως πρέπει να υπολογίσουμε τον πίνακα μετάβασης
	\( e^{At} \):
	\[
	e^{At} = I + At + \frac{1}{2} A^2t^2 + \frac{1}{3!} A^3t^3 + \dots
	\]

	Ισχύει:
	\[
	A^2 = AA = \left[\begin{matrix}
	0 & 1 \\ 0 & 0
	\end{matrix}\right]\left[\begin{matrix}
	0 & 1 \\ 0 & 0
	\end{matrix}\right] = 0
	\]
	άρα \( A^3 = A^2 A \), \( A^4 = 0,\ \dots \)

	Επομένως:
	\[
	e^{At} = I + At = \left[\begin{matrix}
	1 & 0 \\ 0 & 1
	\end{matrix}\right] + \left[\begin{matrix}
	0 & 1 \\ 0 & 0
	\end{matrix}\right] t = \left[\begin{matrix}
	1 & t \\ 0 & 1
	\end{matrix}\right]
	\]

	Άρα τελικά:
	\[
	x(t) = \left[\begin{matrix}
	1 & t \\ 0 & 1
	\end{matrix}\right]\left[\begin{matrix}
	x_1(0) \\ x_2(0)
	\end{matrix}\right]
	\]
	που σημαίνει ότι:
	\begin{align*}
		y = x_1(t) &= x_1(0) + tx_2(0)\\
		x_2(t) &= x_2(0)
	\end{align*}

\end{exercise}

\subsubsection{Πώς βρίσκουμε πίνακα μετάβασης;}

Στο παραπάνω παράδειγμα η εύρεση του πίνακα μετάβασης ήταν εύκολη υπόθεση, επειδή γλιτώσαμε από τις άπειρες
συνιστώσες, επειδή έτυχε \( A^2 = 0 \). Ο υπολογισμός του πίνακα μετάβασης όμως στη γενική περίπτωση είναι
δύσκολος.

Μπορούμε να τον πραγματοποιήσουμε θεωρώντας \textbf{μετασχηματισμό Laplace}:
\begin{alignat*}{3}
	&& \dot x &= Ax &&\implies \\
	\implies && sX(s) - x(0) &= AX(s) &&\implies \\
	\implies && (sI-A)X(s) &= x(0) &&\implies \\
	\implies && X(s) &= (sI-A)^{-1} x(0) &&\implies \\
	\implies && x(t) &= \mathscr L^{-1} \left\lbrace (sI-A)^{-1} \right\rbrace x(0)
\end{alignat*}

Επομένως τελικά:
\[
\boxed{e^{At} = \mathscr{L}^{-1} \left\lbrace (sI-A)^{-1} \right\rbrace}
\]

\paragraph{Για διαγώνιους \(A\)}
Ο παραπάνω υπολογισμός είναι δύσκολος, εκτός από την περίπτωση στην οποία έχουμε διαγώνιους \( A \), οπότε ισχύει:
\begin{align*}
	A &= \left[\begin{matrix}
	\lambda_1 & 0 & \hdots & 0 \\
	0 & \lambda_2 & \hdots & 0 \\
	\vdots & \vdots & \ddots & \vdots \\
	0 & 0 & \hdots & \lambda_k
	\end{matrix}\right] \\
	e^{At} &= \left[\begin{matrix}
	e^{\lambda_1t} & 0 & \hdots & 0 \\
	0 & e^{\lambda_2t} & \hdots & 0 \\
	\vdots & \vdots & \ddots & \vdots \\
	0 & 0 & \hdots & e^{\lambda_kt}
	\end{matrix}\right]\\
	\dot x_i &= \lambda_i x_i
\end{align*}

Όμως πολύ σπάνια έχουμε διαγώνιους πίνακες \( A \). Μπορεί όμως να είναι χρήσιμο να βρούμε έναν ισοδύναμο διαγώνιο \( \tilde A \)
που να λύνει το σύστημα.

Στην παρακάτω σχέση, υπάρχει \textit{πάντα} ένας αντιστρέψιμος πίνακας \( T \) έτσι ώστε ο \( \tilde A \) να είναι διαγώνιος:
\[
\tilde A = TAT^{-1}
\]

Επομένως μπορούμε να ορίσουμε νέες μεταβλητές κατάστασης \( z \):
\[
\underline{z = Tx} \implies x = T^{-1}z
\]
και τότε:
\[
\dot z = T\dot x = T(Ax) = \left(TAT^{-1}\right)z = \tilde A
\]
όπου ο \( \tilde A \) είναι διαγώνιος, και το σύστημα έχει λύση:
\[
z_i(t) = e^{\lambda i} z_i (0)
\]

\lecture{9}{28/3/2018}

\subsection{Ιδιοτιμές και ρυθμοί}
Έστω τα \textit{ιδιοδιανύσματα} \( v \) που αντιστοιχούν στις
ιδιοτιμές \( λ \) ενός πίνακα \( A \), που ορίζονται από τη σχέση:
\[
Av = λv
\]
και έχουμε το γνωστό σύστημα:
\[
\dot x = Ax + Bu
\]

Θα αναζητήσουμε τη λύση του \textbf{ομογενούς} συστήματος (\( u = 0 \implies \dot x = Ax \)), \textit{συγκεκριμένα}
όταν η αρχική τιμή είναι \( x(0) = v \). Από την Ενότητα \ref{sec:linear_solution}, και αναπτύσσοντας κατά Taylor, η λύση του συστήματος αυτού θα είναι:
\begin{align*}
	x(t) &= e^{At} x(0) \\
	&= e^{At} v \\
	&= (I+At+\frac{1}{2}A^2t^2+\dots)v\\
	&= v + (Av)t + \frac{1}{2}A^2v^2t^2 + \dots \\
	&= v + λvt + \frac{1}{2}λ^2vt^2 + \dots \\
	&= (1+λt + \frac{1}{2}λ^2t^2 + \dots) v \\
	&= e^{\lambda t}v \label{eq:linear_eigenvector_solution}
	\numberthis
\end{align*}

\begin{defn}{Ρυθμός}{}
	Ορίζουμε ως \textbf{ρυθμό} της ιδιοτιμής \( λ \) του πίνακα \( A \)
	την ποσότητα:
	\[
	e^{\lambda t} = 1+λt + \frac{1}{2}λ^2t^2 + \dots
	\]
\end{defn}

Για να γενικεύσουμε για \( x(0) \neq \lambda \), θεωρούμε ότι οι
αρχικές συνθήκες του συστήματος προκύπτουν ως \textbf{επαλληλία} των
ιδιοδιανυσμάτων, δηλαδή αποτελούν άθροισμα του κάθε ιδιοδιανύσματος,
πολλαπλασιασμένου με κάποιον συντελεστή:
\[
x(0) = \sum a_i v_i
\]

Τότε, λόγω της \textit{γραμμικότητας} του συστήματος, η \textbf{γενική λύση} θα μοιάζει με ένα άθροισμα ρυθμών:
\[
x(t) = e^{At} \sum_{i=1}^{n} a_iv_i
\]

\paragraph{Σε μιγαδικές ιδιοτιμές}
Αν έχουμε \textbf{μιγαδικές} ιδιοτιμές, αυτές θα έχουν τη μορφή:
\[
λ = σ \pm j\omega
\]
και το ιδιοδιάνυσμα θα έχει τη μορφή:
\[
\vec v = \vec u \pm j\vec w
\]
και η τελική λύση προκύπτει, αφού κάνουμε αρκετές πράξεις στην
\eqref{eq:linear_eigenvector_solution}:
\[
x(t) = e^{σt}
\left[u\cos \omega  t -w\sin \omega t
\right]+j\left[
u\sin \omega t + w\cos \omega t
\right]
\]

\subsubsection{Για μη ομογενή συστήματα}
Παραπάνω θεωρήσαμε ότι, στην εξίσωση \( \dot x =Ax+Bu \), είχαμε:
\[
u = 0 \implies \dot x = Ax
\]
δηλαδή είχαμε ομογενές σύστημα.

Στην περίπτωση που \( u\neq 0 \), η λύση που θα προκύψει είναι:
\[
x(t) = e^{At} x(0) + \int_{0}^{t} e^{A(t-τ)}Bu\dif τ
\]

\subsubsection{Απόκριση εισόδου-εξόδου}
Επιπλέον, αν θεωρήσουμε ότι η \textbf{έξοδος} \( y \) του συστήματος
εξαρτάται από την κατάσταση και την είσοδό του, δηλαδή:
\[
y = Cx + Du
\]
τότε αυτή μπορεί να προσδιοριστεί από τη σχέση:
\[
\boxed{
	y(t) = ce^{At} x(0)
	+ c\int_{0}^{t} e^{A(t-τ)} Bu\dif τ +Du
	}
\]

\subsubsection{Αλλαγή στις μεταβλητές κατάστασης}
\label{sec:linear_varmod}
Έστω ένα σύστημα με μεταβλητές κατάστασης \( x \):
\[
\dot x = Ax + Bu
\]

Έχουμε υποστηρίξει ότι μπορούμε κατά βούληση να τις αλλάξουμε, χωρίς
καμία αλλαγή στο σύστημα. Δηλαδή το παραπάνω σύστημα μπορεί να εκφραστεί
και με βάση ένα σετ \textbf{διαφορετικών μεταβλητών κατάστασης}
\( z \), το οποίο βέβαια θα εκφράζεται και από διαφορετικούς πίνακες
\( A \) και \( B \), έστω \( \tilde A \) και \( \tilde B \) αντίστοιχα.
\[
\dot z = \tilde A z + \tilde B u
\]

\textit{Πράγματι}, έστω ότι μετασχηματίζουμε τον πίνακα των \( x \) μέσω
ενός αντιστρέψιμου πίνακα \( T \) (\textbf{ομογενής μετασχηματισμός}):
\[
z = Tx \qquad \implies x=T^{-1} z
\]

Τότε, παραγωγίζοντας την παραπάνω εξίσωση, έχουμε:
\begin{align*}
	\dot z &= T\dot x \\
	&= T(Ax+Bu) \\
	&= TAx + TBu \\
	\dot z &= \underbrace{(TAT^{-1})}_{\tilde A}z
	+ \underbrace{(TB)}_{\tilde B}u
	\\ &= \tilde A z + \tilde B u
\end{align*}
δηλαδή φτάσαμε στην επιθυμητή μορφή \( \dot z = \tilde A z + \tilde B u \).

Ο μετασχηματισμός αυτός είναι χρήσιμος όταν θέλουμε να αλλάξουμε τις
μεταβλητές κατάστασης, έτσι ώστε να φτάσουμε σε ένα πιο απλοποιημένο
αλλά ισοδύναμο σύστημα από ένα αρχικό. Πρέπει όμως να επιλεγεί ένας
οποιοσδήποτε \textit{μη αντιστρέψιμος} πίνακας \( T \) που να οδηγεί
όντως στην ευκολότερη επίλυση του προβλήματος.

\begin{exercise}
	Δίνεται το μηχανικό σύστημα:

	\begin{circuitikz}
		\fill[postaction={decorate},pattern=north east lines] (0,3) rectangle (-0.5,-0.5) rectangle (10,0);
		\fill[postaction={decorate},pattern=north east lines] (10,2.5) rectangle (11,1);

		\draw (2,0) rectangle ++(2,2) node[midway] {$m$} node[midway] (m2) {};
		\draw (6,0) rectangle ++(2,2) node[midway] {$m$} node[midway] (m1) {};

		\draw (2,1.6) to[damper,l_=$c$,invert] ++(-2,0);
		\draw (2,0.4) to[spring,invert,l_=\raisebox{-1.5ex}{$k$}] ++(-2,0);
		\draw (6,1) to[spring,invert,l_=\raisebox{-1.5ex}{$k$}] ++(-2,0);

		\draw (8,1.8) to[damper,l^=$c$] ++(2,0);
		\draw (8,1.2) to[spring,l_=\raisebox{1.5ex}{$k$}] ++(2,0);

		\draw[thick,->] (8,0.4) -- ++(2.5,0) node[right] {$u$};

		\draw[thick] (0,3) |- (10,0);
		\draw[thick] (10,2.5) -- (10,1);

		\draw[->] (m2) ++ (0,1.4) |- ++(2,0.7) node[above,pos=.75,gray] {$q_1$};
		\draw[->] (m1) ++ (0,1.4) |- ++(2,0.7) node[above,pos=.75,gray] {$q_2$};
	\end{circuitikz}

	Να γραφούν οι εξισώσεις κατάστασής του.

	\tcblower

	Για να βρούμε τις εξισώσεις κατάστασης, πρέπει πρώτα να βρούμε τις
	διαφορικές εξισώσεις του συστήματος. Για κάθε μάζα έχουμε:
	\begin{align*}
		m\ddot q_1 &= -k(q_1-q_2) - kq_1-c\dot q_1\\
		m\ddot q_2 &= -k(q_2-q_1) - kq_2 -c\dot q_2 + u
	\end{align*}
	άρα ισοδύναμα:
	\begin{align}
	\ddot q_1 &= -\frac{k}{m}(q_1-q_2) - \frac{k}{m}q_1-\frac{c}{m}\dot q_1
	\label{eq:sec4ex1a}
	\\
	\ddot q_2 &= -\frac{k}{m}(q_2-q_1) - \frac{k}{m}q_2 -\frac{c}{m}\dot q_2 + \frac{1}{m}u
	\label{eq:sec4ex1b}
	\end{align}

	Έχουμε σύστημα \( 2+2=4 \)\textsuperscript{ης} τάξης, και επιλέγουμε,
	με βάση προηγούμενη θεωρία, τις μεταβλητές κατάστασης ως εξής:
	\[
	x_1=q_1,\quad x_2=q_2,\quad x_3 = \dot q_1,\quad x_4 = \dot q_2
	\]

	Μετά από πράξεις, ο πίνακας των μεταβλητών κατάστασης του συστήματος γίνεται:
	\[
	\dot x = \left[\begin{matrix}
	0 & 0 & 1 & 0\\
	0 & 0 & 0 & 1\\
	-\frac{2k}{m} & \frac{k}{m} & \frac{-c}{m} & 0\\
	\frac{k}{m} & \frac{-2k}{m} & 0 & \frac{-c}{m}
	\end{matrix}
	\right]x + \left[
	\begin{matrix}
	0\\ 0\\ 0 \\ \frac{1}{m}
	\end{matrix}\right]u
	\]

	Οι \textbf{εξισώσεις εξόδου} του συστήματος πρέπει ουσιαστικά να δηλώνουν τις θέσεις των δύο σωμάτων, δηλαδή τις μεταβλητές κατάστασης
	\( x_1 \) και \( x_2 \):
	\[
	y = \left[\begin{matrix}
	1 & 1 & 0 & 0
	\end{matrix}\right]x
	\]

	\paragraph{}
	Αν μας ζητηθεί να \textbf{λύσουμε} το παραπάνω σύστημα, παρατηρούμε πως,
	αν και είναι γραμμικό, είναι 4\textsuperscript{ης} τάξης. Αυτό σημαίνει
	πως θα δυσκολευτούμε σημαντικά να το λύσουμε.

	Για αυτό, κάνουμε μια διαφορετική επιλογή μεταβλητών κατάστασης, ως
	εξής:
	\[
	z_1=\frac{q_1+q_2}{2},\quad
	z_2=\dot z_1,\quad
	z_3=\frac{q_1-q_2}{2},\quad
	z_4=\dot z_3
	\]
	με βάση τα παραπάνω, ισχύει:
	\[
	\dot z_2 = \ddot z_1 = \frac{\ddot q_1+\ddot q_2}{2}
	= -\frac{k}{m}z_1 -\frac{c}{m}z_2 + \frac{u}{2m}
	\]
	και
	\[
	\dot z_4 = \frac{\ddot q_1-\ddot q_2}{2}
	= -\frac{3k}{m}z_3 -\frac{c}{m}z_4 - \frac{u}{2m}
	\]
	όπως προκύπτει από πρόσθεση και αφαίρεση κατά μέλη των
	\eqref{eq:sec4ex1a} και \eqref{eq:sec4ex1b}.

	Τότε, οι εξισώσεις κατάστασης του συστήματος, όπως προκύπτουν
	από τις παραπάνω μεταβλητές, είναι:
	\[
	\dot z = \left[\begin{matrix}
	0 & 1 & 0 & 0\\
	\sfrac{-k}{m} & \sfrac{-c}{m} & 0 & 0\\
	0 & 0 & 0 & 1\\
	0 & 0 & \sfrac{-3k}{m} & \sfrac{-c}{m}
	\end{matrix}\right]z + \left[\begin{matrix}
	0 \\ \sfrac{1}{2m} \\ 0 \\ \sfrac{-1}{2m}
	\end{matrix}\right]u
	\]
	\todo{Matrix what rows/cols}

	Το σύστημα αυτό είναι αρκετά πιο απλό από το προηγούμενο. Πράγματι,
	αυτό μπορεί να χωριστεί σε δύο ανεξάρτητα (\textbf{αποσυζευγμένα})
	συστήματα \( 2\times2 \):
	\begin{align*}
		\left[\begin{matrix}
		\dot z_1\\ \dot z_2
		\end{matrix}\right] &= \left[\begin{matrix}
		0 & 1 \\ \sfrac{-k}{m}  & \sfrac{-c}{m}
		\end{matrix}\right]\left[\begin{matrix}
		z_1\\z_2
		\end{matrix}\right] + \left[\begin{matrix}
		0 \\ \sfrac{1}{2m}
		\end{matrix}\right]\left[\begin{matrix}
		u_1 \\ u_2
		\end{matrix}\right] \\
		\left[\begin{matrix}
		\dot z_3\\ \dot z_4
		\end{matrix}\right] &= \left[\begin{matrix}
		0 & 1 \\ \sfrac{-3k}{m}  & \sfrac{-c}{m}
		\end{matrix}\right]\left[\begin{matrix}
		z_3\\z_4
		\end{matrix}\right] + \left[\begin{matrix}
		0 \\ \sfrac{-1}{2m}
		\end{matrix}\right]\left[\begin{matrix}
		u_3 \\ u_4
		\end{matrix}\right]
	\end{align*}

	Βέβαια, αφού βρούμε τις τιμές των \( z \), θα πρέπει να υπολογιστεί
	η έξοδος του συστήματος \( q_1 \) και \( q_2 \), ή να βρεθεί
	ένας μετασχηματισμός ως προς \( x \). Συγκρίνοντας τις εξισώσεις
	των \( z \) και \( x \), έχουμε:
	\[
	z = \left[\begin{matrix}
	\frac{q_1+q_2}{2} \\ \frac{\dot q_1 + \dot q_2}{2}
	\\ \frac{q_1 - q_2}{2} \\ \frac{\dot q_1 - \dot q_2}{2}
	\end{matrix}\right]
	= \left[\begin{matrix}
    \frac{1}{2} & \frac{1}{2} & 0 & 0\\
    0 & 0 & \frac{1}{2} & \frac{1}{2}\\
    \frac{1}{2} & -\frac{1}{2} & 0 & 0\\
    0 & 0 & \frac{1}{2} & -\frac{1}{2}
	\end{matrix}\right]\left[\begin{matrix}
	x_1 \\ x_2 \\ x_3 \\ x_4
	\end{matrix}\right]
	= \underbrace{\frac{1}{2}\left[\begin{matrix}
	1 & 1 & 0 & 0\\
	0 & 0 & 1 & 1\\
	1 & -1 & 0 & 0\\
	0 & 0 & 1 & -1
	\end{matrix}\right]}_{T}
    \left[\begin{matrix}
	x_1 \\ x_2 \\ x_3 \\ x_4
	\end{matrix}\right]
	\]

	Πρέπει να ελέγξουμε αν ο μετασχηματισμός είναι ομογενής προτού
	τον εφαρμόσουμε (\autoref{sec:linear_varmod}). Ο συγκεκριμένος πίνακας \( T \) είναι μη αντιστρέψιμος (αφού έχει ορίζουσα 0),
	επομένως ο μετασχηματισμός έχει νόημα.
\end{exercise}

\subsubsection{Απόκριση μόνιμης κατάστασης}
Η έξοδος ενός γραμμικού συστήματος θυμόμαστε ότι είναι:
\[
y(t) = ce^{At} x(0) + \int_{0}^{t}ce^{A(t-τ)}Bu\dif τ +Du
\]

Έστω ότι στην είσοδο του συστήματος τοποθετούμε τη μοναδιαία βηματική συνάρτηση
(\( u=1 \)),
χωρίς αρχικές συνθήκες (\( x(0) = 0 \)). Τότε η \textbf{βηματική απόκριση} (δηλαδή η έξοδος)
του συστήματος είναι:
\[
y(t) = c\int_{0}^{t}e^{A(t-τ)}B\dif τ +D
\]

Πραγματοποιούμε αλλαγή μεταβλητής στο ολοκλήρωμα, θέτοντας \( \omega = t-τ \). Άρα:
\begin{align*}
	y(t) &= c\int_{0}^{t}e^{A\omega }B\dif \omega +D \\
	&= \left. cA^{-1}e^{A\omega }B\right|_{\omega = 0}^{\omega = t}
	+ D
	\\ y(t) &=
	\underbrace{cA^{-1}e^{At} B} +\underbrace{D-CA^{-1}B},\quad \forall t \geq 0
\end{align*}

Στο αποτέλεσμα αυτό έχουμε δύο όρους, τον \( cA^{-1}e^{At}B \) που
εκφράζει το \textbf{μεταβατικό φαινόμενο} του συστήματος
(είναι ένας εκθετικός αποσβεννύμενος όρος, αν θεωρήσουμε ότι έχουμε ευστάθεια \textemdash~ πίνακας \( A \) ευσταθής, δηλαδή με ιδιοτιμές
στο αριστερό μόνον ημιεπίπεδο), και τον
\( D-CA^{-1}B \), ο οποίος δεν εξαρτάται από το χρόνο, και εκφράζει
τη \textbf{μόνιμη κατάσταση} του συστήματος.

\subsubsection{Απόκριση Συχνότητας}
Ένα σύστημα μπορεί να αναλυθεί στη συχνότητα για ημιτονοειδείς εισόδους
που προστίθενται κατά την αρχή της επαλληλίας, όπως και στα ΣΑΕ 1.

Αποδεικνύεται ότι το \textbf{κέρδος μηδενικής συχνότητας} είναι:
\[
M_0 = -CA^{-1}B + D
\]

\lecture{10}{30/3/2018}
\subsection{Μετατροπή μη γραμμικού συστήματος σε γραμμικό}
Η μετατροπή είναι χρήσιμη έτσι ώστε να απλοποιήσουμε ένα περίπλοκο
σύστημα, και να το μελετήσουμε σύμφωνα με τα παραπάνω.

\subsubsection{Γραμμικοποίηση γύρω από σημείο ισορροπίας}
\label{sec:linear_linearization_point}
Έστω ένα οδηγούμενο μη γραμμικό σύστημα, με τις παρακάτω εξισώσεις
κατάστασης και εξόδου:
\begin{align*}
	\dot x &= F(x,u)\\
	y &= h(x,u)
\end{align*}

Σκοπός μας είναι να βρούμε το ισοδύναμό του γραμμικό σύστημα κοντά σε
ένα σημείο ισορροπίας.

Για να το πετύχουμε αυτό, σκεφτόμαστε πώς θα δρούσαμε αν θέλαμε να
γραμμικοποιήσουμε μια μη γραμμική συνάρτηση κοντά σε ένα σημείο:
\todo{Graph 23}

Σε ένα σημείο θα λαμβάναμε την \textbf{εφαπτομένη} της καμπύλης, η οποία
θα οδηγούσε στην καλύτερη προσέγγιση. Για μεγάλο εύρος μακριά από το
σημείο αυτό, το σφάλμα της προσέγγισης αυτής θα ήταν μεγάλο, ενώ θα
ελαχιστοποιούνταν όσο φτάναμε σε μικρότερη απόσταση από το σημείο αυτό.
Το εύρος εντός του οποίου έχουμε ανεκτή ποσότητα σφάλματος εξαρτάται
από την \textbf{ομαλότητα} της συνάρτησης.

Για τη μελέτη του συστήματος, πρώτα βρίσκουμε το \textbf{σημείο ισορροπίας} του, δηλαδή το:
\[
\left(x^*,\ u^*\right)
\]
και ορίζουμε τη διαφορά του σημείου ισορροπίας στις μεταβλητές κατάστασης, την είσοδο, και την έξοδο:
\begin{align*}
	z &= x - x^* \\
	v &= u - u^* \\
	w &= y - h(x^*, u^*)
\end{align*}

Έτσι ουσιαστικά έχουμε μετακινήσει το σημείο ισορροπίας στο σημείο
0, δηλαδή \( (z^*, u*) = (0,0) \).

Θέλουμε το σύστημά μας να γίνει \textbf{γραμμικό}, δηλαδή να ισχύουν οι σχέσεις:
\begin{align*}
	\dot z &= Az + Bv\\
	w &= Cz + Dv
\end{align*}
όπου οι πίνακες \( A,B,C,D \) προέρχονται, όπως και στην περίπτωση της
συνάρτησης, από \textbf{παραγώγιση} (ή, ισοδύναμα, από τον πρώτο όρο
της σειράς Taylor):
\begin{alignat*}{3}
	A &= \left. \pd{F}{x} \right|_{x^*,u^*}, \quad&& C &=
	\left. \pd{h}{x}\right|_{x^*,u^*} \\
	B &= \left. \pd{F}{u} \right|_{x^*,u^*}, \quad&& D &=
	\left. \pd{h}{u}\right|_{x^*,u^*}
\end{alignat*}

Βέβαια για να εφαρμοστεί η παραπάνω μέθοδος, πρέπει να \textbf{υπάρχει το
	σημείο ισορροπίας} του εξεταζόμενου συστήματος.

\begin{exercise}[Παράδειγμα]
	Δίνεται το σύστημα:
	\[
	\dot x = c_0 + c_1 x + c_2 x^2 + u,\ c_0 \neq 0
	\]
	Να γραμμικοποιηθεί γύρω από το \( (x,u) = (0,0) \)

	\tcblower

	Στο παραπάνω σύστημα παρατηρούμε ότι το \( (0,0) \) \textbf{δεν} είναι
	σημείο ισορροπίας, αφού \( F(x,u) = \left. \dot x \right|_{{x=0}\atop{u=0}}
	= c_0 \neq 0 \). Επομένως δεν μπορεί να εφαρμοστεί η μεθοδολογία
	του \ref{sec:linear_linearization_point} (\nameref{sec:linear_linearization_point}).

	Μπορούμε όμως, για αρκετά μικρή είσοδο \( u \simeq 0 \) και μεταβλητή
	κατάστασης \( x \simeq 0 \), να θεωρήσουμε πως ο όρος του τετραγώνου
	γίνεται αρκετά μικρός και φεύγει:
	\[
	\dot x = c_0 + c_1x + \cancelto{0}{c_2x^2}
	\]
	και το σύστημα γίνεται:
	\[
	\dot x = c_0 + c_1 x
	\]

	Το \( \dot x = c_0 + c_1 x \) όμως \textbf{δεν} είναι γραμμικό σύστημα!
	Αυτό συμβαίνει λόγω του σταθερού όρου \( c_0 \neq 0 \), ο οποίος δεν
	ικανοποιεί ταυτόχρονα τις ιδιότητες της επαλληλίας και της ομογένειας.
	\todo{which one is bad?}

	Επομένως το παραπάνω σύστημα δεν μπορεί να γραμμικοποιηθεί γύρω από
	το \( (0,0) \) όπως ζητείται.
\end{exercise}

\begin{exercise}
	Δίνεται το σύστημα ενός ηλεκτρομαγνήτη με ρεύμα \( i \) και τάση
	\( v \), με αυτεπαγωγή \( L \) και ωμική αντίσταση των τυλιγμάτων
	\( R \). Σε απόσταση \( x \) από αυτήν βρίσκεται μια σφαίρα μάζας
	\( m \).

    \begin{tikzpicture}[american voltages,scale=.7]
    % Source: https://tex.stackexchange.com/a/32313

    \begin{scope}[rotate=90]

    % Define a formula for the coil.
    % This is what the numbers mean:
    % 0.3 ... how far the rings are apart
    % 0.4 ... how much from the side the rings are seen (try 0 and the same as the radius)
    % 1.5 ... radius of the rings
    \def\coil#1{
    	{0.55 * (2*#1 + \t) + 0.4*sin(\t * pi r))},
    	{1.5 * cos(\t * pi r)}
    }

    % Draw the part of the coil behind the rectangle
    \foreach \n in {0,1,...,5} {
    	\draw[domain={0:1},smooth,variable=\t,samples=15]
    	plot (\coil{\n});
    }

    % Draw the rectangle
    \filldraw[fill=white] (-0.5,-1) rectangle (7,1);

    % Draw the part of the coil in front of the rectangle
    \foreach \n in {0,1,...,5} {
    	\draw[domain={1:2},smooth,variable=\t,samples=15,
    	preaction={draw,white,line width=3pt}     % remove if undesired
    	]
    	plot (\coil{\n});
    }

    \end{scope}

    \draw[	postaction={
    	decorate,
    	decoration={
    		post length=1mm, % ??? Magic to fix "Dimension
    		pre length=1mm, % ???  too large" errors.
    		markings,
    		mark=at position 0.5 with {\arrow{<}},
    		mark=at position 0.5 with {\node[above]{$i$};}
    	}
    }] plot [smooth] coordinates {(-1.5,6.6) (-1.8,7) (-3,7)} (-3,7) node[fill,circle,inner sep=1pt] {};

    \draw[	postaction={
    	decorate,
    	decoration={
    		post length=1mm, % ??? Magic to fix "Dimension
    		pre length=1mm, % ???  too large" errors.
    		markings,
    		mark=at position 0.5 with {\arrow{>}}
    	}
    }] plot [smooth] coordinates {(-1.5,0) (-1.8,-0.6) (-3,-0.7)} (-3,-0.7) node[fill,circle,inner sep=1pt] {};

    \draw (-3,7) to[open,v=$V$] (-3,-0.7);

    \draw (2, 3.5) node[right] {$L,\ R$};

    \draw[very thick,gray,->] (4,5) -- (4,2) node[near end,right] {};

    \shade[ball color=blue,thick,blue,draw=black] (0,-2.5) circle (0.7cm);

    \draw[blue,opacity=.5] (0.7,-2.5) -- ++(0.7,0);
    \draw[blue,opacity=.5] (0.7,-0.5) -- ++(0.7,0);
    \draw[<->,blue,opacity=.5] (0.7+0.35,-2.4) -- (0.7+0.35,-0.6) node[midway,fill=white,opacity=1] {$x$};



    \end{tikzpicture}

	Ζητείται να σχεδιαστεί η είσοδος τάσης \( u \) ώστε η σφαίρα να παραμένει σε
	σταθερή απόσταση \( x^* \) από τον ηλεκτρομαγνήτη.

	Η δύναμη είναι ανάλογη του τετραγώνου του ρεύματος
	\( i^2 \), και αντιστρόφως
	ανάλογη της απόστασης \( x \).

	\tcblower

	Οι δυνάμεις που ασκούνται επάνω στη μάζα είναι το βάρος \( mg \) λόγω
	της βαρύτητας, και η δύναμη \( F \) που ασκείται από τον ηλεκτρομαγνήτη.

	\begin{tikzpicture}[american voltages,scale=.5]
	% Source: https://tex.stackexchange.com/a/32313

	\begin{scope}[rotate=90]

	% Define a formula for the coil.
	% This is what the numbers mean:
	% 0.3 ... how far the rings are apart
	% 0.4 ... how much from the side the rings are seen (try 0 and the same as the radius)
	% 1.5 ... radius of the rings
	\def\coil#1{
		{0.55 * (2*#1 + \t) + 0.4*sin(\t * pi r))},
		{1.5 * cos(\t * pi r)}
	}

	% Draw the part of the coil behind the rectangle
	\foreach \n in {0,1,...,5} {
		\draw[domain={0:1},smooth,variable=\t,samples=15]
		plot (\coil{\n});
	}

	% Draw the rectangle
	\filldraw[fill=white] (-0.5,-1) rectangle (7,1);

	% Draw the part of the coil in front of the rectangle
	\foreach \n in {0,1,...,5} {
		\draw[domain={1:2},smooth,variable=\t,samples=15,
		preaction={draw,white,line width=3pt}     % remove if undesired
		]
		plot (\coil{\n});
	}

	\end{scope}

	\draw[	postaction={
		decorate,
		decoration={
			post length=1mm, % ??? Magic to fix "Dimension
			pre length=1mm, % ???  too large" errors.
			markings,
			mark=at position 0.5 with {\arrow{<}},
			mark=at position 0.5 with {\node[above]{$i$};}
		}
	}] plot [smooth] coordinates {(-1.5,6.6) (-1.8,7) (-3,7)} (-3,7) node[fill,circle,inner sep=1pt] {};

	\draw[	postaction={
		decorate,
		decoration={
			post length=1mm, % ??? Magic to fix "Dimension
			pre length=1mm, % ???  too large" errors.
			markings,
			mark=at position 0.5 with {\arrow{>}}
		}
	}] plot [smooth] coordinates {(-1.5,0) (-1.8,-0.6) (-3,-0.7)} (-3,-0.7) node[fill,circle,inner sep=1pt] {};

	\draw (-3,7) to[open,v=$V$] (-3,-0.7);

	\draw (2, 3.5) node[right] {$L,\ R$};

	\draw[->,red!50!brown, opacity=.8, thick] (0,-2.5) -- ++ (0,1.4) node[right] {$F$};
	\draw[->,red!30!brown, opacity=.8, thick] (0,-2.5) -- ++ (0,-1.4) node[right] {$mg$};

	\draw[very thick,gray,->] (4,5) -- (4,2) node[near end,right] {};

	\shade[ball color=blue,thick,blue,draw=black] (0,-2.5) circle (0.7cm);

	\draw[blue,opacity=.5] (0.7,-2.5) -- ++(0.7,0);
	\draw[blue,opacity=.5] (0.7,-0.5) -- ++(0.7,0);
	\draw[<->,blue,opacity=.5] (0.7+0.35,-2.4) -- (0.7+0.35,-0.6) node[midway,fill=white,opacity=1] {$x$};



	\end{tikzpicture}

	Σύμφωνα με την εκφώνηση, η \( F \) δίνεται από τον τύπο (μαζί με την
	σταθερά αναλογίας \( k \)):
	\[
	F = k\frac{i^2}{x}
	\]

	Σκοπός είναι ο σχεδιασμός ενός συστήματος που θα διατηρεί το \( x \)
	σε σταθερή τιμή, έτσι ώστε να μην φεύγει από το πεδίο του ηλεκτρομαγνήτη
	η σφαίρα. Αυτήν τη στιγμή δεν θα λύσουμε πλήρως την άσκηση, αλλά θα
	φτάσουμε μέχρι ένα μεσαίο σημείο.

	Οι διαφορικές εξισώσεις του συστήματος, όπως προκύπτουν από το
	μηχανικό και το ηλεκτρικό κομμάτι του, είναι αντίστοιχα:
	\begin{gather*}
		\ddot x = g - \frac{k}{m}\frac{i^2}{x} \\
		L\od{i}{t} + Ri = v
	\end{gather*}
	όπου θεωρήσαμε ότι ο πυρήνας του ηλεκτρομαγνήτη δεν εισέρχεται σε
	κορεσμό.

	Με λίγες πράξεις, οι διαφορικές εξισώσεις του συστήματος γίνονται:
	\begin{gather}
		\ddot x = g -\frac{k}{m}\frac{i^2}{x}
		\label{eq:sec4ex2a} \\
		\od{i}{t} + \frac{R}{L}i = \frac{1}{L} v
		\label{eq:sec4ex2b}
	\end{gather}

	Όπως και στα προηγούμενα προβλήματα, πρώτα πρέπει να βρούμε τις
	μεταβλητές και τις εξισώσεις κατάστασης. Έχουμε σύστημα \textbf{3\textsuperscript{ης} τάξης} (1 ΔΕ 2\textsuperscript{ης} τάξης, 1 ΔΕ 1\textsuperscript{ης} τάξης, \( 2+1=3 \)), άρα
	χρειαζόμαστε \( n=3 \) μεταβλητές κατάστασης. Σύμφωνα με τη θεωρία,
	\todo{which theory?} τις επιλέγουμε ως εξής:
	\[
	x_1=x,\qquad x_2=\dot x,\qquad x_3 = i
	\]

	Τότε, με μερικές πράξεις από τις \eqref{eq:sec4ex2a}, \eqref{eq:sec4ex2b}	, οι μεταβλητές κατάστασης θα αποκτήσουν
	τη μορφή:
	\begin{align}
		\dot x_1 &= x_2 \\
		\dot x_2 &= g - \frac{k}{m}\frac{x_3^2}{x_1}
		\label{eq:sec4ex2x2d}
		\\
		\dot x_3 &= -\frac{R}{L} x_3 + \frac{1}{L}u
	\end{align}
	και η είσοδος είναι η τάση, δηλαδή:
	\[
	u = v
	\]

	\todo{g nonlinear?}
    Το σύστημα αυτό είναι μη γραμμικό, λόγω του όρου \( x_3^2 \) που
    εμφανίζεται στην εξίσωση \( \dot x_2 \). Επομένως, προς
    διευκόλυνσή μας, θα γραμμικοποιήσουμε το σύστημα γύρω από το
    σημείο ισορροπίας του.

    Αν και μπορούμε να βρούμε διάφορα σημεία ισορροπίας για το σύστημα,
    \todo{check if many points} θα μελετήσουμε αυτό που αφορά το
    \( \dot x = x_2^* = 0 \), δηλαδή θέλουμε η \textbf{ταχύτητα} της
    μάζας όταν ισορροπεί να είναι \textbf{μηδενική}.

    Θεωρώντας λοιπόν ότι \( x_2^* = 0 \), για τις υπόλοιπες
    συνιστώσες του σημείου ισορροπίας έχουμε:
    \begin{align*}
    	x_2^* &= 0 \\
    	    	\eqref{eq:sec4ex2x2d} \implies x_3^* &= \sqrt{\frac{mg}{k}x_1^*}\\
    	    	x_1^* & \in \mathbb R\\
    	u^* &= R\sqrt{\frac{mg}{k}x_1^*}
    \end{align*}

    Εφαρμόζουμε τη διαδικασία του κεφαλαίου \ref{sec:linear_linearization_point}, και αλλάζουμε τις μεταβλητές:
    \begin{align*}
    	z_1 &= x_1 - x_1^* \\
    	z_2 &= x_2 - x_2^* = x_2 \\
    	z_3 &= x_3 - x_3^*
    	= x_3 - \sqrt{\frac{mg}{k}x_1^*}\\
    	\tilde u &= u - u^* = u-R\sqrt{\frac{mg}{k}x_1^*}
    \end{align*}

    Επομένως, αντικαθιστώντας τις παραπάνω σχέσεις, έχουμε:
    \begin{align*}
    	\dot z_1 &= z_2\\
    	\dot z_2 &= g -\frac{k}{m}\frac{\left(z_3+\sqrt{\frac{mg}{k}x_1^*}\right)^2}{z_1+x_1^*} \\
    	\dot z_3 &= -\frac{R}{L}\left(z_3+\sqrt{\frac{mg}{k}x_1^*}\right)
    	+ \frac{1}{L}\left(\tilde{u} + R\sqrt{\frac{mg}{k}x_1^*}\right)
    \end{align*}

    Ήρθε η ώρα να γραμμικοποιήσουμε το σύστημα, έτσι ώστε να φτάσει στην
    επιθυμητή μορφή:
    \begin{align*}
    	\dot z &= Az + B\tilde u\\
    	y &= Cz + \cancelto{0}{D\tilde u}
    \end{align*}
    και υπολογίζουμε τους πίνακες \( A,B,C,D \):
    \begin{alignat*}{2}
    	A &= \left. \pd{F}{z} \right|_{(0,0)} = \left[\begin{matrix}
    	0 & 1 & 0 \\
    	\sfrac{g}{x_1^*}  & 0 & -2\sqrt{\frac{kg}{mx_1^*}} \\
    	0 & 0 & -\frac{R}{L}
    	\end{matrix}\right],
    	\qquad
    	B &= \left. \pd{F}{\tilde u} \right|_{(0,0)} = \left[\begin{matrix}
    	0 \\ 0 \\ \sfrac{1}{L}
    	\end{matrix}\right]\\
    	C &= \left[\begin{matrix}
    	1 & 0 & 0
    	\end{matrix}\right]
    \end{alignat*}
    \todo{Check A,B,C}

    Εφ' όσον \( x_1^* = x^* \) που είναι η συνιστώσα του σημείου ισορροπίας
    που δίνεται από την εκφώνηση, την διατηρούμε στις εξισώσεις του
    συστήματος.

    Μένει μόνο η υλοποίηση του ελεγκτή. Αυτό δεν θα το αναλύσουμε ακόμα,
    αλλά σε επόμενο κεφάλαιο.
\end{exercise}

\begin{exercise}[Ποδήλατο]
	Σε μια προηγούμενη άσκηση με το ποδήλατο, \todo{Add reference}\todo{Explain u,a,theta} είχαμε
	βρει τις παρακάτω σχέσεις: \[
	\left[\begin{matrix}
	\dot x \\ \dot y \\ \dot \theta
	\end{matrix}\right] = \left[\begin{matrix}
	u\cos\left(a(δ)+\theta\right) \\
	u\sin\left(a(δ)+\theta\right) \\
	\frac{u_0}{b}\tan δ
	\end{matrix}\right]
	\]

	Αν θεωρήσουμε ότι δεν θέλουμε να στρίβει το ποδήλατο, να γραμμικοποιηθεί
	το σύστημα.

	\tcblower

	Το ότι δεν θέλουμε το ποδήλατο να στρίβει, σημαίνει πως η γωνιακή
	του ταχύτητα είναι 0, δηλαδή:
	\[
	\dot{\theta} = 0 \implies \delta = 0
	\]

	Για γραμμικοποίηση γύρω από το σημείο ισορροπίας, πρέπει πρώτα
	να βρούμε το σημείο ισορροπίας του προβλήματος. Οι εξισώσεις του,
	θεωρώντας ότι \( \delta = 0\) και \(\dot{\theta} = 0 \), είναι:
    \[
    \left[\begin{matrix}
    \dot x \\ \dot y
    \end{matrix}\right] = \left[\begin{matrix}
    u\cos\theta \\ u\sin\theta
    \end{matrix}\right]
    \]
    ή, για το σημείο ισορροπίας, θα πρέπει να λύσουμε το σύστημα:
    \begin{align*}
    	u\cos(\theta) = 0\\
    	u\sin(\theta) = 0
    \end{align*}

    Υψώνοντας στο τετράγωνο και προσθέτοντας τις εξισώσεις, έχουμε:
    \[
    u^2\underbrace{\left(\cos^2(\theta) + \sin^2(\theta)\right)}_{1} = 0
    \]

    Για να ισχύει το παραπάνω, απαιτείται \( u=0 \), κάτι που δεν έχει
    νόημα επειδή δηλώνει μηδενική ταχύτητα ποδηλάτου, δηλαδή ότι δεν
    υπάρχει κίνηση στο ποδήλατο.

    Επομένως δεν μπορούμε να γραμμικοποιήσουμε το σύστημα αυτό γύρω από το
    σημείο ισορροπίας.
\end{exercise}

Η μέθοδος γραμμικοποίησης γύρω από σημείο ισορροπίας ισχύει, όπως δείξαμε,
μόνο για μια περιοχή κοντά σε αυτό. Αν όμως υπάρξει μια διαταραχή σε αυτό,
και μετακινηθούμε αρκετά μακριά από αυτήν την περιοχή, η μελέτη
που κάναμε θα πάψει να ισχύει.

\subsubsection{Γραμμικοποίηση μέσω ανάδρασης}
Η ιδέα της γραμμικοποίησης μέσω ανάδρασης είναι να επιλέξουμε έναν
περίεργο ελεγκτή, ο οποίος αν είναι κατάλληλος, θα καταστήσει γραμμικό
το υπό μελέτη σύστημα.

\begin{exercise}[Παράδειγμα]
	\label{sec4ex3}
	Να γραμμικοποιηθεί το σύστημα:
	\begin{align*}
		\dot x &= x^2 -2x + (1+x^2)u \numberthis
		\label{eq:sec4ex3xd}
		\\
		y &= x
	\end{align*}

	Θέλουμε να συγκλίνει στο 0, εκθετικά με ρυθμό 5.
	\tcblower
	Εδώ θα σχεδιάσουμε έναν ελεγκτή \( u \), ο οποίος να καθιστά το σύστημα
	γραμμικό.

	Παρατηρούμε την εξίσωση \eqref{eq:sec4ex3xd} του \( \dot x \). Σκεφτόμαστε να διαιρέσουμε με τον όρο \( (1+x^2) \), ώστε να
	φύγει ο \textit{μη γραμμικός συντελεστής του \( u \)}.

	Επίσης αφαιρούμε το \( x^2 \) και το \( -2x \), για να το απλοποιήσουμε
	ακόμα περισσότερο. Προσθέτουμε και έναν δικό μας όρο \( v \) για να μπορούμε
	να επηρεάσουμε όπως θέλουμε τη συμπεριφορά του.

	Δηλαδή ο ελεγκτής \( u \) έχει γίνει:
	\[
	u = \frac{1}{1+x^2} \left( -x^2+2x+v \right)
	\]

	και τότε η εξίσωση \eqref{eq:sec4ex3xd} του συστήματος παίρνει τη
	μορφή:
	\[
	\dot x = v
	\]
	δηλαδή, το σύστημά μας έγινε γραμμικό!\footnote{Αφού \( \dot x = Ax+Bu \)}

	\paragraph{}
	Για να ικανοποιήσουμε και την απαίτηση του εκθετικού ρυθμού μείωσης
	5, θεωρούμε ότι:
	\[
	v = -5x
	\]
	οπότε η εξίσωση \eqref{eq:sec4ex3xd} του συστήματος γίνεται:
	\[
	\dot x = -5x
	\]
	που έχει λύση:
	\[
	x(t) e^{-5t} x(0)
	\]
	η οποία έχει το ζητούμενο ρυθμό.
\end{exercise}

Η παραπάνω μέθοδος μπορεί να χρησιμοποιηθεί χωρίς να απαιτείται γνώση
ή ύπαρξη του σημείου ισορροπίας, και ισχύει παντού, όχι μόνο σε μία περιοχή.

Όμως, για την εφαρμογή της, πρέπει να φροντίζουμε ώστε ο όρος με
τον οποίο διαιρούμε \textbf{να μην γίνεται αρνητικός}! Σε διαφορετική
περίπτωση, λόγω απειρισμού, η θεώρησή μας δεν θα μπορεί να ισχύει.

Ο \( u \) ονομάζεται \textbf{ελεγκτής γραμμικοποίησης}, και μπορεί να
χρησιμοποιηθεί ώστε να κάνουμε ένα εν γένει μη γραμμικό σύστημα να
\textbf{φαίνεται} γραμμικό, και να μπορούμε να το ελέγξουμε όπως επιθυμούμε:
\todo{Graph 26}

Υπάρχουν ακόμα μερικά πρακτικά σημεία στα οποία χρειάζεται προσοχή. Για παράδειγμα, στην άσκηση \ref{sec4ex3} αφαιρέσαμε τον όρο \( -2x \) για απλοποίηση
των πράξεων. Αν όμως δεν τον αφαιρούσαμε, τότε ήταν \( \dot x = -2x+u \)
και \( u=-3x \), δηλαδή ο ελεγκτής γραμμικοποίησης θα απαιτούσε λιγότερη
ενέργεια για την πρακτική υλοποίησή του.

Επιπλέον, αν είχαμε κάνει λάθος στη μοντελοποίηση, και βρίσκαμε έναν
όρο π.χ. \( x^2 \) αντί για \( 2x^2 \), θα σχεδιάζαμε λάθος
ελεγκτή \( u \), και η γραμμικοποίηση δεν θα ίσχυε αρκετά καλά. Βέβαια,
υπάρχει περίπτωση το σφάλμα αυτό να θεωρηθεί από τον γραμμικό
ελεγκτή που θα βάλουμε αργότερα ως διαταραχή, και να είναι αρκετά
μικρό να μην προκαλέσει σημαντικό πρόβλημα.

\begin{exercise}
	Έστω το σύστημα:
	\[
	M(q)\ddot q +C(q,\dot q)\dot q + G(q) = u
	\]
	όπου το \( q \) είναι ένας πίνακας:
	\[
	q \in \mathbb R^n
	\]
	και \( M(q) \) ένας πίνακας που εξαρτάται από το \( q \), \textbf{θετικά ορισμένος}:
	\[
	M(q) \in \mathbb R^n
	\]
	και \( C(q,\dot q) \) ένας πίνακας που εξαρτάται από τα \( q \) και
	\( \dot q \), και \( G(q) \) ένας πίνακας που εξαρτάται από το \( q \).

	Να σχεδιαστεί \( u \) που να γραμμικοποιεί το σύστημα.

	\tcblower
	\textbf{Επιλέγω} έναν ελεγκτή \( \textbf{u} \), που εξαρτάται
	\textbf{μόνο από γνωστά μεγέθη}\footnote{Αν δινόταν πως ένας πίνακας
		\textbf{δεν} είναι γνωστός, τότε \textbf{δεν} θα μπορούσαμε
		να τον χρησιμοποιήσουμε, επειδή δεν θα γνωρίζαμε τα μεγέθη
		αυτού του πίνακα!}:
	\[
	u = C(q,\dot q)\dot q + G(q) + M(q) v
	\]

	Επομένως, το σύστημά μας γίνεται:
	\[
	M(q)\ddot q = M(q) v
	\]

	Το σύστημα αυτό δεν είναι γραμμικό. Όμως, επειδη ο \( M(q) \) είναι
	\textbf{θετικά ορισμένος}, το παραπάνω σύστημα είναι ισοδύναμο με το:
	\[
	\ddot q = u
	\]
	που είναι γραμμικό.
\end{exercise}
\begin{exercise}[Παρόμοια με την παραπάνω, αλλά με μία μεταβλητή κατάστασης]
		Έστω το σύστημα:
		\[
		M(q)\ddot q +f(q,\dot q)\dot q + k(q) = u
		\]
		όπου \( q,\ M(q),\ f(q,\dot q),\ k(q) \in \mathbb R \), και \( M(q) > 0 \).

		Ζητείται να διαμορφωθεί ώστε να εκφράζει ακριβώς ένα σύστημα ελατηρίου και αποσβεστήρα, με μοναδιαία μάζα.

		\begin{circuitikz}[scale=.9]

			\fill[postaction={decorate},pattern=north east lines] (0,3) rectangle (-0.5,-0.5) rectangle (5,0);

			\draw (2,0) rectangle ++(2,2) node[midway] {$m=1$} node[midway] (m2) {};

			\draw (2,0.4) to[damper,l_=$b$,invert] ++(-2,0);
			\draw (2,1.6) to[spring,invert,l_=\raisebox{-1.5ex}{$k_0$}] ++(-2,0);

			\draw[thick,->] (4,1) -- ++(1.5,0) node[right] {$F$};

			\draw[thick] (0,3) |- (5,0);

			\draw[->] (m2) ++ (0,1.4) |- ++(2,0.7) node[above,pos=.75,gray] {$q$};
		\end{circuitikz}


		Η επιτάχυνση \( \ddot q \) δεν θεωρείται γνωστή, ενώ η
		ταχύτητα \( \dot q \) θεωρίεται γνωστή, επειδή υποτίθεται πως
		έχω όργανο για να την μετρήσω.

		\tcblower
		Για το σύστημα μάζας-ελατηρίου ισχύει, από προηγούμενες
		ασκήσεις:
		\begin{equation}
		\ddot q = F-b\dot q - k_0 q
		\label{eq:sec4ex4qdd}
		\end{equation}
		ή, ισοδύναμα:
		\[
		\ddot q + b\dot q+ k_0 q = F
		\]

		Γραμμικοποιούμε ακόμα το αρχικό σύστημα, επιλέγοντας έναν
		ελεγκτή \( u \), όπως στην αμέσως προηγούμενη άσκηση: \todo{add ref to exerise}
		\[
		u = f(q,\dot q)\dot q + k(q) + M(q) v
		\]
		και, για να καταστήσουμε ισοδύναμα τα δύο συστήματα, υποθέτουμε
		ότι \( v=\ddot q \) (σύμφωνα με την παραπάνω άσκηση), άρα, σύμφωνα
		με την \eqref{eq:sec4ex4qdd}, παίρνουμε:
		\[
		v = F-b\dot q - k_0 q.
		\]
\end{exercise}

\lecture{11}{18/4/2018}

\section{Ελεγξιμότητα}
Θα ασχοληθούμε με το \textbf{σχεδιασμό ελεγκτών} σε \textbf{γραμμικά} συστήματα:
\begin{align*}
	\dot x &= Ax + Bu \\
	y &= Cx + Du
\end{align*}

Τα συστήματα αυτά μπορεί συχνά να προκύπτουν από γραμμικοποίηση, όπως
είδαμε στο προηγούμενο κεφάλαιο. Σκοπός μας εδώ είναι να υλοποιήσουμε
έναν ελεγκτή \( u \), ο οποίος θα καθιστά το σύστημα να ικανοποιεί
κάποιες συνθήκες που ζητούνται. Βέβαια θα απαιτείται η γνώση του πλήρους
διανύσματος κατάστασης \( x \) και όλων των επιμέρους μεταβλητών του.

Δεν είναι πάντα σίγουρο όμως ότι ο σχεδιασμός ενός τέτοιου ελεγκτή είναι
εφικτός. Η δυνατότητα σχεδίασης του ελεγκτή αυτού εκφράζεται από
την έννοια της \textbf{ελεγξιμότητας}, η οποία εκφράζει πως από μια
αρχική τιμή \( x_0 \) μπορούμε να φτάσουμε σε \textit{πεπερασμένο}
χρόνο σε μια τελική τιμή \( x_T \) χρησιμοποιώντας έναν ελεγκτή
\( u \):\[
x_0 \xrightarrow{\quad u \quad} x^T
\]

Επειδή όμως ο ορισμός αυτός δεν είναι εύκολο να χρησιμοποιηθεί, θα προσπαθήσουμε
να βρούμε ένα \textbf{κριτήριο ελεγξιμότητας}.

Αρχικά, θεωρούμε ότι η αρχική τιμή είναι \( 0 \). Επομένως, αφού έχουμε
μηδενική αρχική τιμή, οι μεταβλητές κατάστασης του συστήματος
(με \( x \in \mathbb R^n \)) θα βρίσκονται
από τον τύπο:
\[
x(t) = \int_{0}^{t} e^{A(t-\tau)}Bu(\tau)\dif τ
= \int_{0}^{t} e^{Aτ}Bu(t-τ)\dif τ
\]

Χρησιμοποιούμε ένα θεώρημα σύμφωνα με το οποίο:
\[
e^{Aτ} = c_0(t) I + c_1(t) A + c_2(t)A^2
+\dots + c_{n-1}(t)A^{n-1}
\]

Επομένως, αντικαθιστώντας στον παραπάνω τύπο:
\begin{align*}
x(t) &= \int_{0}^{t} c_0(τ) Bu(t-τ)\dif τ
+ \int_{0}^{t} c_1(t) A B u(t-τ)\dif τ
+ \dots + \int_{0}^{t} c_{n-1}(τ) A^{n-1}Bu(t-τ)\dif τ
\\ &= B\left[
\int_{0}^{t} c_0(τ) u(t)-\tau
\right] + AB\left[
\int_{0}^{t} c_1(τ) u(t-τ)\dif τ
\right] + \dots + A^{n-1}B \left[\int_{0}^{t}
c_{n-1}(τ)u(t-τ)\dif τ
\right]
\end{align*}

Ονομάζουμε το κάθε ένα από τα παραπάνω ολοκληρώματα \( \phi_i(t) \):
\[
\phi_i(t) = \int_{0}^{t} c_i(τ)u(t-τ)\dif τ,\quad
i=0,\dots,n-1
\]
και έναν πίνακα \( M \) που εκφράζει τους συντελεστές των \( \phi_i(t) \):
\[
M = \left[ \begin{matrix}
B & AB & \dots & A^{n-1}B
\end{matrix} \right]
\]

Επειδή οι παραπάνω τιμές πρέπει να είναι \textbf{γραμμικά ανεξάρτητες},
\todo{why?} έχουμε:
\[
\mathop{rank}(M) = n
\]
δηλαδή για την ορίζουσα του πίνακα:
\[
\boxed{\det(M) \neq 0}
\]

Το παραπάνω αποτελεί και το \textbf{κριτήριο ελεγξιμότητας}.

\begin{exercise}
	Δίνεται το σύστημα ενός DC κινητήρα. Στα τυλίγματά του υπάρχει
	αντίσταση \( R_a \) και αυτεπαγωγή \( L_a \). Στο δρομέα
	ασκείται ηλεκτρεγερτική δύναμη \( u_e \), και αυτός περιστρέφει
	φορτίο με ροπή αδράνειας \( I_L \), το οποίο βρίσκεται σε
	γωνία \( \theta \).

	\begin{circuitikz}[american]
		\ctikzset{voltage/american label distance=2}
		\draw (0,0) to[R=$R_a$] (2,0) to[L=$L_a$] (4,0) to[open,v^=$u_e$]
		(4,-2) -- (0,-2) to[open,v^>=$u_a$,*-*] (0,0);
		\draw (4,-1) node[elmech](motor) {};
		\draw (motor.north) -- (4,0) (motor.south) -- (4,-2);
	\end{circuitikz}

	\todo{Graph 28}

	Επίσης πραγματοποιούμε τις παρακάτω παραδοχές:
	\begin{align*}
		u_e &= k_b\dot{\theta} \\
		T_k &= k_i i_a
	\end{align*}
	όπου \( T_k \) η ροπή του κινητήρα.

	Θεωρούμε επίσης ότι δεν ασχολούμαστε με τον στάτη, ο οποίος έχει
	σταθερό ρεύμα και τάση.

	Να μελετηθεί η ελεγξιμότητα του συστήματος.

	\tcblower

	Από τις εξισώσεις του κυκλώματος και αυτές που δίνονται έχουμε:
	\[
	u_a = i_a R_a + L_a \od{i_a}{t} + k_b\dot{\theta}
	\]
	και από την εξίσωση κίνησης του φορτίου \( I_L\ddot{\theta}
	= T_k
	\):
	\[
	I_L\ddot{\theta} = k_i i_a
	\]

	Η είσοδος ελέγχου είναι η τάση \( u_a = u \).

	Η τάξη του συστήματος είναι \( n=3 \), και επιλέγουμε ως μεταβλητές
	κατάστασης τις:
	\[
	x_1 = \theta,\ x_2=\dot{\theta},\ x_3 = i_a
	\]
	και τότε οι εξισώσεις κατάστασης του συστήματος γίνονται:
	\begin{align*}
		\dot x_1 &= x_2 \\
		\dot x_2 &= \frac{k_i}{I_L} x_3 \\
		\dot x_3 &= -\frac{R_a}{L_a}x_3 - \frac{k_b}{L_a}x_2 + \frac{1}{L_a}u
	\end{align*}
	ή, σε μορφή πίνακα:
	\[
	\dot x = \underbrace{\left[\begin{matrix}
	0 & 1 & 0\\
	0 & 0 & \frac{k_i}{I_L} \\
	0 & \frac{-k_b}{L_a} & \frac{-R_a}{L_a}
	\end{matrix}\right]}_{A} x + \underbrace{\left[\begin{matrix}
	0 \\ 0 \\ \sfrac{1}{L_a}
	\end{matrix}\right]}_{B}u
	\]

	Ο \textbf{πίνακας ελεγξιμότητας είναι}:
	\[
	M = \left[\begin{matrix}
	B & AB & A^{2}B
	\end{matrix}\right] = \dots = \left[\begin{matrix}
	0 & 0 & \frac{k_i}{I_L L_a} \\
	0 & \frac{k_i}{I_L L_a} & -\frac{k_iR_a}{I_L L_a} \\
	\frac{1}{L_a}  & - \frac{R_a}{L_a^2} & \frac{R_a^2 I_L - k_bk_i L_a}{I_L L_a^3}
	\end{matrix}\right]
	\]
	για τον οποίο έχουμε:\[
	\det(M) = -\frac{1}{L_a} \left( \frac{k_i}{I_L L_a} \right)^2
	\neq 0
	\]
	επομένως το σύστημα είναι ελέγξιμο.
\end{exercise}
\begin{exercise}
	Να μελετηθεί η ελεγξιμότητα του συστήματος.


	\begin{circuitikz}[american]
		\draw (0,0) to[V=$u(t)$,invert] (0,3) -- ++(4,0);
		\draw (2,3) to[R=$R_1$] (2,1.5) to[C=$C_1$] (2,0) -- (0,0);
		\draw (4,3) to[R=$R_2$, i=$i_2$] (4,1.5) to[C=$C_2$] (4,0) -- (2,0);
	\end{circuitikz}

	\tcblower
	Από νόμους Kirchoff έχουμε:
	\begin{align*}
		u(t) &= i_1R_1 + \frac{1}{C_1} \int_{0}^{t} i_1(τ)\dif τ\\
		u(t) &= i_2R_2 + \frac{1}{C_2} \int_{0}^{t} i_2(τ)\dif τ
	\end{align*}

	Ως μεταβλητές κατάστασης ορίζουμε τις τάσεις των πυκνωτών:
	\begin{align*}
		x_1 &= \frac{1}{C_1} \int_{0}^{t} i_1(τ)\dif τ\\
		x_2 &= \frac{1}{C_2} \int_{0}^{t} i_2(τ)\dif τ
	\end{align*}

	Οπότε, από τις αρχικές εξισώσεις θα έχουμε:
	\begin{align*}
		u(t) &= i_1R_1 + x_1 \implies i_1 = \frac{u-x_1}{R_1} \\
		u(t) &= i_2R_2 + x_2 \implies i_2 = \frac{u-x_2}{R_2}
	\end{align*}

	Και τελικά:
	\begin{align*}
		\dot x_1 &= \frac{1}{C_1}i_1
		\implies \dot x_1 = \frac{u-x_1}{C_1R_1}
		= \frac{-1}{R_1C_1} x_1 + \frac{1}{R_1C_1}u\\
		\dot x_2 &= \frac{1}{C_2}i_2
		\implies \dot x_2 = \frac{u-x_2}{R_2C_2} = \frac{-1}{R_2C_2}x_2
		+\frac{1}{R_2C_2}u
	\end{align*}
	ή, σε μορφή πίνακα:
	\[
	\dot x = \left[\begin{matrix}
	-\frac{1}{R_1C_1} &0 \\ 0 & -\frac{1}{R_2C_2}
	\end{matrix}\right] + u\left[\begin{matrix}
	\frac{1}{R_1C_1} \\ \frac{1}{R_2C_2}
	\end{matrix}\right]
	\]

	Για τον πίνακα ελεγξιμότητας και την ορίζουσά του έχουμε:
	\begin{align*}
	M &= \left[\begin{matrix}
	B & AB
	\end{matrix}\right] = \left[\begin{matrix}
	\frac{1}{R_1C_1} & -\left(\frac{1}{R_1C_1}\right)^2\\
	\frac{1}{R_2C_2} & -\left(\frac{1}{R_2C_2}\right)^2
	\end{matrix}\right]\\
	\det(M) &= \frac{1}{R_1C_1}\frac{1}{R_2C_2}\left(
	\frac{1}{R_1C_1}-\frac{1}{R_2C_2}
	\right)
	\end{align*}

	Το σύστημα είναι ελέγξιμο για όλες τις τιμές \( RC \), εκτός από
	αυτές για τις οποίες ισχύει \( R_1C_1 = R_2C_2 \) (οι δύο κλάδοι
	δηλαδή έχουν την ίδια \textbf{σταθερά χρόνου}). Πρακτικά, δεν μπορούμε
	να εφαρμόσουμε διαφορετική τάση στους πυκνωτές ανάλογα με την είσοδο,
	αν συμβεί αυτό.
\end{exercise}

Γενικότερα, όταν συνδέουμε συστήματα παράλληλα, πρέπει να ελέγχουμε για
την ελεγξιμότητα.

\begin{exercise}
	\begin{circuitikz}
		\draw (0,0) to [twoport,t=$S_2$,>] node[pos=1,above] {$x_2$} (2,0)
		to[twoport,t=$-1$,>] (4,0) node[midway] {}
		to[twoport,t=$S_1$,>] (6,0) node[above] {$x_1$} to[short,i=$ $] ++(1,0)
		;
	\end{circuitikz}

	Δίνεται ένα σύστημα εν σειρά:
	\begin{alignat*}{2}
		s_1 &:\ \dot x_1=-x_2 \quad && x_1(0) = 0\\
		s_2 &:\ \dot x_2= u   \quad && x_2(0) = 0
	\end{alignat*}
	και \( u = 0 \) για \( t < 0 \).

	Έστω ότι τη στιγμή \( t=0 \) εμφανίζεται μία αποσβεννύμενη διαταραχή
	στην είσοδο.

	Να εξεταστεί αν το σύστημα είναι ελέγξιμο.

	\tcblower
	Αφού εμφανίζεται \textbf{αποσβεννύμενη} εξωτερική διαταραχή, αυτή
	σβήνει εκθετικά, δηλαδή:
	\[
	u(t) = e^{-t},\quad t \geq 0
	\]

	Οι εξισώσεις κατάστασης του συστήματος γίνονται:
	\begin{align*}
		\dot x = \left[\begin{matrix}
		0 & -1 \\ 0 & 0
		\end{matrix}\right]x + \left[\begin{matrix}
		0 \\ 1
		\end{matrix}\right]u
	\end{align*}

	και για τον \( M \):
	\begin{align*}
    	n &= 2 \\
		M &= \left[\begin{matrix}
		B & AB
		\end{matrix}\right] = \left[\begin{matrix}
		0 & -1 \\ 1 & 0
		\end{matrix}\right] \\
		\det(M) &=1 \neq 0 \\
		\mathop{rank}(M) &= 2 = n
	\end{align*}

	Βέβαια, ενώ αποδείξαμε ότι το σύστημα είναι ελέγξιμο, δεν βρήκαμε
	ακόμα τον κατάλληλο ελεγκτή ώστε να γίνει αυτό.

	Οι εξισώσεις κατάστασης, για \( u(t) = e^{-t} \), γίνονται:
	\begin{align*}
		x_2(t) &= \int_{0}^{t} e^{-τ}\dif t = 1-e^{-t},\
		t \geq 0\\
		x_1(t) &= -\int_{0}^{t}x_2(τ) \dif τ
		= -\int_{0}^{t}(1-e^{-τ})\dif τ = 1-e^{-t}-t,\
		t \geq 0
	\end{align*}

	\todo{Το συστημα δεν είναι ευσταθές.}
\end{exercise}

Δεν πρέπει βέβαια να μπερδεύουμε τους όρους της \textbf{ελεγξιμότητας}
και της \textbf{σταθερότητας}. Για παράδειγμα, το σύστημα
\( \dot x = x \) είναι ευσταθές αλλά και μη ελέγξιμο (αφού δεν περιέχει
σταθερά \( u \)). Όμως το σύστημα \( \dot x = -x + u \) είναι ελέγξιμο,
αλλά και ασταθές. Όμως με κατάλληλη επιλογή του ελεγκτή \( u \) μπορεί
να γίνει και ευσταθές.

\paragraph{}
Πολλές φορές για συντομία θα αναφέρουμε ότι το ζεύγος \( (A,B) \) είναι
ελέγξιμο ή μη ελέγξιμο αν ισχύει ή όχι η συνθήκη ελεγξιμότητας στο αντίστοιχο
σύστημα.

\subsection{Για μη ελέγξιμα συστήματα}
Σε περίπτωση που μας τύχει μη ελέγξιμο σύστημα, θα μπορούμε, με κατάλληλη
\textbf{επιλογή μεταβλητών κατάστασης}, να το χωρίσουμε σε δύο
συστήματα, το ένα ελέγξιμο, και το άλλο μη ελέγξιμο.

\begin{theorem}{}{}
	Αν το ζεύγος \( (A,B) \) είναι \textbf{μη ελέγξιμο}, τότε
	υπάρχει ένας μη ιδιόμορφος πίνακας \( T \)
	για μετασχηματισμό των μεταβλητών κατάστασης
	για τον οποίο ισχύει:
	\begin{align*}
		\tilde A &= T^{-1}AT = \left[\begin{matrix}
		A_1 & A_{12} \\ 0 & A_{2}
		\end{matrix}\right] \\
		\tilde B &= T^{-1}B = \left[\begin{matrix}
		B_1 \\ 0
		\end{matrix}\right]
	\end{align*}
	όπου το ζεύγος \( (A_1,B_1) \) είναι ελέγξιμο.
\end{theorem}

Δεδομένου του παραπάνω μετασχηματισμού:
\[
x=Tz
\]
παραγωγίζουμε:
\begin{gather*}
	\dot x = T\dot z \implies \dot z = T^{-1}\dot x  \\\implies
	\dot z = T^{-1}(Ax+Bu)\\
	(T^{-1AT}z) + (T^{-1}Bv) \implies \\
	\boxed{\dot z = \tilde A z + \tilde Bu}
\end{gather*}
οπότε, σύμφωνα με το παραπάνω Θεώρημα:
\[
\dot z = \left[\begin{matrix}
A_1 & A_{12} \\ 0 & A_2
\end{matrix}\right]z + \left[\begin{matrix}
B_1 \\ 0
\end{matrix}\right]u
\]
ή, σε μορφή εξισώσεων:
\begin{align*}
	\dot z_1 &= \underbrace{(A_1z_1 + B_1 u)}_{\mathclap{\text{ελέγξιμο}}}
	+ \underbrace{A_{12}z_2}_{\mathclap{\text{"διαταραχές"}}} \\
    \dot z_2 &= A_2 z_2
\end{align*}

Το σύστημα \( \dot z_1 \) περιέχει ένα ελέγξιμο κομμάτι, και το \( A_{12}z_2 \) που προκύπτει άμεσα από το παρακάτω σύστημα, και παίζει το
ρόλο των διαταραχών. Επομένως είναι και ελέγξιμο.

Το σύστημα \( \dot z_2 \) όμως δεν είναι ελέγξιμο, αφού δεν περιέχει ελεγκτή εισόδου. Το αν το συνολικό σύστημα είναι ευσταθές ή όχι,
εξαρτάται από την ευστάθεια του πίνακα \( A_2 \). Αν οι ιδιοτιμές
του βρίσκονται στο αριστερό ημιεπίπεδο, τότε δεν προκαλεί αστάθεια. Αν όμως
βρίσκονται στο δεξί, δεν υπάρχει περίπτωση να την αποφύγουμε. Αυτό σημαίνει
πως ένα μη ελέγξιμο σύστημα μπορεί να είναι σταθεροποιήσιμο.

\paragraph{}
Για να βρούμε τον πίνακα \( T \), πρώτα βρίσκουμε τις \( n_c \) (σε πλήθος)
γραμμικά ανεξάρτητες στήλες του πίνακα ελεγξιμότητας \( M \):
\[
rank(M) = n_c < n
\]

Τις \( n_c \) αυτές στήλες τις τοποθετούμε στις πρώτες θέσεις του πίνακα
\( T \). Στις υπόλοιπες \( n-n_c \) στήλες τοποθετούμε γραμμικά ανεξάρτητες
από τις υπόλοιπες στήλες, έτσι ώστε \( \mathop{rank}(T) = n \).
\todo{Graph 31}

\subsection{\color{green!50!black!90!blue!50!white}Θέματα Προόδου 2018}

\lecture{12}{20/4/2018}
\begin{exercise}[1\textsuperscript{ο} Θέμα Προόδου 2018]
	Δίνεται το σύστημα:
	\[
	\left[
	\begin{matrix}
	\dot x_1 \\ \dot x_2
	\end{matrix}
	\right] = \left[\begin{matrix}
	-1 & 2 \\ 0 & 1
	\end{matrix}\right]\left[\begin{matrix}
	x_1 \\ x_2
	\end{matrix}\right] + \left[\begin{matrix}
	1 \\ 1
	\end{matrix}\right]u
	\]

	\begin{enumgreekparen}
		\item Να δειχθεί ότι είναι ασταθές, για μηδενική \( u \).
		\item Έστω ότι \( u=-k_1x_1-k_2x_2 \), όπου \( k_1>0,\ k_2>0 \).

		Ποιά συνθήκη πρέπει να ικανοποιούν τα \( k_1,k_2 \) ώστε το
		σύστημα κλειστού βρόχου να είναι ασυμπτωτικά ευσταθές;
		\item Στο σύστημα προστίθενται διαταραχές
		\( d \in \mathbb R \) με μέγιστο μέτρο
		\( \left|d(t)\right| \leq \bar d ,\ \forall t \geq 0 \) έτσι
		ώστε το σύστημα να γίνει, για ένα διάνυσμα \( \Gamma \):
		\[
		\left[
		\begin{matrix}
		\dot x_1 \\ \dot x_2
		\end{matrix}
		\right] = \left[\begin{matrix}
		-1 & 2 \\ 0 & 1
		\end{matrix}\right]\left[\begin{matrix}
		x_1 \\ x_2
		\end{matrix}\right] + \left[\begin{matrix}
		1 \\ 1
		\end{matrix}\right]u + Γd
		\]

		Χρησιμοποιώντας τον ελεγκτή του ερωτήματος \textit{(β)}, να
		επαληθεύσετε ότι το σύστημα του κλειστού βρόχου είναι ευσταθές.
	\end{enumgreekparen}

	\tcblower
	\begin{enumgreekparen}
		\item Ο πίνακας \( A = \left[\begin{matrix}
		-1 & 2 \\ 0 & 1
		\end{matrix}\right] \) είναι άνω τριγωνικός, άρα οι ιδιοτιμές
		του βρίσκονται στην κύρια διαγώνιο. Αυτές είναι \( -1 \) και
		\( 1 \), η μία εκ των οποίων είναι θετική, άρα το σύστημα είναι
		ασταθές.
		\item
		Το σύστημα γίνεται:
		\begin{align*}
			\dot x &= \left[\begin{matrix}
			-1 & 2 \\ 0 & 1
			\end{matrix}\right]x - \left[\begin{matrix}
			1 \\ 1
			\end{matrix}\right]\left[\begin{matrix}
			k_1 & k_2
			\end{matrix}\right]x
			\\ &= \underbrace{\left[\begin{matrix}
			-1-k_1 & 2-k_2 \\
			-k_1 & 1-k_2
			\end{matrix}\right]}_{\tilde A}x
		\end{align*}

		Πρέπει, για να έχουμε ευστάθεια, να ισχύει:
		\[
		\det(sI-\tilde A) = 0
		\]
		το οποίο, με μερικές πράξεις, καταλήγει στο:
		\[
		s^2 + (k_1+k_2)s + (k_1+k_2 -1) = 0
		\]

		Το πολυώνυμο είναι 2\textsuperscript{ου} βαθμού. Για να έχει
		ρίζες (άρα ιδιοτιμές του \( \tilde A \)) στο αριστερό ημιεπίπεδο,
		πρέπει οι συντελεστές να είναι ομόσημοι, δηλαδή:
		\begin{gather*}
			k_1 + k_2 > 0\\
			k_1+k_2 > 1
		\end{gather*}
		άρα τελικά, συμπεριλαμβανομένων των \( k_1>0,\ k_2>0 \) από
		την εκφώνηση (οι οποίες \textbf{έπρεπε να αναφερθούν}):
		\begin{gather*}
			k_1+k_2 > 1\\
			k_1 > 0\\
			k_2 > 0
		\end{gather*}
        \item Το σύστημα θα γίνει:
        \[
        \dot x = \tilde A x + Γd
        \]

        Επειδή ο πίνακας \( \tilde A \) έχει ιδιοτιμές στο αριστερό
        μιγαδικό ημιεπίπεδο (σύμφωνα με τα προηγούμενα), υπάρχει
        \textit{συμμετρικός} και \textit{θετικά ορισμένος} πίνακας
        \( P \), τέτοιος ώστε για δοσμένο \textit{συμμετρικό} και
        \textit{θετικά ορισμένο} πίνακα \( Q \), να λύνεται η εξίσωση:
        \[
        \tilde A^{\mathrm T} P + P\tilde A = -Q
        \]

        Ορίζουμε την \textit{υποψήφια} συνάρτηση Lyapunov:
        \[
        V = \frac{1}{2}x^{\mathrm T}Px
        \]
        που είναι θετικά ορισμένη, επειδή και ο \( P \) είναι θετικά
        ορισμένος.

        Παραγωγίζουμε την παραπάνω συνάρτηση ως προς τον χρόνο:
        \begin{align*}
        	\dot V &= \frac{1}{2} \dot x^{\mathrm T} P x
        	+ \frac{1}{2}x^{\mathrm T}P\dot x\\
        	&= \frac{1}{2}\left(
        	x^{\mathrm T}\tilde A^{\mathrm T} + Γ^{\mathrm T}d
        	\right)Px + \frac{1}{2}x^{\mathrm T}P(\tilde Ax+Γd)
        	\\ &= \frac{1}{2}x^{\mathrm T}\left(
        	\tilde A^{\mathrm T} P + P\tilde A
        	\right)x + \frac{1}{2}d\Gamma^{\mathrm T} P x
        	+ \frac{1}{2}x^{\mathrm T} P Γd
        	\\ &=
        	\underbrace{-\frac{1}{2}x^{\mathrm T} Q x}
        	+ x^{\mathrm T}PΓd
        	\\ &\leq -\frac{1}{2}λ_{\min}(Q)|x^2|
        	+ |x| \left\lVert P \right\rVert |Γ||d|
        	\intertext{όπου $λ_{\min}(Q)$ η ελάχιστη ιδιοτιμή του $Q$}
        	&\leq -\frac{1}{2}λ_{\min}(Q)|x^2|
        	+ |x| \left\lVert P \right\rVert |Γ|\bar d
        	\\ &= -|x|\left[\frac{1}{2}
        	\lambda_{\min}(Q) |x| - \left\lVert P \right\rVert |Γ|\bar d
        	\right]
        \end{align*}
        άρα τελικά, η απαίτηση για να έχουμε αρνητική παράγωγο
        είναι:
        \[
        |x| > \frac{\lVert P \rVert |Γ| \bar d}{\frac{1}{2} λ_{\min}(Q)}
        \]
        και το \( x \) συγκλίνει, μετά από κάποιον πεπερασμένο
        χρόνο, στη ζώνη:
        \[
        \Chi \overset{\triangle}{=} \left\lbrace
        x \in \mathbb R^2 : |x| \leq \frac{\lVert P \rVert |Γ|\bar d}{\frac{1}{2} λ_{\min}(Q)}
         \right\rbrace
        \]
        δηλαδή η λύση είναι \textit{ομοιόμορφα τελικώς φραγμένη}.

        \textbf{Προσοχή!} Το σύστημα αυτό δεν είναι απαραίτητα
        \textit{ευσταθές κατά Lyapunov}, αφού δεν έχουμε αποδείξει
        πως ικανοποιεί τον ορισμό όπως τον δώσαμε. Για ένα \( \varepsilon  \) μικρότερο από το όριο του \( x \) που δηλώσαμε παραπάνω,
        δεν έχουμε εγγυηθεί ότι δεν θα ξεφύγουμε από το \( \varepsilon \).
        Όμως ικανοποιείται ο ορισμός της ευστάθειας, σύμφωνα με τον
        οποίο για φραγμένη είσοδο, έχουμε φραγμένη έξοδο.
	\end{enumgreekparen}
\end{exercise}

\begin{exercise}[2\textsuperscript{ο} θέμα προόδου 2018]
	Δίνεται το σύστημα:
	\[
	\left[\begin{matrix}
	\dot x_1 \\ \dot x_2
	\end{matrix}\right] = \left[\begin{matrix}
	x_1^2 -2x_1x_2 -x_2 \\ x_2^4
	\end{matrix}\right] + \left[\begin{matrix}
	1 & x_1^2 \\ 0 & 1-\frac{1}{2}\sin x_2
	\end{matrix}\right]\left[\begin{matrix}
	u_1 \\ u_2
	\end{matrix}\right]
	\]
	όπου τα \( x_1,x_2 \) είναι μετρήσιμα, \( u_1,u_2 \) εξωτερικές
	είσοδοι ελέγχου. Ζητείται να σχεδιαστεί ελεγκτής τέτοιος ώστε το
	σύστημα κλειστού βρόχου που προκύπτει να εμφανίζεται ως προς εξωτερική
	είσοδο ελέγχου \( \upsilon \in \mathbb R \) γραμμικό και χρονικά
	αμετάβλητο.
	\tcblower
	Σκοπός μας είναι ουσιαστικά να σχεδιάσουμε έναν ελεγκτή γραμμικοποίησης.

	\todo{Graph 31}

	Ορίζουμε ότι ο συντελεστής των \( u \) είναι
	\( G(x) = 	\left[\begin{matrix}
	1 & x_1^2 \\ 0 & 1-\frac{1}{2}\sin x_2
	\end{matrix}\right] \).

	Βρίσκουμε τον αντίστροφο του συντελεστή της εισόδου (ο αντίστροφος
	υπάρχει, αφού η ορίζουσα είναι θετική, καθώς οι όροι της διαγωνίου
	είναι θετικοί):
	\[
	\left[\begin{matrix}
	1 & x_1^2 \\ 0 & 1-\frac{1}{2}\sin x_2
	\end{matrix}\right]^{-1} =
	\frac{1}{1-\frac{1}{2}\sin x_2}\left[\begin{matrix}
	1-\frac{1}{2}\sin x_2 & -x_1^2 \\ 0 & 1
	\end{matrix}\right]
	\]

	Σκοπός μας είναι να βρούμε έναν πίνακα που θα διώχνει τις
	μη γραμμικότητες \( x_1^2 \), \( -2x_1x_2 \) και \( x_2^4 \) από
	τον πίνακα των \( \dot x \).

	Χωρίς την είσοδο \( u \), το σύστημά μας έχει ουσιαστικά τη μορφή:
	\[
	f(x) = \underbrace{\left[
	\begin{matrix}
	x_1^2 - 2x_1x_2 \\ x_2^4
	\end{matrix}
	\right]}_{f_0(x)}
    + \underbrace{\left[\begin{matrix}
    0 & -1 \\ 0 & 0
    \end{matrix}\right]}_{A_0}x
	\]

	Σκοπός μας είναι να εξαλείψουμε τις γραμμικότητες, δηλαδή τον πίνακα
	\( f_0(x) \). Επομένως μπορούμε για την είσοδο ελέγχου να θεωρήσουμε
	ότι:
	\[
	u = G^{-1}(x)\left[
	-f_0(x) + (Ax+Bv)
	\right]
	\]
	όπου \( A,B \) ένας πίνακες συντελεστών, και \( \upsilon \) η
	εξωτερική είσοδος ελέγχου που θα τοποθετηθεί μετά τη μελέτη μας.

	Επομένως, τελικά έχουμε:
	\begin{align*}
		\dot x &= A_0 x + Ax + Bυ\\
		&= (A+A_0)x + Bυ
	\end{align*}

	Βέβαια δεν ήταν απαραίτητο να συμπεριλάβουμε τον πίνακα \( Α \) ή
	όλους τους συντελεστές του, αλλά ήταν σημαντικό να διατηρήσουμε
	τον \( Bυ \), καθώς εκφράζει τον εξωτερικό ελεγκτή που ζητείται από
	την εκφώνηση. Επίσης έπρεπε να διατηρηθεί ο \( A_0 \) (δηλαδή ο
	όρος \( -x_2 \)), καθώς είναι ήδη γραμμικός.
\end{exercise}

\begin{exercise}[3\textsuperscript{ο} Θέμα Προόδου 2018]
	Δίνεται ένα μηχανικό σύστημα:
	\todo{Graph 32}

	Υπάρχουν δύο σώματα με μάζες \( m \), γραμμικά ελατήρια με σταθερές
	\( k_1,k_2 \), μη γραμμικοί αποσβεστήρες με χαρακτηριστικές
	\( c_1(z) = z^2 \) και \( c_2(z) = z^3 \), μετατοπίσεις
	\( q_1,q_2 \), και εξωτερική δύναμη \( u \).
	\tcblower
	Πριν ορίσουμε τις μεταβλητές κατάστασης, θα πρέπει να βρούμε τις
	εξισώσεις του συστήματος. Θεωρούμε θετική φορά προς τα δεξιά.

	Για το σώμα 1:
	\begin{align*}
		m\ddot q_1 &=
		u - k_1q_1 - c_1(\dot q_1 -\dot q_2)
		\\ &= u-k_1q_1 - (\dot q_1 - \dot q_2)^2 \\
		\ddot q_1 &=
		\frac{1}{m}u - \frac{k_1}{m}q_1 - \frac{1}{m}(\dot q_1 -\dot q_2)^2
	\end{align*}

	Για το σώμα 2:
	\begin{align*}
	m\ddot q_2 &= -k_2q_2 - \dot q_2^3
	- (\dot q_2 - \dot q_1)^2 \\
	\ddot q_2 &= -\frac{k_2}{m}q_2 - \frac{1}{m}\dot q_2^3
	- \frac{1}{m}(\dot q_2 - \dot q_1)^2
	\end{align*}

	Η τάξη του συστήματος είναι \( n=2+2=4 \), επομένως πρέπει να επιλέξουμε 4 μεταβλητές κατάστασης.

	Αφού δεν εμφανίζονται ανώτερες παράγωγοι του \( u \), μπορούμε
	άνετα να επιλέξουμε τις παρακάτω μεταβλητές κατάστασης:
	\[
	x_1=q_1,\ x_2 = \dot q_1,\ x_3 = q_2,\ x_4 = \dot q_2
	\]

	Επομένως μπορούμε να γράψουμε τις εξισώσεις κατάστασης:
	\begin{align*}
		\dot x_1 &= x_2 \\
		\dot x_2 &= \frac{1}{m} u -\frac{k_1}{m}x_1
		-\frac{1}{m}(x_2-x_4)^2 \\
		\dot x_3 &= x_4 \\
		\dot x_4 &= -\frac{k_2}{m}x_3 - \frac{1}{m}x_4^3-\frac{1}{m}(x_4-x_2)^2
	\end{align*}
\end{exercise}

\subsection{Εξισώσεις κατάστασης}
Θα παρατηρήσουμε αργότερα ότι μια βολική μορφή για να γράφουμε τις εξισώσεις
κατάστασης είναι η εξής:\todo{fix}
\begin{align*}
	\dot z &= \left[\begin{matrix}
	-a_1 & -a_2 & -a_3 & \hdots  & -a_n \\
	1& 0 & 0 & \hdots & 0\\
	0 & 1 & 0 & \hdots & 0 \\
	\vdots & \vdots & \ddots & \vdots & \vdots \\
	0 & 0 & \hdots & 1 & 0
	\end{matrix}\right]z + \left[\begin{matrix}
	1 \\ 0 \\ 0 \\ \vdots \\ 0
	\end{matrix}\right]u \\
	y &= \left[\begin{matrix}
	b_1 & b_2 & \dots & b_n
	\end{matrix}\right]z + Du
\end{align*}

Αυτή η μορφή ονομάζεται \textbf{ελέγξιμη κανονική μορφή}.
\todo{Είναι σίγουρα ελέγξιμη στον όρο;}
Η παραπάνω μορφή έχει την ιδιότητα ότι μπορούμε να βρούμε πολύ εύκολα
το \textbf{χαρακτηριστικό} της \textbf{πολυώνυμο}. Γενικότερα,
το χαρακτηριστικό πολυώνυμο προκύπτει από την εξίσωση
\( p(s)=\det(sI-\tilde A) \). Μετά από πράξεις, στον παραπάνω πίνακα
θα προκύψει:
\[
p(s) =
s^n + a_1s^{n-1} + \dots + a_{n-1}s+a_n
\]

Τα συστήματα όμως γενικά θα δίνονται στην περιγραφή:
\begin{align*}
	\dot x &= Ax+Bu \\
	y &= Cx+Du
\end{align*}
όπου \( u\in\mathbb R,\ x\in \mathbb R^{n} \) και ο πίνακας
ελεγξιμότητας είναι \( M = \left[\begin{matrix}
B & AB & \hdots & A^{n-1}B
\end{matrix}\right] \).

Τα δύο παραπάνω συστήματα \( \dot x \) και \( \dot z \) είναι \textit{ισοδύναμα}, αν και έχουν διαφορετικές μεταβλητές κατάστασης.

Μάλιστα, αποδεικνύεται ότι ο \textit{πίνακας ελεγξιμότητας}
\( \tilde M = \left[\begin{matrix}
\tilde B & \tilde A\tilde B & \hdots & \tilde A^{n-1}\tilde B
\end{matrix}\right] \) του μετασχηματισμένου συστήματος \( \dot z \) είναι
\textbf{άνω τριγωνικός} και τα στοιχεία στην \textbf{κύρια διαγώνιό} του
είναι \textbf{\( 1 \)}.

Ο μετασχηματισμός μεταξύ των δύο επιλογών μεταβλητών κατάστασης γίνεται,
όπως έχουμε δει στο Kεφάλαιο \todo{ref}, μέσω ενός πίνακα \( T \):
\[
z = Tx
\]
και ισχύει ακόμα:
\begin{align*}
	\dot z &= T\dot x\\
	&= T(Ax+Bu)\\
	&=\underbrace{(TAT^{-1})}_{\tilde A}z
	+\underbrace{(TB)}_{\tilde B}u
\end{align*}
και για τον πίνακα ελεγξιμότητας:
\begin{align*}
	\tilde M &= \left[\begin{matrix}
	TB & TAT^{-1}TB \hdots
	\end{matrix}\right]
	\\ &= \left[\begin{matrix}
	TB & TAB & \hdots & TA^{n-1}B
	\end{matrix}\right]
	\\ &= T\left[\begin{matrix}
	B & AB & \hdots & A^{n-1}B
	\end{matrix}
	\right]
	\\ &= TM \implies \boxed{T = \tilde M M^{-1}}
\end{align*}

\paragraph{}

\begin{theorem}{}{}
	Αν το ζευγάρι \( (A,B) \) είναι \textbf{ελέγξιμο}, τότε υπάρχει
	\textbf{μετασχηματισμός} \( z=Tx \) που να μετατρέπει το αρχικό
	σύστημα στην \textit{ελέγξιμη κανονική μορφή} με χαρακτηριστικό
	πολυώνυμο: \[ p(s) =
	s^n + a_1s^{n-1} + \dots + a_{n-1}s+a_n \]
\end{theorem}

\begin{exercise}[Παράδειγμα]
	Δίνεται το σύστημα: \[
	\dot x = \left[\begin{matrix}
	a & \omega \\ -\omega &  a
	\end{matrix}\right]x + \left[\begin{matrix}
	0 \\ 1
	\end{matrix}\right]u
	\] όπου \( (a,\omega ) \neq (0,0) \)

	Να το φέρετε στην ελέγξιμη κανονική μορφή.
	\tcblower
	Για την εφαρμογή του θεωρήματος, πρέπει πρώτα να αποδείξουμε ότι το
	δοθέν σύστημα είναι ελέγξιμο.
	Υπολογίζουμε τον πίνακα ελεγξιμότητας:
	\[
	M=\left[\begin{matrix}
	B & AB
	\end{matrix}\right] = \left[\begin{matrix}
	0 & \omega \\ 1 & a
	\end{matrix}\right]
	\]

	Βρίσκουμε την ορίζουσά του:
	\[
	\det(M) = -\omega  \neq 0
	\]
	επομένως, αφού είναι μη μηδενική, το σύστημα είναι ελέγξιμο.
	\todo{really?}

	Άρα υπάρχει ο ζητούμενος μετασχηματισμός:
	\begin{align*}
		z &= Tx \\
		T &= \tilde M M^{-1}
	\end{align*}

	Για να βρούμε τους συντελεστές \( a_1, a_2 \), θα βρούμε το
	\textbf{χαρακτηριστικό πολυώνυμο} του αρχικού συστήματος. Αφού το πρώτο
	σύστημα θα πρέπει να είναι \textit{ισοδύναμο} με το τελικό, πρέπει
	να έχουν ίδιο χαρακτηριστικό πολυώνυμο.

	Το αρχικό χαρακτηριστικό πολυώνυμο είναι:
	\[
	\det(sI-A) = \det\left(
	\left[\begin{matrix}
	s & 0 \\ 0 & s
	\end{matrix}\right]-\left[\begin{matrix}
	a & \omega  \\ -\omega &a
	\end{matrix}\right]
	\right) = s^2-2as + (a^2+\omega^2)
	\]
	και, εξισώνοντας τους συντελεστές με το \( p(s) = s^2 + a_1s^1 + a_2 \):
	\begin{align*}
		a_1 &= -2a \\
		a_2 &= a^2+\omega^2
	\end{align*}

	Άρα τελικά, οι πίνακες του ζητούμενου συστήματος είναι:
	\begin{align*}
		\tilde A &= \left[\begin{matrix}
		-a_1 & -a_2 \\ 1 & 0
		\end{matrix}\right] = \left[\begin{matrix}
		2a & -a^2 - \omega^2 \\ 1 &0 \end{matrix}
		\right] \\
		\tilde B &= \left[\begin{matrix}
		1 \\ 0
		\end{matrix}\right]
	\end{align*}

	Ως επαλήθευση, μπορούμε να βρούμε τον πίνακα ελεγξιμότητας του νέου
	συστήματος, και να επαληθεύσουμε πως έχη μη μηδενική ορίζουσα:
	\[
	\tilde M = \left[\begin{matrix}
	\tilde B & \tilde A \tilde B
	\end{matrix}\right] = \left[\begin{matrix}
	1 & -a_1 \\ 0 & 1
	\end{matrix}\right]
	\]

	Επιπλέον, ο πίνακας μετασχηματισμού \( T \) μπορεί να χρησιμοποιηθεί
	ώστε να σχεδιάσουμε τον ελεγκτή μας (θυμόμαστε ότι οι μεταβλητές
	\( x \) είναι μετρήσιμες, και \textit{όχι} οι \( z \)), ή για
	να βρούμε πώς συνδέεται η έξοδος (π.χ. \( y= x_1 \)) με τις νέες μεταβλητές κατάστασης.
	Ο πίνακας μετασχηματισμού \( T \) του συστήματος προκύπτει:
	\[
	T = \tilde M M^{-1} = \dots = \left[\begin{matrix}
	\frac{-3a}{\omega} & 1 \\ \frac{1}{\omega} & 0
	\end{matrix}\right]
	\]
\end{exercise}

\begin{infobox}{}
	Αν δίνεται ένα σύστημα στην ελέγξιμη κανονική μορφή, τότε αυτό
	είναι πάντα ελέγξιμο.
\end{infobox}

\lecture{13}{25/4/2018}

\subsection{}
\todo{what}
\todo{add notes}
\todo{Graph 33}

Στόχος μας είναι να ελέγξουμε ένα γραμμικό σύστημα της παρακάτω μορφής,
έτσι ώστε να πληροί κάποιες προδιαγραφές:
\begin{align*}
	\dot x &= Ax + Bu\\
	y &= Cx + Du
\end{align*}

Στη περίπτωση που έχουμε κάνει κάποιο λάθος κατά τη μοντελοποίηση του συστήματος
(π.χ. θεωρήσαμε ότι μια σταθερά είναι ίση με \( 1 \), ενώ στην πραγματικότητα
είναι \( 1.1 \)). Επομένως είναι επιθυμητό να σχεδιάσουμε έναν ελεγκτή ο οποίος
δεν θα επηρεάζεται σημαντικά από τέτοια σφάλματα. Στην πορεία θα
μελετάμε διάφορα είδη ελεγκτών.

Εφ' όσον τα συστήματά μας είναι γραμμικά, μπορούμε να εφαρμόσουμε την αρχή της
επαλληλίας, και να λειτουργούμε μόνο με μία \textit{ενεργή} είσοδο κάθε φορά, και όλες τις
υπόλοιπες νεκρές.

\subsubsection{Γραμμική Ανάδραση Καταστάσεων}

Θεωρούμε έναν ελεγκτή της μορφής:
\[
u = -kx + k_r r
\]

Μπορεί να θέλουμε να καταστήσουμε ένα (ίσως ήδη ευσταθές) σύστημα πιο
ταχύ στην απόκριση. Αυτό το πετυχαίνουμε μετακινώντας τις \textbf{ιδιοτιμές} του πιο αριστερά στο επίπεδο. Ουσιαστικά πρέπει δηλαδή να παρέμβουμε στον πίνακα \( Α \) της έκφρασης \( \dot x = Ax+Bu \). Επομένως
στην έκφραση του ελεγκτή μας πρέπει να υπάρχει και ένας όρος που πολλαπλασιάζεται
με το \( x \), έστω \( -kx \). Τότε, το σύστημα θα αποκτήσει τη μορφή:
\begin{align*}
	\dot x &= Ax + Bu \\
	\dot x &= Ax - Bkx \\
	&= \underbrace{(A-Bk)}x \\
	&= \tilde A x
\end{align*}

Μία ακόμα προδιαγραφή που θα θέλουμε να πληρούται είναι να θέλουμε να είμαστε κοντά σε μια συγκεκριμένη έξοδο στη μόνιμη κατάσταση.

Για αυτό θα προσθέσουμε έναν όρο \( k_r r \) στον ελεγκτή, δηλαδή
\( u = -kx+k_r r \), τότε:
\begin{align*}
\dot x &= Ax + Bu \\
&= Ax - Bkx + Bk_r r\\
&= (A-Bk)x + Bk_r r\\
&= \tilde Ax + Bk_r r
\end{align*}

Για να βρούμε την έξοδο στη μόνιμη κατάσταση και να αποδείξουμε ότι ο
παραπάνω ελεγκτής ικανοποιεί την απαίτησή μας, θα θεωρήσουμε ότι εκεί
έχουμε μηδενική παράγωγο για το \( \dot x \):
\begin{align*}
	\dot x &= 0 \implies \\
	\tilde Ax^* &= - Bk_r r \implies \\
	x^* &= -(A-Bk)^{-1}B k_r r \implies \\
	r &= y_{\mathrm{ss}} = -C(A-Bk)^{-1}Bk_rr
	+D(-kx^*+k_r r) \implies
	\hfill \text{\small όπου $y_{ss}$ η έξοδος στη μόνιμη κατάσταση}
	\\
	k_r &= \frac{1}{D k (A-Bk)^{-1} +D - C(A-Bk)^{-1}B }
\end{align*}
\todo{check}
δηλαδή φτάνουμε σε μια έκφραση η οποία μας επιστρέφει την τιμή της
σταθεράς \( k_r \) για να πετύχουμε την επιθυμητή έξοδο. Η παραπάνω
έκφραση μπορεί να υπολογιστεί πιο εύκολα όταν έχουμε στη διάθεσή μας
τη συνάρτηση μεταφοράς του συστήματος.

Συνοπτικά, ρυθμίζοντας το \( k \) μπορούμε να επηρεάσουμε την ταχύτητα
απόκρισης του συστήματος, και ρυθμίζοντας το \( k_r \) μπορούμε να ελέγξουμε
την έξοδο στη μόνιμη κατάσταση.

Βέβαια για να τα εφαρμόσουμε όλα αυτά, απαιτείται να γνωρίζουμε ότι το
σύστημα είναι ελέγξιμο, με μελέτη του πίνακα ελεγξιμότητας, ακόμα κι
αν δεν αναφέρεται ρητά στην εκάστοτε άσκηση.

Αν θεωρήσουμε ότι ένα σύστημα είναι ελέγξιμο, τότε μπορεί να γραφεί
στην ελέγξιμη κανονική μορφή ως εξής:
\begin{align*}
	\dot z &= \left[\begin{matrix}
	-a_1 & -a_2 & \hdots & -a_n \\
	1 & 0 & \hdots & 0\\
	0 & 1 & \hdots & 0 \\
	\vdots & \vdots & \ddots &\vdots \\
	0 & 0 & \hdots & 0
	\end{matrix}\right]z + \left[\begin{matrix}
	1 \\ 0 \\ \vdots \\ 0
	\end{matrix}\right]u\\
	y &= \left[\begin{matrix}
	b_1 & b_2 & \hdots & b_n
	\end{matrix}\right]z
\end{align*}
με χαρακτηριστικό πολυώνυμο:
\[
p(s) = s^n + a_1s^{n-1} + a_2s^{n-2} + \dots + a_{n-1}s + a_n
\]
αφού μπορούμε να χρησιμοποιήσουμε το μετασχηματισμό \( T = \tilde M M^{-1} \) \todo{add reference}

Σύμφωνα με την παραπάνω ανάλυση, μπορούμε να τοποθετήσουμε έναν
ελεγκτή της μορφής:
\[
u = -k_1 z_1 - k_2z_2 - \dots - k_nz_n + k_r r
\]
οπότε το σύστημα θα γίνει:
\begin{align*}
\dot z &= \left[\begin{matrix}
-a_1-k_1 & -a_2-k_2 & \hdots & -a_n-k_n \\
1 & 0 & \hdots & 0\\
0 & 1 & \hdots & 0 \\
\vdots & \vdots & \ddots &\vdots \\
0 & 0 & \hdots & 0
\end{matrix}\right]z + \left[\begin{matrix}
k_r \\ 0 \\ \vdots \\ 0
\end{matrix}\right]r
\end{align*}
και το χαρακτηριστικό πολυώνυμο:
\[
p(s) = s^n + (a_1+k_1)s^{n-1} + (a_2+k_2)s^{n-2} + \dots + (a_{n-1} + k_{n-1})s + (a_n+k_n)
\]

Παραπάνω αναφέραμε ότι η πρόθεσή μας για τα \( k \) είναι να μεταφέρουμε
τις ιδιοτιμές του συστήματος σε μια επιθυμητή θέση. Όμως οι ιδιοτιμές
είναι οι ρίζες του χαρακτηριστικού πολυωνύμου. Για παράδειγμα, αν θέλουμε
να έχουμε ιδιοτιμές \( -3 \), \( -4 \), \( -5 \), το επιθυμητό χαρακτηριστικό
πολυώνυμο θα είναι το:
\[
p(s) = (s+3)(s+4)(s+5)
\]
και εύκολα μπορούμε να βρούμε τους συντελεστές:
\[
p(s) = s^3 + 12s^2 + 47s + 60
\]

Γενικότερα, τα χαρακτηριστικά πολυώνυμα θα βρίσκονται στη μορφή:
\[
P_a(s) = s^n + P_1s^{n-1} + \dots + P_{n-1}s+P_1
\]
όπου \( a_i+k_i = P_i \implies k_i = P_i - a_i \), και οι συντελεστές
\( a_i \) προκύπτουν από το δοθέν αρχικό σύστημα, και οι \( P_i \)
σύμφωνα με τις επιθυμητές ιδιοτιμές, όπως αναλύσαμε παραπάνω.

Επιπλέον, σε αυτήν την περίπτωση, η σταθερά \( k_r \) προκύπτει:
\[
k_r = \frac{a_n+k_n}{b_n}
\]

\textbf{Προσοχή} όμως! Ο ελεγκτής που σχεδιάσαμε είναι ο:
\[
u = -kz +k_r r
\]

Αν όμως το σύστημα που μας δίνεται \textbf{δεν} είναι σε ελέγξιμη κανονική μορφή, αφού η μετρήσιμη μεταβλητή είναι η \( x \), θα πρέπει να εφαρμόσουμε
το μετασχηματισμό:
\[
x = Tx \implies x = T^{-1}z
\]
ώστε να δώσουμε τον πραγματικό ελεγκτή που μπορεί να υλοποιηθεί.

\paragraph{}
Όλα τα παραπάνω συνοψίζονται με το εξής θεώρημα:

\begin{theorem}{}{}
	Έστω το γραμμικό, χρονικά αμετάβλητο σύστημα:
	\begin{align*}
		\dot x &= Ax+Bu \\
		y &= C x
	\end{align*}
	με χαρακτηριστικό πολυώνυμο \( p(s) \) και πίνακα ελεγξιμότητας \( M \).

	Αν το σύστημα είναι ελέγξιμο, υπάρχει ελεγκτής της μορφής \( u = -k_x +k_r r \) ώστε το σύστημα να έχει χαρακτηριστικό πολυώνυμο \( P_d \).

	Τα κέρδη της ανάδρασης δίνονται από την πράξη \( \bar k = kT = k\tilde M M^{-1} \), όπου οι συντελεστές \( k_i = P_i - a_i \), και το κέρδος
	\( k_r \) υπολογίζεται από το κέρδος μηδενικής συχνότητας:
\[ \boxed{k_r = \frac{a_n+k_n}{b_n}} \]

\todo{συμπλήρωση}
\end{theorem}

Βέβαια, όσο πιο μακριά θέλουμε να μεταφέρουμε τις ιδιοτιμές του συστήματος,
τόσο πιο μεγάλα κέρδη θα πρέπει να έχει ο ελεγκτής. Όμως τα μεγαλύτερα
κέρδη σημαίνουν και μεγαλύτερη δυσκολία υλοποίησης του ελεγκτή (π.χ. ίσως
απαιτείται περισσότερη ενέργεια).

\paragraph{}
Στην περίπτωση που το σύστημά μας \textit{δεν} είναι ελέγξιμο, η
παραπάνω διαδικασία δεν μπορεί να εφαρμοστεί. Δεν θα υπάρχει μετασχηματισμός
ώστε να μετατρέψουμε το σύστημα σε ελέγξιμη κανονική μορφή, ούτε θα
υπάρχει πίνακας \( T \) για να βρούμε τα \( z=Tx \) ή \( \bar k = kT \).


\begin{exercise}{}
	Να ελεγχθεί το παρακάτων σύστημα:
	\[
	\dot x = Ax+Bu,\quad y=Cx
	\]
	όπου:
	\begin{align*}
		A &= \left[\begin{matrix}
		0 & 1 \\ 0 & 0
		\end{matrix}\right],\quad B = \left[\begin{matrix}
		\gamma \\ 1
		\end{matrix}\right],\quad \gamma >0\\
		C &= \left[\begin{matrix}
		1 & 0
		\end{matrix}\right]
	\end{align*}
	\tcblower
	Η τάξη του συστήματος είναι \( n=2 \), και ο πίνακας ελεγξιμότητας:
	\[
	M = \left[\begin{matrix}
	B & AB
	\end{matrix}\right] = \left[\begin{matrix}
	γ & 1 \\ 1 & 0
	\end{matrix}\right]
	\]
	όπου παρατηρούμε ότι \( \mathop{rank}(M) = 2 = n \), άρα το σύστημα είναι
	ελέγξιμο.

	Θα εφαρμόσουμε μία διαδικασία διαφορετική από την παραπάνω, η οποία
	μπορεί να εφαρμοστεί σε συστήματα χαμηλής τάξης.

	Επιλέγουμε έναν ελεγκτή της μορφής:
	\[
	u = -kx + k_r r
	\]
	ή, αναλυτικότερα, αν θεωρήσουμε ότι \( k = \left[\begin{matrix}
	k_1 & k_2
	\end{matrix}\right] \):
	\begin{align*}
		u &= -k_1 x_1 - k_2 x_2 + k_r r
	\end{align*}

	Επομένως, αν στο σύστημα κάνουμε αντικατάσταση (αφού γνωρίζουμε
	από τη θεωρία ότι \( \dot x = (A-Bk)x +Bk_r r \)):
	\[
	\dot x = \underbrace{\left[\begin{matrix}
	-γk_1 & 1 -γk_2 \\ -k_1 & -k_2
	\end{matrix}\right]}_{\tilde A}x + \left[\begin{matrix}
	γk_r \\ k_r
	\end{matrix}\right]r
	\]

	Μπορούμε να βρούμε το χαρακτηριστικό πολυώνυμο του συστήματος, χρησιμοποιώντας τον τύπο της ορίζουσας:
	\begin{align*}
		P_c(s) &= \det(sI-\tilde A) = \dots
		= s^2 + (γk_1+k_2)s + k_1
	\end{align*}
	Το επιθυμητό χαρακτηριστικό πολυώνυμο έχει τη μορφή:
	\[
	P_d(s) = s^2 + P_1 s + P_2
	\] όπου τα \( P_1,P_2 \) προκύπτουν από τις επιθυμητές ιδιοτιμές.
	Επομένως:
	\begin{align*}
		P_1 &= γk_1 + k_2 \implies \boxed{k_2 = P_1-γP_2} \\
		\Aboxed{P_2 &= k_1}
	\end{align*}

	\todo{συμπλήρωση if necessary}
	\todo{kr = P2 why?}

	Άρα ο ελεγκτής θα γίνει:
	\begin{align*}
		u &= -k_1x_1 - k_2x_2 + k_r r \\
		&= -P_2x_1 - (P_1-γP_2)x_2 + P_2 r \\
		&= -P_2 y + P_2 r - (P_1-γP_2)x_2 \\
		&= -P_2(y-r) - (P_1-γP_2)x_2
		\intertext{Αν θέσουμε \( e = y-r \):}
		&= -P_2 e - (P_1-γP_2)x_2
	\end{align*}

	\lecture{14}{27/4/2018}
	\paragraph{}
	\todo{graph 34}
	\todo{notes}
	Θα προσπαθήσουμε να σχεδιάσουμε έναν ελεγκτή έτσι ώστε το κέρδος να είναι μικρότερο
	του 1.

	Θεωρούμε πως πολλαπλασιάζουμε τον ελεγκτή \( u=-kx+k_rr \) με μια σταθερά \( \bar k \)
	έτσι ώστε να έχουμε το επιθυμητό κέρδος.

	Τότε:
	\begin{align*}
		k_1 &= a_2 \\
		k_2 &= a_1 - \gamma a_2 \\
		k_r &= k_i = a_2
	\end{align*}

	και
	\begin{align*}
		\bar k k_1 &= a_2\\
		\bar k k_2 &= a_1 - \gamma a_2\\
		\bar k k_r &= a_2
	\end{align*}

	άρα:
	\[
	0 < k_1 = \frac{a_2}{\bar k} \leq 1 \implies \boxed{\begin{aligned}
		0 < a_2 \leq \bar k\\
		0 < a_1 - \gamma a_2 \leq \bar k
		\end{aligned}}
	\]

	\tcbsubtitle{Με εξωτερικές διαταραχές}
	Θα μελετήσουμε πώς θα ανταποκριθεί ο ελεγκτής αυτός με την παρουσία
	διαταραχών, θεωρώντας ότι οι διαταραχές είναι φραγμένες (κάτι που
	είναι λογικό για τα φυσικά συστήματα).
	\todo{graph 35}

	Εδώ θα θεωρήσουμε ότι \( \bar k =1 \), δηλαδή δεν λαμβάνουμε
	ουσιαστικά υπ' όψιν την παραπάνω ανάλυση, για απλοποίηση των πράξεων.

	Τότε, με τον ελεγκτή \( u \), το σύστημα θα αποκτήσει τη μορφή:
	\begin{align*}
		\dot x &= Ax + B \Big(
		\underbrace{(-kx+k_rr)}_u + d(t)
		\Big)
		\\
		\dot x &= (A-Bk)x + Bk_r r + Bd(t)
	\end{align*}

	Αν θεωρήσουμε ότι \( d(t) = d \forall t \geq 0 \) \todo{why}, θα έχουμε:
	\begin{align*}
		\dot x &= (A-Bk)x + Bk_r r + Bd
		\end{align*}

    Για να βρούμε τον \( k_r \), ασχολούμαστε με τη μόνιμη κατάσταση,
    δηλαδή με το σημείο ισορροπίας: \[
    		x^* = - (A-Bk)^{-1} Bk_r r - (A-Bk)^{-1}Bd
	\]
	επομένως η σταθερά \( k_r \) προκύπτει:
	\[
	k_r = \frac{-1}{C(A-Bk)^{-1}B}
	\]
	και η έξοδος στη μόνιμη κατάσταση είναι:
	\begin{align*}
	y_s &= Cx^* = \left[
	-C(A-Bk)^{-1}B
	\right]k_r r - C(A-Bk)^{-1}Bd
	\\ &=
	r - \underbrace{C(A-Bk)^{-1}Bd}_{\text{σφάλμα}}
	\end{align*}

	Εδώ παρατηρούμε ότι δεν θα έχουμε στη μόνιμη κατάσταση έξοδο ίση
	με την επιθυμητή \( r \), αλλά θα υπάρχει ένα σφάλμα που εξαρτάται από
	τη διαταραχή, το οποίο είναι ίσο με τον όρο \( C(A-Bk)^{-1}Bd \).

	Ο όρος αυτός όμως είναι, στη συγκεκριμένη άσκηση:
	\[
	C(A-Bk)^{-1}Bd = -\frac{d}{k_1}
	\]

	Παρατηρούμε δηλαδή ότι, για ένα μέγιστο πλάτος \( d \) των διαταραχών
	που δίνεται από τη φυσική υλοποίηση του συστήματος, μπορούμε να
	επηρεάσουμε την τιμή του σφάλματος, αλλάζοντας την τιμή του \( k_1 \).
	Πρακτικά, για να μειώσουμε το σφάλμα, αυξάνουμε και το \( k_1 \).
	Αυξάνοντας το \( k_1 \) οδηγούμαστε στη μετακίνηση των ιδιοτιμών
	του συστήματος πιο αριστερά, όπως έχουμε δείξει παραπάνω. \todo{where?}

	Ουσιαστικά, μπορούμε να πραγματοποιήσουμε απόσβεση των διαταραχών
	του συστήματος, μετακινώντας τις ιδιοτιμές προς τα αριστερά, άρα
	καθιστώντας την απόκρισή του πιό γρήγορη.

	Ο λόγος βέβαια που στην πραγματικότητα δεν μπορούμε να αυξήσουμε το
	\( k_1 \) κατά βούληση είναι η ύπαρξη θορύβου κατά τη μέτρηση των
	μεταβλητών κατάστασης \( x \) από τις μετρητικές διατάξεις, η οποία
	γίνεται περισσότερο καταστρεπτική με την αύξηση του \( k_1 \). Τον
	θόρυβο θα τον μελετήσουμε αργότερα στο μάθημα. \todo{add reference later}\todo{check}
\end{exercise}

\paragraph{}

Η σχεδίαση αυτή βέβαια απαιτεί να είναι γνωστοί οι \(A,B,C,D\), και να
μην υπάρχουν διαταραχές. Θα δούμε στη συνέχεια πώς μπορούμε να παρακάμψουμε
αυτούς τους περιορισμούς.

\paragraph{}
Η γραμμική ανάδραση καταστάσεων είναι ουσιαστικά ένας \textbf{αναλογικός
	ελεγκτής}, χωρίς άλλους παράγοντες, όπως ολοκληρωτικούς.



\subsection{Επιλογή Κερδών}
Στα παραπάνω είδαμε πως η επιλογή των κερδών ενός ελεγκτή είναι η πιο σημαντική, και
τελικά η πιο επίπονη διαδικασία στην υλοποίηση ενός ελεγκτή. Αντιστοιχεί
με ένα δύσκολο πρόβλημα βελτιστοποίησης το οποίο έχει κάποιους περιορισμούς, αβεβαιότητες λόγω μοντελοποίησης, θορύβου, κ.ά.

Έστω λοιπόν το γραμμικό σύστημα:
\begin{align*}
	\dot x &= Ax + Bu,\quad x(t_0) = x_0\\
	y &= Cx
\end{align*}

Ένα πρόβλημα που θα χρειαστεί αντιμετωπίσουμε είναι η συμπεριφορά του
κατά το μεταβατικό φαινόμενο.
\todo{Graph 36}

Αν και δεν είναι δύσκολο, να ρυθμίσουμε τη συμπεριφορά του στη μόνιμη
κατάσταση, οι πολύ γρήγορες διακυμάνσεις κατά τη μετάβαση μπορεί να οδηγήσουν
στην καταστροφή του.

Για τη μελέτη των παραπάνω συμπεριφορών, ορίζουμε μερικούς \textbf{δείκτες επίδοσης}: \todo{NOOO}
\begin{defn}{}{}
	Για τις μεταβλητές κατάστασης:
	\[
	J_1 = \int_{t_0}^{t_f} \left|
	x(τ)^2
	\right|\dif τ
	\]

	Για την είσοδο ελέγχου:
	\[
	J_2 = \int_{t_0}^{t_f} \left|
	u(t)
	\right|^2\dif τ
	\]

	Συνδυάζοντας τα δύο παραπάνω, δίνοντας έναν συντελεστή βαρύτητας \( λ \):
	\[
	J_3 = λ J_1 + (1-λ)J_2
	\]
\end{defn}
και, επιπλέον, μπορούμε να θεωρήσουμε ότι αντί για μονοδιάστατους αριθμούς
έχουμε πίνακες:
\begin{gather*}
	x \to x^{\mathrm T} Q x \\
	u \to u^{\mathrm T} R u
\end{gather*}

\todo{συμπλήρωση}
\todo{what is tf?}

Όταν θέλουμε να ελαχιστοποιήσουμε το \( J_1 \), αυξάνεται το \( J_2 \), και το αντίστροφο. Για αυτό ήταν απαραίτητος ο ορισμός της τιμής
\( J_3 \).

\todo{όνομα με κυρτότητα}
\begin{defn}{}{}
	\[
	J = \int_{t_0}^{\infty}
	\left[
	x^{\mathrm T}(t) Qx(t) + u^{\mathrm T}(t) R u(t)
	\right] \dif t
	\]
	όπου \( Q^{\mathrm T} = Q \geq 0 \) συμμετρικός θετικά ημιορισμένος,
	και \( R^{\mathrm T} = R > 0 \) συμμετρικός θετικά ορισμένος πίνακας.
\end{defn}

Σκοπός μας είναι να ελαχιστοποιήσουμε τον παραπάνω δείκτη επίδοσης
\( J \), με κάποιον ελεγκτή \( u_0 = -kx \). Τότε το σύστημα θα
είναι ευσταθές\footnote{ασυμπτωτικά ευσταθές, ως γραμμικό}, άρα
θα υπάρχει πίνακας συμμετρικός θετικά ορισμένος \( P^{\mathrm T} = P >0 \)
για τη συνάρτηση \( V(x) = x^{\mathrm T} P x \).

\begin{theorem}{}{}
	Έστω το σύστημα \( \dot x = Ax+Bu \) με αρχική τιμή \( x(t_0) = x_0 \) με δείκτη επίδοσης
	\( J \) όπως ορίστηκε παραπάνω. \todo{ref}

	Αν ο ελεγκτής \( u_0=-kx \) καθιστά ασυμπτωτικά ευσταθές
	το παραπάνω σύστημα κλειστού βρόχου, και ικανοποιεί το παρακάτω:
	\begin{equation}
	\min_{u}\left(
	\od{V}{t} + x^{\mathrm T}Qx + u^{\mathrm T}R u
	\right) = 0
	\label{eq:sec5linconc}
	\end{equation}
	τότε ο δείκτης επίδοσης ελαχιστοποιείται, και αποκτά την ελάχιστη
	τιμή:
	\[
	J_{\min} = x_0^{\mathrm T} P x_0
	\]
\end{theorem}

Η παραπάνω \todo{which one} είναι γνησίως κυρτή συνάρτηση, δηλαδή μπορούμε
να βρούμε την ελάχιστη τιμή της βρίσκοντας τη θέση όπου η παράγωγός της
είναι 0:
\begin{align*}
\left. \pd{}{u} \left(
\od{V}{t} + x^{\mathrm T}Qx + u^{\mathrm T}Ru
\right)\right|_{u=u_0} &= 0\\
\pd{}{u}\left(
2x^{\mathrm T}P\dot x +x^{\mathrm T}Qx + u^{\mathrm T}Ru
\right)  &= \pd{}{u}\left(
2x^{\mathrm T}P(Ax+Bu) + x^{\mathrm T}Qx + u^{\mathrm T}Ru
\right) \\
2x^{\mathrm T}PB + 2u_0^{\mathrm T} R &= 0 \\
\Aboxed{u_0 &= -\underbrace{\left(
	R^{-1}B^{\mathrm T}P\right)}_{k}x}
\end{align*}

Με την παραπάνω μέθοδο έχουμε βρει την επιθυμητή τιμή του ελεγκτή
\( u_0 = -kx \), τέτοια ώστε να ελαχιστοποιηθεί ο δείκτης επίδοσης:
\[
k = R^{-1}B^{\mathrm T}P
\]
όπου οι πίνακες \( R \) και \( B \) είναι γνωστοί, ενώ τον \( P \)
θα τον βρούμε παρακάτω.

Εφαρμόζοντας το παραπάνω συμπέρασμα στη σχέση \eqref{eq:sec5linconc} έχουμε:
\begin{align*}
	\od{V}{t} + x^{\mathrm T}Qx + u_0^{\mathrm T} R u_0 &= 0 \implies \\
	A^{\mathrm T}P + PA + Q - PBR^{-1}B^{\mathrm T}P &= 0
\end{align*}

Η παραπάνω ονομάζεται \textbf{αλγεβρική εξίσωση του Ricatti}. Από αυτήν
μπορούμε να βρούμε τον πίνακα \( P \).

\begin{exercise}
	Για το σύστημα:
	\begin{align*}
		\dot x_1 &= x_2 \\
		\dot x_2 &= u
	\end{align*}
	να σχεδιαστεί ο βέλτιστος τετραγωνικός ρυθμιστής που να ελαχιστοποιεί
	τη συνάρτηση:
	\[
	J = \int_{0 }^{\infty} (x^{\mathrm T} Q x +u^2)\dif t
	\]
	όπου ο πίνακας \( Q \) είναι:
	\[
	Q = \left[\begin{matrix}
	1 & 0 \\ 0 & \mu
	\end{matrix}\right], \ \mu \geq 0
	\]
	\tcblower
	Το σύστημα γράφεται στη μορφή πίνακα:
	\[
	\dot x = \underbrace{\left[\begin{matrix}
		0 & 1 \\ 0 & 1
		\end{matrix}\right]}x + \underbrace{\left[\begin{matrix}
		0 \\ 1
		\end{matrix}\right]}u
	\]

	Από τη θεωρία, γνωρίζουμε ότι ο επιθυμητός βέλτιστος τετραγωνικός
	ρυθμιστής είναι ο:
	\[
	u_0 = -(R^{-1}B^{\mathrm T}P)x
	\]
	όπου \( B = \left[\begin{matrix}
	0 \\ 1
	\end{matrix}\right] \) (από το δοθέν σύστημα), \( R = \left[\begin{matrix}
	1
	\end{matrix}\right] \) (από τη σχέση για το \( J \)), και \( P \)
	ένας πίνακας που θα υπολογίσουμε από την εξίσωση Riccati.

	Έστω ότι \( P = \left[\begin{matrix}
	P_{11} & P_{12} \\ P_{12} & P_{22}
	\end{matrix}\right] \) (επειδή ο \( P \) είναι συμμετρικός).
	Τότε, από την αλγεβρική εξίσωση Riccati \todo{add eqref} έχουμε:
	\begin{gather*}
		A^{\mathrm T}P + PA + Q - PBR^{-1}B^{\mathrm T}P = 0\implies\\
		\left[\begin{matrix}
		0 & 0 \\ 1 & 0
		\end{matrix}\right]\left[\begin{matrix}
		P_{11} & P_{12} \\ P_{12} & P_{22}
		\end{matrix}\right] + \left[\begin{matrix}
		P_{11} & P_{12} \\ P_{12} & P_{22}
		\end{matrix}\right]\left[\begin{matrix}
		0 & 1 \\ 0 & 0
		\end{matrix}\right] + \left[\begin{matrix}
		1 & 0 \\ 0 & \mu
		\end{matrix}\right] - PBR^{-1}B^{\mathrm T}P = 0 \implies \\
		\dots \implies \\
		\left[\begin{matrix}
		1-P_{12}^2 & P_{11}-P_{12}P_{22} \\ P_{11}-P_{12}P_{22}
		& 2P_{12} - P_{22}^2 + \mu
		\end{matrix}\right] = \left[\begin{matrix}
		0 & 0 \\ 0 & 0
		\end{matrix}\right]
	\end{gather*}

	Άρα τελικά:\[
	P = \left[\begin{matrix}
	\sqrt{\mu+2} & 1 \\ 1 & \sqrt{\mu + 2}
	\end{matrix}\right] > 0
	\]

	Επομένως, το αποτέλεσμα που ζητείται είναι:
	\[
	u_0 = -(R^{-1}B^{\mathrm T}P)x = \dots = \left[\begin{matrix}
	1 & \sqrt{\mu+2}
	\end{matrix}\right]x = -x_1 - \sqrt{\mu+2}x_2
	\]
\end{exercise}

\lecture{15}{2/5/2018}

\begin{exercise}
	Δίνεται το σύστημα:
	\[
	\dot x = \left[\begin{matrix}
	0 & 1 \\ 0 & 0
	\end{matrix}\right]x + \left[\begin{matrix}
	0 \\ 1
	\end{matrix}\right]u
	\]
	όπου \( x(0) = \left[\begin{matrix}
	c & 0
	\end{matrix}\right]^{\mathrm{T}} \)
	με δείκτη επίδοσης:
	\[
	J = \int_{0}^{\infty} x^{\mathrm T}x\dif t
	\]

	Να σχεδιαστεί ελεγκτής \( u \) τέτοιος ώστε η \textbf{φυσική συχνότητα} του συστήματος να είναι:
	\[
	\omega_n = 2 \ \mathrm{rad/s}
	\]
	\tcblower
	Επιλέγουμε τον ελεγκτή:
	\[
	u = -k_1x_1 - k_2x_2
	\]
	άρα:
	\begin{align*}
		\dot x &= \left[\begin{matrix}
		0 & 1 \\ 0 & 0
		\end{matrix}\right] + \left[\begin{matrix}
		0 \\ -k_1x_1 - k_2x_2
		\end{matrix}\right]
		\\ &= \underbrace{\left[\begin{matrix}
		0 & 1 \\ -k_1 & -k_2
		\end{matrix}\right]}_{A}x
	\end{align*}

	Για να υπολογίσουμε τη φυσική συχνότητα του συστήματος, θεωρούμε τη χαρακτηριστική του εξίσωση, την
	οποία βρίσκουμε ως εξής:
	\begin{align*}
		\det(sI-A) &= 0\\
		s(s+k_2) + k_1 &= 0\\
		s^2 + k_2s + k_1 &= 0
	\end{align*}

	Θυμόμαστε ότι η μορφή του χαρακτηριστικού πολυωνύμου ενός συστήματος
	2\textsuperscript{ης} τάξης είναι:
	\[
	s^2 + 2ζ\omega_ns + \omega_n^2
	\]

	Εξισώνοντας τους συντελεστές, ισχύει \( \omega_n^2 = k_1 \implies
	k_1 = 2^2 = 4 \).

	\paragraph{}
	Τώρα αρκεί να βρούμε το \( k_2 \) ώστε να ελαχιστοποιήσηουμε
	τον \( J \). Για την παραπάνω διαδικασία θυμόμαστε ότι \( u_0
	= R^{-1}B^{\mathrm T}Px \), όμως στη συγκεκριμένη άσκηση
	ισχύει \( R=0 \), άρα ο \( R^{-1} \) δεν υπάρχει. Επομένως θα
	ακολουθήσουμε μια ελαφρώς διαφορετική προσέγγιση.

	Έχουμε:
	\[
	\left.\od{V}{t}\right|_{u=u_0}
	+x^{\mathrm T} \cancelto{I}{Q} x
	+\cancelto{0}{u_0^{\mathrm T} R u_0} = 0
	\]
	από το οποίο προκύπτει: \todo{πράξεις}
	\[
	P = \left[\begin{matrix}
	\frac{k_2}{8} + \frac{5}{2k_2} & \frac{1}{8}\\
	\frac{1}{8} & \frac{5}{8k_2}
	\end{matrix}\right]
	\]

	Από το γνωστό θεώρημα, δίνεται η ελάχιστη τιμή του \( J \), η οποία
	είναι:
	\begin{align*}
		J_{\min}^{(k_2)} &= x^{\mathrm{T}}(0) P x(0)\\ &=
		\left(\frac{k_2}{8} + \frac{5}{2k_2}\right)c^2
	\end{align*}

	Στο σημείο όπου αποκτούμε την ελάχιστη τιμή έχουμε:
	\[
	\pd{J_{\min}}{k_2} = 0 \implies \dots \implies k_2 = \sqrt{20}
	\]

	Επομένως, ο τελικός ελεγκτής προκυπτει:
	\[
	u  = -4x_1 - \sqrt{20}x_2
	\]

	Η άσκηση αυτή δείχνει τη σημασία της κατανόησης της θεωρίας, η οποία
	χρειάζεται για την άρση του περιορισμού που προκύπτει από τη
	μη αντιστρεψιμότητα του \( R \).
\end{exercise}

\subsection{Δυναμική Ανάδραση Καταστάσεων}
Όπως παρατηρήσαμε παραπάνω, η ύπαρξη των διαταραχών ή η αβεβαιότητα
στους συντελεστές (από τη μοντελοποίηση του συστήματος) μπορεί να
οδηγήσει σε σφάλματα στη μόνιμη κατάσταση του συστήματος. Επομένως
τώρα θα σχεδιάσουμε έναν ελεγκτή ο οποίος θα εξαλείφει αυτά τα σφάλματα.

Ο νέος ελεγκτής αυτός θα αποτελείται και από έναν \textbf{ολοκληρωτή}.

Ορίζουμε μια νέα μεταβλητή κατάστασης \( z \) μέσω της εξής διαφορικής
εξίσωσης:
\[
\dot z = y - r
\]

Η μεταβλητή αυτή ουσιαστικά ολοκληρώνει τον όρο \( y-r \), ο οποίος εκφράζει την απόσταση της εξόδου από την είσοδο.

Αφού προσθέσαμε στο σύστημα μια νέα μεταβλητή κατάστασης, η τάξη του θα αυξηθεί, και θα γίνει το εξής:
\begin{align*}
    \dot x &= Ax+Bu\\
	\dot z &= y-r
\end{align*}
και το σημείο ισορροπίας του θα εκφράζεται ως \( (x^*,\ z^*) \). Όμως
στο σημείο ισορροπίας ισχύει εξ' ορισμού \( \dot x = 0 \) και \( \dot z = 0 \implies y-r = 0 \). Αυτόματα δηλαδή, βρίσκοντας το σημείο ισορροπίας,
μηδενίζουμε το σφάλμα, δηλαδή την απόσταση \( y-r \). Επομένως
αρκεί να σχεδιάσουμε ένα σύστημα που θα έχει τις ιδιοτιμές του στα
αριστερά, έτσι ώστε να είναι ασυμπτωτικά ευσταθές, και να τείνει στο
σημείο ισορροπίας.

Με βάση την θεωρία της προηγούμενης ενότητας, μπορούμε να θεωρήσουμε
έναν ελεγκτή ανάδρασης καταστάσεων. Γενικά, αυτοί οι ελεγκτές
έχουν τη μορφή \( u=-kx+k_rr \). Όμως ο όρος \( k_r r \) που είχαμε
χρησιμοποιήσει παλιότερα για τον έλεγχο της εξόδου στη μόνιμη κατάσταση
δεν χρειάζεται τώρα, αφού η έξοδος θα είναι συγκεκριμένη, όπως δείξαμε
παραπάνω. Επομένως θεωρούμε:
\[
u = -k\tilde x
\]
όπου \( \tilde x \) το σύνολο των μεταβλητών κατάστασης του συστήματος, δηλαδή \( \tilde x = \left[\begin{matrix}
x & z
\end{matrix}\right]^{\mathrm T} \).

Επομένως, ο ελεγκτής μας θα γίνει:
\[\boxed{\begin{aligned}
	u &= -kx - k_i z\\
	\dot z&=y-r
\end{aligned}}\]
όπου \( k,k_i \) κάποιες σταθερές.

Ο ελεγκτής αυτός ονομάζεται \textbf{δυναμικής ανάδρασης καταστάσεων}, αφού
επεξεργάζεται την είσοδο, και δεν την χρησιμοποιεί στατικά.

\todo{Graph 37}

\begin{exercise}
	Δίνεται το βαθμωτό σύστημα:\[
	\dot x = ax+bu+b_0d
	\]
	με αρχική τιμή \( x(0) = x_0 \), σταθερούς όρους \( b,b_0\neq 0 \),
	έξοδο \( y=x \) και διαταραχές \( d \).

	Να σχεδιαστεί ελεγκτής τέτοιος ώστε η έξοδος \( y \) να οδηγείται
	σε μια σταθερή τιμή \( y\to r \).

	Τι γίνεται αν έχουμε κάποια αβεβαιότητα για τις σταθερές
	\( a \) και \( b \);
	\tcblower
	Σύμφωνα με τα παραπάνω, έχουμε:
	\begin{align*}
		u &= -kx - k_i z\\
		\dot z &= y-r
	\end{align*}
	ή, ισοδύναμα:
	\begin{align*}
		\dot x &= ax - bkx - bk_i z + b_0 d \\
		\dot z &= \cancelto{x}{y}-r
	\end{align*}
	και σε μορφή πίνακα:
	\[
	\left[\begin{matrix}
	\dot x \\ \dot z
	\end{matrix}\right]
	= \underbrace{\left[\begin{matrix}
		(a-bk) & -bk_i \\ 1 & 0
		\end{matrix}\right]}_{\tilde A}\left[\begin{matrix}
	x \\ z
	\end{matrix}\right] + \left[\begin{matrix}
	0 \\ 1
	\end{matrix}\right]r + \left[\begin{matrix}
	b_0 \\ 0
	\end{matrix}\right]d
	\]

	Σκοπός μας είναι να επιλέξουμε τα \( k \) και \( k_i \) έτσι ώστε
	οι ιδιοτιμές του \( \tilde A \) να βρίσκονται στο αριστερό ημιεπίπεδο.

	Το χαρακτηριστικό πολυώνυμο είναι:
	\begin{align*}
	 P_c(s) &= \det(sI-\tilde A)
		\\ &= s^2 + (bk-a)s + bk_i
	\end{align*}
	άρα, αφού \( P_d(s) = s^2+a_1s+a_2 \), όπου \( a_1,a_2 \) οι
	συντελεστές του χαρακτηριστικού πολυωνύμου που οδηγούν
	στις επιθυμητές ιδιοτιμές:
	\[ \begin{aligned}
		bk-a = a_1 &\implies \\
		bk_i = a_2 &\implies
		\end{aligned}\boxed{\begin{aligned}
			k &= \frac{a_1+a}{b} \\
			k_i &= \frac{a_2}{b}
			\end{aligned}}
	\]

	Λύνοντας τις εξισώσεις \( \dot x = 0 = \dot z \), το σημείο
	ισορροπίας του συστήματος είναι το:
	\[
	(x^*,z^*) = \left(
	\frac{b_0 d - a_2z^*}{a_1},\ z^*
	\right)
	\]

	\tcbsubtitle{Αβεβαιότητα σταθερών}

	Εδώ παρατηρούμε ότι η τιμή του \( b_0 \), δηλαδή και το πλάτος των
	διαταραχών, δεν επηρεάζουν την επιλογή των σταθερών \( k,k_i \),
	αφού δεν βρίσκονται στους τύπους τους. Όμως η επιλογή των σταθερών
	εξαρτάται από τα χαρακτηριστικά του συστήματος \( a \) και \( b \).

	Πολλές φορές δεν θα γνωρίζουμε ακριβώς τις τιμές των παραμέτρων
	αυτών, αλλά να έχουμε μια μικρή αβεβαιότητα, δηλαδή:
	\begin{align*}
		a &= \bar a + Δa \\
		b &= \bar b + Δb
	\end{align*}

	Επομένως στον ελεγκτή που θα
	υλοποιήσουμε θα πρέπει να χρησιμοποιηθούν οι σταθερές
	\( \bar a \) και \( \bar b \) που είναι οι μόνες γνωστές, ενώ το
	χαρακτηριστικό πολυώνυμο θα περιέχει τις πλήρεις εκφράσεις.

	Μετά από πράξεις, το χαρακτηριστικό πολυώνυμο θα γίνει:
	\[
	P_c(s) = s^2 + \left[
	(\bar b k - \bar a) + (Δb\,k - Δa)
	\right]s + k_i(\bar b + Δb)
	\]
	όμως για τα \( k \) και \( k_i \) έχουμε κάνει την επιλογή,
	όπως είπαμε παραπάνω, \( k=\frac{a_1+\bar a}{\bar b} \) και
	\( k_i = \frac{a_2}{\bar b} \), δηλαδή:
	\begin{align*}
		\bar b k - \bar a &= a_1\\
		k_i \bar b &= a_2
	\end{align*}
	άρα το χαρακτηριστικό πολυώνυμο γράφεται τώρα ως εξής:
	\[
	P_c(s) = s^2 + \left[
	a_1 + (Δb\,k-Δa)
	\right]s + (a_2 + k_iΔb)
	\]

	Η ύπαρξη ριζών μόνο στο αριστερό ημιεπίπεδο της παραπάνω έκφρασης
	φαίνεται από την εφαρμογή του κριτηρίου Routh-Hurwitz, σύμφωνα
	με το οποίο:
	\begin{align*}
		a_1 + Δb\, k - Δa &> 0 \\
		a_2 + k_iΔb &>0
	\end{align*}

	Για \textbf{μικρά σφάλματα}
	\( Δa \) και \( Δb \) οι ανισώσεις θα ικανοποιούνται
	και θα οδηγούμαστε στο ίδιο αποτέλεσμα.

	Αν και κάποιος μπορεί να θεωρήσει πως αυξάνοντας τις σταθερές
	\( a_1,a_2 \) θα κάνει πιο σίγουρο το αποτέλεσμα των ανισώσεων,
	αυτό δεν ισχύει απόλυτα, λόγω της εξάρτησης των \( k \) και
	\( k_i \) από τα \( a \) και \( b \).
\end{exercise}

\lecture{16}{5/4/2018}
\subsection{Παρατηρησιμότητα}
Ασχοληθήκαμε με γραμμικά συστήματα της μορφής \( x=Ax+Bu,\ y=Cx+Du \),
όπου θέλαμε η έξοδος \( y \) να φτάνει στην είσοδο που δίνουμε \( r \).
Για να το πετύχουμε αυτό χρησιμοποιήσαμε ελεγκτές οι οποίοι χρησιμοποιούσαν
ολόκληρο το διάνυσμα κατάστασης, έτσι ώστε να λάβουν την απόφαση που θα
οδηγήσει στην επιθυμητή έξοδο.

Πολλές φορές όμως αυτό δεν θα είναι δυνατόν. Λόγοι τεχνολογικοί ή οικονομικοί μπορούν να καθιστούν \textbf{αδύνατη τη μέτρηση} κάποιων
ή όλων των μεταβλητών κατάστασης του συστήματος. Σε τέτοιες περιπτώσεις
το μόνο που θα είναι διαθέσιμο θα είναι η έξοδος \( y \) του συστήματος.
Στο κεφάλαιο αυτό θα μελετήσουμε τη σχεδίαση ελεγκτή όταν δεν μετράμε
το διάνυσμα κατάστασης, αλλά μόνο την έξοδο του συστήματος.

Για να το καταφέρουμε αυτό, θα προσπαθήσουμε να κατασκευάσουμε ένα
σύστημα που θα παράγει \textbf{εκτιμήσεις} \( \hat x \) του διανύσματος
\( x \) δεδομένης της εξόδου \( y \), και θα λειτουργούμε με το εκτιμηθέν
\( \hat x \), και όχι το πραγματικό, δηλαδή θα σχεδιάζουμε ελεγκτές
όπως ο \( u=-k\hat x \). Ο στόχος μας θα είναι η \( \hat x \) να συγκλίνει στην πραγματική \( x \) όσο καλύτερα γίνεται.

Το σύστημα που δεδομένης της εισόδου και της εξόδου του συστήματος θα
παράγει την εκτίμηση \( \hat x \) ονομάζεται \textbf{παρατηρητής}.
\todo{Graph 38}

Στόχος του παρατηρητή είναι η έξοδός του \( \hat x \) να συγκλίνει
στο διάνυσμα των μεταβλητών κατάστασης \( x \), θεωρητικά για \( t\to \infty \), αλλά στην πραγματικότητα θέλουμε με τρόπο πολύ γρηγορότερο
από αυτόν που καθορίζεται από τη σταθερά χρόνου του αρχικού συστήματος
(π.χ τουλάχιστον 10 φορές ταχύτερο).

Για τη μελέτη μας θα θεωρήσουμε ότι οι πίνακες \( A,B,C,D \) είναι γνωστοί.
Η εύρεσή τους είναι αντικείμενο της μοντελοποίησης συστημάτων.

Εδώ προκύπτουν προβλήματα όπως το αν υπάρχει σύστημα το οποίο μπορεί
να προσδιορίσει το \( \hat x \) όπως ορίσαμε παραπάνω. Η ιδιότητα αυτή
ονομάζεται \textbf{παρατηρησιμότητα}, μέσα σε ένα χρονικό διάστημα
\( [0,T] \). \todo{συμπλήρωση}

Οι μεταβλητές κατάστασης στα γραμμικά συστήματα έχουν τιμή
\( \forall t \geq 0 \):
\[
x(t) = e^{At}x(0) + \int_{0}^{t} e^{A(t-τ)}Bu(τ)\dif τ
\]

Στην παραπάνω έκφραση θεωρήσαμε γνωστές τις σταθερές \( A,B \) και
τον ελεγκτή \( u(τ) \). Όμως \textbf{δεν είναι γνωστή η αρχική τιμή
	\( x(0) \)}. Επομένως το πρόβλημα ανάγεται στην μονοσήμαντη
εύρεση της αρχικής κατάστασης του συστήματος:
\[
x(0)
\]
και μπορούμε κατά τη μελέτη της \textit{παρατηρησιμότητας} να αγνοήσουμε
τον δεξί όρο, δηλαδή \( u=0 \).

\begin{defn}{Μη παρατηρήσιμη κατάσταση}{}
	Μία κατάσταση \( x^* \neq 0 \) ονομάζεται \textbf{μη παρατηρήσιμη}
	ότανν ισχύει:
	\[
	Ce^{At} x^* = 0,\quad t\geq 0
	\]
\end{defn}

Πρακτικά αυτό σημαίνει πως δεν μπορούμε να εξάγουμε πληροφορία από
αυτήν την κατάσταση, αφού ο όρος \( e^{At}x(0) \) μηδενίζεται.

\begin{defn}{Παρατηρήσιμο σύστημα}{}
	Ένα σύστημα λέγεται \textbf{παρατηρήσιμο σύστημα} όταν \textbf{δεν} έχει
	καμία \textit{μη παρατηρήσιμη} κατάσταση.
\end{defn}

\paragraph{Παράδειγμα}
Έστω μια αυθαίρετη αρχική τιμή \( x_1(0) \neq 0 \).
Τότε θεωρούμε ότι η έξοδος του συστήματος είναι:
\[
y_1 = Cx = Ce^{At} x_1(0)
\]
όπου θεωρήσαμε ότι \( u=0 \).

Έστω ότι επιλέγουμε μια άλλη αρχική τιμή \( x_2 \):
\[
x_2(0) = x_1(0) + x^*
\]
επομένως τότε η έξοδος θα γίνει:
\begin{align*}
	y_2 &= Cx = Ce^{At}x_2(0) \\
	&= Ce^{At}\left[ x_1(0) + x^* \right]
	\\ &= Ce^{At}x_1(0) + Ce^{At}x^*
\end{align*}
Αν η \( x^* \) είναι μη παρατηρήσιμη, δηλαδή \( Ce^{At}x^* = 0 \), τότε
\( y_1 = y_2 \), δηλαδή δεν μπορούμε να διακρίνουμε την κατάσταση του
συστήματος από την έξοδό του. Επομένως το σύστημα πράγματι δεν είναι
παρατηρήσιμο.

\begin{exercise}
	Έστω ένα γραμμικό σύστημα:
	\begin{align*}
		A &= \left[\begin{matrix}
		-2 &0 \\ 0 & -1
		\end{matrix}\right]\\
		C &= \left[\begin{matrix}3 & 0\end{matrix}\right]
	\end{align*}

	Είναι παρατηρήσιμο;
	\tcblower
	Υπολογίζουμε τον πίνακα μετάβασης:\todo{add ref}
	\begin{align*}
		e^{At} &= \left[\begin{matrix}
		e^{-2t} & 0 \\ 0 & e^{-t}
		\end{matrix}\right]
	\end{align*}

	και: \todo{why?}
	\[
	x^* = \left[ \begin{matrix}0 & 1\end{matrix} \right]^{\mathrm T}
	\]

	Τότε:
	\[
	ce^{At}x^* = \left[\begin{matrix}
	3 & 0
	\end{matrix}\right] \left[\begin{matrix}
	e^{-2t} & 0 \\ 0 & e^{-t}
	\end{matrix}\right]\left[\begin{matrix}
	0 \\ 1
	\end{matrix}\right]
	= 0
	\]
	δηλαδή η κατάσταση \( x^* \) δεν είναι παρατηρήσιμη. Άρα και το σύστημα
	\textbf{δεν είναι παρατηρήσιμο}.

	Στο σύστημα αυτό θεωρήσαμε μηδενική είσοδο \( u=0 \), αφού δεν
	επηρεάζει την παρατηρησιμότητα. Το σύστημα που προκύπτει δηλαδή
	είναι το:
	\begin{align*}
		\dot x_1 &= -2x_1 \\
		\dot x_2 &= -x_2 \\
		y &= 3x_1
	\end{align*}

	Στο παραπάνω σύστημα μετράμε την έξοδο \( y=3x_1 \). Η έξοδος αυτή
	εξαρτάται μόνο από το \( x_1 \), αφού η διαφορική εξίσωση του
	\( x_1 \) περιέχει μόνο την ίδια την \( x_1 \). Επιπλέον, η διαφορική
	εξίσωση του \( x_2 \) περιέχει μόνο την ίδια την \( x_2 \). Οι μεταβλητές
	κατάστασης αυτές δεν συνδέονται μεταξύ τους, και η έξοδος σχετίζεται
	μόνο με την \( x_1 \). Επομένως το αποτέλεσμα που είναι πως
	το σύστημα δεν είναι παρατηρήσιμο, είναι λογικό, καθώς δεν υπάρχει
	τρόπος να εξάγουμε ελάχιστη πληροφορία για το \( x_2 \), δεδομένης
	μόνο της εξόδου.
\end{exercise}

\subsubsection{Κριτήρια Παρατηρησιμότητας}
Έστω μία μη παρατηρήσιμη κατάσταση \( x^* \neq 0 \) για την οποία
ισχύει \( Ce^{At} x^* = 0,\ \forall t\geq 0 \).

Σε προηγούμενα κεφάλαια διαπιστώσαμε ότι: \todo{where?}
\[
e^{At} = c_0(t) I + c_1(t)A + \dots + c_{n-1}(t)A^{n-1}
\]
\todo{what is n?}
αρα, αντικαθιστώντας θα έχουμε:
\[
Ce^{At} x^* = 0 \implies
\left[
c_0(t) C + c_1(t)CA + \dots + c_{n-1}(t)CA^{n-1}
\right]x^* = 0,\quad \forall t \geq 0
\]

Η παραπάνω σχέση ισχύει για τα μη παρατηρήσιμα συστήματα. Το ότι δίνει
άθροισμα 0, σημαίνει (από την ιδιότητα του εσωτερικού γινομένου) πως
το \( x^* \) και ο όρος \( \left[
c_0(t) C + c_1(t)CA + \dots + c_{n-1}(t)CA^{n-1}
\right] \) είναι μεταξύ τους \textbf{κάθετα}. Αν οι επιμέρους όροι
είναι γραμμικά ανεξάρτητοι μεταξύ τους, τότε και το \( x^* \) θα
πρέπει να είναι κάθετο με τον κάθε έναν από αυτούς, κάτι που δεν
μπορεί να ισχύει για \( n \) διαστάσεις. \todo{???}

Επομένως, μπορούμε να ορίσουμε έναν πίνακα \( W \) ως εξής:
\[
W = \left[\begin{matrix}
C \\ CA \\ \vdots \\ CA^{n-1}
\end{matrix}\right]
\]
που ονομάζεται \textbf{πίνακας παρατηρησιμότητας}.

Ανν \( \mathop{rank}(W) < n \), τότε το σύστημα \textbf{δεν είναι παρατηρήσιμο}. Ανν \( \mathop{rank}(W) = n \), τότε το σύστημα
\textbf{είναι παρατηρήσιμο}.

\begin{exercise}
	Έστω το σύστημα:\[
	\dot x = \left[\begin{matrix}
	-k_0 -k_1 & k_1 \\ k_2 & -k_2
	\end{matrix}\right]x + \left[\begin{matrix}
	k_0 \\ 0
	\end{matrix}\right]u
	\]
	με έξοδο \( y= \left[\begin{matrix}
	1 & 0
	\end{matrix}\right]x \).

	Είναι παρατηρήσιμο;
	\tcblower
	Έχουμε 2 μεταβλητές κατάστασης, άρα η τάξη του συστήματος είναι
	\( n = 2 \).

	Ο πίνακας παρατητησιμότητας είναι:
	\[
	W = \left[\begin{matrix}
	C \\ CA
	\end{matrix}\right] = \left[\begin{matrix}
	1 & 0 \\ -k_0-k_1 & k_1
	\end{matrix}\right]
	\]
	και η ορίζουσά του \( \det(W) = k_1 \).

	Αν \( \det(W) \neq 0 \iff k_1 \neq 0 \), τότε το σύστημα είναι παρατηρήσιμο.
\end{exercise}

\subsubsection{Σε παράλληλα συνδεδεμένα συστήματα}
Έστω ότι έχουμε δύο παράλληλα συνδεδεμένα γραμμικά συστήματα
\( A_1,B_1,C_1 \) και \( A_2,B_2,C_2 \).
\todo{Graph 39}

Τα παράλληλα συνδεδεμένα συστήματα έχουν κοινή είσοδο \( u \), και
η έξοδός τους \( y \) είναι το άθροισμα των επιμέρους εξόδων \( y_1 \)
και \( y_2 \).

Σε μορφή πινάκων, αυτό μπορεί να εκφραστεί ως εξής:
\begin{align*}
	\dot x &= \left[\begin{matrix}
	A_1 &0 \\ 0 & A_2
	\end{matrix}\right]x + \left[\begin{matrix}
	B_1 \\ B_2
	\end{matrix}\right]u \\
	y &= \left[\begin{matrix}
	C_1 & C_2
	\end{matrix}\right]
\end{align*}
και η έξοδος είναι:
\begin{align*}
	y &= C_1 \left[
	e^{A_1t}x_1(0) + \int_{0}^{t} e^{A_1(t-τ)}B_1u(τ)\dif τ
	\right] + C_2\left[
	e^{A_2t} x_2(0) + \int_{0}^{t} e^{A_2(t-τ)}B_2u(τ)\dif τ
	\right]
\end{align*}

Για \textit{απλούστευση} του προβλήματος θεωρούμε ίσες σταθερές, δηλαδή:
\begin{align*}
	C_1=C_2&=C\\
	A_1=A_2&=A
\end{align*}
επομένως η έξοδος θα γίνει:
\[
y = Ce^{At} \left[
x_1(0)+x_2(0)
\right]+\int_{0}^{t}Ce^{A(t-τ)}(B_1+B_2)u(τ)\dif τ
\]

Αν επιλέξουμε τιμές των \( x_1(0) \) και \( x_2(0) \) που καθιστούν
σταθερό το άθροισμα \( x_1(0)+x_2(0) \), τότε δεν θα είναι δυνατόν να
καταλάβουμε τις επιμέρους τιμές των \( x_1(0),x_2(0) \), επομένως
δεν είναι δυνατόν το σύστημα να είναι παρατηρήσιμο.

\subsubsection{Δυαδικά συστήματα}
Έστω ένα σύστημα:
\[(Σ_1)
\begin{cases}
\dot x &= Ax + Bu\\
y &= Cx+Du
\end{cases}
\]
με αρχική τιμή \( x(0) = x_0 \).

Έστω και το σύστημα \( (Σ_2) \):
\[
(Σ_2) \begin{cases}
\bar{\dot x} &= A^{\mathrm T}\bar x + C^{\mathrm T} u\\
\bar y &= B^{\mathrm T} \bar x + D^{\mathrm T} u
\end{cases}
\]

Πότε είναι το σύστημα \( (Σ_1) \) \textbf{ελέγξιμο}, και πότε είναι
το \( (Σ_2) \) \textbf{παρατηρήσιμο}; Θεωρούμε τους πίνακες ελεγξιμότητας
και παρατηρησιμότητας των συστημάτων, όπως ορίζονται συναρτήσει των
σταθερών τους:
\begin{align*}
	(Σ_1) \text{ ελέγξιμο} &\implies \rank\left(
	\left[\begin{matrix}
	B & AB & \dots & A^{n-1}B\end{matrix}
	\right]
	\right) = n\\
	(Σ_2) \text{ παρατηρήσιμο} &\implies \rank\left(
	\left[\begin{matrix}
	B^{\mathrm T} \\
	B^{\mathrm T}A^{\mathrm T}\\
	\vdots \\
	B^{\mathrm T} (A^{\mathrm{T}})^{n-1}
	\end{matrix}
	\right]
	\right) = n\\
	(Σ_2) \text{ ελέγξιμο}
	&\implies \rank\left(\left[\begin{matrix}
	C^{\mathrm T} & A^{\mathrm T}C^{\mathrm T} & \dots &
	(A^{\mathrm T})^{n-1} C^{\mathrm T}
	\end{matrix}
	\right]\right) = n
	\\ &\iff \rank\left(
	\left[
	\begin{matrix}
	C \\ CA \\ \vdots \\ CA^{n-1}
	\end{matrix}
	\right]
	\right) = n \iff (Σ_1) \text{ παρατηρήσιμο}\\
	(Σ_2) \text{ παρατηρήσιμο} &\xRightarrow{\dots}
	(Σ_1) \text{ ελέγξιμο}
\end{align*}

\todo{prettify}

Παρατηρούμε εδώ πως η \textit{ελεγξιμότητα} του \( (Σ_1) \) οδηγεί στην
\textit{παρατηρησιμότητα} του \( (Σ_2) \), και το αντίστροφο. Τα
συστήματα \( (Σ_1) \) και \( (Σ_2) \) που ικανοποιούν αυτήν την
ιδιότητα ονομάζονται \textbf{δυαδικά συστήματα}.
Αυτή η ιδιότητα μπορεί να χρησιμοποιηθεί για την επαλήθευση μιας από
αυτές τις ιδιότητες μέσω του δυαδικού συστήματος, όταν είναι δύσκολη
η απ' ευθείας μελέτη της.

Ταυτόχρονα, η δυαδικότητα αυτή μας προϊδεάζει για την ύπαρξη μιας
παρατηρήσιμης κανονικής μορφής, όπως υπήρχε η ελέγξιμη κανονική μορφή, η
οποία θα είναι πιο εύκολη στη χρήση κατά τον σχεδιασμό των παρατηρητών.

Έτσι, η \textbf{παρατηρήσιμη κανονική μορφή} είναι η εξής:
\begin{align*}
	\dot z &= \left[\begin{matrix}
	-a_1 & 1 & 0 &0& \dots & 0\\
	-a_2 & 0 & 1 & 0& \dots & 0\\
	\vdots & \vdots & \vdots &\vdots & \ddots & \vdots \\
	-a_n & 0 & 0 & \dots & 1 & 0
	\end{matrix}\right]z + \left[\begin{matrix}
	b_1 \\ b_2 \\ \vdots \\ b_n
	\end{matrix}\right]u\\
	y &= \left[\begin{matrix}
	1 & 0 & \dots & 0
	\end{matrix}\right]z + Du
\end{align*}

Εδώ προκύπτει το ερώτημα πώς μεταβαίνουμε από ένα \textbf{απαραίτητα παρατηρήσιμο} σύστημα στην ελέγξιμη κανονική μορφή του.

Από τα παραπάνω, έχουμε ότι \( (Σ_1) \text{ παρατηρήσιμο} \implies
(Σ_2)\text{ ελέγξιμο} \). Επομένως πρώτα πρέπει να επιβεβαιώσουμε (μέσω
του πίνακα παρατηρησιμότητας) ότι το \( (Σ_1) \) είναι
παρατηρήσιμο. Μπορούμε να βρούμε την \textit{ελέγξιμη κανονική
μορφή} του \( (Σ_2) \) (αν δεν την έχουμε ήδη) χρησιμοποιώντας τον πίνακα μετασχηματισμού
\( T = \tilde M M^{-1} \). Και τότε, βρίσκουμε το \textit{δυαδικό} της
ελέγξιμης κανονικής μορφής του \( (Σ_2) \). Το σύστημα που θα βρούμε
από την τελευταία αυτή διαδικασία θα είναι στην \textit{παρατηρήσιμη κανονική μορφή}.

\paragraph{Για μη παρατηρήσιμα συστήματα}
Έστω \( W \) ο πίνακας παρατηρησιμότητας ενός συστήματος, και έστω ότι
αυτός ο πίνακας τυχαίνει να ικανοποιεί \( \rank(W) = n_0 < n \), δηλαδή
το αντίστοιχο σύστημά του \textbf{δεν είναι παρατηρήσιμο}. Τότε μπορούμε
να \textbf{χωρίσουμε} το σύστημα σε ένα ελέγξιμο και ένα μη ελέγξιμο κομμάτι.

\begin{theorem}{}{}
	Έστω ένα \textbf{μη ελέγξιμο} γραμμικό σύστημα που προσδιορίζεται
	από τους συντελεστές \( (A,C) \). Τότε υπάρχει κάποιος \textit{μη ιδιόμορφος} (αντιστρέψιμος) πίνακας μετασχηματισμού:
	\[
	\left[\begin{matrix}
	\dot z_1 \\ \dot z_2
	\end{matrix}\right] = \left[\begin{matrix}
	A_1 & 0 \\ A_{12} & A_{2}
	\end{matrix}\right]\left[\begin{matrix}
	z_1 \\ z_2
	\end{matrix}\right] + \left[\begin{matrix}
	B_1 \\ B_2
	\end{matrix}\right]u
	\]
	και αντίστοιχα για την έξοδο:\[
	y = \left[ \begin{matrix}
	c_1 & 0
	\end{matrix} \right]\left[\begin{matrix}
	z_1 \\ z_2
	\end{matrix}\right] + Du
	\]
	\todo{add}
\end{theorem}

Με αυτό το θεώρημα, η μεταβλητή \( z_1 \) ουσιαστικά καθίσταται ανεξάρτητη
από τη \( z_2 \), αφού στην εξίσωση κατάστασής της ο συντελεστής του
\( z_2 \) είναι 0.

\lecture{17}{9/5/2018}

\paragraph{Εκτίμηση των καταστάσεων}
Θεωρούμε ένα παρατηρήσιμο σύστημα:
\begin{align*}
	\dot x &= Ax + Bu\\
	y &= Cx
\end{align*}
όπου θεωρήσαμε πως \( D= 0 \), για λόγους απλότητας. Η υπόθεση που κάνουμε
είναι ότι γνωρίζουμε την είσοδο, την έξοδο, τους πίνακες \( A,B,C \), αλλά
δεν μπορούμε να μετρήσουμε τις καταστάσεις \( x_1 \) και \( x_2 \).

Έστω \( \hat x \) η \textbf{εκτίμηση} των καταστάσεων \( x \):
\begin{equation}
\label{eq:sec5approx}
\dot{\hat{x}} = A\hat x + Bu
\end{equation}
αυτό είναι εύκολο να βρεθεί αν γνωρίζουμε την αρχική τιμή \( \hat x(0) = \hat x_0 \).

Ορίζουμε το \textbf{σφάλμα} \( \tilde x \) της εκτίμησης ως εξής:
\[
\tilde x = x-\hat x
\]
άρα, κάνοντας πράξεις στην \eqref{eq:sec5approx}:
\[
\dot{\tilde{x}} = \dot x - \dot{\tilde{x}}
\implies \dot{\tilde{x}} = Ax + Bu - A\hat x -Bu
\implies \boxed{\dot{\tilde{x}} = A\tilde x}
\]

Η παραπάνω ονομάζεται \textbf{διαφορική εξίσωση σφάλματος}, και δεν μπορούν
τα μέλη της να μετρηθούν, αφού δεν μπορεί να μετρηθεί το \( x \), άρα
και το σφάλμα.

Από αυτήν παρατηρούμε ότι και το \( \tilde x \) θα τείνει στο 0, αφού
η διαφορική εξίσωση σφάλματος αντιστοιχεί ουσιαστικά στη διαφορική εξίσωση
του συστήματος. Το ότι το σφάλμα γίνεται 0, σημαίνει ότι \( \hat x \to x \), για \( t \to \infty \). Πρακτικά δηλαδή έχουμε λύσει το πρόβλημα της
εκτίμησης, αφού έχουμε βρει μια εκτίμηση που να τείνει στην πραγματικότητα.

Όμως το πρόβλημα δεν έχει λυθεί εντελώς, καθώς δεν μπορούμε να ελέγξουμε την \textit{ταχύτητα} με την οποία η εκτίμηση τείνει στην πραγματική τιμή, αφού αυτό εξαρτάται από τον πίνακα \( A \) του αρχικού συστήματος, τον οποίο δεν μπορούμε να επηρεάσουμε. Επιπλέον, αν ο \( A \) έχει ιδιοτιμές
στα δεξιά, δηλαδή το σύστημα είναι ασταθές, τότε ούτε η εκτίμηση θα
μπορεί να βρεθεί με τον παραπάνω τρόπο.

Επομένως, θεωρούμε έναν διαφορετικό ελεγκτή για την εκτίμηση:
\[
\boxed{\dot{\hat x} = A\hat x + Bu + L(y-C\hat x)}
\]
όπου θεωρήσαμε έναν πίνακα \( L \) τον οποίο \textbf{έχουμε επιλέξει} εμείς.

Άρα τότε, κάνοντας πράξεις στην \eqref{eq:sec5linconc}:
\begin{align*}
	\dot{\tilde x} &= Ax + Bu - A\hat x - Bu - L(y-C\hat x)\\
	\dot{\tilde x} &\overset{y=Cx}{=} A\tilde x - LC(x-\hat x)\\
	\dot{\tilde x}&= A\tilde{x} - LC\tilde x\\
	\Aboxed{
		\dot{\tilde x} &= (A-LC)\tilde x
		}
\end{align*}
\todo{prettify}

Εδώ ουσιαστικά μπορούμε να επηρεάσουμε την ταχύτητα σύγκλισης της εκτίμησης,
κάνοντας κατάλληλες επιλογές και για τον πίνακα \( L \). Οι επιμέρους
συντελεστές του \( L \) μπορούν να υπολογιστούν με βάση το παρακάτω Θεώρημα.

\begin{theorem}{}{}
	Αν έχουμε ένα γραμμικό σύστημα (ζεύγος \( (A,C) \)) το οποίο είναι
	παρατηρήσιμο με πίνακα παρατηρησιμότητας \( W \) και χαρακτηριστικό
	πολυώνυμο \( p(s) = s^n + a_1s^{n-1} + \dots + a_{n-1}s + a_n \),
	τότε ο παρατηρητής μπορεί να είναι της μορφής:
	\[
	\boxed{\dot{\tilde x} = (A-LC)\tilde x}
	\]
	όπου:
	\[
	L = W^{-1}\tilde W \left[\begin{matrix}
	p_1 - a_1 \\ \vdots \\ p_n - a_n
	\end{matrix}\right]
	\]
	και:
	\[
	W = \left[\begin{matrix}
	C \\ CA \\ \vdots \\ CA^{n-1}
	\end{matrix}\right],\qquad \tilde W = \left[\begin{matrix}
	1 & 0 & 0 & \hdots & 0\\
	a_1 & 1 & 0 & \hdots & 0\\
	a_2 & a_1 & 1 & \hdots & 0\\
	\vdots & \vdots & \vdots & \ddots & \vdots \\
	a_{n-1} & a_{n-2} & a_{n-3} & \hdots & 1
	\end{matrix}\right]^{-1}
	\]
	με το επιθυμητό χαρακτηριστικό πολυώνυμο του παρατηρητή να είναι:
	\begin{gather*}
		p_d(s) = s^n + p_1s^{n-1} + \dots + p_{n-1}s+p_n
	\end{gather*}
\end{theorem}

Εδώ παρατηρούμε και τη σχέση με την αντίστοιχη διαδικασία για την ελεγξιμότητα του συστήματος. Οι δυαδικοί πίνακες για την ελεγξιμότητα και
την παρατηρησιμότητα:
\[
\boxed{\begin{aligned}
	A &\leftrightarrow A^{\mathrm T} \\
	C &\leftrightarrow C^{\mathrm T} \\
	K &\leftrightarrow L \\
	M &\leftrightarrow W
	\end{aligned}}
\]

\begin{exercise}
	Έστω το γραμμικό σύστημα:
	\begin{align*}
		\dot x &= \underbrace{\left[\begin{matrix}
		-k_0 - k_1 & k_1 \\ k_2 & -k_2
		\end{matrix}\right]}_{A} + \left[\begin{matrix}
	b_0 \\ 0
	\end{matrix}\right]u\\
	y &= \left[\begin{matrix}
	1 & 0
	\end{matrix}\right]x
	\end{align*}

	Να σχεδιαστεί παρατηρητής του.
	\tcblower
	Έστω ο πίνακας παρατηρησιμότητας του συστήματος:
	\[
	W = \left[\begin{matrix}
	C \\ CA
	\end{matrix}\right] = \left[\begin{matrix}
	1 & 0 \\ -k_0-k_1 & k_1
	\end{matrix}\right]
	\]

	Για να είναι το σύστημα παρατηρήσιμο, θα πρέπει \( \det(W) \neq 0 \iff k_1 \neq 0 \).

	Το χαρακτηριστικό πολυώνυμο του συστήματος είναι:
	\begin{align*}
		p(s) &= \det(sI-A) \\&=
		s^2 + (k_0+k_1+k_2)s + k_0k_2
	\end{align*}
	και το επιθυμητό χαρακτηριστικό πολυώνυμο είναι:
	\[
	p_d(s) = s^2 + P_1 s + P_2
	\]

	Για εφαρμογή του θεωρήματος πρέπει να υπολογίσουμε τους πίνακες
	\( W^{-1} \) και \( \tilde W \):
	\begin{align*}
		W^{-1} &= \frac{1}{k_1} \left[\begin{matrix}
		k_1 & 0 \\ k_0 + k_1 & 1
		\end{matrix}\right]
		\\
		\tilde W &= \left[\begin{matrix}
		1 & 0 \\ k_0+k_1+k_2 & 1
		\end{matrix}\right]^{-1} = \left[\begin{matrix}
		1 & 0 \\ -k_0-k_1-k_2 & 1
		\end{matrix}\right]
	\end{align*}
	άρα ο πίνακας \( L \), σύμφωνα με το θεώρημα \todo{τάδε}, είναι:
	\begin{align*}
	L &= W^{-1} \tilde W \left[\begin{matrix}
	P_1 - k_0 - k_1 - k_2 \\ P_2 - k_0 k_2
	\end{matrix}\right]
	\\ &= \left[\begin{matrix}
	P_1 - k_0 - k_1 - k_2 \\
	\frac{P_2 - P_1k_2 + k_1k_2 + k_2^2}{k_1}
	\end{matrix}\right]
	\end{align*}

	Επομένως ο ελεγκτής του παρατηρητή είναι:
	\[
	\hat x = A\hat x + Bu + L(y-C\hat x)
	\]

	Σε αυτό το σημείο βέβαια πρέπει να αναφέρουμε πως αν δεν υπήρχε ο
	όρος \( k_1 \) στον παρονομαστή (που αποκλείει την περίπτωση
	\( k_1 = 0 \)), θα έπρεπε να αναφέρουμε ρητά τον περιορισμό
	\( k_1 \neq 0 \) που βρήκαμε παραπάνω, για να βεβαιωθούμε ότι το
	αποτέλεσμα ισχύει και το αρχικό σύστημα είναι όντως ελέγξιμο.

	Ο παρατηρητής αυτός μπορεί να υλοποιηθεί φυσικά σε λογισμικό χρησιμοποιώντας
	αριθμητικές μεθόδους επίλυσης διαφορικών εξισώσεων.

	Βέβαια ο παρατηρητής έχει σχεδιαστεί με την προϋπόθεση ότι όλο
	το διάνυσμα κατάστασης είναι μη μετρήσιμο, επομένως κάνει επιπλέον
	δουλειά, προσπαθώντας να υπολογίσει το \( x_1 \) το οποίο είναι
	\textit{γνωστό}, αφού \( y = x_1 \).
\end{exercise}

\begin{exercise}
	Έστω το σύστημα:
	\begin{align*}
		\dot x &= \left[\begin{matrix}
		0 & 1 \\ 0 & 0
		\end{matrix}\right]x + \left[\begin{matrix}
		\gamma \\ 1
		\end{matrix}\right]u\\
		y &= \left[\begin{matrix}
		1 & 0
		\end{matrix}\right]x
	\end{align*}

	Να σχεδιαστεί παρατηρητής.
	\tcblower
	Για τον πίνακα παρατηρησιμότητας έχουμε:
	\[
			W = \left[\begin{matrix}
			C \\ CA
			\end{matrix}\right] =
	\]
	για τον οποίο ισχύει:
	\[
	\rank(W) = 2 = n
	\]

	Εδώ θα χρησιμοποιήσουμε μια πιο απλή διαδικασία για τον υπολογισμό
	του παρατηρητή, χωρίς να αξιοποιήσουμε όλη την παραπάνω θεωρία.

	Έστω λοιπόν ότι:
	\[
	L = \left[\begin{matrix}
	l_1 \\ l_2
	\end{matrix}\right]
	\]

	\[
	A - LC = \left[\begin{matrix}
	0 & 1 \\ 0 & 0
	\end{matrix}\right]-\left[\begin{matrix}
	l_1 \\ l_2
	\end{matrix}\right]\left[\begin{matrix}
	1 & 0
	\end{matrix}\right]
	\]
\end{exercise}

\todo{Add lecture 17 part 2}


\subsection{Ευρωστία}

\lecture{19}{18/5/2018}

\todo{Add lecture 18}

....

\[
\dot x = Ax + bu + f(x) + g(x) u
\]

\begin{align*}
	\left| f(x) \right| &\leq c_1|x| \\
	\left| g(x) \right| &\leq c_2|x|
\end{align*}
\( \forall x \in \mathbb R^n \)όπου γνωρίζουμε τους πίνακες \( A \) και \( B \), αλλά δεν
θεωρούνται γνωστές οι συναρτήσεις \( f(x) \) και \( g(x) \) και
οι σταθερές \( c_1 \) και \( c_2 \). Επίσης ο \( A = A^{\mathrm T} \) είναι
συμετρικός, κάτι που θεωρήσαμε για ευκολία.

Θεωρούμε τον ελεγκτή:
\[
u = -kx + v
\]
όπου:
\[
v = -γB^{\mathrm T}x,\ γ > 0
\]
και τη συνάρτηση Lyapunov:
\[
V(x) = \frac{1}{2} x^{\mathrm T} x
\]
με χρονική παράγωγο:
\begin{align*}
	\dot V &= x^{\mathrm T} \dot x
	\\ &= x^{\mathrm T} A x + x^{\mathrm T} B u + x^{\mathrm T}B u
	+ x^{\mathrm T} f(x) + x^{\mathrm T} g(x)u
	\\ &= x^{\mathrm T} A x - x^{\mathrm T} B k x - \gamma(x^{\mathrm T}B)(B^{\mathrm T} x) + x^{\mathrm T}f(x) + x^{\mathrm T}g(x)u
	\\ &= x^{\mathrm T}(A-Bk)x - \gamma\left| x^{\mathrm T}B \right|^2
	+ x^{\mathrm T}f(x) + x^{\mathrm T}g(x)u
\end{align*}

Σε αυτήν την ανάλυση αξιοποιήσαμε το γεγονός πως \( A=A^{\mathrm T} \).
Η απαίτηση όμως αυτή δεν είναι απαραίτητη, καθώς θα μπορούμε να χρησιμοποιήσουμε, για οποιονδήποτε πίνακα \( A \), το συμμετρικό του μέρος.

Αν θεωρήσουμε ότι ο \( A \) είναι ευσταθής, τότε ο όρος \( -kx \) στο \( u \) δεν χρειάζεται, ή μπορούμε με τη διόρθωση του \( k \) να θεωρήσουμε έναν πίνακα \( \tilde A \). \todo{what?}

Άρα έχουμε:
\begin{align*}
	\dot V &= x^{\mathrm T}(A-Bk)x
	- \gamma\left| x^{\mathrm T}B \right|^2
	+ x^{\mathrm T}f(x)
	+ x^{\mathrm T}g(x)u
	\\
    &=	\underbrace{x^{\mathrm T} \tilde A x}_{\leq \lambda_{\min} (\tilde A)|x|^2}
	- \gamma\left| x^{\mathrm T}B \right|^2
	+ \underbrace{x^{\mathrm T}f(x) }_{\leq |x|\left|f(x)\right|}
	+ \underbrace{\gamma x^{\mathrm T} g(x) \left| B^{\mathrm T} x \right|}_{\leq \gamma|x|\underbrace{\left| g(x) \right|}_{\leq c_2} \left| x^{\mathrm T} B \right|}
	\\ &\leq -\lambda_{\min}(\tilde A) |x|^2 - \gamma\left|x^{\mathrm T} B\right|^2  + c_1 |x|^2 + \gamma c_2|x|\left| x^{\mathrm{T}}B \right|
\end{align*}
όπου \( \lambda_{\min} \) η ελάχιστη ιδιοτιμή του αντίστοιχου πίνακα.

Σε μορφή πολλαπλασιασμού πινάκων, η παραπάνω σχέση γράφεται:
\[
\dot V \leq \left[\begin{matrix}
|x| & \left|x^{\mathrm T}B\right|
\end{matrix}\right]\left[\begin{matrix}
c_1 - \lambda_{\min}(\tilde A) & \frac{\gamma c_1}{2} \\
\frac{\gamma c_1}{2} & -\gamma
\end{matrix}\right]\left[\begin{matrix}
|x| \\ \left|x^{\mathrm T} B\right|
\end{matrix}\right]
\]
όπου για να είναι αρνητικά ημιορισμένος ο κεντρικός πίνακας (και κατ' επέκτασιν η \( \dot V \)), πρέπει να ισχύει:
\begin{align*}
	\lambda_{\min}(\tilde A) &> c_1 \\
	\gamma > \frac{4\left(\lambda_{\min} -c_1 \right)}{c_2^2}
\end{align*}

Η παραπάνω ανάλυση μας δίνει τους περιορισμούς που πρέπει να καλύπτονται από τον ελεγκτή που θα επιλέξουμε.
Παρατηρούμε όμως ότι οι περιορισμοί εξαρτώνται από τις τιμές των σταθερών \( c_1 \) και \( c_2 \), οι οποίες
δεν είναι γνωστές. Επομένως η παραπάνω ανάλυση μπορεί να χρησιμοποιηθεί μόνο όταν γνωρίζουμε το εύρος
στο οποίο ίσως να βρίσκονται αυτοί οι αριθμοί. Διαφορετικά, έχει μόνο υπαρξιολογική σημασία, δηλαδή δηλώνει
ότι ο ελεγκτής υπάρχει, ακόμα κι αν δεν μπορούμε να τον βρούμε εμείς.

\subsubsection{}
Έστω το σύστημα:
\begin{align*}
	\dot x &= Ax + Bu \\
	y &= Cx
\end{align*}
με έξοδο που τείνει σε μια επιθυμητή είσοδο \( y\to r \), για το οποίο χρησιμοποιούμε
τον ελεγκτή γραμμικής ανάδρασης καταστάσεων \( u=-kx + k_r r \).

\todo{Graph 40}

Εδώ ο όρος \( k_r \) λειτουργεί ως σταθερά \textbf{προσοτροφοδότησης}
που καθορίζει την επίδραση της εισόδου, και ο όρος \( k \) εκφράζει
την \textbf{ανάδραση}, και επηρεάζει τη \textit{δυναμική συμπεριφορά}
του συστήματος, την απόσβεση των διαταραχών, και κάποιον τρόπο
διορθώνει τα σφάλματα μοντελοποίησης. Τελικά δηλαδή έχουμε δύο \textbf{βαθμούς ελευθερίας} που καθορίζονται από τις σταθερές \( k \)
και \( k_r \).

\subsubsection{}
\todo{ρύθμισης ή σταθεροποίησης?}
Τα προβλήματα που λύσαμε ονομάζονται \textbf{προβλήματα ρύθμισης},
καθώς παρείχαμε σε αυτά μία \textbf{σταθερή} είσοδο, και θέλαμε το
σύστημα να \textbf{σταθεροποιηθεί} σε αυτήν.

\textbf{Προβλήματα παρακολούθησης} ονομάζονται τα προβλήματα στα οποία
θέλουμε η έξοδος του συστήματος να \textbf{παρακολουθεί} μια οποιαδήποτε
είσοδο \( r \) που μεταβάλλεται στο χρόνο.

Πρακτικά, τα προβλήματα ρύθμισης αποτελούν προβλήματα παρακολούθησης μιας σταθερής εισόδου.

Οι αναλύσεις που πραγματοποιήσαμε προηγουμένως αφορούσαν σταθερές εισόδους που υπολογίζονταν ως σταθερές στις παραγωγίσεις. Επομένως δεν θα
επιστρέψει σωστά αποτελέσματα για μεταβαλλόμενα \( r \).

Για την ανάλυσή μας, θα θεωρήσουμε ένα \textbf{επιθυμητό σύστημα}
που θα εκφράζει την έξοδο που θέλουμε από το αρχικό σύστημα:
\[
\dot x_d = A_d x_d + B_d(t)
\]
όπου το \textbf{σφάλμα} είναι:
\[
e = x - x_d
\]

Παραγωγίζοντας το σφάλμα, έχουμε:
\begin{align*}
	\dot e &= \dot x - \dot x_d \\
	&= Ax + Bu - A_dx_d - B_d r
\end{align*}
όπου μπορούμε να χρησιμοποιήσουμε έναν ελεγκτή της μορφής \( \boxed{u=-kx + u_0} \)
για να ελέγξουμε τις ιδιοτιμές και την ταχεία απόκριση (απόσβεση) του
σφάλματος, με τον όρο \( u_0 \) να χρησιμοποιείται για να φτάσουμε σε μια
επιθυμητή έξοδο.

Επομένως, το σύστημα σφάλματος θα γίνει:
\[
\dot e = (A-Bk) x + Bu_0 - A_d x_d - B_d r
\]
όπου οι πίνακες \( A,B \) είναι γνωστοί, και οι \( A_d , B_d , k , u_0 , r \)
μπορούν να επιλεγούν. θεωρούμε ότι \( B_d = B \). \todo{why?}

Για την ανάλυση του συστήματος σφάλματος, προσπαθούμε να το φέρουμε στη μορφή \( \dot e = \tilde A e + \tilde B\mathscr r \):
\[
\dot e = (A-Bk)x + B(u_0 - r) - A_d x_d
\]

Στο παραπάνω, δεν είναι επιθυμητός ο όρος \( A_d x_d \), άρα θεωρούμε πως
\( A_d = (A-Bk) \) (αφού το μητρώο \( A_d \) είναι επιλεγόμενο), και τελικά έχουμε:
\[
\dot e = A_d e + B(u_0 - r)
\]

\paragraph{}
Για ανάλυση της ευστάθειας του συστήματος, θεωρούμε την υποψήφια συνάρτηση Lyapunov:
\[
V(e) = \frac{1}{2} e^{\mathrm T}e
\]
με χρονική παράγωγο:
\[
\dot V = e^{\mathrm T} e = e^{\mathrm T} A_d e +e^{\mathrm T} B(u_0 - r)
\]

Εδώ για τον όρο \( e^{\mathrm T} B \) επιλέγουμε δύο περιπτώσεις:
\begin{itemize}
	\item Για \( e^{\mathrm T} B = 0 \), ισχύει \( \dot V = e^{\mathrm T} A_d < 0 \) θέτοντας ότι \( u_0 = 0 \) (αφού το \( u_0 \) μπορούμε εμείς να το επιλέξουμε), άρα το σύστημα είναι ευσταθές.
	\item Για \( e^{\mathrm T} B \neq 0 \), θα \textbf{θέσουμε}:
	\[
	u_0 = -\frac{B^{\mathrm T} e}{\left| B^{\mathrm T} e \right|}|r|
	\]
	και η παράγωγος της Lyapunov είναι:
	\begin{align*}
		\dot V &= e^{\mathrm T} A_d e -\frac{\left|e^{\mathrm T}B\right|^2}{\left|B^{\mathrm T}e\right|}|r| - e^{\mathrm T} B r
		\\ &\leq e^{\mathrm T}A_d e - \left| e^{\mathrm T}B \right||r|
		+ \left| e^{\mathrm T} B \right| |r|
		\\ &= e^{\mathrm T} A_d e < 0
	\end{align*}
	άρα το σύστημα είναι πάλι ευσταθές.
\end{itemize}

Επομένως, η τελική τιμή του \( u_0 \) για να έχουμε σύγκλιση του
συστήματος σφάλματος είναι:
\[
u_0 = \begin{cases}
-\frac{B^{\mathrm T}e}{\left| B^{\mathrm T}e \right|}|r|,
&\quad \text{για } e^{\mathrm T} B \neq 0 \\
0,&\quad \text{για } e^{\mathrm T} B = 0
\end{cases}
\]

Βέβαια υπάρχει ένα πρόβλημα γύρω από την επιφάνεια όπου
\( B^{\mathrm T}e \), στην οποία υπάρχει ασυνέχεια στην επιλογή του
\( u_0 \). Αν η ασυνέχεια αυτή δεν πραγματοποιείται σε πεπερασμένο
αριθμό σημείων, θα πραγματοποιείται ταλάντωση με συχνότητα τείνουσα στο
\( \infty \), με αποτέλεσμα να μη λειτουργεί ο ελεγκτής και να προκαλείται ένα φαινόμενο που ονομάζεται chattering.

Διαφορετικά το σφάλμα θα τείνει ασυμπτωτικά στο 0.

\paragraph{Διόρθωση chattering}
Για να αποφύγουμε το φαινόμενο του chattering, θεωρούμε έναν διαφορετικό
ελεγκτή για το \( u_0 \):
\[
u_0 = \begin{cases}
\frac{-B^{\mathrm T}e}{\delta}|r|, &\quad \text{για } \left|B^{\mathrm T} e\right| \leq \delta\\
\frac{-B^{\mathrm T} e}{\left| B^{\mathrm T} e \right|}|r|, &\quad \text{για } \left| B^{\mathrm T}e \right| > \delta
\end{cases}
\]

Ο ελεγκτής αυτός δημιουργεί μια "\textit{επικίνδυνη ζώνη}" εύρους \( δ \) γύρω
από την επιφάνεια ασυνέχειας. Αν κινούμαστε εκτός της επικίνδυνης περιοχής, θα μπορούμε να υπολογίσουμε κανονικά τον όρο, αν όμως βρεθούμε
εντός της (κάτι που θα γίνει σίγουρα, δεδομένου ότι \( e\to 0 \)),
θα περιορίσουμε την αύξηση της τιμής \( u_0 \) η οποία δεν θα ξεπεράσει
ένα μέγιστο ποσό.

\todo{Graph 41}

Τοποθετώντας αυτόν τον ελεγκτή στην παράγωγο της Lyapunov, έχουμε:
\begin{align*}
	\dot V &\leq e^{\mathrm T} A_d e - \frac{\left|e^{\mathrm T} B\right|^2}{\delta}|r| - e^{\mathrm T} B r
	\\ &\leq e^{\mathrm T} A_d e - \frac{\left| e^{\mathrm T} B \right|^2}{\delta} |r| + \left| e^{\mathrm T} B \right||r|
	\\ &= e^{\mathrm T} A_d e - \left| e^{\mathrm T}B \right||r|
	\left[
	\frac{\left| e^{\mathrm T}B \right|}{\delta} - 1
	\right]
	\\ &= e^{\mathrm T} A_d e + \left| e^{\mathrm T}B \right||r|\left[
	1 - \frac{\left| e^{\mathrm T} B \right|}{\delta}
	\right]
	\\ &\leq e^{\mathrm T} A_d e + \underbrace{\left| e^{\mathrm T} B \right|}_{\leq \delta}|r|
	\\ &\leq e^{\mathrm T} A_d e + \delta |r|
\end{align*}

Θεωρώντας ότι ο \( A \) είναι συμμετρικός, ή ότι τον χωρίζουμε σε ένα
αντισυμμετρικο και ένα αντισυμμετρικό μέρος,
και επειδή \( |r(t)| \leq \bar r \) για μια μέγιστη τιμή \( \bar r \)
που θεωρούμε,
θα έχουμε:
\begin{align*}
	\dot V &\leq - \lambda_{\min}(A_d) |e|^2 + \delta \bar r
\end{align*}

Για να είναι μη θετική η \( \dot V \), θέλουμε:
\[
|e|^2 > \frac{\delta \bar r}{\lambda_{\min}(A_d)}
\]
δηλαδή:
\[
|e| > \sqrt{\frac{
	\delta \bar r}{\lambda_{\min} (A_d) }}
\]
το οποίο οδηγεί σε ένα σύστημα \textbf{ομοιόμορφα τελικώς φραγμένο}, όπως
έχουμε δει και σε άλλα παραδείγματα.

Ορίζουμε το σύνολο που εκφράζει το εύρος τιμών εντός των οποίων θα κινείται \textbf{εγγυημένα} το σφάλμα \( e \) στη μόνιμη κατάσταση (μετά από πεπερασμένο χρόνο):
\[
\varepsilon = \left\lbrace
e \in \mathbb R^n :
|e| \leq \sqrt{
\frac{\delta \bar r}{\lambda_{\min} (A_d)}
}
 \right\rbrace
\]

Η μέγιστη τιμή του \( e \), δηλαδή το μέγιστο σφάλμα, εξαρτάται όπως βλέπουμε παραπάνω από την επιλογή της σταθεράς \( \delta \) του ελεγκτή \( u_0 \). Όσο πιο μικρή είναι, μειώνεται ανίστοιχα και το σφάλμα. Όμως δεν μπορούμε να επιλέξουμε αυθαίρετα τη σταθερά \( \delta \), γιατί όσο μειώνεται αυτή, αυξάνεται και η τιμή του \( u_0 \), η οποία δεν μπορεί να αυξηθεί αυθαίρετα, αφού οι πραγματικοί ελεγκτές μπορούν να δώσουν ένα μέγιστο πλάτος και μία μέγιστη ενέργεια, χωρίς να την ξεπεράσουν, αφού ψαλιδίζεται για λόγους τεχνικούς και λόγους ασφαλείας.

Βέβαια το σύνολο \( \varepsilon \) περιέχει τις τιμές εντός των οποίων παραμένουμε εγγυημένα, όμως είναι πιθανό το σφάλμα \( e \) να γίνει πολύ μικρό και πολύ κοντά στο 0.

\subparagraph{Με διαταραχές}
Αν θεωρήσουμε ένα σύστημα με διαταραχές \( d(t) \) φραγμένες από μια τιμή \( \bar d \) κλείνοντας το βρόχο με μια \( u = -kx + u_0  \), τότε:
\[
\dot x = (A-Bk) x + Bu_0 + Bd(t)
\]

Θεωρούμε την υποψήφια LyapunovQ
\begin{align*}
	V &= \frac{1}{2} x^{\mathrm T} x
	\\
	\dot{V} &= x^{\mathrm T} (A-Bk) x - x^{\mathrm T} B u_0
	+ x^{\mathrm T} B d(t)
	\\ &= x^{\mathrm T}(A-Bk)x + x^{\mathrm T} B (u_0 + d(t))
\end{align*}
Σε σχέση με το προηγούμε πρόβλημα, μας απασχολεί ο όρος \( x^{\mathrm T}B\left(u_0 + d(t)\right) \).
Αυτό αντιστοιχεί στον όρο \( e^{\mathrm T}B(u_0 - x) \)
Μπορούμε να εφαρμόσουμε τις παραπάνω επιλογές, και να έχουμε ακριβώς τα ίδια αποτελέσματα.

Παρατηρούμε πως χρησιμοπιώντας τον παραπάνω μη γραμμικό ελεγκτή, μπορούμε όχι μόνο να παρακολουθήσουμε μεταβαλλόμενες εισόδους, αλλά και να αποσβέσουμε χρονικά μεταβαλλόμενες διαταραχές.

\subparagraph{}
Βέβαια, μπορεί κανείς να αναρωτηθεί γιατί πραγματοποιήσαμε την παραπάνω ανάλυση, από τη στιγμή που μπορούσαμε να θέσουμε \( u_0 = r \) για να εξαλείψουμε τον όρο \( B(u_0 - r) \). Η επιλογή αυτή είναι δυνατή αφού η
\( r \) είναι γνωστή, και είναι απλούστερη.

Όμως σε αυτήν την περίπτωση, αν έρθουν διαταραχές, ο όρος θα γίνει
\( B\left(u_0 - (r+d)\right) \), άρα θα πρέπει \( u_0 = r + d \), κάτι
που δεν μπορεί να υλοποιηθεί, αφού το \( d \) είναι άγνωστο. Επομένως δεν
μπορούν να αποσβεστούν οι διαταραχές.

Δηλαδή πληρώνουμε την πολυπλοκότητα, αλλά κερδίζουμε την απόσβεση διαταραχών.

\lecture{20}{23/5/2018}

\section{Ασκήσεις}

\begin{exercise}
	\todo{???}
	Έστω το σύστημα με \textbf{μεταβαλλόμενη διαταραχή}.

	Να σχεδιαστεί ελεγκτής.
	\tcblower
	Επιλέγουμε τον ελεγκτή:
	\todo{???}
	\[
	u = -kx + u_0
	\]
	όπου
	\begin{align*}
		u_0 &= -\gamma(PB)^{\mathrm T}x\\&= -\gamma cx - \gamma y
	\end{align*}
	για \( \gamma >0 \).

	Έστω η υποψήφια συνάρτηση Lyapunov:\[
	V = x^{\mathrm T} P x
	\]
	με χρονική παράγωγο:
	\begin{align*}
		\dot V &= \frac{1}{2}
		x^{\mathrm T} \left[
		(A-Bk)^{\mathrm T}P + P(A-Bk)
		\right]x + x^{\mathrm T} P Bu_0
		+ x^{\mathrm T}PBd(t)
		\\ &= -\frac{1}{2}x^{\mathrm T}Qx
		+x^{\mathrm T}(PB)u_0 + x^{\mathrm T} PB d(t)
		\\ &= -\frac{1}{2}x^{\mathrm T}Qx - \gamma |y|^2 + yd(t)
	\end{align*}

\end{exercise}

\begin{exercise}
	Έστω το σύστημα:
	\begin{align*}
		\dot x &= \left[\begin{matrix}
		-a_1 & -a_2 \\ 1 & 0
		\end{matrix}\right]x + \left[\begin{matrix}
		1 \\ 0
		\end{matrix}\right]u + \left[\begin{matrix}
		1 \\ 0
		\end{matrix}\right]d \\
		y &= \left[\begin{matrix}
		0 & 1
		\end{matrix}\right]x
	\end{align*}

	Να σχεδιαστεί ελεγκτής έτσι ώστε η έξοδος να τείνει σε μια επιθυμητή είσοδο \( y \to r \), με τις διαταραχές \( d \) να έχουν εξαλειφθεί.

	Θεωρούμε ότι η διαταραχή \( d \) είναι σταθερή.

	\paragraph{}
	Επίσης θεωρήστε πως υπάρχει μια ασάφεια στη σταθερά \( a_1 \).
	Είναι γνωστή κάποιες τιμές \( \overline{a_1} \), αλλά η πραγματική σταθερά είναι:
	\[
	a_1 = \overline{a_1} + \delta
	\]
	όπου \( \delta \) ένας όρος ασάφειας.

	Να διαπιστωθεί ποιά είναι η μέγιστη τιμή του \( δ \) έτσι ώστε η σχεδίαση που πραγματοποιήσαμε παραπάνω να συνεχίζει να ισχύει.

	\tcblower
	Για να δούμε αν μπορεί να σχεδιαστεί τέτοιος ελεγκτής, \textbf{πρέπει} πρώτα να εξετάσουμε
	την ελεγξιμότητα του συστήματος.

	Το σύστημα βρίσκεται ήδη στην \textit{ελέγξιμη κανονική μορφή}, επομένως
	είμαστε βέβαιοι πως είναι ελέγξιμο.

	Αφού θέλουμε το σύστημα να εξαλείφει εντελώς τις διαταραχές, θα χρησιμοποιήσουμε ελεγκτή \textit{δυναμικής ανάδρασης καταστάσεων},
	δηλαδή:
	\begin{align*}
		u &= -k_1x_1 -k_2 x_2 -k_i z\\
		\dot z &= y-r = x_2 - r
	\end{align*}
	και, μετά από πράξεις, τελικά το σύστημα θα γίνει:
	\[
	\left[\begin{matrix}
	\dot x_1 \\ \dot x_2 \\ \dot z
	\end{matrix}\right] = \left[\begin{matrix}
	-a_1-k_1 & -a_2-k_2 & -k_i \\
	1 & 0 & 0\\
	0 & 1 & 0
	\end{matrix}\right]\left[\begin{matrix}
	x_1 \\ x_2 \\ z
	\end{matrix}\right] + \left[\begin{matrix}
	1 \\ 0 \\ 0
	\end{matrix}\right]d + \left[\begin{matrix}
	0 \\ 0 \\ -1
	\end{matrix}\right]r
	\]

	Τις σταθερές \( k_1,k_2,k_i \) μπορούμε να βρούμε τοποθετώντας τις ιδιοτιμές του πίνακα σε επιθυμητά σημεία. Χρησιμοποιούμε το χαρακτηριστικό πολυώνυμο του συστήματος κλειστού βρόχου, που είναι:
	\[
	p_c(s) = s^3 + (a_1+k_1)s^2 + (a_2+k_2)s + k_i
	\]
	και θέλουμε να είναι ίσο με ένα επιθυμητό πολυώνυμο \( p_d \).

	Εδώ θα επιλέξουμε για λόγους απλότητας το τελικό σύστημα να έχει 3
	πόλους στο ίδιο σημείο \( -λ \), δηλαδή το επιθυμητό χαρακτηριστικό πολυώνυμο
	να είναι της μορφής:
	\[
	p_d(s) = (s+λ)^3 = s^3 + 3λs^2 + 3λ^2s + λ^3
	\]

	Επομένως, εξισώνοντας τους συντελεστές:
	\begin{align*}
		a_1 + k_1 = 3λ \implies \Aboxed{k_1 &= 3λ-a_1}\\
		a_2 + k_2 = 3λ^2 \implies \Aboxed{k_2 &= 3\lambda^2 - a_2} \\
		\Aboxed{k_i &= \lambda^3}
	\end{align*}

	\tcbsubtitle{Λύση με διαταραχές}
	Αντικαθιστούμε στις τελευταίες σχέσεις:
	\begin{align*}
	\bar{a_1} + k_1 = 3λ \implies \Aboxed{k_1 &= 3λ-\bar{a_1}}\\
	a_2 + k_2 = 3λ^2 \implies \Aboxed{k_2 &= 3\lambda^2 - a_2} \\
	\Aboxed{k_i &= \lambda^3}
	\end{align*}
	επομένως το χαρακτηριστικό πολυώνυμο θα γίνει:
	\[
	p_c(s) = s^3 + (δ+3λ)s^2 + 3λ^2s + λ^3
	\]
	το οποίο, όπως είναι αναμενόμενο, εξαρτάται από την επιλογή μας του \( λ \) και την αβεβαιότητα \( δ \).

	Το ότι ισχύει η σχεδίασή μας, σημαίνει ουσιαστικά πως οι πόλοι συνεχίζουν να παραμένουν στο αριστερό ημιεπίπεδο, έτσι ώστε να έχουμε
	ευστάθεια. Για να το διαπιστώσουμε αυτό χρησιμοποιούμε κριτήριο Routh-Hurwitz.

	Από αυτό προκύπτει η τελική συνθήκη:
	\[
	\boxed{δ > -2.4λ}
	\]
	\todo{check}
\end{exercise}

\begin{exercise}
	Έστω το σύστημα:
	\begin{align*}
		\left[\begin{matrix}
		\dot x_1 \\ \dot x_2 \\ \dot x_3
		\end{matrix}\right] = \left[\begin{matrix}
		1 & 1 & 1 \\ 0 & -1 & 2 \\
		0 & 0 & -2
		\end{matrix}\right]\left[\begin{matrix}
		x_1 \\ x_2 \\ x_3
		\end{matrix}\right] + \left[\begin{matrix}
		1 \\ 0 \\ 0
		\end{matrix}\right]
	\end{align*}

	\begin{itemize}
		\item Να διαπιστωθεί η αστάθειά του.
		\item Να σχεδιαστεί ο \textbf{απλούστερος} ελεγκτής γραμμικής ανάδρασης καταστάσεων:
		\[
		u = -k_1 x_1 - k_2x_2 -k_3x_3
		\]
	    που να οδηγεί στην ασυμπτωτική ευστάθεια, με την πιο αργή ιδιοτιμή
	    να έχει τιμή το πολύ \( -1 \).

	    "\textit{Απλούστερος}" θεωρείται ο ελεγκτής που μετράει τις λιγότερες
	    καταστάσεις.
	\end{itemize}
    \tcblower
    \begin{itemize}
    	\item Ο πίνακας είναι άνω τριγωνικός, άρα οι ιδιοτιμές του βρίσκονται στην κύρια διαγώνιο, και είναι:
    	\[
    	1,\ -1,\ -2
    	\]

    	Η ιδιοτιμή \( +1 \) είναι η αιτία που το σύστημα είναι ασταθές.
    	\item Αντικαθιστώντας το \( u \), το σύστημά μας θα γίνει:
    	\[
    	\dot x = \left[\begin{matrix}
    	1-k_1 & 1-k_2 & 1-k_3 \\
    	0 & -1 & 2 \\
    	0 & 0 & -2
    	\end{matrix}\right]
    	\]

    	Οι ιδιοτιμές του θα είναι (αφού έχουμε άνω τριγωνικό πίνακα):
    	\[
    	1-k_1, \ -1,\ -2
    	\]
    	επομένως αρκεί να δώσουμε κάποια τιμή μόνο στο \( k_1 \) για να
    	καταστήσουμε ευσταθές το σύστημα, αφού οι παράγοντες \( k_2,k_3 \)
    	δεν επηρεάζουν τις ιδιοτιμές του. Επομένως θεωρούμε \( k_2 = 0, k_3 = 0 \).

    	Πρέπει να έχουμε το πολύ \( -1 \) ιδιοτιμή, άρα:
    	\[
    	1-k_1 < -1 \implies \boxed{k_1 > 2}
    	\]
    	άρα ο ελεγκτής είναι:
    	\[
    	u = -k_1x_1
    	\]
    \end{itemize}
\end{exercise}

\begin{exercise}
	Δίνεται το παρακάτω σύστημα:
	\begin{align*}
        \dot x_1 &= -x_1 + x_2\\
        \dot x_2 &= (x_1+x_2)\sin x_1 - 3x_2
	\end{align*}

	\begin{enumerate}
		\item Να διαπιστωθεί ότι το \( (0,0) \) είναι το μοναδικό του σημείο ισορροπίας.
		\item Να γραμμικοποιηθεί γύρω από το \( (0,0) \) και να αποδειχθεί
		ότι το σημείο ισορροπίας είναι τοπικά ασυμπτωτικά ευσταθές.
		\item Να δείξετε ότι το \( (0,0) \) είναι ολικά ασυμπτωτικά ευσταθές.
	\end{enumerate}
\tcblower

    \begin{enumerate}
    	\item Για την εύρεση του σημείου ισορροπίας πρέπει να μηδενίσουμε
    	τις παραγώγους:
    	\begin{align*}
    		x_1 &= x_2 \implies 2x_2\sin x_2 - 3x_2 = 0\\
    		\implies x_2\underbrace{(2\sin x_2 - 3)}_{\neq 0} & = 0
    		\implies x_2 = 0
    	\end{align*}
    	άρα τελικά:
    	\[
    	x_1 = x_2 = 0
    	\]
    	και επιβεβαιώνεται ότι το μοναδικό σημείο ισορροπίας είναι το
    	\( (0,0) \).

    	\item Για τη γραμμικοποίηση, θεωρούμε τις ιακωβιανές παραγώγους των πινάκων:
    	\begin{align*}
    		\pd{F}{x} = \left[\begin{matrix}
    		-1 & 1 \\ \sin x_1 + (x_1+x_2)\cos x_1 & \sin x_1 - 3
    		\end{matrix}\right]
    		\implies \left.\pd{F}{x} \right|_{(0,0)} = \left[\begin{matrix}
    		-1 & 1 \\ 0 & -3
    		\end{matrix}\right]
    	\end{align*}

    	Ο πίνακας αυτός είναι άνω τριγωνικός με ιδιοτιμές \( -1 \), \( -3 \). Αφού είναι αρνητικές, το σύστημα είναι ασυμπτωτικά ευσταθές στη γειτονιά του \( (0,0) \).

    	\item Επιλέγουμε την υποψήφια συνάρτηση Lyapunov που είναι θετικά
    	ορισμένη:
    	\[
    	V(x_1,x_2) = \frac{1}{2}x_1^2 + \frac{1}{2} x_2^2
    	\]
    	με χρονική παράγωγο:
    	\begin{align*}
    		\dot V &= x_1 \dot x_1 + x_2\dot x_2
    		\\ &= x_1(-x_1+x_2) + x_2\left[
    		(x_1+x_2)\sin x_1 - 3x_2
    		\right]
    		\\ &= -x_1^2 + x_1x_2
    		+ x_1x_2\sin x_1 + x_2^2\sin x_1 - 3x_2^2
    		\\ &= -x_1^2-2x_2^2 - x_2^2 + x_1x_2 + \sin x_1 \left(
    		x_1x_2 + x_2^2
    		\right)
    		\\ &= -x_1^2 -2x_2^2 + x_1x_2(1+\sin x_1)+x_2^2(\sin x_1 - 1)
    	\intertext{επειδή ο όρος \( \sin x_1 - 1 \) είναι \( \leq 0 \)
    	\( \forall x_1 \), ισχύει:}
            \\ \dot V &\leq
            -x_1-2x_2^2 + x_1x_2(1+\sin x_1)
            \\ &= -\left[\begin{matrix}
            x_1 &x_2
            \end{matrix}\right]\left[\begin{matrix}
            1 & -\frac{1+\sin x_1}{2}\\
            -\frac{1+\sin x_1}{2} & 2
            \end{matrix}\right]\left[\begin{matrix}
            x_1 \\ x_2
            \end{matrix}\right]
    	\end{align*}
    	όπου για να είναι αρνητική θέλουμε ο πίνακας
    	\( \left[\begin{matrix}
    	1 & -\frac{1+\sin x_1}{2}\\
    	-\frac{1+\sin x_1}{2} & 2
    	\end{matrix}\right] \) να θετικά ορισμένος.

    	Πράγματι, οι κύριες ελάσσονες ορίζουσές του είναι:
    	\begin{gather*}
    		1 > 0\quad \checkmark\\
    		2 - \frac{(1+\sin x_1)^2}{4} > 0 \iff
    		8 > (1+\sin x_1)^2\quad \checkmark
    	\end{gather*}

    	Άρα το σημείο είναι ολικά ασυμπτωτικά ευσταθές.
    \end{enumerate}
\end{exercise}

\lecture{21}{25/5/2018}
\subsection{Ελεγκτές υψηλού κέρδους}

Το μάθημα των Συστημάτων Αυτομάτου Ελέγχου έχει τη δυσκολία ότι απαιτεί το σχεδιασμό
μεθόδων και ελεγκτών που ανταποκρίνονται στις πραγματικές καταστάσεις, υπό εξωτερικές
διαταραχές και θόρυβο, ακόμα κι αν υπάρχουν σφάλματα στη μοντελοποίηση.

Στα πλαίσια των ΣΑΕ υπάρχει η έννοια του \textbf{Ελεγκτή υψηλού κέρδους} (High Gain Controller),
ο οποίος είναι ένας ελεγκτής που μπορεί να ελέγξει συστήματα για τα οποία δεν έχουμε κάποια πληροφορία.

Για παράδειγμα, μπορεί να έχουμε στη διάθεσή μας ένα σύστημα:
\[
\dot y = ay + u
\]
για το οποίο το \( a \) \textbf{δεν είναι γνωστό}, και ούτε
είναι γνωστό το πρόσημό του, και να θέλουμε να σχεδιάσουμε έναν
ελεγκτή \( u \) ο οποίος θα αποκρίνεται σωστά για οποιαδήποτε τιμή
του \( a \).

Για παράδειγμα, μπορεί να έχουμε δύο συστήματα ίδιας μαθηματικής έκφρασης:
\begin{align*}
	\dot y_1 &= a_1 y_1 + u\\
	\dot y_2 &= a_2 y_2 + u
\end{align*}
και να θέλουμε να ελέγξουμε και τα δύο συστήματα με τον \textbf{ίδιο} ελεγκτή
\( u \), αφού έχουν ίδια μαθηματική περιγραφή, αλλά διαφορετική τιμή των
αριθμητικών σταθερών.

Στα προηγούμενα κεφάλαια, είδαμε πως θα έπρεπε να σχεδιάσουμε τους ελεγκτές και να
επιλέξουμε διαφορετικές παραμέτρους για αυτούς, διαφορετικές ανάλογα με το σύστημα
υπό έλεγχο. Όμως η ρύθμιση των παραμέτρων αυτών ήταν κατά κανόνα μία δύσκολη διαδικασια,
την οποία θα προσπαθήσουμε να αποφύγουμε.

Έστω ότι επιλέγουμε τον γνωστό ελεγκτή:
\[
u = -ky
\]
για \( k>0 \). Τότε το σύστημα γίνεται:
\[
\dot y = (a-k)y
\]

Αν δώσουμε πολύ μεγάλη τιμή στο \( k \to \infty \) (δηλαδή \textbf{high gain} για τον ελεγκτή), τότε ο
όρος \( (a-k) \) θα είναι σίγουρα αρνητικός, και θα έχουμε καταφέρει να ελέγξουμε το σύστημα. Αυτή βέβαια
είναι μια απλοϊκή προσέγγιση, όμως θεωρητικά μπορεί να δουλέψει ακόμα και για περίεργα συστήματα. Καθιστά δηλαδή το σύστημα ασυμπτωτικά ευσταθές, αδιάφορα από την τιμή του \( a \).

\paragraph{}

Αν έχουμε \textbf{διαταραχές} \( a \), το σύστημα αποκτά τη μορφή:
\[
\dot y = ay + u + d(t)
\]
όπου οι διαταραχές είναι φραγμένες \( \left|d(t)\right|\leq \bar d \).

Για να μελετήσουμε το σύστημα, επιλέγουμε τον ίδιο ελεγκτή και θεωρούμε την υποψήφια συνάρτηση Lyapunov:
\begin{align*}
	V &= \frac{1}{2} y^2 \\
	\dot V &= y\dot y = y\left[ ay + u + d(t) \right]
	\\ &= (a-k)y^2 + yd(t) \\
	&\leq (a-k)|y|^2 + |y|\bar{d}
	\\ &= |y|\left[ (a-k)|y| + \bar d \right]
\end{align*}
άρα τελικά, για να έχουμε \( \dot V \leq 0 \):
\[
|y| > \frac{\bar d}{k-a}
\]
και το σύστημα θα είναι \textbf{ομοιόμορφα τελικώς φραγμένο}, με τις καταστάσεις του να τείνουν στο σύνολο:
\[
Y \overset{\triangle}{=} \left\lbrace
y \in \mathbb R: |y| \leq \frac{\bar{d}}{k-a}
 \right\rbrace
\]

Επομένως για πολύ μεγάλες τιμές του \( k \), το σύστημα θα τείνει σε ένα
όλο και μικρότερο σύνολο τιμών.

\paragraph{}
Στην πράξη όμως, όσο μεγαλώνει το \( k \), μεγαλώνει και ο συντελεστής
\( (a-k) \) στον όρο
\[
\dot y = (a-k) y
\]

Όσο αυξάνεται ο όρος αυτός, μεγαλώνουν οι τιμές των ιδιοτιμών και το εύρος ζώνης του συστήματος, και γίνεται πολύ πιο ευάλωτο σε \textbf{θόρυβο}. Πράγματι, αν θεωρήσουμε ότι \( n \) είναι ο θόρυβος, ο ελεγκτής θα είναι της μορφής \( u = -k(y+n) \) και θα αποκτά πολύ μεγάλες τιμές για θόρυβο
\( n \). Και όπως είναι γνωστό, στα πραγματικά συστήματα δεν μπορούμε να μετρήσουμε χωρίς θόρυβο.

\paragraph{}
Βέβαια, αν δεν γνωρίζουμε τίποτα για το \( a \), δεν μπορούμε να ξέρουμε
το εύρος τιμών στις οποίες μπορεί να ανήκει το \( k \). Για αυτό, θα
αλλάξουμε τον ελεγκτή, και θα αποκτήσει τη μορφή:
\[
u = -ky
\]
με την τιμή του \( k \) να μεταβάλλεται σύμφωνα με τη σχέση:
\[
\dot k = γy^2,\quad \gamma>0,\ k(0) > 0
\]

Οι παραπάνω ονομάζονται \textbf{προσαρμοστικοί ελεγκτές} (adaptive controllers, ή στη συγκεκριμένη περίπτωση high gain adaptive controllers)
και είναι εκ κατασκευής μη γραμμικοί.

Η ιδέα για την παραπάνω επιλογή είναι ότι ψάχνουμε ένα αρκούντως μεγάλο
\( k \). Ξεκινάμε από μια θετική αρχική τιμή του \( k \), και το δεξί μέρος
της παραπάνω Διαφορικής Εξίσωσης είναι θετικό. Τότε το \( k \) θα αυξάνεται,
και επομένως θα γίνει κάποια στιγμή μεγαλύτερο του \( a \), και το σύστημα
κλειστού βρόχου θα οδηγηθεί στην ευστάθεια, και το \( y \) θα τείνει στο 0.

Βέβαια μπορούν να εμφανιστούν προβλήματα αν το \( k \) τείνει να αυξηθεί
πολύ γρήγορα και οδηγούμαστε σε κάποια εσωτερική αστάθεια. Επίσης, το σύστημα γίνεται μη γραμμικό λόγω του όρου \( y^2 \), και δυσκολότερο
στην ανάλυση.

\paragraph{Απόδειξη}
Ουσιαστικά έχουμε ένα σύστημα με δύο καταστάσεις, δηλαδή:
\begin{align*}
	x_1 &= y \\
	x_2 &= k
\end{align*}

Επομένως το σύστημα μπορεί να γραφτεί στη μορφή:
\begin{align*}
	\dot x_1 &= ax_1 + u\\
	\dot x_2 &= γx_1^2
\end{align*}

Εφ' όσον είναι μη γραμμικό, θεωρούμε την υποψήφια συνάρτηση Lyapunov:
\[
V = \frac{1}{2} x_1^2 + \frac{1}{2} x_2^2
\]
με χρονική παράγωγο:
\begin{align*}
	\dot V &=
	x_1\dot x_1 + x_2\dot x_2
	=
	\underbrace{ax_1^2}_{\geq 0}
	\underbrace{- x_1^2 x_2
	+ γx_1^2 x_2}_{\text{εξαρτάται από τις τιμές } \gamma,a}
\end{align*}
Η παραπάνω δίνει ικανοποιητικά αποτελέσματα για \( γ\in (0,1] \), όμως
αυτό μπορεί να μη δίνει ικανοποιητικά αποτελέσματα, επειδή δεν αυξάνεται
αρκετά γρήγορα το \( k \).

Θεωρούμε μία διαφορετική συνάρτηση Lyapunov:
\[
V = \frac{1}{2} x_1^2 + \frac{1}{2\gamma} x_2^2
\]
οπότε:
\begin{align*}
	\dot V =
	x_1\dot x_1 + x_2\dot x_2
	&=
	ax_1^2
	- x_1^2 x_2 + x_1^2 x_2
	\\ &= ax_1^2
\end{align*}
που είναι \( \geq 0 \) για \( a < 0 \), αλλά δε λειτουργεί για \( a>0 \),
δηλαδή εκ των προτέρων ασταθή συστήματα.

Αν μελετήσουμε τα σημεία ισορροπίας του συστήματος, θα διαπιστώσουμε
πως για \( \dot x_1 = \dot x_2 = 0 \), τα σημεία ισορροπίας του συστήματος
ανήκουν στην ευθεία \( (0,c) \). Δηλαδή πρέπει \( y = x_1 = 0 \), ενώ
το \( x_2 = k \) αποκτά οποιαδήποτε τιμή.

Επομένως, θα θεωρήσουμε υποψήφια συνάρτηση Lyapunov που λαμβάνει υπ' όψιν
και τις θέσεις των σημείων ισορροπίας:
\[
V = \frac{1}{2} x_1^2 +\frac{1}{2γ}(x_2 - c)^2
\]
και, μετά από πράξεις, θα προκύψει:
\[
\dot V = (a-c) x_1^2 \quad \leq 0 \quad \text{για } c > a.
\]

Επίσης, θα εφαρμόσουμε το θεώρημα LaSalle για να εγγυηθούμε \textbf{σύγκλιση} στο 0, αφού δείξαμε μόνο ότι η \( \dot V \) είναι
αρνητικά \textbf{ημι}ορισμένη. Θεωρούμε το σύνολο \( S \):
\[
S \overset{\triangle}{=} \left\lbrace
x \in \mathbb R^2:
\dot V = 0
 \right\rbrace = \left\lbrace
 x\in\mathbb R^2: x_1 = 0
  \right\rbrace
\]

Σύμφωνα με το θεώρημα, θα συγκλίνουμε στο μεγαλύτερο δυνατό αμετάβλητο υποσύνολο \( S \), άρα για το \( k \) θα οδηγηθούμε σε μια τιμή μεγαλύτερη
από το \( a \), το \( x_1 \) θα τείνει στο \( 0 \), και το σύστημα θα είναι
φραγμένο, αφού \( \dot V \leq 0 \).

\paragraph{}
Αν θεωρήσουμε ότι υπάρχουν \textbf{διαταραχές}, μπορούμε (μετά από πράξεις) να οδηγηθούμε στο συμπέρασμα ότι η παραπάνω συνάρτηση Lyapunov
ικανοποιεί τη σχέση:
\[
\dot V \leq |x_1| \left[
(a-c)|x_1| + \bar d
\right]
\]

Επομένως σε πεπερασμένο χρόνο θα εγκλωβιστούμε στο σύνολο:
\[
Υ \overset{\triangle}{=} \left\lbrace y \in \mathbb R
: |y| \leq \frac{\bar d}{c-a} \right\rbrace
\]

Μέσα σε αυτό το σύνολο η παράγωγος \( \dot V \) μπορεί να έχει οποιοδήποτε
πρόσημο. Ακόμα κι αν βρισκόμαστε μέσα στο σύνολο \( Y \), δεν γνωρίζουμε
για τη μεταβλητή \( x_2 = k \), η οποία μπορεί να αυξάνεται και γίνεται
ανεξέλεγκτη. Στην καλύτερη περίπτωση, \( \dot V < 0 \) και δεν υπάρχει
πρόβλημα, ενώ στην χειρότερη \( \dot V > 0 \), και το \( k \) οδηγείται
στο \( \infty \). Αυτό το πρόβλημα ονομάζεται \textbf{παραμετρική ολίσθηση}
και είναι συνηθισμένο πρόβλημα στον Αυτόματο Έλεγχο. Για την αντιμετώπισή
του, εμφανίστηκαν αλγόριθμοι (εύρωστοι προσαρμοστικοί αλγόριθμοι) που
εξασφαλίζουν ότι το πρόβλημα αυτό δεν πρόκειται να εφαρμοστεί.

\begin{exercise}
	Έστω το μοντέλο του κινητήρα συνεχούς ρεύματος:
	\begin{align*}
		T_a \od{I_a}{t} &= -I_a - \Phi \Omega + V_a \\
		T_m \od{\Omega}{t} &= \Phi I_a - k_a\Omega \\
		T_f \od{\Phi}{t} &= -I_f + V_f
	\end{align*}
	όπου \( \Phi = a I_f \).
	\tcblower
	Στο σύστημα αυτό οι \textbf{είσοδοι ελέγχου} είναι οι \( V_a \) και
	\( V_f \).

	Ως \textbf{μεταβλητές κατάστασης} επιλέγουμε τις
	\( I_a \), \( \Omega \) και \( \Phi \), ή την \( I_f \) έναντι
	της \( \Phi \).

	Οι \( T_a \), \( T_m \), \( T_f \) και \( k_a \) είναι
	\textbf{σταθερές} του συστήματος.
\end{exercise}

\end{document}
